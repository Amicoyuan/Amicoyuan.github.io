{
    "version": "https://jsonfeed.org/version/1",
    "title": "Amicoyuan",
    "description": "",
    "home_page_url": "https://xingyuanjie.top",
    "items": [
        {
            "id": "https://xingyuanjie.top/2023/03/08/cuda013/",
            "url": "https://xingyuanjie.top/2023/03/08/cuda013/",
            "title": "ç»„ç»‡å¹¶è¡Œç¼–ç¨‹",
            "date_published": "2023-03-08T14:13:01.000Z",
            "content_html": "<h2 id=\"ç»„ç»‡å¹¶è¡Œç¼–ç¨‹\"><a href=\"#ç»„ç»‡å¹¶è¡Œç¼–ç¨‹\" class=\"headerlink\" title=\"ç»„ç»‡å¹¶è¡Œç¼–ç¨‹\"></a>ç»„ç»‡å¹¶è¡Œç¼–ç¨‹</h2><p>ä»å‰é¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœä½¿ç”¨äº†åˆé€‚çš„ç½‘æ ¼å’Œå—å¤§å°æ¥æ­£ç¡®åœ°ç»„ç»‡çº¿ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥å¯¹å†…æ ¸æ€§èƒ½äº§ç”Ÿå¾ˆå¤§çš„å½±å“ã€‚åœ¨å‘é‡åŠ æ³•çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†å®ç°æœ€ä½³æ€§èƒ½æˆ‘ä»¬è°ƒæ•´äº†å—çš„å¤§å°ï¼Œå¹¶åŸºäºå—å¤§å°å’Œå‘é‡æ•°æ®å¤§å°è®¡ç®—å‡ºäº†ç½‘æ ¼å¤§å°ã€‚</p>\n<p>ç°åœ¨é€šè¿‡ä¸€ä¸ªçŸ©é˜µåŠ æ³•çš„ä¾‹å­è¯´æ˜è¿™ä¸€ç‚¹ã€‚å¯¹äºçŸ©é˜µè¿ç®—ï¼Œä¼ ç»Ÿçš„æ–¹æ³•æ˜¯åœ¨å†…æ ¸ä¸­ä½¿ç”¨ä¸€ä¸ªåŒ…å«äºŒç»´ç½‘æ ¼ä¸äºŒä½å—çš„å¸ƒå±€æ¥ç»„ç»‡çº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œè¿™ç§ä¼ ç»Ÿçš„æ–¹æ³•æ— æ³•è·å¾—æœ€ä½³æ€§èƒ½ã€‚åœ¨çŸ©é˜µåŠ æ³•ä¸­ä½¿ç”¨ä»¥ä¸‹å¸ƒå±€å°†æœ‰åŠ©äºäº†è§£æ›´å¤šå…³äºç½‘æ ¼å’Œå—çš„å¯å‘æ€§çš„ç”¨æ³•ï¼š</p>\n<ol>\n<li>æœ‰äºŒç»´çº¿ç¨‹å—æ„æˆçš„äºŒç»´ç½‘æ ¼</li>\n<li>ç”±ä¸€ç»´çº¿ç¨‹å—æ„æˆçš„ä¸€ç»´ç½‘æ ¼</li>\n<li>ç”±ä¸€ç»´çº¿ç¨‹å—æ„æˆçš„äºŒç»´ç½‘æ ¼</li>\n</ol>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/07/CUDA012/",
            "url": "https://xingyuanjie.top/2023/03/07/CUDA012/",
            "title": "CUDAç»™æ ¸å‡½æ•°è®¡æ—¶",
            "date_published": "2023-03-07T01:53:34.000Z",
            "content_html": "<h2 id=\"CUDAç»™æ ¸å‡½æ•°è®¡æ—¶\"><a href=\"#CUDAç»™æ ¸å‡½æ•°è®¡æ—¶\" class=\"headerlink\" title=\"CUDAç»™æ ¸å‡½æ•°è®¡æ—¶\"></a>CUDAç»™æ ¸å‡½æ•°è®¡æ—¶</h2><p>åœ¨å†…æ ¸çš„æ€§èƒ½è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œäº†è§£æ ¸å‡½æ•°çš„æ‰§è¡Œéœ€è¦å¤šé•¿æ—¶é—´æ˜¯å¾ˆæœ‰å¸®åŠ©å¹¶ä¸”ååˆ†å…³é”®çš„ã€‚è¡¡é‡æ ¸å‡½æ•°æ€§èƒ½çš„æ–¹æ³•æœ‰å¾ˆå¤šã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨ä¸»æœºç«¯ä½¿ç”¨ä¸€ä¸ªCPUæˆ–GPUè®¡æ—¶å™¨æ¥è®¡ç®—å†…æ ¸çš„æ‰§è¡Œæ—¶é—´ã€‚åœ¨æœ¬èŠ‚ï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ªCPUè®¡æ—¶å™¨ï¼Œå¹¶ä½¿ç”¨NVIDIAåˆ†æå·¥å…·æ¥è®¡ç®—æ‰§è¡Œæ—¶é—´ã€‚</p>\n<h3 id=\"ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶\"><a href=\"#ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶\" class=\"headerlink\" title=\"ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶\"></a>ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶</h3><p>å¯ä»¥ä½¿ç”¨gettimeofdayç³»ç»Ÿè°ƒç”¨æ¥åˆ›å»ºä¸€ä¸ªCPUè®¡æ—¶å™¨ï¼Œä»¥è·å–ç³»ç»Ÿçš„æ—¶é’Ÿæ—¶é—´ï¼Œå®ƒå°†è¿”å›è‡ª1970å¹´1æœˆ1æ—¥é›¶ç‚¹ä»¥æ¥ï¼Œåˆ°ç°åœ¨çš„ç§’æ•°ã€‚ç¨‹åºä¸­éœ€è¦æ·»åŠ sys&#x2F;time.hå¤´æ–‡ä»¶ï¼Œå¦‚ä»£ç æ¸…å•2-5æ‰€ç¤ºã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">double</span> <span class=\"hljs-title\">cpuSecond</span><span class=\"hljs-params\">()</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-class\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title\">timeval</span> <span class=\"hljs-title\">tp</span>;</span><br>    <span class=\"hljs-built_in\">gettimeofday</span>(&amp;tp,<span class=\"hljs-literal\">NULL</span>);<br>    <br>    <span class=\"hljs-keyword\">return</span> ((<span class=\"hljs-keyword\">double</span>)tp.tv_sec + (<span class=\"hljs-keyword\">double</span>)tp.tv_usec*<span class=\"hljs-number\">1.e-6</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä½ å¯ä»¥ç”¨cpuSecondå‡½æ•°æ¥æµ‹è¯•ä½ çš„æ ¸å‡½æ•°ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">double</span> iStart = <span class=\"hljs-built_in\">cpuSecond</span>();<br>kernel_name&lt;&lt;&lt;grid,block&gt;&gt;&gt;(argument list);<br><span class=\"hljs-built_in\">cudaDeviceSynchronize</span>();<br><span class=\"hljs-keyword\">double</span> iElaps = <span class=\"hljs-built_in\">cpuSecond</span>() - iStart;<br></code></pre></div></td></tr></table></figure>\n\n<p>ç”±äºæ ¸å‡½æ•°è°ƒç”¨ä¸ä¸»æœºç«¯ç¨‹åºæ˜¯å¼‚æ­¥çš„ï¼Œä½ éœ€è¦ç”¨cudaDeviceSynchronizeå‡½æ•°æ¥ç­‰å¾…æ‰€æœ‰çš„GPUçº¿ç¨‹è¿è¡Œç»“æŸã€‚å˜é‡iElapsè¡¨ç¤ºç¨‹åºè¿è¡Œçš„æ—¶é—´ï¼Œå°±åƒä½ ç”¨æ‰‹è¡¨è®°å½•çš„æ ¸å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ï¼ˆç”¨ç§’è®¡ç®—ï¼‰ã€‚</p>\n<p>ç°åœ¨ï¼Œé€šè¿‡è®¾ç½®æ•°æ®é›†å¤§å°æ¥å¯¹ä¸€ä¸ªæœ‰16Mä¸ªå…ƒç´ çš„å¤§å‘é‡è¿›è¡Œæµ‹è¯•ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">int</span> nElem = <span class=\"hljs-number\">1</span>&lt;&lt;<span class=\"hljs-number\">24</span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>ç”±äºGPUçš„å¯æ‰©å±•æ€§ï¼Œä½ éœ€è¦å€ŸåŠ©å—å’Œçº¿ç¨‹çš„ç´¢å¼•æ¥è®¡ç®—ä¸€ä¸ªæŒ‰è¡Œä¼˜å…ˆçš„æ•°ç»„ç´¢å¼• i ï¼Œå¹¶å¯¹æ ¸å‡½æ•°è¿›è¡Œä¿®æ”¹ï¼Œæ·»åŠ é™å®šæ¡ä»¶ï¼ˆi &lt; Nï¼‰æ¥æ£€éªŒç´¢å¼•å€¼æ˜¯å¦è¶Šç•Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">__global__ <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">sumArraysOnGPU</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *A, <span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C, <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">int</span> N)</span></span>&#123;<br>    <span class=\"hljs-keyword\">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;<br>    <span class=\"hljs-keyword\">if</span>( n &lt; N) C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>æœ‰äº†è¿™äº›æ›´æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ‰§è¡Œé…ç½®æ¥è¡¡é‡æ ¸å‡½æ•°ã€‚ä¸ºäº†è§£å†³åˆ›å»ºçš„çº¿ç¨‹æ€»æ•°å¤§äºå‘é‡å…ƒç´ æ€»æ•°çš„æƒ…å†µï¼Œä½ éœ€è¦é™åˆ¶å†…æ ¸ä¸èƒ½éæ³•è®¿é—®å…¨å±€å†…å­˜ï¼Œå¦‚å›¾2-7æ‰€ç¤ºã€‚</p>\n<p><img src=\"/2023/03/07/CUDA012/image-20230307120643741.png\" alt=\"image-20230307120643741\"></p>\n<p>ä»£ç æ¸…å•2-5å±•ç¤ºäº†å¦‚ä½•åœ¨ä¸»å‡½æ•°ä¸­ç”¨CPUè®¡æ—¶å™¨æµ‹è¯•å‘é‡åŠ æ³•çš„æ ¸å‡½æ•°ã€‚</p>\n<p>ä»£ç æ¸…å•2-5\tæµ‹è¯•å‘é‡åŠ æ³•çš„æ ¸å‡½æ•°ï¼ˆsumArraysOnGPU-timer.cuï¼‰</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;cuda_runtime.h&gt;</span></span><br><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdio.h&gt;</span></span><br><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;sys/time.h&gt;</span></span><br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> argc,<span class=\"hljs-keyword\">char</span> **argv)</span></span>&#123;<br>    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;%s Starting...\\n&quot;</span>,argv[<span class=\"hljs-number\">0</span>]);<br>    <br>    <span class=\"hljs-comment\">//set up device</span><br>    <span class=\"hljs-keyword\">int</span> dev = <span class=\"hljs-number\">0</span>;<br>    cudaDeviceProp deviceProp;<br>    <span class=\"hljs-built_in\">CHECK</span>(<span class=\"hljs-built_in\">cudaGetDeviceProperties</span>(&amp;deviceProp, dev));<br>    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Using Device %d: %s\\n&quot;</span>, dev, deviceProp.name);<br>    <span class=\"hljs-built_in\">CHECK</span>(<span class=\"hljs-built_in\">cudaSetDevice</span>(dev));<br>    <br>    <span class=\"hljs-comment\">//set up data size of vectors</span><br>    <span class=\"hljs-keyword\">int</span> nElem = <span class=\"hljs-number\">1</span>&lt;&lt;<span class=\"hljs-number\">24</span>;<br>    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Vector size %d\\n&quot;</span>,nElem);<br>    <br>    <span class=\"hljs-comment\">//malloc host memory</span><br>    <span class=\"hljs-keyword\">size_t</span> nBytes = nElem * <span class=\"hljs-built_in\"><span class=\"hljs-keyword\">sizeof</span></span>(<span class=\"hljs-keyword\">float</span>);<br>    <br>    <span class=\"hljs-keyword\">float</span> *h_A, *h_B, *hostRef, *gpuRef;<br>    h_A = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    h_B = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    hostRef = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    gpuRef = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    <br>    <span class=\"hljs-keyword\">double</span> iStart,iElaps;<br>    <br>    <span class=\"hljs-comment\">//initialize data at host side</span><br>    iStart = <span class=\"hljs-built_in\">cpuSecond</span>();<br>    <span class=\"hljs-built_in\">initialData</span>(h_A, nElem);<br>    <span class=\"hljs-built_in\">initialData</span>(h_B, nElem);<br>    iElaps = <span class=\"hljs-built_in\">cpuSecond</span>() - iStart;<br>    <br>    <span class=\"hljs-built_in\">memset</span>(hostRef, <span class=\"hljs-number\">0</span> ,nBytes);<br>    <span class=\"hljs-built_in\">memset</span>(gpuRef, <span class=\"hljs-number\">0</span> ,nBytes);<br>    <br>    <span class=\"hljs-comment\">//add vector at host side for result checks</span><br>    iStart = <span class=\"hljs-built_in\">cpuSecond</span>();<br>    <span class=\"hljs-built_in\">sumArraysOnHost</span>(h_A, h_B, hostRef, nElem);<br>    iElaps = <span class=\"hljs-built_in\">cpuSecond</span>() - iStart;<br>    <br>    <span class=\"hljs-comment\">//malloc device global memory</span><br>    <span class=\"hljs-keyword\">float</span> *d_A, *d_B, *d_C;<br>    <span class=\"hljs-built_in\">cudaMalloc</span>((<span class=\"hljs-keyword\">float</span>**)&amp;d_A, nBytes);<br>    <span class=\"hljs-built_in\">cudaMalloc</span>((<span class=\"hljs-keyword\">float</span>**)&amp;d_B, nBytes);<br>    <span class=\"hljs-built_in\">cudaMalloc</span>((<span class=\"hljs-keyword\">float</span>**)&amp;d_C, nBytes);<br>    <br>    <span class=\"hljs-comment\">//transfer data from host to device</span><br>    <span class=\"hljs-built_in\">cudaMemcpy</span>(d_A, h_A, nBytes, cudaMemcpyHostTodevice);<br>    <span class=\"hljs-built_in\">cudaMemcpy</span>(d_B, h_B, nBytes, cudaMemcpyHostTodevice);<br>    <br>    <span class=\"hljs-comment\">//invoke kernel at host side</span><br>    <span class=\"hljs-keyword\">int</span> iLen = <span class=\"hljs-number\">1024</span>;<br>    <span class=\"hljs-function\">dim3 <span class=\"hljs-title\">block</span><span class=\"hljs-params\">(iLen)</span></span>;<br>    <span class=\"hljs-function\">dim3 <span class=\"hljs-title\">grid</span><span class=\"hljs-params\">((nElem+block.x<span class=\"hljs-number\">-1</span>))</span>/block.x)</span>;<br>    <br>    iStart = <span class=\"hljs-built_in\">cpuSecond</span>();<br>    sumArraysOnGPU&lt;&lt;&lt;grid,block&gt;&gt;&gt;(d_A, d_B, d_C,nElem);<br>    <span class=\"hljs-built_in\">cudaDeviceSynchronize</span>();<br>    iElaps = <span class=\"hljs-built_in\">cpuSecond</span>() - iStart;<br>    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;sumArraysOnGPU&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec\\n&quot;</span>,grid.x, block.x, iElaps);<br>    <br>    <span class=\"hljs-comment\">//copy kernel result back to host side</span><br>    <span class=\"hljs-built_in\">cudaMemcpy</span>(gpuRef, d_C, nBytes, cudaMemcpyDeviceToHost);<br>    <br>    <span class=\"hljs-comment\">//check device results</span><br>    <span class=\"hljs-built_in\">checkResult</span>(hostRef, gpuRef, nElem);<br>    <br>    <span class=\"hljs-comment\">//free device global memory</span><br>    <span class=\"hljs-built_in\">cudaFree</span>(d_A);<br>    <span class=\"hljs-built_in\">cudaFree</span>(d_B);<br>    <span class=\"hljs-built_in\">cudaFree</span>(d_C);<br>    <br>    <span class=\"hljs-comment\">//free host memory</span><br>    <span class=\"hljs-built_in\">free</span>(h_A);<br>    <span class=\"hljs-built_in\">free</span>(h_B);<br>    <span class=\"hljs-built_in\">free</span>(hostRef);<br>    <span class=\"hljs-built_in\">free</span>(gpuRef);<br>    <br>    <span class=\"hljs-keyword\">return</span>(<span class=\"hljs-number\">0</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>é»˜è®¤çš„æ‰§è¡Œé…ç½®è¢«è®¾ç½®ä¸ºä¸€ä¸ªåŒ…å«16384ä¸ªå—çš„ä¸€ç»´ç½‘æ ¼ï¼Œæ¯ä¸ªå—åŒ…å«1024ä¸ªçº¿ç¨‹ã€‚ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">nvcc sumArraysOnGPU-timer.cu -o sumArraysOnGPU-timer<br>./sumArraysOnGPU-timer<br></code></pre></div></td></tr></table></figure>\n\n<p>åœ¨åŸºäºè‹±ç‰¹å°”Sandy Bridgeæ¶æ„çš„ç³»ç»Ÿä¸Šè¿›è¡Œæµ‹è¯•ï¼Œä»ä»£ç æ¸…å•2-5çš„ç¤ºä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨GPUä¸Šè¿›è¡Œçš„å‘é‡åŠ æ³•çš„è¿ç®—é€Ÿåº¦æ˜¯åœ¨CPUä¸Šè¿è¡Œå‘é‡åŠ æ³•çš„3.86å€ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">./sumArraysOnGPU-timer Starting...<br>Using Device 0:Tesia M2070<br>Vector size 16777216<br>sumArraysOnGPU&lt;&lt;&lt;16384, 1024&gt;&gt;&gt;\t\tTime elapsed 0.002456 sec<br>Arrays match.<br></code></pre></div></td></tr></table></figure>\n\n<p>æŠŠå—çš„ç»´åº¦å‡å°‘åˆ°512å¯ä»¥åˆ›å»º32768ä¸ªå—ã€‚åœ¨è¿™ä¸ªæ–°çš„é…ç½®ä¸‹ï¼Œå†…æ ¸çš„æ€§èƒ½æå‡äº†1.19å€ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">sumArraysOnGPU&lt;&lt;&lt;32768, 512&gt;&gt;&gt;\tTime elapsed 0.002058 sec<br></code></pre></div></td></tr></table></figure>\n\n<p>å¦‚æœè¿›ä¸€æ­¥å°†å—çš„ç»´åº¦é™ä½åˆ°256ï¼Œç³»ç»Ÿå°†æç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼Œä¿¡æ¯è¡¨ç¤ºå—çš„æ€»æ•°è¶…è¿‡ä¸€ç»´ç½‘æ ¼çš„é™åˆ¶ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">./sumArraysOnGPU-timer Starting...<br>Using Device 0:\tTesla M2070<br>Vector size 16777216<br>sumArraysOnGPU&lt;&lt;&lt;65536, 256&gt;&gt;&gt;  Time elapsed 0.000183 sec<br>Error: sumArraysOnGPU-timer.cu:153, code:9, reason: invalid configuration argument<br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"äº†è§£è‡ªèº«å±€é™æ€§\"><a href=\"#äº†è§£è‡ªèº«å±€é™æ€§\" class=\"headerlink\" title=\"äº†è§£è‡ªèº«å±€é™æ€§\"></a>äº†è§£è‡ªèº«å±€é™æ€§</h3><p>åœ¨è°ƒæ•´æ‰§è¡Œé…ç½®æ—¶éœ€è¦äº†è§£çš„ä¸€ä¸ªå…³é”®ç‚¹æ˜¯å¯¹ç½‘æ ¼å’Œå—ç»´åº¦çš„é™åˆ¶ã€‚çº¿ç¨‹å±‚æ¬¡ç»“æ„ä¸­æ¯ä¸ªå±‚æ¬¡çš„æœ€å¤§å°ºå¯¸å–å†³äºè®¾å¤‡ã€‚</p>\n<p>CUDAæä¾›äº†é€šè¿‡æŸ¥è¯¢GPUæ¥äº†è§£è¿™äº›é™åˆ¶çš„èƒ½åŠ›ã€‚</p>\n<p>å¯¹äºFermiè®¾å¤‡ï¼Œæ¯ä¸ªå—çš„æœ€å¤§çº¿ç¨‹æ•°æ˜¯1024ï¼Œä¸”ç½‘æ ¼çš„x,y,zä¸‰ä¸ªæ–¹å‘ä¸Šçš„ç»´åº¦æœ€å¤§å€¼æ˜¯65535</p>\n<h3 id=\"ç”¨nvprofå·¥å…·è®¡æ—¶\"><a href=\"#ç”¨nvprofå·¥å…·è®¡æ—¶\" class=\"headerlink\" title=\"ç”¨nvprofå·¥å…·è®¡æ—¶\"></a>ç”¨nvprofå·¥å…·è®¡æ—¶</h3><p>è‡ªCUDA 5.0ä»¥æ¥ï¼ŒNVIDIAæä¾›äº†ä¸€ä¸ªåä¸ºnvprofçš„å‘½ä»¤è¡Œåˆ†æå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä»åº”ç”¨ç¨‹åºçš„CPUå’ŒGPUæ´»åŠ¨æƒ…å†µä¸­è·å–æ—¶é—´çº¿ä¿¡æ¯ï¼Œå…¶åŒ…æ‹¬å†…æ ¸æ‰§è¡Œï¼Œå†…å­˜ä¼ è¾“ä»¥åŠCUDA APIçš„è°ƒç”¨ã€‚å…¶ç”¨æ³•å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">nvprof [nvprof_args] &lt;application&gt;  [application_args]<br></code></pre></div></td></tr></table></figure>\n\n<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–æ›´å¤šå…³äºnvprofçš„å¸®åŠ©ä¿¡æ¯ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">nvprof --help<br></code></pre></div></td></tr></table></figure>\n\n<p>ä½ å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤å»æµ‹è¯•å†…æ ¸ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">nvprof  ./sumArraysOnGPU-timer<br></code></pre></div></td></tr></table></figure>\n\n<p>nvprofçš„è¾“å‡ºç»“æœä¼šå› ä¸ºä½ ä½¿ç”¨çš„GPUç±»å‹ä¸åŒè€Œæœ‰æ‰€å·®å¼‚ã€‚ä»¥ä¸‹ç»“æœæ˜¯ä»Tesla GPUä¸­å¾—åˆ°çš„ï¼š</p>\n<p><img src=\"/2023/03/07/CUDA012/image-20230307142027522.png\" alt=\"image-20230307142027522\"></p>\n<p>ä»¥ä¸Šç»“æœçš„å‰åŠéƒ¨åˆ†æ¥è‡ªäºç¨‹åºçš„è¾“å‡ºï¼ŒååŠéƒ¨åˆ†æ¥è‡ªäºnvprofçš„è¾“å‡ºã€‚å¯ä»¥æ³¨æ„åˆ°ï¼ŒCPUè®¡æ—¶å™¨æ˜¾ç¤ºæ¶ˆè€—çš„å†…æ ¸æ—¶é—´ä¸º3.26msï¼Œè€Œnvprofæ˜¾ç¤ºæ¶ˆè€—çš„å†…æ ¸æ—¶é—´ä¸º2.90msã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œnvprofçš„ç»“æœæ›´ä¸ºç²¾ç¡®ï¼Œå› ä¸ºCPUè®¡æ—¶å™¨æµ‹é‡çš„æ—¶é—´ä¸­åŒ…å«äº†æ¥è‡ªnvprofé™„åŠ çš„æ—¶é—´ã€‚</p>\n<p>nvprofæ˜¯ä¸€ä¸ªèƒ½å¸®åŠ©ä½ ç†è§£åœ¨æ‰§è¡Œåº”ç”¨ç¨‹åºæ—¶æ‰€èŠ±è´¹çš„æ—¶é—´ä¸»è¦ç”¨åœ¨ä½•å¤„çš„å¼ºå¤§å·¥å…·ã€‚å¯ä»¥æ³¨æ„åˆ°ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“éœ€è¦çš„æ—¶é—´æ¯”å†…æ ¸æ‰§è¡Œçš„æ—¶é—´è¦å¤šã€‚å›¾2-8æ‰€æç»˜çš„æ—¶é—´çº¿ï¼ˆæœªæŒ‰æ¯”ä¾‹ç»˜åˆ¶ï¼‰ï¼Œæ˜¾ç¤ºäº†åœ¨CPUä¸Šæ¶ˆè€—çš„æ—¶é—´ï¼Œæ•°æ®ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ä»¥åŠåœ¨GPUä¸Šè®¡ç®—æ‰€ç”¨çš„æ—¶é—´ã€‚</p>\n<p><img src=\"/2023/03/07/CUDA012/image-20230307145539161.png\" alt=\"image-20230307145539161\"></p>\n<p>å¯¹äºHPCå·¥ä½œè´Ÿè½½ï¼Œç†è§£ç¨‹åºä¸­é€šä¿¡æ¯”çš„è®¡ç®—æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºç”¨äºè®¡ç®—çš„æ—¶é—´å¤§äºæ•°æ®ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ï¼Œé‚£ä¹ˆæˆ–è®¸å¯ä»¥å‹ç¼©è¿™äº›æ“ä½œï¼Œå¹¶å®Œå…¨éšè—ä¸ä¼ è¾“æ•°æ®æœ‰å…³çš„å»¶è¿Ÿã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºç”¨äºè®¡ç®—çš„æ—¶é—´å°‘äºæ•°æ®ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ï¼Œé‚£ä¹ˆéœ€è¦å°½é‡å‡å°‘ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„ä¼ è¾“ã€‚</p>\n<h3 id=\"æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–\"><a href=\"#æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–\" class=\"headerlink\" title=\"æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–\"></a>æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–</h3><p>åœ¨è¿›è¡Œç¨‹åºä¼˜åŒ–æ—¶ï¼Œå¦‚ä½•å°†åº”ç”¨ç¨‹åºå’Œç†è®ºç•Œé™è¿›è¡Œæ¯”è¾ƒæ˜¯å¾ˆé‡è¦çš„ã€‚ç”±nvprofå¾—åˆ°çš„è®¡æ•°å™¨å¯ä»¥å¸®åŠ©ä½ è·å–åº”ç”¨ç¨‹åºçš„æŒ‡ä»¤å’Œå†…å­˜ååé‡ã€‚å¦‚æœå°†åº”ç”¨ç¨‹åºçš„æµ‹é‡å€¼ä¸ç†è®ºå³°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¯ä»¥åˆ¤å®šä½ çš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½æ˜¯å—é™äºç®—æ³•è¿˜æ˜¯å—é™äºå†…å­˜å¸¦å®½çš„ã€‚ä»¥Tesla K10ä¸ºä¾‹ï¼Œå¯ä»¥å¾—åˆ°ç†è®ºä¸Šçš„æ¯”ç‡ï¼š</p>\n<p>Tesla K10å•ç²¾åº¦å³°å€¼æµ®ç‚¹è¿ç®—æ¬¡æ•°</p>\n<p>745 MHzæ ¸å¿ƒé¢‘ç‡*2 GPU&#x2F;èŠ¯ç‰‡*  ï¼ˆ8ä¸ªå¤šå¤„ç†å™¨<em>192ä¸ªæµ®ç‚¹å•å…ƒ</em>32æ ¸å¿ƒ&#x2F;å¤šå¤„ç†å™¨ï¼‰*2OPS&#x2F;å‘¨æœŸ &#x3D; 4.58 TFLOPS ï¼ˆFLOPSè¡¨ç¤ºæ¯ç§’æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼‰</p>\n<p>Tesla K10å†…å­˜å¸¦å®½å³°å€¼</p>\n<p>2 GPU&#x2F;èŠ¯ç‰‡<em>256ä½</em>2500 MHzå†…å­˜æ—¶é’Ÿ*2 DDR&#x2F;8ä½&#x2F;å­—èŠ‚ &#x3D; 320 GB&#x2F;s</p>\n<p>æŒ‡ä»¤æ¯”ï¼šå­—èŠ‚</p>\n<p>4.58 TFLOPS&#x2F;320 GB&#x2F;s,\tä¹Ÿå°±æ˜¯13.6ä¸ªæŒ‡ä»¤ï¼š1ä¸ªå­—èŠ‚</p>\n<p>å¯¹äºTesla K10è€Œè¨€ï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ¯è®¿é—®ä¸€ä¸ªå­—èŠ‚æ‰€äº§ç”Ÿçš„æŒ‡ä»¤æ•°å¤šäº13.6ï¼Œé‚£ä¹ˆä½ çš„åº”ç”¨ç¨‹åºå—ç®—æ³•æ€§èƒ½é™åˆ¶ã€‚å¤§å¤šæ•°HPCå·¥ä½œè´Ÿè½½å—å†…å­˜å¸¦å®½çš„é™åˆ¶ã€‚</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/06/ML001/",
            "url": "https://xingyuanjie.top/2023/03/06/ML001/",
            "title": "çº¿æ€§å›å½’æ¨¡å‹",
            "date_published": "2023-03-06T11:00:34.000Z",
            "content_html": "<h2 id=\"çº¿æ€§å›å½’æ¨¡å‹\"><a href=\"#çº¿æ€§å›å½’æ¨¡å‹\" class=\"headerlink\" title=\"çº¿æ€§å›å½’æ¨¡å‹\"></a>çº¿æ€§å›å½’æ¨¡å‹</h2><h3 id=\"MOdel-Representation\"><a href=\"#MOdel-Representation\" class=\"headerlink\" title=\"MOdel Representation\"></a>MOdel Representation</h3><p><img src=\"/2023/03/06/ML001/image-20230306195956356.png\" alt=\"image-20230306195956356\"></p>\n<h3 id=\"Goals\"><a href=\"#Goals\" class=\"headerlink\" title=\"Goals\"></a>Goals</h3><p>In this lab you will:</p>\n<ul>\n<li>learn to implement the model f_{w,b} for linear regression with one variable</li>\n</ul>\n<h3 id=\"Notation\"><a href=\"#Notation\" class=\"headerlink\" title=\"Notation\"></a>Notation</h3><p>Here is a summary of some of the notation you will encounter.</p>\n<p><img src=\"/2023/03/06/ML001/image-20230306200250050.png\" alt=\"image-20230306200250050\"></p>\n<h3 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><p>In this lab you will make use of:</p>\n<ul>\n<li><p>NumPy,a popular library for scientific computing</p>\n</li>\n<li><p>Matplotlib,a popular library for plotting data</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np<br><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt<br>plt.style.use(<span class=\"hljs-string\">&#x27;./deeplearning.mpstyle&#x27;</span>)<br></code></pre></div></td></tr></table></figure></li>\n</ul>\n<h3 id=\"Problem-Statement\"><a href=\"#Problem-Statement\" class=\"headerlink\" title=\"Problem Statement\"></a>Problem Statement</h3><p><img src=\"/2023/03/06/ML001/image-20230306200642937.png\" alt=\"image-20230306200642937\"></p>\n<p>As in the lecture,you will use the motivating example of housing price prediction. This lab will use a simple data set with only two data points - a house with 1000 square feet(sqft) sold for $300,000 and a house with 2000 square feet sold for $500,000.These two points will constitute our data or training set. In this lab, the units of size are 1000 sqft and the units of price are 1000s of dollars.</p>\n<table>\n<thead>\n<tr>\n<th>Size (1000 sqft)</th>\n<th>Price (1000s of dollars)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1.0</td>\n<td>300</td>\n</tr>\n<tr>\n<td>2.0</td>\n<td>500</td>\n</tr>\n</tbody></table>\n<p>You would like to fit a linear regression model(shown above as the blue straight line)through these two points, so you can then predict price for other houses - say, a house with 1200 sqft.</p>\n<p>Please run the following code cell to create your x_train and y_train variables. The data is stored in one-dimensional NumPy arrays.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\"><span class=\"hljs-comment\">#x_train is the input variable (size in 1000 square feet)</span><br><span class=\"hljs-comment\">#y_train is the target (price in 1000s of dollars)</span><br>x_train = np.array([<span class=\"hljs-number\">1.0</span>,<span class=\"hljs-number\">2.0</span>])<br>y_train = np.array([<span class=\"hljs-number\">300.0</span>,<span class=\"hljs-number\">500.0</span>])<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;x_train = <span class=\"hljs-subst\">&#123;x_train&#125;</span>&quot;</span>)<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;y_train = <span class=\"hljs-subst\">&#123;y_train&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"Number-of-training-examples-m\"><a href=\"#Number-of-training-examples-m\" class=\"headerlink\" title=\"Number of training examples m\"></a>Number of training examples m</h3><p>you will use m to denote the number of training examples. Numpy arrays have a .shape parameter. x_train.shape return a python tuple with an entry for each dimension. x_train.shape[0] is the length of the array and number of examples as shown below.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\"><span class=\"hljs-comment\"># m is the number of training examples</span><br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;x_train.shape: <span class=\"hljs-subst\">&#123;x_train.shape&#125;</span>&quot;</span>)<br>m = x_train.shape[<span class=\"hljs-number\">0</span>]<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Number of training example is: <span class=\"hljs-subst\">&#123;m&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure>\n\n<p>x.train.shape: (2,)</p>\n<p>Number of training examples is: 2</p>\n<p><strong>One can also use the Python len() function as shown below.</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\"><span class=\"hljs-comment\"># m is the number of training examples</span><br>m = <span class=\"hljs-built_in\">len</span>(x_train)<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Number of training example is: <span class=\"hljs-subst\">&#123;m&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure>\n\n<p>Number of training examples  is:\t2</p>\n<h3 id=\"Training-example-x-i-y-i\"><a href=\"#Training-example-x-i-y-i\" class=\"headerlink\" title=\"Training example x_i, y_i\"></a>Training example x_i, y_i</h3><p>You will use (x(ğ‘–), y(ğ‘–)) to denote the ğ‘–(th) training example. Since Python is zero indexed, (x(0), y(0) is (1.0, 300.0) and (x(1), y(1) is (2.0, 500.0).</p>\n<p>To access a value in a Numpy array, one indexes the array with the desired offset. For example the syntax to access location zero of x_train is x_train[0]. Run the next code block below to get the i(th) training example.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">i = <span class=\"hljs-number\">0</span> <span class=\"hljs-comment\">#Change this to 1 to see (x^1,y^1)</span><br><br>x_i = x_train[i]<br>y_i = y_train[i]<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;(x^(<span class=\"hljs-subst\">&#123;i&#125;</span>), y^(<span class=\"hljs-subst\">&#123;i&#125;</span>)) = (<span class=\"hljs-subst\">&#123;x_i&#125;</span>, <span class=\"hljs-subst\">&#123;y_i&#125;</span>)&quot;</span>)<br></code></pre></div></td></tr></table></figure>\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">(x^(<span class=\"hljs-number\">0</span>), y^(<span class=\"hljs-number\">0</span>)) = (<span class=\"hljs-number\">1.0</span>, <span class=\"hljs-number\">300.0</span>)<br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"Plotting-the-data\"><a href=\"#Plotting-the-data\" class=\"headerlink\" title=\"Plotting the data\"></a>Plotting the data</h3><p>You can plot these two points using the scatter() function is the matplotlib library,as shown in the cell below.</p>\n<ul>\n<li>The function arguments marker and c show the points as red crosses(the default is blue dots.)</li>\n</ul>\n<p>You can use other functions in the matplotlib library to set title and labels to display.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\"><span class=\"hljs-comment\">#Plot the data points</span><br>plt.scatter(x_train, y_train, marker=<span class=\"hljs-string\">&#x27;x&#x27;</span> c=<span class=\"hljs-string\">&#x27;r&#x27;</span>)<br><span class=\"hljs-comment\">#Set the title</span><br>plt.title(<span class=\"hljs-string\">&quot;Housing Prices&quot;</span>)<br><span class=\"hljs-comment\">#Set the y-axis label</span><br>plt.ylabel(<span class=\"hljs-string\">&#x27;Price (in 1000s of dollars)&#x27;</span>)<br><span class=\"hljs-comment\">#Set the x-axis lbel</span><br>plt.xlabel(<span class=\"hljs-string\">&#x27;Size (1000 sqft)&#x27;</span>)<br>plt.show()<br></code></pre></div></td></tr></table></figure>\n\n<p><img src=\"/2023/03/06/ML001/image-20230306204822102.png\" alt=\"image-20230306204822102\"></p>\n<h3 id=\"Model-function\"><a href=\"#Model-function\" class=\"headerlink\" title=\"Model function\"></a>Model function</h3><p><img src=\"/2023/03/06/ML001/image-20230306204918585.png\" alt=\"image-20230306204918585\"></p>\n<p>As described in lecture, the model function for linear regression (which is a function that maps from x to y)is represented as</p>\n<p><img src=\"/2023/03/06/ML001/image-20230306205107527.png\" alt=\"image-20230306205107527\"></p>\n<p>The formula above is how you can represent straight lines - different values of w and b give you different straight lines on the plot.</p>\n<p>Letâ€™s try to get a better intuition for this through the code blocks below. Letâ€™s start with w &#x3D; 100 and b &#x3D;100.</p>\n<p>Note: You can come back to this cell to adjust the modelâ€™s w and b parameters.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">w = <span class=\"hljs-number\">100</span><br>b = <span class=\"hljs-number\">100</span><br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;w: <span class=\"hljs-subst\">&#123;w&#125;</span>&quot;</span>)<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;b: <span class=\"hljs-subst\">&#123;b&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure>\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">w:\t<span class=\"hljs-number\">100</span><br>b:\t<span class=\"hljs-number\">100</span><br></code></pre></div></td></tr></table></figure>\n\n<p>Now,letâ€™s compute the value of f_{w,b}(x^i) for your two data points. You can explicitly write this out for each data poins as -</p>\n<p>for x(0),f_wb &#x3D; w * x[0] + b</p>\n<p>for x(1),f_wb &#x3D; w * x[1] + b</p>\n<p>For a large number of data points, this can get unwieldy and repetitive. So instead, you can calculate the function output in a for loop as shown in the compute_model_output function below.</p>\n<p>Note:The argument description (ndarray (m,)) describes a Numpy n-dimensional array of shape (m,). (scalar) describes an argument without dimensions, just a magnitude.</p>\n<p>Note: np.zero(n) will return a one-dimensional numpy array with n entries</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title\">compute_model_output</span>(<span class=\"hljs-params\">x, w, b</span>):</span><br>    <span class=\"hljs-string\">&quot;&quot;&quot;</span><br><span class=\"hljs-string\">    Computes the prediction of a linear model</span><br><span class=\"hljs-string\">    Args:</span><br><span class=\"hljs-string\">    \tx (ndarray (m,)):Data, m examples</span><br><span class=\"hljs-string\">    \tw,b (scalar)\t:model parameters</span><br><span class=\"hljs-string\">    Returns</span><br><span class=\"hljs-string\">    \ty (ndarray (m,)):target values</span><br><span class=\"hljs-string\">    &quot;&quot;&quot;</span><br>    <br>    m = x.shape[<span class=\"hljs-number\">0</span>]<br>    f_wb = np.zeros(m)<br>    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(m)<br>    \tf_wb[i] = w * x[i] + b<br>    <br>    <span class=\"hljs-keyword\">return</span> f_wb<br></code></pre></div></td></tr></table></figure>\n\n<p>Now letâ€™s call the compute_model_output function and plot the output.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">tmp_f_wb = compute_model_output(x_train, w, b,)<br><br><span class=\"hljs-comment\">#Plot our model prediction</span><br>plt.plot(x_train, tmp_f_wb, c=<span class=\"hljs-string\">&#x27;b&#x27;</span>,label=<span class=\"hljs-string\">&#x27;Our Prediction&#x27;</span>)<br><br><span class=\"hljs-comment\">#Plot the data points</span><br>plt.scatter(x_train, y_train, marker=<span class=\"hljs-string\">&#x27;x&#x27;</span>, c=<span class=\"hljs-string\">&#x27;r&#x27;</span>,label=<span class=\"hljs-string\">&#x27;Actual Values&#x27;</span>)<br><br><span class=\"hljs-comment\">#Set the title</span><br>plt.title(<span class=\"hljs-string\">&quot;Housing Prices&quot;</span>)<br><span class=\"hljs-comment\">#Set the y-axis label</span><br>plt.ylabel(<span class=\"hljs-string\">&#x27;Price (in 1000s of dollars)&#x27;</span>)<br><span class=\"hljs-comment\">#Set the x-axis label</span><br>plt.xlabel(<span class=\"hljs-string\">&#x27;Size (1000 sqft)&#x27;</span>)<br>plt.legend()<br>plt.show()<br></code></pre></div></td></tr></table></figure>\n\n<p><img src=\"/2023/03/06/ML001/image-20230306211337338.png\" alt=\"image-20230306211337338\"></p>\n<p>As you can see, setting w &#x3D; 100 and b &#x3D; 100 does not result in a line that fits our data.</p>\n<h3 id=\"Challenge\"><a href=\"#Challenge\" class=\"headerlink\" title=\"Challenge\"></a>Challenge</h3><p>Try experimenting with different values of w and b. What should the values be for a line that fits our data?</p>\n<p><strong>Tips:</strong></p>\n<p>You can use  your mouse to click on the triangle to the left of the green â€œHintsâ€ below to reveal some hints for choosing b and w.</p>\n<p><strong>Hints</strong></p>\n<h3 id=\"Prediction\"><a href=\"#Prediction\" class=\"headerlink\" title=\"Prediction\"></a>Prediction</h3><p>Now that we have a model, we can use it to make our original prediction. Letâ€™s predict the price of a house with 1200 sqft. Since the units of x are in 1000â€™s of sqft, x is 1.2.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">w = <span class=\"hljs-number\">200</span><br>b = <span class=\"hljs-number\">100</span><br>x_i = <span class=\"hljs-number\">1.2</span><br>cost_1200sqft = w * x_i + b<br><span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;$<span class=\"hljs-subst\">&#123;cost_1200sqft:<span class=\"hljs-number\">.0</span>f&#125;</span> thousand dollars&quot;</span> )<br></code></pre></div></td></tr></table></figure>\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs python\">$<span class=\"hljs-number\">340</span> thousand dollars<br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"Congratulations\"><a href=\"#Congratulations\" class=\"headerlink\" title=\"Congratulations!\"></a>Congratulations!</h3><p>In this lab you have learned:</p>\n<ul>\n<li>Linear regression bulids a model which establishes a relationship between features and targets</li>\n<li>In the example above, the feature was house size and the target was house price</li>\n<li>for simple linear regression, the model has two parameters w and b whose calue are â€˜fitâ€™ using training data.</li>\n<li>once a modelâ€™s parameters have been determined, the model can be used to make predictions on novel data.</li>\n</ul>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797\">https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797</a></p>\n<p><a href=\"https://github.com/kaieye/2022-Machine-Learning-Specialization\">kaieye&#x2F;2022-Machine-Learning-Specialization (github.com)</a></p>\n",
            "tags": [
                "Tensorflow",
                "Machine Learning"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/06/cuda011/",
            "url": "https://xingyuanjie.top/2023/03/06/cuda011/",
            "title": "CUDAç¼–è¯‘ä¸æ‰§è¡Œ",
            "date_published": "2023-03-06T08:18:09.000Z",
            "content_html": "<h2 id=\"CUDAç¼–è¯‘ä¸æ‰§è¡Œ\"><a href=\"#CUDAç¼–è¯‘ä¸æ‰§è¡Œ\" class=\"headerlink\" title=\"CUDAç¼–è¯‘ä¸æ‰§è¡Œ\"></a>CUDAç¼–è¯‘ä¸æ‰§è¡Œ</h2><p>ç°åœ¨æŠŠæ‰€æœ‰çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶åä¸ºsumArraysOnGPU-small-case.cuçš„æ–‡ä»¶ä¸­ï¼Œå¦‚ä»£ç æ¸…å•2-4æ‰€ç¤ºã€‚</p>\n<p><strong>ä»£ç æ¸…å•2-4\t\tåŸºäºGPUçš„å‘é‡åŠ æ³•ï¼ˆsumArraysOnGPU-small-case.cuï¼‰</strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;cuda_runtime.h&gt;</span></span><br><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdio.h&gt;</span></span><br><span class=\"hljs-comment\">/*</span><br><span class=\"hljs-comment\">#define CHECK(call)</span><br><span class=\"hljs-comment\">&#123;</span><br><span class=\"hljs-comment\">    const cudaError_t error = call;</span><br><span class=\"hljs-comment\">    if(error != cudaSuccess)</span><br><span class=\"hljs-comment\">    &#123;</span><br><span class=\"hljs-comment\">        printf(&quot;Error:%s:%d, &quot;, __FILE__, __LINE__);</span><br><span class=\"hljs-comment\">        printf(&quot;code:%d, reason: %s\\n&quot;, error, cudaGetErrorString(error));</span><br><span class=\"hljs-comment\">    &#125;</span><br><span class=\"hljs-comment\">&#125;</span><br><span class=\"hljs-comment\">*/</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">checkResult</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *hostRef, <span class=\"hljs-keyword\">float</span> *gpuRef, <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">int</span> N)</span></span>&#123;<br>    <span class=\"hljs-keyword\">double</span> epsilon = <span class=\"hljs-number\">1.0E-8</span>;<br>    <span class=\"hljs-keyword\">int</span> match = <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span> ;i &lt; N; i++)&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">abs</span>(hostRef[i] - gpuRef[i]) &gt; epsilon)&#123;<br>            match = <span class=\"hljs-number\">0</span>;<br>            <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Arrays do not match!\\n&quot;</span>);<br>            <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;host %5.2f gpu %5.2f at current %d\\n&quot;</span>,hostRef[i],gpuRef[i],i);<br>            <span class=\"hljs-keyword\">break</span>;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span>(match) <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Arrays match.\\n\\n&quot;</span>);<br>    <span class=\"hljs-keyword\">return</span>;<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">initialData</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *ip,<span class=\"hljs-keyword\">int</span> size)</span></span>&#123;<br>    <span class=\"hljs-comment\">//generate different seed for random number</span><br>    <span class=\"hljs-keyword\">time_t</span> t;<br>    <span class=\"hljs-built_in\">srand</span>((<span class=\"hljs-keyword\">unsigned</span>) <span class=\"hljs-built_in\">time</span>(&amp;t));<br>    <br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i&lt;size;i++)&#123;<br>        ip[i] = (<span class=\"hljs-keyword\">float</span>)(<span class=\"hljs-built_in\">rand</span>() &amp; <span class=\"hljs-number\">0xFF</span>) /<span class=\"hljs-number\">10.0f</span>;<br>    &#125;<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">sumArraysOnHost</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *A,<span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C)</span></span>&#123;<br>    <span class=\"hljs-keyword\">int</span> i = threadIdx.x;<br>    C[i] = A[i] + B[i];<br>&#125;<br><br><span class=\"hljs-function\">__gloal__ <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">sumArraysOnGPU</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *A, <span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C)</span></span>&#123;<br>    <span class=\"hljs-keyword\">int</span> i = threadIdx.x;<br>    C[i] = A[i] + B[i];<br>&#125;<br><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> argc,<span class=\"hljs-keyword\">char</span> **argv)</span></span>&#123;<br>    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;%s Starting...\\n&quot;</span>,argv[<span class=\"hljs-number\">0</span>]);<br>    <br>    <span class=\"hljs-comment\">//set up device</span><br>    <span class=\"hljs-keyword\">int</span> dev = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-built_in\">cudaSetDevice</span>(dev);<br>    <br>    <span class=\"hljs-comment\">//set up data size of vectors</span><br>    <span class=\"hljs-keyword\">int</span> nElem = <span class=\"hljs-number\">32</span>;<br>    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Vector size %d\\n&quot;</span>,nElem);<br>    <br>    <span class=\"hljs-comment\">//malloc host memory</span><br>    <span class=\"hljs-keyword\">size_t</span> nBytes = nElem * <span class=\"hljs-built_in\"><span class=\"hljs-keyword\">sizeof</span></span>(<span class=\"hljs-keyword\">float</span>);<br>    <br>    <span class=\"hljs-keyword\">float</span> *h_A, *h_B, *hostRef, *gpuRef;<br>    h_A = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    h_B = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    hostRef = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    gpuRef = (<span class=\"hljs-keyword\">float</span>*)<span class=\"hljs-built_in\">malloc</span>(nBytes);<br>    <br>    <span class=\"hljs-comment\">//initialize data at host side</span><br>    <span class=\"hljs-built_in\">initialData</span>(h_A, nElem);<br>    <span class=\"hljs-built_in\">initialData</span>(h_B, nElem);<br>    <br>    <span class=\"hljs-built_in\">memset</span>(hostRef, <span class=\"hljs-number\">0</span> ,nBytes);<br>    <span class=\"hljs-built_in\">memset</span>(gpuRef, <span class=\"hljs-number\">0</span> ,nBytes);<br>    <br>    <span class=\"hljs-comment\">//malloc device global memory</span><br>    <span class=\"hljs-keyword\">float</span> *d_A, *d_B, *d_C;<br>    <span class=\"hljs-built_in\">cudaMalloc</span>((<span class=\"hljs-keyword\">float</span>**)&amp;d_A, nBytes);<br>    <span class=\"hljs-built_in\">cudaMalloc</span>((<span class=\"hljs-keyword\">float</span>**)&amp;d_B, nBytes);<br>    <span class=\"hljs-built_in\">cudaMalloc</span>((<span class=\"hljs-keyword\">float</span>**)&amp;d_C, nBytes);<br>    <br>    <span class=\"hljs-comment\">//transfer data from host to device</span><br>    <span class=\"hljs-built_in\">cudaMemcpy</span>(d_A, h_A, nBytes, cudaMemcpyHostTodevice);<br>    <span class=\"hljs-built_in\">cudaMemcpy</span>(d_B, h_B, nBytes, cudaMemcpyHostTodevice);<br>    <br>    <span class=\"hljs-comment\">//invoke kernel at host side</span><br>    <span class=\"hljs-function\">dim3 <span class=\"hljs-title\">block</span><span class=\"hljs-params\">(nElem)</span></span>;<br>    <span class=\"hljs-function\">dim3 <span class=\"hljs-title\">grid</span><span class=\"hljs-params\">(nElem/block.x)</span></span>;<br>    <br>    sumArraysOnGPU&lt;&lt;&lt;grid,block&gt;&gt;&gt;(d_A, d_B, d_C);<br>    <span class=\"hljs-built_in\">pritnf</span>(<span class=\"hljs-string\">&quot;Execution configuration &lt;&lt;&lt;%d, %d&gt;&gt;&gt;\\n&quot;</span>,grid.x,block.x);<br>    <br>    <span class=\"hljs-comment\">//copy kernel result back to host side</span><br>    <span class=\"hljs-built_in\">cudaMemcpy</span>(gpuRef, d_C, nBytes, cudaMemcpyDeviceToHost);<br>    <br>    <span class=\"hljs-comment\">//add vector at host side for result checks</span><br>    <span class=\"hljs-built_in\">sumArraysOnHost</span>(h_A, h_B, hostRef, nElem);<br>    <br>    <span class=\"hljs-comment\">//check device results</span><br>    <span class=\"hljs-built_in\">checkResult</span>(hostRef, gpuRef, nElem);<br>    <br>    <span class=\"hljs-comment\">//free device global memory</span><br>    <span class=\"hljs-built_in\">cudaFree</span>(d_A);<br>    <span class=\"hljs-built_in\">cudaFree</span>(d_B);<br>    <span class=\"hljs-built_in\">cudaFree</span>(d_C);<br>    <br>    <span class=\"hljs-comment\">//free host memory</span><br>    <span class=\"hljs-built_in\">free</span>(h_A);<br>    <span class=\"hljs-built_in\">free</span>(h_B);<br>    <span class=\"hljs-built_in\">free</span>(hostRef);<br>    <span class=\"hljs-built_in\">free</span>(gpuRef);<br>    <br>    <span class=\"hljs-keyword\">return</span>(<span class=\"hljs-number\">0</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå‘é‡å¤§å°è¢«è®¾ç½®ä¸º32ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">int</span> nElem = <span class=\"hljs-number\">32</span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>æ‰§è¡Œé…ç½®è¢«æ”¾å…¥ä¸€ä¸ªå—å†…ï¼Œå…¶ä¸­åŒ…å«32ä¸ªå…ƒç´ ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">dim3 <span class=\"hljs-title\">block</span><span class=\"hljs-params\">(nElem)</span></span>;<br><span class=\"hljs-function\">dim3 <span class=\"hljs-title\">grid</span><span class=\"hljs-params\">(nElem/block.x)</span></span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘å’Œæ‰§è¡Œè¯¥å¸¦å•Šå—ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">nvcc sumArraysOnGPU-small-case.cu -o addvector<br>./addvector<br></code></pre></div></td></tr></table></figure>\n\n<p>ç³»ç»ŸæŠ¥å‘Šå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">./addvector Starting...<br>Vector size 32<br>Execution configuration &lt;&lt;&lt;1,32&gt;&gt;&gt;<br>Arrays match.<br></code></pre></div></td></tr></table></figure>\n\n<p>å¦‚æœä½ å°†æ‰§è¡Œé…ç½®é‡æ–°å®šä¹‰ä¸º32ä¸ªå—ï¼Œæ¯ä¸ªå—åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼›</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">dim3 <span class=\"hljs-title\">block</span><span class=\"hljs-params\">(<span class=\"hljs-number\">1</span>)</span></span>;<br><span class=\"hljs-function\">dim3 <span class=\"hljs-title\">grid</span><span class=\"hljs-params\">(nElem)</span></span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>é‚£ä¹ˆå°±éœ€è¦åœ¨ä»£ç æ¸…å•2-4ä¸­å¯¹æ ¸å‡½æ•°sumArraysOnGPUè¿›è¡Œä¿®æ”¹ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">ç”¨<span class=\"hljs-keyword\">int</span> i = threadIdx.x;    æ›¿æ¢<span class=\"hljs-keyword\">int</span> i = blockIdx.x;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥åŸºäºç»™å®šçš„ä¸€ç»´ç½‘æ ¼å’Œå—çš„ä¿¡æ¯æ¥è®¡ç®—å…¨å±€æ•°æ®è®¿é—®çš„å”¯ä¸€ç´¢å¼•ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">__gloal__ <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">sumArraysOnGPU</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *A, <span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C)</span></span>&#123;<br>    <span class=\"hljs-keyword\">int</span> i = blockIdx.x * blockDim.x * threadIdx.x;<br>    C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä½ éœ€è¦ç¡®ä¿ä¸€èˆ¬æƒ…å†µä¸‹è¿›è¡Œæ›´æ”¹æ‰€äº§ç”Ÿç»“æœçš„æ­£ç¡®æ€§ã€‚</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/06/cuda010/",
            "url": "https://xingyuanjie.top/2023/03/06/cuda010/",
            "title": "CUDAå¤„ç†é”™è¯¯",
            "date_published": "2023-03-06T08:17:59.000Z",
            "content_html": "<h2 id=\"CUDAå¤„ç†é”™è¯¯\"><a href=\"#CUDAå¤„ç†é”™è¯¯\" class=\"headerlink\" title=\"CUDAå¤„ç†é”™è¯¯\"></a>CUDAå¤„ç†é”™è¯¯</h2><p>ç”±äºè®¸å¤šCUDAè°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æœ‰æ—¶å¯èƒ½å¾ˆéš¾ç¡®å®šæŸä¸ªé”™è¯¯æ˜¯ç”±å“ªä¸€æ­¥ç¨‹åºå¼•èµ·çš„ã€‚å®šä¹‰ä¸€ä¸ªé”™è¯¯å¤„ç†å®å°è£…æ‰€æœ‰çš„CUDA APIè°ƒç”¨ï¼Œè¿™ç®€åŒ–äº†é”™è¯¯æ£€æŸ¥è¿‡ç¨‹ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">define</span> CHECK(call)</span><br>&#123;<br>    <span class=\"hljs-keyword\">const</span> cudaError_t error = call;<br>    <span class=\"hljs-keyword\">if</span>(error != cudaSuccess)<br>    &#123;<br>        <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Error:%s:%d, &quot;</span>, __FILE__, __LINE__);<br>        <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;code:%d, reason: %s\\n&quot;</span>, error, <span class=\"hljs-built_in\">cudaGetErrorString</span>(error));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ä»¥ä¸‹ä»£ç ä¸­ä½¿ç”¨å®ï¼š</p>\n<figure class=\"highlight reasonml\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs reasonml\"><span class=\"hljs-constructor\">CHECK(<span class=\"hljs-params\">cudaMemcpy</span>(<span class=\"hljs-params\">d_C</span>, <span class=\"hljs-params\">gpuRef</span>, <span class=\"hljs-params\">nBytes</span>, <span class=\"hljs-params\">cudaMemcpyHostToDevice</span>)</span>);<br></code></pre></div></td></tr></table></figure>\n\n<p>å¦‚æœå†…å­˜æ‹·è´æˆ–ä¹‹å‰çš„å¼‚æ­¥æ“ä½œäº§ç”Ÿäº†é”™è¯¯ï¼Œè¿™ä¸ªå®ä¼šæŠ¥å‘Šé”™è¯¯ä»£ç ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªå¯è¯»ä¿¡æ¯ï¼Œç„¶ååœæ­¢ç¨‹åºã€‚ä¹Ÿå¯ä»¥ç”¨ä¸‹è¿°æ–¹æ³•ï¼Œåœ¨æ ¸å‡½æ•°è°ƒç”¨åæ£€æŸ¥æ ¸å‡½æ•°é”™è¯¯ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">kernel_function&lt;&lt;&lt;grid,block&gt;&gt;&gt;(argument list);<br><span class=\"hljs-built_in\">CHECK</span>(<span class=\"hljs-built_in\">cudaDeviceSynchronize</span>());<br></code></pre></div></td></tr></table></figure>\n\n<p>CHECK(cudaDeviceSynchronize())ä¼šé˜»å¡ä¸»æœºç«¯çº¿ç¨‹çš„è¿è¡Œç›´åˆ°è®¾å¤‡ç«¯æ‰€æœ‰çš„è¯·æ±‚ä»»åŠ¡éƒ½ç»“æŸï¼Œå¹¶ç¡®ä¿æœ€åçš„æ ¸å‡½æ•°å¯åŠ¨éƒ¨åˆ†ä¸ä¼šå‡ºé”™ã€‚ä»¥ä¸Šä»…æ˜¯ä»¥è°ƒè¯•ä¸ºç›®çš„çš„ï¼Œå› ä¸ºåœ¨æ ¸å‡½æ•°å¯åŠ¨åæ·»åŠ è¿™ä¸ªæ£€æŸ¥ç‚¹ä¼šé˜»å¡ä¸»æœºç«¯çº¿ç¨‹ï¼Œä½¿è¯¥æ£€æŸ¥ç‚¹æˆä¸ºå…¨å±€å±éšœã€‚</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/06/cuda009/",
            "url": "https://xingyuanjie.top/2023/03/06/cuda009/",
            "title": "CUDAéªŒè¯æ ¸å‡½æ•°",
            "date_published": "2023-03-06T08:06:35.000Z",
            "content_html": "<h2 id=\"CUDAéªŒè¯æ ¸å‡½æ•°\"><a href=\"#CUDAéªŒè¯æ ¸å‡½æ•°\" class=\"headerlink\" title=\"CUDAéªŒè¯æ ¸å‡½æ•°\"></a>CUDAéªŒè¯æ ¸å‡½æ•°</h2><p>æ—¢ç„¶ä½ å·²ç»ç¼–å†™äº†æ ¸å‡½æ•°ï¼Œä½ å¦‚ä½•èƒ½çŸ¥é“å®ƒæ˜¯å¦æ­£ç¡®è¿è¡Œï¼Ÿä½ éœ€è¦ä¸€ä¸ªä¸»æœºå‡½æ•°æ¥éªŒè¯æ ¸å‡½æ•°çš„ç»“æœã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">checkResult</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *hostRef, <span class=\"hljs-keyword\">float</span> *gpuRef, <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">int</span> N)</span></span>&#123;<br>    <span class=\"hljs-keyword\">double</span> epsilon = <span class=\"hljs-number\">1.0E-8</span>;<br>    <span class=\"hljs-keyword\">int</span> match = <span class=\"hljs-number\">1</span>;<br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span> ;i &lt; N; i++)&#123;<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">abs</span>(hostRef[i] - gpuRef[i]) &gt; epsilon)&#123;<br>            match = <span class=\"hljs-number\">0</span>;<br>            <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Arrays do not match!\\n&quot;</span>);<br>            <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;host %5.2f gpu %5.2f at current %d\\n&quot;</span>,hostRef[i],gpuRef[i],i);<br>            <span class=\"hljs-keyword\">break</span>;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span>(match) <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">&quot;Arrays match.\\n\\n&quot;</span>);<br>    <span class=\"hljs-keyword\">return</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"éªŒè¯æ ¸å‡½æ•°ä»£ç \"><a href=\"#éªŒè¯æ ¸å‡½æ•°ä»£ç \" class=\"headerlink\" title=\"éªŒè¯æ ¸å‡½æ•°ä»£ç \"></a>éªŒè¯æ ¸å‡½æ•°ä»£ç </h3><p>é™¤äº†è®¸å¤šå¯ç”¨çš„è°ƒè¯•å·¥å…·å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªéå¸¸ç®€å•å®ç”¨çš„æ–¹æ³•å¯ä»¥éªŒè¯æ ¸å‡½æ•°ã€‚</p>\n<p>é¦–å…ˆï¼Œä½ å¯ä»¥åœ¨FermiåŠæ›´é«˜ç‰ˆæœ¬çš„è®¾å¤‡ç«¯çš„æ ¸å‡½æ•°ä¸­ä½¿ç”¨printfå‡½æ•°ã€‚</p>\n<p>å…¶æ¬¡ï¼Œå¯ä»¥å°†æ‰§è¡Œå‚æ•°è®¾ç½®ä¸º&lt;&lt;&lt;1,1&gt;&gt;&gt;ï¼Œå› æ­¤å¼ºåˆ¶ç”¨ä¸€ä¸ªå—å’Œä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ ¸å‡½æ•°ï¼Œè¿™æ¨¡æ‹Ÿäº†ä¸²è¡Œæ‰§è¡Œç¨‹åºã€‚è¿™å¯¹äºè°ƒè¯•å’ŒéªŒè¯ç»“æœæ˜¯å¦æ­£ç¡®æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œè€Œä¸”ï¼Œå¦‚æœä½ é‡åˆ°äº†è¿ç®—æ¬¡åºçš„é—®é¢˜ï¼Œè¿™æœ‰åŠ©äºä½ å¯¹æ¯”éªŒè¯æ•°å€¼ç»“æœæ˜¯å¦æ˜¯æŒ‰ä½ç²¾ç¡®çš„ã€‚</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/06/cuda008/",
            "url": "https://xingyuanjie.top/2023/03/06/cuda008/",
            "title": "CUDAç¼–å†™æ ¸å‡½æ•°",
            "date_published": "2023-03-06T07:46:00.000Z",
            "content_html": "<h2 id=\"ç¼–å†™æ ¸å‡½æ•°\"><a href=\"#ç¼–å†™æ ¸å‡½æ•°\" class=\"headerlink\" title=\"ç¼–å†™æ ¸å‡½æ•°\"></a>ç¼–å†™æ ¸å‡½æ•°</h2><p>æ ¸å‡½æ•°æ˜¯åœ¨è®¾å¤‡ç«¯æ‰§è¡Œçš„ä»£ç ã€‚åœ¨æ ¸å‡½æ•°ä¸­ï¼Œéœ€è¦ä¸ºä¸€ä¸ªçº¿ç¨‹è§„å®šè¦è¿›è¡Œçš„è®¡ç®—ä»¥åŠè¦è¿›è¡Œçš„æ•°æ®è®¿é—®ã€‚å½“æ ¸å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè®¸å¤šä¸åŒçš„CUDAçº¿ç¨‹å¹¶è¡Œæ‰§è¡ŒåŒä¸€ä¸ªè®¡ç®—ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ç”¨_<em>global</em>_</p>\n<p>å£°æ˜å®šä¹‰æ ¸å‡½æ•°ï¼š</p>\n<figure class=\"highlight reasonml\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs reasonml\">__global__  void kernel<span class=\"hljs-constructor\">_name(<span class=\"hljs-params\">argument</span> <span class=\"hljs-params\">list</span>)</span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>æ ¸å‡½æ•°å¿…é¡»æœ‰ä¸€ä¸ªvoidè¿”å›ç±»å‹ã€‚</p>\n<p>è¡¨2-2æ€»ç»“äº†CUDA Cç¨‹åºä¸­çš„å‡½æ•°ç±»å‹é™å®šç¬¦ã€‚å‡½æ•°ç±»å‹é™å®šç¬¦æŒ‡å®šä¸€ä¸ªå‡½æ•°åœ¨ä¸»æœºä¸Šæ‰§è¡Œè¿˜æ˜¯åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œï¼Œä»¥åŠå¯è¢«ä¸»æœºè°ƒç”¨è¿˜æ˜¯è¢«è®¾å¤‡è°ƒç”¨ã€‚</p>\n<p><img src=\"/2023/03/06/cuda008/image-20230306155126122.png\" alt=\"image-20230306155126122\"></p>\n<p>_<em>device</em>_   å’Œ __host__é™å®šç¬¦å¯ä»¥ä¸€é½ä½¿ç”¨ï¼Œè¿™æ ·å‡½æ•°å¯ä»¥åŒæ—¶åœ¨ä¸»æœºå’Œè®¾å¤‡ç«¯è¿›è¡Œç¼–è¯‘ã€‚</p>\n<h3 id=\"CUDAæ ¸å‡½æ•°çš„é™åˆ¶\"><a href=\"#CUDAæ ¸å‡½æ•°çš„é™åˆ¶\" class=\"headerlink\" title=\"CUDAæ ¸å‡½æ•°çš„é™åˆ¶\"></a>CUDAæ ¸å‡½æ•°çš„é™åˆ¶</h3><p>ä»¥ä¸‹é™åˆ¶é€‚ç”¨äºæ‰€æœ‰æ ¸å‡½æ•°ï¼š</p>\n<ul>\n<li>åªèƒ½è®¿é—®è®¾å¤‡å†…å­˜</li>\n<li>å¿…é¡»å…·æœ‰voidè¿”å›ç±»å‹</li>\n<li>ä¸æ”¯æŒå¯å˜æ•°é‡çš„å‚æ•°</li>\n<li>ä¸æ”¯æŒé™æ€å˜é‡</li>\n<li>æ˜¾ç¤ºå¼‚æ­¥è¡Œä¸º</li>\n</ul>\n<p>è€ƒè™‘ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šå°†ä¸¤ä¸ªå¤§å°ä¸ºNçš„å‘é‡Aå’ŒBç›¸åŠ ï¼Œä¸»æœºç«¯çš„å‘é‡åŠ æ³•Cä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">sumArrayOnHost</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *A, <span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C, <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">int</span> N)</span></span>&#123;<br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>;i &lt; N; i++)<br>        C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>è¿™æ˜¯ä¸€ä¸ªè¿­ä»£Næ¬¡çš„ä¸²è¡Œç¨‹åºï¼Œå¾ªç¯ç»“æŸåå°†äº§ç”Ÿä»¥ä¸‹æ ¸å‡½æ•°ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">__global__ <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">sumArrayOnHost</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">float</span> *A, <span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C)</span></span>&#123;<br>    \t<span class=\"hljs-keyword\">int</span> i = threadIdx.x;<br>        C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>Cå‡½æ•°å’Œæ ¸å‡½æ•°ä¹‹é—´æœ‰ä»€ä¹ˆä¸åŒï¼Ÿä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°å¾ªç¯ä½“æ¶ˆå¤±äº†ï¼Œå†…ç½®çš„çº¿ç¨‹åæ ‡å˜é‡æ›¿æ¢äº†æ•°ç»„ç´¢å¼•ï¼Œç”±äºNæ˜¯è¢«éšå¼å®šä¹‰ç”¨æ¥å¯åŠ¨Nä¸ªçº¿ç¨‹çš„ï¼Œæ‰€ä»¥Næ²¡æœ‰ä»€ä¹ˆå‚è€ƒä»·å€¼ã€‚</p>\n<p>å‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸º32ä¸ªå…ƒç´ çš„å‘é‡ï¼Œä½ å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹æ³•ç”¨32ä¸ªçº¿ç¨‹æ¥è°ƒç”¨æ ¸å‡½æ•°ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">sumArraysOnGPU&lt;&lt;&lt;<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">32</span>&gt;&gt;&gt;(<span class=\"hljs-keyword\">float</span> *A, <span class=\"hljs-keyword\">float</span> *B, <span class=\"hljs-keyword\">float</span> *C);<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/06/cuda007/",
            "url": "https://xingyuanjie.top/2023/03/06/cuda007/",
            "title": "å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°",
            "date_published": "2023-03-06T05:59:18.000Z",
            "content_html": "<h2 id=\"å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°\"><a href=\"#å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°\" class=\"headerlink\" title=\"å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°\"></a>å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°</h2><p>ä½ åº”è¯¥å¯¹ä¸‹åˆ—Cè¯­è¨€å‡½æ•°è°ƒç”¨è¯­å¥å¾ˆç†Ÿæ‚‰ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-built_in\">function_name</span> (argument list);<br></code></pre></div></td></tr></table></figure>\n\n<p>CUDAå†…æ ¸è°ƒç”¨æ˜¯å¯¹Cè¯­è¨€å‡½æ•°è°ƒç”¨è¯­å¥çš„å»¶ç”³ï¼Œ&lt;&lt;&lt;&gt;&gt;&gt;è¿ç®—ç¬¦å†…æ˜¯æ ¸å‡½æ•°çš„æ‰§è¡Œé…ç½®ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">kerbel_name&lt;&lt;&lt;grid,block&gt;&gt;&gt;(srgument list);<br></code></pre></div></td></tr></table></figure>\n\n<p>æ­£å¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ï¼ŒCUDAç¼–ç¨‹æ¨¡å‹æ­ç¤ºäº†çº¿ç¨‹å±‚æ¬¡ç»“æ„ã€‚åˆ©ç”¨æ‰§è¡Œé…ç½®å¯ä»¥æŒ‡å®šçº¿ç¨‹åœ¨GPUä¸Šè°ƒåº¦è¿è¡Œçš„æ–¹å¼ã€‚æ‰§è¡Œé…ç½®çš„ç¬¬ä¸€ä¸ªå€¼æ˜¯ç½‘æ ¼ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨å—çš„æ•°ç›®ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯å—ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå—ä¸­çº¿ç¨‹çš„æ•°ç›®ã€‚é€šè¿‡æŒ‡å®šç½‘æ ¼å’Œå—çš„ç»´åº¦ï¼Œä½ å¯ä»¥è¿›è¡Œä¸€ä¸‹é…ç½®ï¼š</p>\n<ul>\n<li>å†…æ ¸ä¸­çº¿ç¨‹çš„æ•°ç›®</li>\n<li>å†…æ ¸ä¸­ä½¿ç”¨çš„çº¿ç¨‹å¸ƒå±€</li>\n</ul>\n<p>åŒä¸€ä¸ªå—ä¸­çš„çº¿ç¨‹ä¹‹é—´å¯ä»¥ç›¸äº’åä½œï¼Œä¸åŒå—å†…çš„çº¿ç¨‹ä¸èƒ½åä½œã€‚å¯¹äºä¸€ä¸ªç»™å®šçš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ç½‘æ ¼å’Œå—å¸ƒå±€æ¥ç»„ç»‡ä½ çš„çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰32ä¸ªæ•°æ®å…ƒç´ ç”¨äºè®¡ç®—ï¼Œæ¯8ä¸ªå…ƒç´ ä¸€ä¸ªå—ï¼Œéœ€è¦å¯åŠ¨4ä¸ªå—ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">kernel_name&lt;&lt;&lt;<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">8</span>&gt;&gt;&gt;(argument list);<br></code></pre></div></td></tr></table></figure>\n\n<p><img src=\"/2023/03/06/cuda007/image-20230306140924311.png\" alt=\"image-20230306140924311\"></p>\n<p>ç”±äºæ•°æ®åœ¨å…¨å±€å†…å­˜ä¸­æ˜¯çº¿æ€§å­˜å‚¨çš„ï¼Œå› æ­¤å¯ä»¥ç”¨å˜é‡blockIdx.xå’ŒthreadIdx.xæ¥è¿›è¡Œä»¥ä¸‹æ“ä½œã€‚</p>\n<ul>\n<li>åœ¨ç½‘æ ¼ä¸­æ ‡è¯†ä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹</li>\n<li>å»ºç«‹çº¿ç¨‹å’Œæ•°æ®å…ƒç´ ä¹‹é—´çš„æ˜ å°„å…³ç³»</li>\n</ul>\n<p>å¦‚æœæŠŠ32ä¸ªå…ƒç´ æ”¾åˆ°ä¸€ä¸ªå—é‡Œï¼Œé‚£ä¹ˆåªä¼šå¾—åˆ°ä¸€ä¸ªå—ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">kernel_name&lt;&lt;&lt;<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">32</span>&gt;&gt;&gt;(argument list);<br></code></pre></div></td></tr></table></figure>\n\n<p>å¦‚æœæ¯ä¸ªå—åªå«ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆä¼šæœ‰32ä¸ªå—ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">kernel_name&lt;&lt;&lt;<span class=\"hljs-number\">32</span>,<span class=\"hljs-number\">1</span>&gt;&gt;&gt;(argument list);<br></code></pre></div></td></tr></table></figure>\n\n<p>æ ¸å‡½æ•°çš„è°ƒç”¨ä¸ä¸»æœºçº¿ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚æ ¸å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œæ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™ä¸»æœºç«¯ã€‚ä½ å¯ä»¥è°ƒç”¨ä»¥ä¸‹å‡½æ•°æ¥å¼ºåˆ¶ä¸»æœºç«¯ç¨‹åºç­‰å¾…æ‰€æœ‰çš„æ ¸å‡½æ•°æ‰§è¡Œç»“æŸï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">cudaError_t <span class=\"hljs-title\">cudaDeviceSynchronize</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">void</span>)</span></span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä¸€äº›CUDAè¿è¡Œæ—¶APIåœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´æ˜¯éšå¼åŒæ­¥çš„ã€‚å½“ä½¿ç”¨cudaMemcpyå‡½æ•°åœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´æ‹·è´æ•°æ®æ—¶ï¼Œä¸»æœºç«¯éšå¼åŒæ­¥ï¼Œå³ä¸»æœºç«¯ç¨‹åºå¿…é¡»ç­‰å¾…æ•°æ®æ‹·è´å®Œæˆåæ‰èƒ½ç»§ç»­æ‰§è¡Œç¨‹åºã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\">cudaError_t <span class=\"hljs-title\">cudaMemcpy</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">void</span>* dst, <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">void</span>* src, <span class=\"hljs-keyword\">size_t</span> count, cudaMemcpyKind kind)</span></span>;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä¹‹å‰æ‰€æœ‰çš„æ ¸å‡½æ•°è°ƒç”¨å®Œæˆåå¼€å§‹æ‹·è´æ•°æ®ã€‚å½“æ‹·è´å®Œæˆåï¼Œæ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™ä¸»æœºç«¯ã€‚</p>\n<h3 id=\"å¼‚æ­¥è¡Œä¸º\"><a href=\"#å¼‚æ­¥è¡Œä¸º\" class=\"headerlink\" title=\"å¼‚æ­¥è¡Œä¸º\"></a>å¼‚æ­¥è¡Œä¸º</h3><p>ä¸åŒäºCè¯­è¨€çš„å‡½æ•°è°ƒç”¨ï¼Œæ‰€æœ‰çš„CUDAæ ¸å‡½æ•°çš„å¯åŠ¨éƒ½æ˜¯å¼‚æ­¥çš„ã€‚CUDAå†…æ ¸è°ƒç”¨å®Œæˆåï¼Œæ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™CPUã€‚</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>\n",
            "tags": [
                "CUDA"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/02/leetcode205/",
            "url": "https://xingyuanjie.top/2023/03/02/leetcode205/",
            "title": "205.åŒæ„å­—ç¬¦ä¸²",
            "date_published": "2023-03-02T12:44:27.000Z",
            "content_html": "<h2 id=\"205-åŒæ„å­—ç¬¦ä¸²\"><a href=\"#205-åŒæ„å­—ç¬¦ä¸²\" class=\"headerlink\" title=\"205.åŒæ„å­—ç¬¦ä¸²\"></a>205.åŒæ„å­—ç¬¦ä¸²</h2><h2 id=\"é¢˜ç›®é“¾æ¥\"><a href=\"#é¢˜ç›®é“¾æ¥\" class=\"headerlink\" title=\"é¢˜ç›®é“¾æ¥\"></a>é¢˜ç›®é“¾æ¥</h2><p><a href=\"https://leetcode.cn/problems/isomorphic-strings/\">205. åŒæ„å­—ç¬¦ä¸² - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n<h2 id=\"å®Œæ•´ä»£ç \"><a href=\"#å®Œæ•´ä»£ç \" class=\"headerlink\" title=\"å®Œæ•´ä»£ç \"></a>å®Œæ•´ä»£ç </h2><figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Solution</span> &#123;</span><br><span class=\"hljs-keyword\">public</span>:<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">bool</span> <span class=\"hljs-title\">isIsomorphic</span><span class=\"hljs-params\">(string s, string t)</span> </span>&#123;<br>        string ss;<br>        string st;<br>        <span class=\"hljs-keyword\">int</span> hash[<span class=\"hljs-number\">255</span>];<br>        <span class=\"hljs-keyword\">int</span> index=<span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-built_in\">memset</span>(hash, <span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\"><span class=\"hljs-keyword\">sizeof</span></span>(hash));<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i=<span class=\"hljs-number\">0</span>;i&lt;s.<span class=\"hljs-built_in\">size</span>();i++)&#123;<br>            <span class=\"hljs-keyword\">if</span>(hash[<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">int</span></span>(s[i])]==<span class=\"hljs-number\">0</span>)<br>            &#123;<br>                index++;<br>                hash[<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">int</span></span>(s[i])]=index;<br>                ss.<span class=\"hljs-built_in\">push_back</span>(index+<span class=\"hljs-string\">&#x27;0&#x27;</span>);<br>            &#125;<span class=\"hljs-keyword\">else</span>&#123;<br>                ss.<span class=\"hljs-built_in\">push_back</span>(hash[<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">int</span></span>(s[i])]+<span class=\"hljs-string\">&#x27;0&#x27;</span>);<br>            &#125;<br>        &#125;<br>        index=<span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-built_in\">memset</span>(hash, <span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\"><span class=\"hljs-keyword\">sizeof</span></span>(hash));<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i=<span class=\"hljs-number\">0</span>;i&lt;t.<span class=\"hljs-built_in\">size</span>();i++)&#123;<br>            <span class=\"hljs-keyword\">if</span>(hash[<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">int</span></span>(t[i])]==<span class=\"hljs-number\">0</span>)<br>            &#123;<br>                index++;<br>                hash[<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">int</span></span>(t[i])]=index;<br>                st.<span class=\"hljs-built_in\">push_back</span>(index+<span class=\"hljs-string\">&#x27;0&#x27;</span>);<br>            &#125;<span class=\"hljs-keyword\">else</span>&#123;<br>                st.<span class=\"hljs-built_in\">push_back</span>(hash[<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">int</span></span>(t[i])]+<span class=\"hljs-string\">&#x27;0&#x27;</span>);<br>            &#125;<br>        &#125;<br>        <span class=\"hljs-keyword\">int</span> ans = ss.<span class=\"hljs-built_in\">compare</span>(st);<br>        <span class=\"hljs-keyword\">if</span>(ans==<span class=\"hljs-number\">0</span>)&#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>        &#125;<span class=\"hljs-keyword\">else</span>&#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒä»£ç \"><a href=\"#å‚è€ƒä»£ç \" class=\"headerlink\" title=\"å‚è€ƒä»£ç \"></a>å‚è€ƒä»£ç </h2><p><img src=\"/2023/03/02/leetcode205/image-20230302204605581.png\" alt=\"image-20230302204605581\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Solution</span> &#123;</span><br><span class=\"hljs-keyword\">public</span>:<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">bool</span> <span class=\"hljs-title\">isIsomorphic</span><span class=\"hljs-params\">(string s, string t)</span> </span>&#123;<br>        unordered_map&lt;<span class=\"hljs-keyword\">char</span>, <span class=\"hljs-keyword\">char</span>&gt; s2t;<br>        unordered_map&lt;<span class=\"hljs-keyword\">char</span>, <span class=\"hljs-keyword\">char</span>&gt; t2s;<br>        <span class=\"hljs-keyword\">int</span> len = s.<span class=\"hljs-built_in\">length</span>();<br>        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; len; ++i) &#123;<br>            <span class=\"hljs-keyword\">char</span> x = s[i], y = t[i];<br>            <span class=\"hljs-keyword\">if</span> ((s2t.<span class=\"hljs-built_in\">count</span>(x) &amp;&amp; s2t[x] != y) || (t2s.<span class=\"hljs-built_in\">count</span>(y) &amp;&amp; t2s[y] != x)) &#123;<br>                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>            &#125;<br>            s2t[x] = y;<br>            t2s[y] = x;<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><p><a href=\"https://leetcode.cn/problems/isomorphic-strings/solution/tong-gou-zi-fu-chuan-by-leetcode-solutio-s6fd/\">åŒæ„å­—ç¬¦ä¸² - åŒæ„å­—ç¬¦ä¸² - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n",
            "tags": [
                "C++",
                "LeetCode",
                "å“ˆå¸Œè¡¨"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/02/leetcode189/",
            "url": "https://xingyuanjie.top/2023/03/02/leetcode189/",
            "title": "189.è½®è½¬æ•°ç»„",
            "date_published": "2023-03-02T12:03:32.000Z",
            "content_html": "<h2 id=\"189-è½®è½¬æ•°ç»„\"><a href=\"#189-è½®è½¬æ•°ç»„\" class=\"headerlink\" title=\"189.è½®è½¬æ•°ç»„\"></a>189.è½®è½¬æ•°ç»„</h2><h2 id=\"é¢˜ç›®é“¾æ¥\"><a href=\"#é¢˜ç›®é“¾æ¥\" class=\"headerlink\" title=\"é¢˜ç›®é“¾æ¥\"></a>é¢˜ç›®é“¾æ¥</h2><p><a href=\"https://leetcode.cn/problems/rotate-array/\">189. è½®è½¬æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n<h2 id=\"å®Œæ•´ä»£ç \"><a href=\"#å®Œæ•´ä»£ç \" class=\"headerlink\" title=\"å®Œæ•´ä»£ç \"></a>å®Œæ•´ä»£ç </h2><p><img src=\"/2023/03/02/leetcode189/image-20230302200538871.png\" alt=\"image-20230302200538871\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Solution</span> &#123;</span><br><span class=\"hljs-keyword\">public</span>:<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">reverse</span><span class=\"hljs-params\">(vector&lt;<span class=\"hljs-keyword\">int</span>&gt;&amp; nums,<span class=\"hljs-keyword\">int</span> begin,<span class=\"hljs-keyword\">int</span> end)</span></span><br><span class=\"hljs-function\">    </span>&#123;<br>        <span class=\"hljs-keyword\">while</span>(begin&lt;end)&#123;<br>            <span class=\"hljs-built_in\">swap</span>(nums[begin], nums[end]);<br>            begin++;<br>            end--;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">rotate</span><span class=\"hljs-params\">(vector&lt;<span class=\"hljs-keyword\">int</span>&gt;&amp; nums, <span class=\"hljs-keyword\">int</span> k)</span> </span>&#123;<br>        <span class=\"hljs-comment\">//æ•°ç»„ç¿»è½¬</span><br>        <span class=\"hljs-keyword\">int</span> p = k%nums.<span class=\"hljs-built_in\">size</span>();<br>        <span class=\"hljs-built_in\">reverse</span>(nums,<span class=\"hljs-number\">0</span>,nums.<span class=\"hljs-built_in\">size</span>()<span class=\"hljs-number\">-1</span>);<br>        <span class=\"hljs-built_in\">reverse</span>(nums,<span class=\"hljs-number\">0</span>,p<span class=\"hljs-number\">-1</span>);<br>        <span class=\"hljs-built_in\">reverse</span>(nums,p,nums.<span class=\"hljs-built_in\">size</span>()<span class=\"hljs-number\">-1</span>);<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://leetcode.cn/problems/rotate-array/solution/xuan-zhuan-shu-zu-by-leetcode-solution-nipk/\">æ—‹è½¬æ•°ç»„ - è½®è½¬æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n",
            "tags": [
                "C++",
                "LeetCode",
                "æ•°ç»„ç¿»è½¬"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/03/01/leetcode724/",
            "url": "https://xingyuanjie.top/2023/03/01/leetcode724/",
            "title": "724.å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡",
            "date_published": "2023-03-01T09:35:03.000Z",
            "content_html": "<h1 id=\"724-å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡\"><a href=\"#724-å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡\" class=\"headerlink\" title=\"724.å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡\"></a>724.å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡</h1><h2 id=\"é¢˜ç›®é“¾æ¥\"><a href=\"#é¢˜ç›®é“¾æ¥\" class=\"headerlink\" title=\"é¢˜ç›®é“¾æ¥\"></a>é¢˜ç›®é“¾æ¥</h2><p><a href=\"https://leetcode.cn/problems/find-pivot-index/\">724. å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n<h2 id=\"å®Œæ•´ä»£ç \"><a href=\"#å®Œæ•´ä»£ç \" class=\"headerlink\" title=\"å®Œæ•´ä»£ç \"></a>å®Œæ•´ä»£ç </h2><p><img src=\"/2023/03/01/leetcode724/image-20230301173931031.png\" alt=\"image-20230301173931031\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Solution</span> &#123;</span><br><span class=\"hljs-keyword\">public</span>:<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">pivotIndex</span><span class=\"hljs-params\">(vector&lt;<span class=\"hljs-keyword\">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">int</span> total=<span class=\"hljs-built_in\">accumulate</span>(nums.<span class=\"hljs-built_in\">begin</span>(), nums.<span class=\"hljs-built_in\">end</span>(),<span class=\"hljs-number\">0</span>);\t<span class=\"hljs-comment\">//ç¬¬ä¸‰ä¸ªå½¢å‚æ˜¯ç´¯åŠ çš„åˆå§‹å€¼</span><br>        <span class=\"hljs-keyword\">int</span> sum=<span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i=<span class=\"hljs-number\">0</span>;i&lt;nums.<span class=\"hljs-built_in\">size</span>();i++)<br>        &#123;<br>            <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-number\">2</span>*sum+nums[i] == total)&#123;<br>                <span class=\"hljs-keyword\">return</span> i;<br>            &#125;<br>            sum+=nums[i];<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">-1</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://leetcode.cn/problems/find-pivot-index/solution/xun-zhao-shu-zu-de-zhong-xin-suo-yin-by-gzjle/\">å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒç´¢å¼• - å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n",
            "tags": [
                "C++",
                "LeetCode",
                "å‰ç¼€å’Œ"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/28/vectorbool/",
            "url": "https://xingyuanjie.top/2023/02/28/vectorbool/",
            "title": "vector<bool>ä¸vector<T>",
            "date_published": "2023-02-28T12:59:01.000Z",
            "content_html": "<h1 id=\"vector-lt-bool-gt-ä¸vector-lt-T-gt\"><a href=\"#vector-lt-bool-gt-ä¸vector-lt-T-gt\" class=\"headerlink\" title=\"vector&lt;bool&gt;ä¸vector&lt;T&gt;\"></a>vector&lt;bool&gt;ä¸vector&lt;T&gt;</h1><p>vector&lt;bool&gt; ä¸åƒå…¶ä»–å®¹å™¨ä¸€æ ·æŒ‰Byteå­˜å‚¨çš„ï¼Œå®ƒæ˜¯æŒ‰bitå­˜å‚¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ­£å¸¸çš„boolç±»å‹çš„ç©ºé—´å¯ä»¥å­˜æ”¾vector&lt;bool&gt;ä¸­çš„8ä¸ªï¼Œç©ºé—´ä¸Šç¡®å®ä¼˜åŒ–äº†å¾ˆå¤šï¼Œç„¶è€Œï¼Œc++æ˜¯ä¸èƒ½ç›´æ¥å–å¯¹bitæ“ä½œçš„ï¼ˆå› ä¸ºC++çš„æœ€å°å¯å¯»å€å€¼é€šå¸¸ä»¥byteä¸ºå•ä½ï¼‰ï¼Œå¯¹å…¶ä½¿ç”¨operator[]å…¶å®è¿”å›çš„ä¸æ˜¯boolçš„å¼•ç”¨è€Œæ˜¯ä¸€ä¸ªâ€proxy referenceâ€æ˜¯â€std::vector&lt; bool&gt;:referenceâ€ç±»å‹çš„å¯¹è±¡ã€‚</p>\n<p>æ­£å› ä¸ºå¦‚æ­¤ï¼Œvector&lt;bool&gt;é€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œå­˜å–è®¿é—®æ—¶éœ€è¦æ‰§è¡Œé€ä½å¤„ç†ï¼Œè®¿é—®é€šå¸¸æ¯”intä¹‹ç±»çš„æ™®é€šç±»å‹æ“ä½œè¦æ…¢å¾ˆå¤šã€‚</p>\n<p>å› æ­¤ï¼Œå¯¹vecotr&lt;bool&gt;çš„ä½¿ç”¨éœ€æ…é‡è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š<br>(1)æ˜¯å¦éœ€è¦ç‰ºç‰²é€Ÿåº¦æ¥è·å–ç©ºé—´ä¸Šçš„ä¼˜åŒ–<br>(2)ç®—æ³•ä¸­ä¼šå¦æœ‰å¯¹vecotråœ°å€è¿›è¡Œè§£å¼•ç”¨æ“ä½œçš„å¯èƒ½ã€‚</p>\n<p>å¦‚æœä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œå»ºè®®ä½¿ç”¨deque&lt;bool&gt;æ¥å–ä»£vector&lt;bool&gt;ï¼ŒåŠŸèƒ½åŸºæœ¬ç›¸åŒï¼Œä½†deque&lt;bool&gt;æœªå¯¹å…¶è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p>\n<p>ä¸‹é¢æ˜¯vector&lt;bool&gt;ä¸vector&lt;T&gt;ç®€å•çš„å¯¹æ¯”ä¾‹å­ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span></span>&#123;<br>\tvector&lt;<span class=\"hljs-keyword\">char</span>&gt; ch;<br>\tvector&lt;<span class=\"hljs-keyword\">int</span>&gt; in;<br>\tvector&lt;<span class=\"hljs-keyword\">bool</span>&gt; bo;<br> <br>\t<span class=\"hljs-keyword\">int</span> m = <span class=\"hljs-number\">1e6</span>;<br>\t<span class=\"hljs-keyword\">clock_t</span> t1, t2, t3;<br> <br>\tt1 = <span class=\"hljs-built_in\">clock</span>();<br>\t<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i++)&#123;<br>\t\tch.<span class=\"hljs-built_in\">push_back</span>(<span class=\"hljs-string\">&#x27;0&#x27;</span>);<br>\t&#125;<br>\tt1 = <span class=\"hljs-built_in\">clock</span>() - t1;<br> <br>\tt2 = <span class=\"hljs-built_in\">clock</span>();<br>\t<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i++)&#123;<br>\t\tin.<span class=\"hljs-built_in\">push_back</span>(<span class=\"hljs-number\">0</span>);<br>\t&#125;<br>\tt2 = <span class=\"hljs-built_in\">clock</span>() - t2;<br> <br>\tt3 = <span class=\"hljs-built_in\">clock</span>();<br>\t<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i++)&#123;<br>\t\tbo.<span class=\"hljs-built_in\">push_back</span>(<span class=\"hljs-literal\">true</span>);<br>\t&#125;<br>\tt3 = <span class=\"hljs-built_in\">clock</span>() - t3;<br> <br>\tcout &lt;&lt;<span class=\"hljs-string\">&quot;vector&lt;char&gt; &quot;</span>&lt;&lt; t1 &lt;&lt; <span class=\"hljs-string\">&quot;\\n vector&lt;int&gt; &quot;</span> &lt;&lt; t2 &lt;&lt; <span class=\"hljs-string\">&quot;\\nvector&lt;bool&gt; &quot;</span> &lt;&lt; t3 &lt;&lt; endl;<br>\tcout &lt;&lt; endl;<br> <br>\t<span class=\"hljs-built_in\">system</span>(<span class=\"hljs-string\">&quot;pause&quot;</span>);<br>\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>è¿è¡Œç»“æœï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs cpp\">vector&lt;<span class=\"hljs-keyword\">char</span>&gt; <span class=\"hljs-number\">216</span><br>vextor&lt;<span class=\"hljs-keyword\">int</span>&gt; <span class=\"hljs-number\">229</span><br>vector&lt;<span class=\"hljs-keyword\">bool</span>&gt; <span class=\"hljs-number\">16535</span><br></code></pre></div></td></tr></table></figure>\n\n<p>è¿™é‡Œå‘ç°vector&lt;bool&gt;ç›¸è¾ƒäºå…¶ä»–vector&lt;T&gt;é€Ÿåº¦è¦æ…¢çš„å¤šï¼</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://blog.csdn.net/qq_52134928/article/details/121066304?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-121066304-blog-86603050.pc_relevant_3mothn_strategy_and_data_recovery&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-121066304-blog-86603050.pc_relevant_3mothn_strategy_and_data_recovery&utm_relevant_index=1\">(65æ¡æ¶ˆæ¯) ã€C++ã€‘vectorï¼œboolï¼çš„ç‰¹åˆ«ä¹‹å¤„_å°é™¶åŒå­¦_çš„åšå®¢-CSDNåšå®¢</a></p>\n<p><a href=\"https://blog.csdn.net/u013249689/article/details/25297657\">(65æ¡æ¶ˆæ¯) ä¸ä½¿ç”¨vectorçš„åŸå› å’Œæ›¿ä»£æ–¹æ³•_jackycmuçš„åšå®¢-CSDNåšå®¢</a></p>\n",
            "tags": [
                "STL",
                "Vector",
                "C/C++",
                "bool"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/28/Linux004/",
            "url": "https://xingyuanjie.top/2023/02/28/Linux004/",
            "title": "C/C++å…³é”®å­—ä¹‹restrict",
            "date_published": "2023-02-28T11:45:09.000Z",
            "content_html": "<h1 id=\"C-x2F-C-å…³é”®å­—ä¹‹restrict\"><a href=\"#C-x2F-C-å…³é”®å­—ä¹‹restrict\" class=\"headerlink\" title=\"C&#x2F;C++å…³é”®å­—ä¹‹restrict\"></a>C&#x2F;C++å…³é”®å­—ä¹‹restrict</h1><p>åœ¨Cè¯­è¨€ä¸­ï¼Œrestrictå…³é”®å­—ç”¨äºä¿®é¥°æŒ‡é’ˆï¼ˆC99æ ‡å‡†ï¼‰ã€‚é€šè¿‡åŠ ä¸Šrestrictå…³é”®å­—ï¼Œç¨‹åºå‘˜å¯æç¤ºç¼–è¯‘å™¨ï¼šåœ¨è¯¥æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå…¶æŒ‡å‘çš„å¯¹è±¡ä¸ä¼šè¢«åˆ«çš„æŒ‡é’ˆæ‰€å¼•ç”¨ã€‚</p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨C++ä¸­ï¼Œå¹¶æ— æ˜ç¡®ç»Ÿä¸€çš„æ ‡å‡†æ”¯æŒrestrictå…³é”®å­—ã€‚ä½†æ˜¯å¾ˆå¤šç¼–è¯‘å™¨å®ç°äº†åŠŸèƒ½ç›¸åŒçš„å…³é”®å­—ï¼Œä¾‹å¦‚gccå’Œclangä¸­çš„__restrictå…³é”®å­—ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">add1</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span>*a, <span class=\"hljs-keyword\">int</span>* b)</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    *a = <span class=\"hljs-number\">10</span>;<br>    *b = <span class=\"hljs-number\">12</span>;<br>    <span class=\"hljs-keyword\">return</span> *a + *b;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>add1å‡½æ•°çš„è¿”å›å€¼ä¼šæ°¸è¿œæ˜¯10 + 12 &#x3D; 22å—ï¼Ÿ</p>\n<p>ç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚åœ¨æŒ‡é’ˆaå’Œbçš„åœ°å€ä¸åŒæ—¶ï¼Œè¿”å›22æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯å½“æŒ‡é’ˆaä¸bæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªintå¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡å…ˆè¢«èµ‹å€¼ä¸º10ï¼Œåè¢«èµ‹å€¼ä¸º12ï¼Œå› æ­¤aå’Œbéƒ½è¿”å›12ï¼Œå› æ­¤add1å‡½æ•°æœ€ç»ˆè¿”å›24ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;bits/stdc++.h&gt;</span></span><br><span class=\"hljs-keyword\">using</span> <span class=\"hljs-keyword\">namespace</span> std;<br><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">add1</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span>* a, <span class=\"hljs-keyword\">int</span>* b)</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    *a = <span class=\"hljs-number\">10</span>;<br>    *b = <span class=\"hljs-number\">12</span>;<br>    <span class=\"hljs-keyword\">return</span> *a + *b;<br>&#125;<br><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span></span>&#123;<br>    <span class=\"hljs-keyword\">int</span>* c;<br>    <span class=\"hljs-keyword\">int</span>* d;<br>    d=(<span class=\"hljs-keyword\">int</span>*)<span class=\"hljs-built_in\">malloc</span>(<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">sizeof</span></span>(<span class=\"hljs-keyword\">int</span>)*<span class=\"hljs-number\">1</span>);<br>    c=(<span class=\"hljs-keyword\">int</span>*)<span class=\"hljs-built_in\">malloc</span>(<span class=\"hljs-built_in\"><span class=\"hljs-keyword\">sizeof</span></span>(<span class=\"hljs-keyword\">int</span>)*<span class=\"hljs-number\">1</span>);<br>    *c=<span class=\"hljs-number\">10</span>;<br>    *d=<span class=\"hljs-number\">12</span>;<br>    *d=<span class=\"hljs-number\">12</span>;<br>    cout&lt;&lt;<span class=\"hljs-string\">&quot;c:&quot;</span>&lt;&lt;*c&lt;&lt;endl;<br>    cout&lt;&lt;<span class=\"hljs-string\">&quot;d:&quot;</span>&lt;&lt;*d&lt;&lt;endl;<br>    cout&lt;&lt;<span class=\"hljs-string\">&quot;When Pointers a and b have different addresses&quot;</span>&lt;&lt;endl;<br>    cout&lt;&lt;<span class=\"hljs-built_in\">add1</span>(c,d)&lt;&lt;endl;<br>    cout&lt;&lt;<span class=\"hljs-string\">&quot;When Pointers a and b have the same address&quot;</span>&lt;&lt;endl;<br>    cout&lt;&lt;<span class=\"hljs-built_in\">add1</span>(c,c)&lt;&lt;endl;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\">c:<span class=\"hljs-number\">10</span><br>d:<span class=\"hljs-number\">12</span><br>When Pointers a <span class=\"hljs-keyword\">and</span> b have different addresses<br><span class=\"hljs-number\">22</span><br>When Pointers a <span class=\"hljs-keyword\">and</span> b have the same address<br><span class=\"hljs-number\">24</span><br></code></pre></div></td></tr></table></figure>\n\n<p>å¼€å¯-O3ä¼˜åŒ–ï¼Œadd1å¯¹åº”çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹:</p>\n<p>ä¸ºäº†å¾—åˆ°<code>*a</code>çš„å€¼è®¿é—®äº†1æ¬¡å†…å­˜ï¼Œè€Œä¸ç®¡åœ¨ä½•ç§æ¡ä»¶ä¸‹(<code>a == b</code> or <code>a != b</code>)ï¼Œ<code>*b</code>çš„å€¼éƒ½æ˜¯12ã€‚å› æ­¤ç¼–è¯‘å™¨å°†<code>*a</code>çš„å€¼è½½å…¥<code>eax</code>å¯„å­˜å™¨åï¼Œç›´æ¥åŠ ä¸Šç«‹å³æ•°12ï¼Œè€Œæ— éœ€å†è®¿é—®å†…å­˜è·å–<code>*b</code>çš„å€¼ã€‚åœ¨æ— æ³•ç¡®å®šæŒ‡é’ˆaå’Œbæ˜¯å¦ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨åªèƒ½å¸®ä½ ä¼˜åŒ–åˆ°è¿™é‡Œäº†ã€‚</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs fortran\"><span class=\"hljs-number\">0000000000400</span>a10 &lt;_Z4add1PiS_&gt;:<br>  <span class=\"hljs-number\">400</span>a10:   c7 <span class=\"hljs-number\">07</span> <span class=\"hljs-number\">0</span>a <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span>       movl   $<span class=\"hljs-number\">0</span>xa,(%rdi) ; *a = <span class=\"hljs-number\">10</span><br>  <span class=\"hljs-number\">400</span>a16:   c7 <span class=\"hljs-number\">06</span> <span class=\"hljs-number\">0</span>c <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span>       movl   $<span class=\"hljs-number\">0</span>xc,(%rsi) ; *b = <span class=\"hljs-number\">10</span><br>  <span class=\"hljs-number\">400</span>a1c:   <span class=\"hljs-number\">8</span>b <span class=\"hljs-number\">07</span>                   mov    (%rdi),%eax ; ç»“æœ = *a<br>  <span class=\"hljs-number\">400</span>a1e:   <span class=\"hljs-number\">83</span> c0 <span class=\"hljs-number\">0</span>c                add    $<span class=\"hljs-number\">0</span>xc,%eax   ; ç»“æœ += <span class=\"hljs-number\">12</span> <br>  <span class=\"hljs-number\">400</span>a21:   c3                      retq<br></code></pre></div></td></tr></table></figure>\n\n<p>åŠ ä¸Šäº†restrictå…³é”®å­—è¿‡åï¼ŒåŒæ ·å¼€å¯-O3ä¼˜åŒ–ï¼Œadd1å¯¹åº”çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š</p>\n<p>åŠ ä¸Šå…³é”®å­—restrictåï¼Œç¼–è¯‘å™¨èƒ½å¤Ÿç¡®è®¤æŒ‡é’ˆaå’Œbä¸å¯èƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤åœ¨æ±‚*a + *bæ—¶ï¼Œæ— è™šè®¿é—®å†…å­˜ï¼Œå› ä¸º*aå¿…ç„¶ç­‰äºç«‹å³æ•°10ï¼Œ*bå¿…ç„¶ç­‰äºç«‹å³æ•°12ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">add2</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span>* __restrict  a, <span class=\"hljs-keyword\">int</span>* __restrict b)</span> </span><br><span class=\"hljs-function\"></span>&#123;<br>    *a = <span class=\"hljs-number\">10</span>;<br>    *b = <span class=\"hljs-number\">12</span>;<br>    <span class=\"hljs-keyword\">return</span> *a + *b ;<br>&#125;<br><span class=\"hljs-number\">0000000000400</span>a30 &lt;_Z4add2PiS_&gt;:<br>  <span class=\"hljs-number\">400</span>a30:   c7 <span class=\"hljs-number\">07</span> <span class=\"hljs-number\">0</span>a <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span>       movl   $<span class=\"hljs-number\">0xa</span>,(%rdi) ; *a = <span class=\"hljs-number\">10</span><br>  <span class=\"hljs-number\">400</span>a36:   b8 <span class=\"hljs-number\">16</span> <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span>          mov    $<span class=\"hljs-number\">0x16</span>,%eax  ; ç»“æœ = <span class=\"hljs-number\">22</span><br>  <span class=\"hljs-number\">400</span>a3b:   c7 <span class=\"hljs-number\">06</span> <span class=\"hljs-number\">0</span>c <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span> <span class=\"hljs-number\">00</span>       movl   $<span class=\"hljs-number\">0xc</span>,(%rsi) ; *b = <span class=\"hljs-number\">12</span><br>  <span class=\"hljs-number\">400</span>a41:   c3  <br></code></pre></div></td></tr></table></figure>\n\n<p>æœ‰æ— restrictå…³é”®å­—çš„ä¸¤ç§æƒ…å†µä¸‹çš„æ±‡ç¼–æŒ‡ä»¤å¯çœ‹åˆ°ï¼Œåè€…æ¯”å‰è€…å°‘è®¿é—®ä¸€æ¬¡å†…å­˜ï¼Œä¸”å°‘æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ã€‚å°±æ˜¯å› ä¸ºæ²¡åŠ restructå…³é”®å­—æ—¶ï¼Œç¼–è¯‘å™¨ä¸èƒ½ç¡®å®šåˆ«çš„åœ°æ–¹æ˜¯ä¸æ˜¯ä¼šä¿®æ”¹æ­¤å€¼ï¼Œæ‰€ä»¥ä¼šå»ç›¸åº”çš„åœ°å€æŸ¥çœ‹ã€‚</p>\n<p><strong>è¿™æ ·å½“æˆ‘ä»¬æ˜ç¡®çŸ¥é“ä¸¤ä¸ªæŒ‡é’ˆä¸å¯èƒ½æŒ‡å‘åŒä¸€ä¸ªåœ°å€æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä½¿ç”¨restrictå…³é”®å­—æ¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚</strong></p>\n<p>æ³¨æ„ä½¿ç”¨restrictçš„æ—¶å€™ï¼Œç¨‹åºå‘˜å¿…é¡»ç¡®ä¿ä¸ä¼šå‡ºç°<strong>pointer aliasing</strong>ï¼Œå³åŒä¸€å—å†…å­˜æ— æ³•é€šè¿‡ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„æŒ‡é’ˆå˜é‡åè®¿é—®ã€‚ä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶å¼ºè¡ŒæŒ‡å®šrestrictï¼Œå°†ä¼šå‡ºç°<strong>underfined behavior</strong>ã€‚</p>\n<p>é€šå¸¸ç¼–å†™ä»£ç æ—¶ä¼šå¿½ç•¥pointer aliasingçš„é—®é¢˜ã€‚æ›´å¸¸è§æ˜¯åœ¨æ€§èƒ½åˆ†ææ—¶ï¼Œé€šè¿‡åæ±‡ç¼–çœ‹åˆ°å¾ˆå¤šå†—ä½™çš„è¯»å–æŒ‡ä»¤ï¼Œæ‰ä¼šæƒ³åˆ°åŠ å…¥restrictå…³é”®å­—æ¥æå‡æ€§èƒ½ã€‚</p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://zhuanlan.zhihu.com/p/349726808\">C&#x2F;C++å…³é”®å­—ä¹‹restrict - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://github.com/ClickHouse/ClickHouse/pull/19946\">Improve performance of aggregate functions by alexey-milovidov Â· Pull Request #19946 Â· ClickHouse&#x2F;ClickHouse (github.com)</a></p>\n<p><a href=\"https://en.cppreference.com/w/c/language/restrict\">restrict type qualifier - cppreference.com</a></p>\n<p><a href=\"https://www.zhihu.com/question/41653775/answer/2535730128\">å¦‚ä½•ç†è§£Cè¯­è¨€å…³é”®å­—restrictï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p>\n<p><a href=\"https://blog.csdn.net/qq_41822235/article/details/83479562\">(65æ¡æ¶ˆæ¯) å…³é”®å­—_restrict___restrict_æ¥šæ¥šå¯è–‡çš„åšå®¢-CSDNåšå®¢</a></p>\n<p><a href=\"https://blog.csdn.net/qq_41950508/article/details/126619881?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-126619881-blog-102577325.pc_relevant_3mothn_strategy_recovery&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-126619881-blog-102577325.pc_relevant_3mothn_strategy_recovery&utm_relevant_index=1\">(65æ¡æ¶ˆæ¯) ã€C++ã€‘å…³é”®å­—restrictçš„ä½œç”¨_restrictå…³é”®å­—çš„ä½œç”¨_ä¸çŸ¥æ‰€æªçš„æ¸£æ¸£è¾‰çš„åšå®¢-CSDNåšå®¢</a></p>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/26/intel001/",
            "url": "https://xingyuanjie.top/2023/02/26/intel001/",
            "title": "unroll_and_jam/nounroll_and_jam",
            "date_published": "2023-02-26T11:12:51.000Z",
            "content_html": "<h1 id=\"unroll-and-jam-x2F-nounroll-and-jam\"><a href=\"#unroll-and-jam-x2F-nounroll-and-jam\" class=\"headerlink\" title=\"unroll_and_jam&#x2F;nounroll_and_jam\"></a>unroll_and_jam&#x2F;nounroll_and_jam</h1><p>å¯ç”¨æˆ–ç¦ç”¨å¾ªç¯å±•å¼€å’Œé˜»å¡ã€‚è¿™äº›æŒ‡ä»¤åªèƒ½åº”ç”¨äºè¿­ä»£forå¾ªç¯ã€‚</p>\n<h2 id=\"Syntax\"><a href=\"#Syntax\" class=\"headerlink\" title=\"Syntax\"></a>Syntax</h2><p>#pragma unroll_and_jam\t#pragma unroll_and_jam (n)\t#pragma nounroll_and_jam</p>\n<h2 id=\"Arguments\"><a href=\"#Arguments\" class=\"headerlink\" title=\"Arguments\"></a>Arguments</h2><p>å±•å¼€å› å­ï¼Œè¡¨ç¤ºå±•å¼€å¾ªç¯çš„æ¬¡æ•°;å¿…é¡»æ˜¯0åˆ°255ä¹‹é—´çš„æ•´æ•°å¸¸æ•°</p>\n<h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>unroll_and_jamæŒ‡ä»¤éƒ¨åˆ†å±•å¼€å¥—ä¸­æ¯”æœ€å†…å±‚å¾ªç¯æ›´é«˜çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¾ªç¯ï¼Œå¹¶å°†ç»“æœå¾ªç¯èåˆ&#x2F;é˜»å¡å›ä¸€èµ·ã€‚è¿™ç§è½¬æ¢å…è®¸åœ¨å¾ªç¯ä¸­è¿›è¡Œæ›´å¤šçš„é‡ç”¨ã€‚</p>\n<p>æ­¤pragmaå¯¹æœ€å†…å±‚å¾ªç¯æ— æ•ˆã€‚ç¡®ä¿ç´§éšå…¶åçš„å¾ªç¯ä¸æ˜¯ç¼–è¯‘å™¨å‘èµ·çš„äº¤æ¢å®Œæˆåçš„æœ€å†…å±‚å¾ªç¯ã€‚</p>\n<p>æŒ‡å®šæ­¤pragmaæ˜¯å‘ç¼–è¯‘å™¨æç¤ºå±•å¼€å’Œé˜»å¡åºåˆ—æ˜¯åˆæ³•ä¸”æœ‰åˆ©å¯å›¾çš„ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ä»»ä½•å¯èƒ½çš„æƒ…å†µä¸‹å¯ç”¨è¿™ç§è½¬æ¢ã€‚</p>\n<p>å¯¹äºå®ƒå½±å“çš„æ¯ä¸ªforå¾ªç¯ï¼Œunroll_and_jamæŒ‡ä»¤å¿…é¡»åœ¨forè¯­å¥ä¹‹å‰ã€‚å¦‚æœæŒ‡å®šäº†nï¼Œä¼˜åŒ–å™¨å°†å±•å¼€å¾ªç¯næ¬¡ã€‚å¦‚æœnè¢«çœç•¥æˆ–è¶…å‡ºå…è®¸çš„èŒƒå›´ï¼Œä¼˜åŒ–å™¨å°†åˆ†é…å±•å¼€å¾ªç¯çš„æ¬¡æ•°ã€‚ç¼–è¯‘å™¨é€šè¿‡æ¯”è¾ƒnå’Œå¾ªç¯è®¡æ•°ç”Ÿæˆæ­£ç¡®çš„ä»£ç ã€‚</p>\n<p>åªæœ‰åœ¨è®¾ç½®äº†ç¼–è¯‘å™¨é€‰é¡¹O3æ—¶ï¼Œæ‰æ”¯æŒæ­¤pragmaã€‚unroll_and_jamæŒ‡ä»¤å°†è¦†ç›–ä»å‘½ä»¤è¡Œå±•å¼€å¾ªç¯çš„ä»»ä½•è®¾ç½®ã€‚</p>\n<p>å½“å±•å¼€å¾ªç¯ä¼šå¢åŠ å¯„å­˜å™¨å‹åŠ›å’Œä»£ç å¤§å°æ—¶ï¼Œå¯èƒ½éœ€è¦é˜²æ­¢å±•å¼€åµŒå¥—å¾ªç¯æˆ–ä¸å®Œç¾çš„åµŒå¥—å¾ªç¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨nounroll_and_jamç¼–è¯‘æŒ‡ä»¤ã€‚nounroll_and_jam pragmaæç¤ºç¼–è¯‘å™¨ä¸è¦å±•å¼€æŒ‡å®šçš„å¾ªç¯ã€‚</p>\n<p><strong>Examples</strong></p>\n<p><strong>Use the unroll_and_jam pragma:</strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">int</span> a[<span class=\"hljs-number\">10</span>][<span class=\"hljs-number\">10</span>]; <br><span class=\"hljs-keyword\">int</span> b[<span class=\"hljs-number\">10</span>][<span class=\"hljs-number\">10</span>]; <br><span class=\"hljs-keyword\">int</span> c[<span class=\"hljs-number\">10</span>][<span class=\"hljs-number\">10</span>]; <br><span class=\"hljs-keyword\">int</span> d[<span class=\"hljs-number\">10</span>][<span class=\"hljs-number\">10</span>]; <br><span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">unroll</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> n)</span> </span>&#123;<br>Â Â Â Â <span class=\"hljs-keyword\">int</span> i,j,k;<br>Â Â Â Â <span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">pragma</span> unroll_and_jam (6)</span><br>Â Â Â Â <span class=\"hljs-keyword\">for</span> (i = <span class=\"hljs-number\">1</span>; i &lt; n; i++) &#123;<br>Â Â Â Â Â Â Â <span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">pragma</span> unroll_and_jam (6)</span><br>Â Â Â Â Â Â Â <span class=\"hljs-keyword\">for</span> (j = <span class=\"hljs-number\">1</span>; j &lt; n; j++) &#123;<br>Â Â Â Â Â Â Â Â Â Â <span class=\"hljs-keyword\">for</span> (k = <span class=\"hljs-number\">1</span>; k &lt; n; k++)&#123;<br>Â Â Â Â Â Â Â Â Â Â Â Â a[i][j] += b[i][k]*c[k][j];<br>Â Â Â Â Â Â Â Â Â Â Â Â &#125;<br>Â Â Â Â Â Â Â &#125;<br>Â Â Â Â &#125; <br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://www.intel.com/content/www/us/en/develop/documentation/cpp-compiler-developer-guide-and-reference/top/compiler-reference/pragmas/intel-specific-pragma-reference/unroll-and-jam-nounroll-and-jam.html\">unroll_and_jam nounroll_and_jam (intel.com)</a></p>\n",
            "tags": [
                "C++",
                "Intel"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/26/cache001/",
            "url": "https://xingyuanjie.top/2023/02/26/cache001/",
            "title": "Cache Blocking Techniquesã€ä¸ªäººç¿»è¯‘ã€‘",
            "date_published": "2023-02-26T10:02:29.000Z",
            "content_html": "<h2 id=\"Cache-Blocking-Techniques\"><a href=\"#Cache-Blocking-Techniques\" class=\"headerlink\" title=\"Cache Blocking Techniques\"></a>Cache Blocking Techniques</h2><p><strong>æ–‡ç« æ¥æºï¼š</strong><a href=\"https://www.intel.cn/content/www/cn/zh/developer/articles/technical/cache-blocking-techniques.html\">Cache Blocking Techniques (intel.cn)</a></p>\n<p><strong>æ–‡ç« ä½œè€…ï¼š</strong><a href=\"https://community.intel.com/cipcp26785/plugins/custom/intel/intel/custom.userprofile?id=3UpJu61CDTyShonSVJNwDw==&iv=8843887237217530\">Amanda K Sharp</a></p>\n<h3 id=\"Overview\"><a href=\"#Overview\" class=\"headerlink\" title=\"Overview\"></a>Overview</h3><p>ä¸€ç±»é‡è¦çš„ç®—æ³•æ›´æ”¹æ¶‰åŠåˆ†å—æ•°æ®ç»“æ„ä»¥é€‚åº”ç¼“å­˜ã€‚é€šè¿‡ç»„ç»‡æ•°æ®å†…å­˜è®¿é—®ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªå¤§å¾—å¤šçš„æ•°æ®é›†çš„ä¸€ä¸ªå°å­é›†åŠ è½½ç¼“å­˜ã€‚æ¥ä¸‹æ¥çš„æƒ³æ³•æ˜¯åœ¨ç¼“å­˜ä¸­å¤„ç†è¿™ä¸ªæ•°æ®å—ã€‚é€šè¿‡åœ¨ç¼“å­˜ä¸­ä½¿ç”¨&#x2F;é‡ç”¨è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å‡å°‘äº†è®¿é—®å†…å­˜çš„éœ€è¦(å‡å°‘å†…å­˜å¸¦å®½å‹åŠ›)ã€‚</p>\n<h3 id=\"Topic\"><a href=\"#Topic\" class=\"headerlink\" title=\"Topic\"></a>Topic</h3><p>åˆ†å—æ˜¯ä¸€ç§è‘—åçš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©é¿å…è®¸å¤šåº”ç”¨ç¨‹åºä¸­çš„å†…å­˜å¸¦å®½ç“¶é¢ˆã€‚åˆ†å—èƒŒåçš„å…³é”®æ€æƒ³æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­å›ºæœ‰çš„æ•°æ®é‡ç”¨ï¼Œç¡®ä¿æ•°æ®åœ¨å¤šä¸ªç”¨é€”ä¹‹é—´ä¿æŒåœ¨ç¼“å­˜ä¸­ã€‚åˆ†å—å¯ä»¥åœ¨1-Dã€2-Dæˆ–3-Dç©ºé—´æ•°æ®ç»“æ„ä¸Šæ‰§è¡Œã€‚ä¸€äº›è¿­ä»£åº”ç”¨ç¨‹åºå¯ä»¥è¿›ä¸€æ­¥å—ç›Šäºå¤šæ¬¡è¿­ä»£çš„åˆ†å—(é€šå¸¸ç§°ä¸ºæ—¶é—´åˆ†å—)ï¼Œä»¥è¿›ä¸€æ­¥ç¼“è§£å¸¦å®½ç“¶é¢ˆã€‚å°±ä»£ç æ›´æ”¹è€Œè¨€ï¼Œåˆ†å—é€šå¸¸æ¶‰åŠå¾ªç¯åˆ†å‰²å’Œäº¤æ¢çš„ç»„åˆã€‚åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºä»£ç ä¸­ï¼Œé€šè¿‡å¯¹åˆ†å—å› å­è¿›è¡Œä¸€äº›å‚æ•°åŒ–ï¼Œå¯¹æºè¿›è¡Œæ­£ç¡®çš„æ›´æ”¹ï¼Œç”¨æˆ·å¯ä»¥æœ€å¥½åœ°æ‰§è¡Œåˆ†å—ã€‚</p>\n<h3 id=\"Original-Source\"><a href=\"#Original-Source\" class=\"headerlink\" title=\"Original Source\"></a>Original Source</h3><figure class=\"highlight fortran\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs fortran\">for (body1 = <span class=\"hljs-number\">0</span>; body1 &lt; NBODIES; body1 ++) &#123;<br>   for (body2=<span class=\"hljs-number\">0</span>; body2 &lt; NBODIES; body2++) &#123;<br>     <span class=\"hljs-keyword\">OUT</span>[body1] += compute(body1, body2);<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæ•°æ®(body2)æ¥è‡ªå†…å­˜ã€‚å‡è®¾NBODIESå¾ˆå¤§ï¼Œæˆ‘ä»¬å°†æ— æ³•åœ¨ç¼“å­˜ä¸­é‡ç”¨ã€‚æ­¤åº”ç”¨ç¨‹åºå—å†…å­˜å¸¦å®½é™åˆ¶ã€‚åº”ç”¨ç¨‹åºå°†ä»¥å†…å­˜åˆ°CPUçš„é€Ÿåº¦è¿è¡Œï¼Œè€Œä¸æ˜¯æœ€ä½³é€Ÿåº¦ã€‚</p>\n<p><strong>Modified Source (with 1-D blocking):</strong></p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs fortran\">for (body2 = <span class=\"hljs-number\">0</span>; body2 &lt; NBODIES; body2 += <span class=\"hljs-keyword\">BLOCK</span>) &#123;<br>   for (body1=<span class=\"hljs-number\">0</span>; body1 &lt; NBODIES; body1 ++) &#123;<br>      for (body22=<span class=\"hljs-number\">0</span>; body22 &lt; <span class=\"hljs-keyword\">BLOCK</span>; body22 ++) &#123;<br>         <span class=\"hljs-keyword\">OUT</span>[body1] += compute(body1, body2 + body22);<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>åœ¨ä¿®æ”¹åçš„ä»£ç ä¸­ï¼Œæ•°æ®(body22)åœ¨ç¼“å­˜ä¸­è¢«ä¿ç•™å’Œé‡ç”¨ï¼Œä»è€Œè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œä¸Šé¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†ä¸€ä¸ªåˆ†å—NBodyä»£ç çš„ç¤ºä¾‹ã€‚æœ‰ä¸¤ä¸ªå¾ªç¯(body1å’Œbody2)éå†æ‰€æœ‰ä¸»ä½“ã€‚é¡¶éƒ¨çš„åŸå§‹ä»£ç æµç»å†…éƒ¨å¾ªç¯ä¸­çš„æ•´ä¸ªä¸»ä½“é›†ï¼Œå¹¶ä¸”å¿…é¡»åœ¨æ¯æ¬¡è¿­ä»£ä¸­ä»å†…å­˜ä¸­åŠ è½½body2å€¼ã€‚åº•éƒ¨çš„åˆ†å—ä»£ç æ˜¯é€šè¿‡å°†body2å¾ªç¯åˆ†è§£ä¸ºä¸€ä¸ªè¿­ä»£å¤šä¸ªBLOCKä¸­çš„bodyçš„å¤–éƒ¨å¾ªç¯å’Œä¸€ä¸ªè¿­ä»£BLOCKä¸­çš„å…ƒç´ çš„å†…éƒ¨body22å¾ªç¯ï¼Œå¹¶äº¤ç»‡body1å’Œbody2å¾ªç¯æ¥è·å¾—çš„ã€‚è¿™æ®µä»£ç åœ¨body1å¾ªç¯çš„å¤šæ¬¡è¿­ä»£ä¸­é‡ç”¨äº†ä¸€ç»„BLOCK body2å€¼ã€‚å¦‚æœBLOCKè¢«é€‰ä¸­ï¼Œä½¿å¾—è¿™ç»„å€¼é€‚åˆç¼“å­˜ï¼Œå†…å­˜æµé‡å°±ä¼šé™ä½ä¸€ä¸ªBLOCKçš„å› å­ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯æ¥è‡ªOpenMP*ç‰ˆæœ¬çš„NBodyåŸºå‡†æµ‹è¯•çš„ç›¸å…³ä»£ç ç‰‡æ®µ(ä½¿ç”¨CHUNK_SIZEå› å­è¿›è¡Œåˆ†å—åº”ç”¨)ã€‚</p>\n<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ªç¯å±•å¼€-é˜»å¡è½¬æ¢è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªpragmaï¼Œå¹¶ç”±ç¼–è¯‘å™¨å®Œæˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç ”ç©¶-opt-reportçš„è¾“å‡ºå¯ä»¥ç¡®è®¤ç¼–è¯‘å™¨ç¡®å®ä¸ºä½ çš„å¾ªç¯æ‰§è¡Œäº†å±•å¼€é˜»å¡ä¼˜åŒ–ã€‚</p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs fortran\">#define CHUNK_SIZE <span class=\"hljs-number\">8192</span><br><br>#pragma omp parallel <span class=\"hljs-keyword\">private</span>(body_start_index)<br>  for(body_start_index = <span class=\"hljs-number\">0</span>; body_start_index &lt; global_number_of_bodies; body_start_index += CHUNK_SIZE) &#123;<br>    <span class=\"hljs-built_in\">int</span> i;<br>    <span class=\"hljs-built_in\">int</span> body_end_index = body_start_index + CHUNK_SIZE;<br><br>    #pragma omp for <span class=\"hljs-keyword\">private</span>(i) schedule(guided)<br>    #pragma unroll_and_jam (<span class=\"hljs-number\">4</span>)<br>    for(i=starting_index; i&lt;ending_index; i++) &#123;<br>      <span class=\"hljs-built_in\">int</span> j;<br>      <span class=\"hljs-keyword\">TYPE</span> acc_x_0 = <span class=\"hljs-number\">0</span>, acc_y_0 = <span class=\"hljs-number\">0</span>, acc_z_0 = <span class=\"hljs-number\">0</span>;<br>      for(j=body_start_index; j&lt;body_end_index; j+=<span class=\"hljs-number\">1</span>) &#123;<br>        <span class=\"hljs-keyword\">TYPE</span> delta_x_0 = Input_Position_X[(j+<span class=\"hljs-number\">0</span>)] - Input_Position_X[i];<br>        <span class=\"hljs-keyword\">TYPE</span> delta_y_0 = Input_Position_Y[(j+<span class=\"hljs-number\">0</span>)] - Input_Position_Y[i];<br>        <span class=\"hljs-keyword\">TYPE</span> delta_z_0 = Input_Position_Z[(j+<span class=\"hljs-number\">0</span>)] - Input_Position_Z[i];<br><br>        <span class=\"hljs-keyword\">TYPE</span> gamma_0 = delta_x_0*delta_x_0 + delta_y_0*delta_y_0 + delta_z_0*delta_z_0 + epsilon_sqr;<br>        <span class=\"hljs-keyword\">TYPE</span> s_0 = Mass[j+<span class=\"hljs-number\">0</span>]/(gamma_0 * <span class=\"hljs-built_in\">SQRT</span>(gamma_0));<br>        acc_x_0 += s_0*delta_x_0;<br>        acc_y_0 += s_0*delta_y_0;<br>        acc_z_0 += s_0*delta_z_0;<br>      &#125;<br>      Output_Acceleration[<span class=\"hljs-number\">3</span>*(i+<span class=\"hljs-number\">0</span>)+<span class=\"hljs-number\">0</span>] += acc_x_0;<br>      Output_Acceleration[<span class=\"hljs-number\">3</span>*(i+<span class=\"hljs-number\">0</span>)+<span class=\"hljs-number\">1</span>] += acc_y_0;<br>      Output_Acceleration[<span class=\"hljs-number\">3</span>*(i+<span class=\"hljs-number\">0</span>)+<span class=\"hljs-number\">2</span>] += acc_z_0;<br>    &#125;<br>  &#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>ä¸‹é¢æ˜¯Fortranä¸­çš„ä¸€ä¸ªçŸ©é˜µä¹˜æ³•ä»£ç ç¤ºä¾‹ï¼Œå…¶ä¸­ç”¨æˆ·æ‰§è¡Œé«˜çº§å—å±•å¼€-åˆ†å—è½¬æ¢(åœ¨ä¿®æ”¹ç‰ˆæœ¬ä¸­)ï¼Œæ¶‰åŠæœ¬åœ°å¤åˆ¶æ•°ç»„ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚</p>\n<p><strong>Fortran Source Example:</strong></p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs fortran\"><span class=\"hljs-keyword\">do</span> j=<span class=\"hljs-number\">1</span>,N<br>  <span class=\"hljs-keyword\">do</span> k = <span class=\"hljs-number\">1</span>,N<br>    <span class=\"hljs-keyword\">do</span> i = <span class=\"hljs-number\">1</span>,N<br>      c(i,j) = c(i,j) + a(i,k) * b(k,j)<br>    <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>  <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br><span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br></code></pre></div></td></tr></table></figure>\n\n<p><strong>Modified Fortran Source:</strong></p>\n<figure class=\"highlight fortran\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs fortran\"><span class=\"hljs-keyword\">do</span> JJ = <span class=\"hljs-number\">1</span>, N, TJ<br><br>       <span class=\"hljs-keyword\">do</span> KK = <span class=\"hljs-number\">1</span>, N, TK<br>         <span class=\"hljs-keyword\">do</span> jjj = <span class=\"hljs-number\">1</span>,<span class=\"hljs-built_in\">min</span>(tj,N-jj+<span class=\"hljs-number\">1</span>)                     <span class=\"hljs-comment\">! BCOPY - no transpose</span><br>           <span class=\"hljs-keyword\">do</span> kkk = <span class=\"hljs-number\">1</span>, <span class=\"hljs-built_in\">min</span>(tk,N-kk+<span class=\"hljs-number\">1</span>)<br>             p(kkk,jjj-<span class=\"hljs-number\">1</span>+<span class=\"hljs-number\">1</span>) = B(kk+kkk-<span class=\"hljs-number\">1</span>, jj+jjj-<span class=\"hljs-number\">1</span>)<br>           <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>         <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>         <span class=\"hljs-keyword\">do</span> II = <span class=\"hljs-number\">1</span>, N, TI<br>           <span class=\"hljs-keyword\">do</span> iii = <span class=\"hljs-number\">1</span>,<br>             <span class=\"hljs-built_in\">min</span>(ti,N-ii+<span class=\"hljs-number\">1</span>)                   <span class=\"hljs-comment\">!ACOPY - transpose</span><br>             <span class=\"hljs-keyword\">do</span> kkk = <span class=\"hljs-number\">1</span>, <span class=\"hljs-built_in\">min</span>(tk,N-kk+<span class=\"hljs-number\">1</span>)<br>                Q(kkk,iii) = A(ii+iii-<span class=\"hljs-number\">1</span>, kk+kkk-<span class=\"hljs-number\">1</span>)<br>             <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>           <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>           <span class=\"hljs-keyword\">do</span> J = <span class=\"hljs-number\">1</span>, <span class=\"hljs-built_in\">min</span>(tj,N-jj+<span class=\"hljs-number\">1</span>), <span class=\"hljs-number\">4</span><br>             <span class=\"hljs-keyword\">do</span> I = <span class=\"hljs-number\">1</span>, <span class=\"hljs-built_in\">min</span>(ti,N-ii+<span class=\"hljs-number\">1</span>), <span class=\"hljs-number\">2</span><br>                t1 = <span class=\"hljs-number\">0</span> ; t2 = <span class=\"hljs-number\">0</span> ; t5 = <span class=\"hljs-number\">0</span> ; t6 = <span class=\"hljs-number\">0</span> ; t9 = <span class=\"hljs-number\">0</span> ; t10 = <span class=\"hljs-number\">0</span> ; t13 =<span class=\"hljs-number\">0</span> ; t14 = <span class=\"hljs-number\">0</span><br>                <span class=\"hljs-comment\">!DIR$ vector aligned                      !DIR$ unroll(2)</span><br>                <span class=\"hljs-keyword\">do</span> K = <span class=\"hljs-number\">1</span>,<span class=\"hljs-built_in\">min</span>(TK,N-kk+<span class=\"hljs-number\">1</span>)      <span class=\"hljs-comment\">! Innermost loop, vectorized and unrolled by 2 after that</span><br>                   qi = Q(K,I)           ;    qi1 = Q(K,I+<span class=\"hljs-number\">1</span>)  <br>                   t1 = t1+qi*P(K,J)     ;    t2 = t2+ qi1*P(K,J)<br>                   t5 = t5+ qi*P(K,J+<span class=\"hljs-number\">1</span>)  ;    t6 = t6+ qi1*P(K,J+<span class=\"hljs-number\">1</span>)<br>                   t9 = t9+ qi*P(K,J+<span class=\"hljs-number\">2</span>)  ;    t10 = t10+ qi1*P(K,J+<span class=\"hljs-number\">2</span>)<br>                   t13 = t13+ qi*P(K,J+<span class=\"hljs-number\">3</span>);    t14 = t14+qi1*P(K,J+<span class=\"hljs-number\">3</span>)<br>                <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>               c(i+ii-<span class=\"hljs-number\">1</span>,j+jj-<span class=\"hljs-number\">1</span>) = c(i+ii-<span class=\"hljs-number\">1</span>,j+jj-<span class=\"hljs-number\">1</span>) +t1          ; c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+jj-<span class=\"hljs-number\">1</span>) = c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+jj-<span class=\"hljs-number\">1</span>) + t2<br>               c(i+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">1</span>+jj-<span class=\"hljs-number\">1</span>) = c(i+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">1</span>+jj-<span class=\"hljs-number\">1</span>) + t5     ; c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">1</span>+jj-<span class=\"hljs-number\">1</span>) = c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">1</span>+jj-<span class=\"hljs-number\">1</span>) + t6<br>               c(i+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">2</span>+jj-<span class=\"hljs-number\">1</span>) = c(i+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">2</span>+jj-<span class=\"hljs-number\">1</span>) + t9     ; c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">2</span>+jj-<span class=\"hljs-number\">1</span>) = c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">2</span>+jj-<span class=\"hljs-number\">1</span>) + t10<br>               c(i+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">3</span>+jj-<span class=\"hljs-number\">1</span>) = c(i+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">3</span>+jj-<span class=\"hljs-number\">1</span>) + t13    ; c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">3</span>+jj-<span class=\"hljs-number\">1</span>) = c(i+<span class=\"hljs-number\">1</span>+ii-<span class=\"hljs-number\">1</span>,j+<span class=\"hljs-number\">3</span>+jj-<span class=\"hljs-number\">1</span>) + t14<br>             <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>           <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>         <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>       <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br>     <span class=\"hljs-keyword\">end</span> <span class=\"hljs-keyword\">do</span><br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"Take-Aways\"><a href=\"#Take-Aways\" class=\"headerlink\" title=\"Take Aways\"></a>Take Aways</h3><p>ç¼“å­˜åˆ†å—æ˜¯ä¸€ç§é‡æ–°å®‰æ’æ•°æ®è®¿é—®çš„æŠ€æœ¯ï¼Œå°†æ•°æ®å­é›†(å—)æ‹‰å…¥ç¼“å­˜ï¼Œå¹¶å¯¹è¿™ä¸ªå—è¿›è¡Œæ“ä½œï¼Œä»¥é¿å…ä¸å¾—ä¸é‡å¤ä»ä¸»å­˜ä¸­è·å–æ•°æ®ã€‚æ­£å¦‚ä¸Šé¢çš„ç¤ºä¾‹æ‰€ç¤ºï¼Œå¯ä»¥ä»¥è¿™ç§æ–¹å¼æ‰‹åŠ¨åˆ†å—å¾ªç¯æ•°æ®ä»¥é‡ç”¨ç¼“å­˜ã€‚</p>\n<p>å¯¹äºæ€§èƒ½å…³é”®çš„å¾ªç¯ï¼Œå…¶ä¸­æ€§èƒ½åˆ†æè¡¨æ˜å†…å­˜å¸¦å®½é™åˆ¶ï¼Œè€Œ-opt-reportæ˜¾ç¤ºç¼–è¯‘å™¨æ²¡æœ‰ä»¥æœ€ä½³æ–¹å¼åˆ†å—å¾ªç¯ï¼Œæ‚¨å¯ä»¥è€ƒè™‘æ‰‹åŠ¨å±•å¼€å¾ªç¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°åˆ†å—æ•°æ®ä»¥å®ç°ç¼“å­˜é‡ç”¨ã€‚</p>\n<h3 id=\"NEXT-STEPS\"><a href=\"#NEXT-STEPS\" class=\"headerlink\" title=\"NEXT STEPS\"></a>NEXT STEPS</h3><p>æ‚¨å¿…é¡»ä»å¤´åˆ°å°¾é˜…è¯»æœ¬æŒ‡å—ï¼Œä½¿ç”¨å†…ç½®çš„è¶…é“¾æ¥æ¥æŒ‡å¯¼æ‚¨åœ¨IntelÂ®Xeonå¤„ç†å™¨ä¸ŠæˆåŠŸåœ°ç§»æ¤å’Œè°ƒä¼˜åº”ç”¨ç¨‹åºã€‚æœ¬æŒ‡å—ä¸­æä¾›çš„è·¯å¾„åæ˜ äº†è·å¾—æœ€ä½³åº”ç”¨ç¨‹åºæ€§èƒ½æ‰€éœ€çš„æ­¥éª¤ã€‚</p>\n",
            "tags": [
                "Cache",
                "Blocking"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/26/openmp008/",
            "url": "https://xingyuanjie.top/2023/02/26/openmp008/",
            "title": "OpenMP:Internal Control Variables",
            "date_published": "2023-02-26T09:36:54.000Z",
            "content_html": "<h2 id=\"2-5-Internal-Control-Variables\"><a href=\"#2-5-Internal-Control-Variables\" class=\"headerlink\" title=\"2.5 Internal Control Variables\"></a>2.5 Internal Control Variables</h2><p>OpenMPå®ç°å¿…é¡»åƒå†…éƒ¨æ§åˆ¶å˜é‡(icv)ä¸€æ ·æ§åˆ¶OpenMPç¨‹åºçš„è¡Œä¸ºã€‚è¿™äº›icvå­˜å‚¨çš„ä¿¡æ¯åŒ…æ‹¬ç”¨äºæœªæ¥å¹¶è¡ŒåŒºåŸŸçš„çº¿ç¨‹æ•°ã€ç”¨äºå·¥ä½œå…±äº«å¾ªç¯çš„è°ƒåº¦ä»¥åŠæ˜¯å¦å¯ç”¨åµŒå¥—å¹¶è¡Œã€‚åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œicvåœ¨ä¸åŒçš„æ—¶é—´è¢«èµ‹äºˆå€¼(å¦‚ä¸‹æ‰€è¿°)ã€‚å®ƒä»¬æ˜¯ç”±å®ç°æœ¬èº«åˆå§‹åŒ–çš„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡OpenMPç¯å¢ƒå˜é‡å’Œè°ƒç”¨OpenMP APIä¾‹ç¨‹æ¥èµ‹å€¼ã€‚ç¨‹åºåªèƒ½é€šè¿‡OpenMP APIä¾‹ç¨‹æ£€ç´¢è¿™äº›icvçš„å€¼ã€‚</p>\n<p>å‡ºäºè¯´æ˜çš„ç›®çš„ï¼Œæœ¬æ–‡æ¡£ä½¿ç”¨ç‰¹å®šçš„åç§°æ¥å¼•ç”¨icvï¼Œä½†æ˜¯å®ç°ä¸éœ€è¦ä½¿ç”¨è¿™äº›åç§°ï¼Œä¹Ÿä¸éœ€è¦æä¾›è®¿é—®å˜é‡çš„ä»»ä½•æ–¹æ³•ï¼Œé™¤éé€šè¿‡ç¬¬<a href=\"https://www.openmp.org/spec-html/5.0/openmpsu31.html#x50-680002.5.2\">189</a>é¡µç¬¬<a href=\"https://www.openmp.org/spec-html/5.0/openmpsu31.html#x50-680002.5.2\">2.5.2èŠ‚</a>æ‰€ç¤ºçš„æ–¹æ³•ã€‚</p>\n<p>2.5.1 <a href=\"https://www.openmp.org/spec-html/5.0/openmpsu30.html#x49-670002.5.1\">ICV Descriptions</a></p>\n<p>2.5.2 <a href=\"https://www.openmp.org/spec-html/5.0/openmpsu31.html#x50-680002.5.2\">ICV Initialization</a></p>\n<p>2.5.3 <a href=\"https://www.openmp.org/spec-html/5.0/openmpsu32.html#x51-710002.5.3\">Modifying and Retrieving ICV Values</a></p>\n<p>2.5.4 <a href=\"https://www.openmp.org/spec-html/5.0/openmpsu33.html#x52-740002.5.4\">How ICVs are Scoped</a></p>\n<p>â€‹\t\t 2.5.4.1 <a href=\"https://www.openmp.org/spec-html/5.0/openmpsu33.html#x52-760002.5.4.1\">How the Per-Data Environment ICVs Work</a></p>\n<p>2.5.5 <a href=\"https://www.openmp.org/spec-html/5.0/openmpsu34.html#x53-770002.5.5\">ICV Override Relationships</a></p>\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://www.openmp.org/spec-html/5.0/openmpse13.html#x48-660002.5\">Internal Control Variables (openmp.org)</a></p>\n",
            "tags": [
                "OpenMP"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/26/openmp007/",
            "url": "https://xingyuanjie.top/2023/02/26/openmp007/",
            "title": "OpenMPçº¿ç¨‹ç»‘å®šã€æœªå®Œç»“ã€‘",
            "date_published": "2023-02-26T09:06:59.000Z",
            "content_html": "<h2 id=\"OpenMPçº¿ç¨‹ç»‘å®š\"><a href=\"#OpenMPçº¿ç¨‹ç»‘å®š\" class=\"headerlink\" title=\"OpenMPçº¿ç¨‹ç»‘å®š\"></a>OpenMPçº¿ç¨‹ç»‘å®š</h2><h3 id=\"OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤\"><a href=\"#OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤\" class=\"headerlink\" title=\"OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤\"></a>OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤</h3><h4 id=\"OMP-PROC-BIND\"><a href=\"#OMP-PROC-BIND\" class=\"headerlink\" title=\"OMP_PROC_BIND\"></a>OMP_PROC_BIND</h4><p>OMP_PROC_BINDç¯å¢ƒå˜é‡è®¾ç½®bind-var ICVçš„åˆå§‹å€¼ã€‚è¿™ä¸ªç¯å¢ƒå˜é‡çš„å€¼å¯ä»¥æ˜¯trueã€falseï¼Œæˆ–è€…ç”¨é€—å·åˆ†éš”çš„masterã€closeæˆ–spreadåˆ—è¡¨ã€‚åˆ—è¡¨çš„å€¼è®¾ç½®äº†å¯¹åº”åµŒå¥—çº§åˆ«çš„å¹¶è¡ŒåŒºåŸŸè¦ä½¿ç”¨çš„çº¿ç¨‹äº²å’Œç­–ç•¥ã€‚</p>\n<p>å¦‚æœç¯å¢ƒå˜é‡è®¾ç½®ä¸ºfalseï¼Œåˆ™æ‰§è¡Œç¯å¢ƒå¯èƒ½ä¼šåœ¨OpenMPä½ç½®ä¹‹é—´ç§»åŠ¨OpenMPçº¿ç¨‹ï¼Œçº¿ç¨‹ç›¸å…³æ€§å°†è¢«ç¦ç”¨ï¼Œå¹¶è¡Œæ„é€ ä¸Šçš„proc_bindå­å¥å°†è¢«å¿½ç•¥ã€‚</p>\n<p>å¦åˆ™ï¼Œæ‰§è¡Œç¯å¢ƒä¸åº”è¯¥åœ¨OpenMPä½ç½®ä¹‹é—´ç§»åŠ¨OpenMPçº¿ç¨‹ï¼Œçº¿ç¨‹äº²å’Œæ€§è¢«å¯ç”¨ï¼Œå¹¶ä¸”åˆå§‹çº¿ç¨‹è¢«ç»‘å®šåˆ°OpenMPä½ç½®åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œå…ˆäºç¬¬ä¸€ä¸ªæ´»åŠ¨å¹¶è¡ŒåŒºåŸŸã€‚</p>\n<p>å¦‚æœOMP_PROC_BINDç¯å¢ƒå˜é‡ä¸­çš„å€¼ä¸æ˜¯trueã€falseæˆ–masterã€closeæˆ–spreadçš„é€—å·åˆ†éš”åˆ—è¡¨ï¼Œåˆ™ç¨‹åºçš„è¡Œä¸ºæ˜¯å®ç°å®šä¹‰çš„ã€‚å¦‚æœåˆå§‹çº¿ç¨‹ä¸èƒ½ç»‘å®šåˆ°OpenMPä½ç½®åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œåˆ™è¯¥è¡Œä¸ºä¹Ÿæ˜¯å®ç°å®šä¹‰çš„ã€‚</p>\n<p>ä¾‹å­ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">setenv OMP_PROC_BIND false<br>setenv OMP_PROC_BIND &quot;spread,\tspread, close&quot;<br></code></pre></div></td></tr></table></figure>\n\n<h3 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h3><p><a href=\"https://harrychen.xyz/2022/05/08/numa-processor-and-cpu-binding/\">NUMA å¤„ç†å™¨ä¸è¿›ç¨‹ç»‘å®š - Harry Chenâ€™s Blog</a></p>\n<p><a href=\"https://www.openmp.org/spec-html/5.0/openmpse52.html\">OMP_PROC_BIND (openmp.org)</a></p>\n<p><a href=\"https://www.openmp.org/spec-html/5.0/openmpsu36.html#x56-900002.6.2\">Controlling OpenMP Thread Affinity</a></p>\n<p><a href=\"https://www.openmp.org/spec-html/5.0/openmpse53.html\">OMP_PLACES (openmp.org)</a></p>\n<p><a href=\"https://www.intel.com/content/www/us/en/develop/documentation/cpp-compiler-developer-guide-and-reference/top/optimization-and-programming/openmp-support/openmp-library-support/thread-affinity-interface.html\">Thread Affinity Interface (intel.com)</a></p>\n",
            "tags": [
                "OpenMP"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/24/Linux003/",
            "url": "https://xingyuanjie.top/2023/02/24/Linux003/",
            "title": "åŸºäºGDBçš„ç¨‹åºè°ƒè¯•",
            "date_published": "2023-02-24T08:50:20.000Z",
            "content_html": "<h2 id=\"åŸºäºGDBçš„ç¨‹åºè°ƒè¯•\"><a href=\"#åŸºäºGDBçš„ç¨‹åºè°ƒè¯•\" class=\"headerlink\" title=\"åŸºäºGDBçš„ç¨‹åºè°ƒè¯•\"></a>åŸºäºGDBçš„ç¨‹åºè°ƒè¯•</h2><h3 id=\"ç¨‹åºè°ƒè¯•å·¥å…·GDB\"><a href=\"#ç¨‹åºè°ƒè¯•å·¥å…·GDB\" class=\"headerlink\" title=\"ç¨‹åºè°ƒè¯•å·¥å…·GDB\"></a>ç¨‹åºè°ƒè¯•å·¥å…·GDB</h3><p>ç¼–è¯‘å™¨GCCï¼Œé¡¹ç›®æ„å»ºå·¥å…·Makeï¼ˆåˆç§°gmakeï¼‰ï¼Œä»¥åŠGDBã€‚</p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224165344672.png\" alt=\"image-20230224165344672\"></p>\n<p><strong>GDBæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>\n<p>GDBï¼šGNU symbolic debuggeræ˜¯Linuxä¸‹å¸¸ç”¨çš„ç¨‹åºè°ƒè¯•å™¨</p>\n<p><strong>GDBå¯ä»¥åšä»€ä¹ˆï¼Ÿ</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224165606636.png\" alt=\"image-20230224165606636\"></p>\n<p><strong>GDBå®˜ç½‘ï¼š</strong><a href=\"https://www.sourceware.org/gdb/\">GDB: The GNU Project Debugger (sourceware.org)</a></p>\n<h3 id=\"è°ƒè¯•æ¡ˆä¾‹ä¸€\"><a href=\"#è°ƒè¯•æ¡ˆä¾‹ä¸€\" class=\"headerlink\" title=\"è°ƒè¯•æ¡ˆä¾‹ä¸€\"></a>è°ƒè¯•æ¡ˆä¾‹ä¸€</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdio.h&gt;</span></span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span></span><br><span class=\"hljs-function\"></span>&#123;<br>    <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">long</span> <span class=\"hljs-keyword\">long</span> <span class=\"hljs-keyword\">int</span> n,sum;<br>    n = <span class=\"hljs-number\">1</span>;<br>    sum = <span class=\"hljs-number\">0</span>;<br>    <span class=\"hljs-keyword\">while</span>( n &lt;= <span class=\"hljs-number\">100</span>)<br>    &#123;<br>        sum = sum + n;<br>        n = n + <span class=\"hljs-number\">1</span>;<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>åœ¨ç¼–è¯‘ç¨‹åºçš„æ—¶å€™ï¼Œéœ€è¦åŠ è°ƒè¯•é€‰é¡¹ï¼š -g</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">gcc gdb001.c -g -o ex1<br></code></pre></div></td></tr></table></figure>\n\n<p>ä½¿ç”¨gdbå¯åŠ¨ç¨‹åºï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs shell\">gdb ./ex1<br></code></pre></div></td></tr></table></figure>\n\n<p><strong>è¿›å…¥gdbè°ƒè¯•ç¯å¢ƒ</strong>ï¼š</p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224170419171.png\" alt=\"image-20230224170419171\"></p>\n<p><strong>åœ¨è°ƒè¯•ç¯å¢ƒä¸­ï¼šä½¿ç”¨lé€‰é¡¹ä¼šæ˜¾ç¤ºå¸¦è¡Œå·çš„æºä»£ç </strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224170620617.png\" alt=\"image-20230224170620617\"></p>\n<p><strong>ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œlé€‰é¡¹åªæ˜¾ç¤º10è¡Œæºä»£ç ï¼Œå¦‚æœæŸ¥çœ‹åç»­ä»£ç ï¼Œåœ¨è°ƒè¯•ç•Œé¢Enterå›è½¦å³å¯</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224170804048.png\" alt=\"image-20230224170804048\"></p>\n<p><strong>åœ¨ç¬¬7è¡Œæºä»£ç å¤„æ‰“æ–­ç‚¹ï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224171858691.png\" alt=\"image-20230224171858691\"></p>\n<p><strong>è¿è¡Œç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœæ­¢ï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172105514.png\" alt=\"image-20230224172105514\"></p>\n<p><strong>æŸ¥çœ‹ä»£ç ä¸­å˜é‡nçš„å€¼</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172200662.png\" alt=\"image-20230224172200662\"></p>\n<p>å½“å‰nçš„å€¼ä¸º1ï¼Œ$1è¡¨ç¤ºè¯¥å˜é‡æ‰€åœ¨å­˜å‚¨åŒºçš„åç§°</p>\n<p><strong>åœ¨ç¨‹åºç¬¬12è¡Œå¤„æ‰“æ–­ç‚¹</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172321002.png\" alt=\"image-20230224172321002\"></p>\n<p><strong>ç»§ç»­æ‰§è¡Œç¨‹åº</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172356622.png\" alt=\"image-20230224172356622\"></p>\n<p><strong>æŸ¥çœ‹å½“å‰nå˜é‡çš„å€¼</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172422998.png\" alt=\"image-20230224172422998\"></p>\n<p>å½“å‰nçš„å€¼ä¸º101</p>\n<p><strong>é€€å‡ºè°ƒè¯•</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172456626.png\" alt=\"image-20230224172456626\"></p>\n<p><strong>æŸ¥çœ‹è°ƒè¯•ç¯å¢ƒæ‰€æœ‰æ–­ç‚¹ï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172650422.png\" alt=\"image-20230224172650422\"></p>\n<p><strong>åˆ é™¤ç¬¬7è¡Œçš„æ–­ç‚¹ï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172745323.png\" alt=\"image-20230224172745323\"></p>\n<p><strong>ç¦ç”¨ç¼–å·ä¸º2çš„æ–­ç‚¹ï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224172832507.png\" alt=\"image-20230224172832507\"></p>\n<p>æ³¨æ„æ–­ç‚¹çŠ¶æ€Enb(enable)ç”±yå˜æˆnï¼Œä»£è¡¨ç¦ç”¨</p>\n<p><strong>æ¢å¤ç¼–å·ä¸º2çš„æ–­ç‚¹ï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224173006975.png\" alt=\"image-20230224173006975\"></p>\n<h3 id=\"å°ç»“\"><a href=\"#å°ç»“\" class=\"headerlink\" title=\"å°ç»“\"></a>å°ç»“</h3><p>GDBæœ‰ä¸‰ç§è°ƒè¯•æ¨¡å¼ï¼š</p>\n<p><strong>è°ƒè¯•æ‰§è¡Œç¨‹åºï¼š</strong>ï¼ˆå‰é¢çš„æ¡ˆä¾‹ï¼‰ï¼Œæ³¨æ„ç¼–è¯‘åŠ è°ƒè¯•ä¿¡æ¯(-g)</p>\n<p><strong>è°ƒè¯•coreæ–‡ä»¶   ï¼š</strong>éœ€è¦å¯¹ç³»ç»Ÿè®¾ç½®çš„coreæ–‡ä»¶å¤§å°ä½œè°ƒæ•´ï¼ˆulimit - c unlimlitedï¼‰ï¼Œå¦åˆ™å¯èƒ½æ— æ³•\t\t\t\t\t\t\t  äº§ç”Ÿcoreæ–‡ä»¶</p>\n<p><strong>è°ƒè¯•æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºï¼ˆgdb attachï¼‰ ï¼š</strong>Topæ‰¾åˆ°è¿›ç¨‹ç¼–å·pidï¼ŒGdb attach pid</p>\n<p><strong>GDBç»“æ„ç»„æˆï¼š</strong></p>\n<p><img src=\"/2023/02/24/Linux003/image-20230224173613247.png\" alt=\"image-20230224173613247\"></p>\n<h3 id=\"å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š\"><a href=\"#å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š\" class=\"headerlink\" title=\"å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š\"></a>å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š</h3><h4 id=\"å¯åŠ¨æŒ‡ä»¤\"><a href=\"#å¯åŠ¨æŒ‡ä»¤\" class=\"headerlink\" title=\"å¯åŠ¨æŒ‡ä»¤\"></a>å¯åŠ¨æŒ‡ä»¤</h4><p>è°ƒè¯•ç¨‹åºï¼šgdb program</p>\n<p>æ ¹æ®coreæ–‡ä»¶è°ƒè¯•ç¨‹åºï¼šgdb program corefile</p>\n<p>è·Ÿè¸ªè°ƒè¯•è¿›ç¨‹ï¼šgdb attach pid</p>\n<h4 id=\"ç¨‹åºè¿è¡Œ\"><a href=\"#ç¨‹åºè¿è¡Œ\" class=\"headerlink\" title=\"ç¨‹åºè¿è¡Œ\"></a>ç¨‹åºè¿è¡Œ</h4><p>runï¼Œè¯¥å‘½ä»¤ä¼šè¿è¡Œè‡³ç¨‹åºç»“æŸï¼Œé™¤éé‡åˆ°æ–­ç‚¹æˆ–æŠ¥é”™</p>\n<h4 id=\"å•æ­¥æ‰§è¡Œ\"><a href=\"#å•æ­¥æ‰§è¡Œ\" class=\"headerlink\" title=\"å•æ­¥æ‰§è¡Œ\"></a>å•æ­¥æ‰§è¡Œ</h4><p>æ­¥è¿›æ‰§è¡Œä¸è¿›æ ˆï¼Ÿnext</p>\n<p>æ­¥è¿›æ‰§è¡Œï¼Œè¿›æ ˆstep</p>\n<h4 id=\"ä»£ç æŸ¥çœ‹\"><a href=\"#ä»£ç æŸ¥çœ‹\" class=\"headerlink\" title=\"ä»£ç æŸ¥çœ‹\"></a>ä»£ç æŸ¥çœ‹</h4><p>åˆ—å‡ºæ–­ç‚¹é™„è¿‘æˆ–ç¨‹åºæ‰€æœ‰ä»£ç list</p>\n<p>è®¾ç½®ç°å®ä»£ç çš„è¡Œæ•° set listsize &lt;n&gt;</p>\n<h4 id=\"é€€å‡ºè°ƒè¯•\"><a href=\"#é€€å‡ºè°ƒè¯•\" class=\"headerlink\" title=\"é€€å‡ºè°ƒè¯•\"></a>é€€å‡ºè°ƒè¯•</h4><p>quit</p>\n<h4 id=\"æŸ¥çœ‹æ ˆä¿¡æ¯\"><a href=\"#æŸ¥çœ‹æ ˆä¿¡æ¯\" class=\"headerlink\" title=\"æŸ¥çœ‹æ ˆä¿¡æ¯\"></a>æŸ¥çœ‹æ ˆä¿¡æ¯</h4><p>bt\tæ‰“å°å½“å‰çš„å‡½æ•°è°ƒç”¨æ ˆçš„æ‰€æœ‰ä¿¡æ¯</p>\n<p>bt &lt;n&gt;\tnæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºåªæ‰“å°æ ˆé¡¶ä¸Šnå±‚çš„æ ˆä¿¡æ¯</p>\n<p>bt &lt;-n&gt;\tè¡¨ç¤ºåªæ‰“å°æ ˆåº•ä¸‹nå±‚çš„æ ˆä¿¡æ¯</p>\n<h4 id=\"è®¾ç½®æ–­ç‚¹\"><a href=\"#è®¾ç½®æ–­ç‚¹\" class=\"headerlink\" title=\"è®¾ç½®æ–­ç‚¹\"></a>è®¾ç½®æ–­ç‚¹</h4><p><strong>ä»£ç æ–­ç‚¹ï¼š</strong></p>\n<ul>\n<li>break lineNumber | functionName</li>\n<li>break lineNumber | functionName if condition</li>\n<li>tbreak lineNumber | functionName  ä¸´æ—¶æ–­ç‚¹ï¼Œä»…èƒ½ä½¿ç”¨ä¸€æ¬¡</li>\n</ul>\n<p><strong>å†…å­˜æ–­ç‚¹ï¼ˆè§‚å¯Ÿç‚¹ï¼‰ï¼š</strong></p>\n<ul>\n<li>ç›‘æ§å†…å­˜å€¼æ”¹å˜ watch expr [if condition]</li>\n<li>ç›‘æ§å†…å­˜å€¼è¢«è¯»å– rwatch expr [if condition]</li>\n<li>ç›‘æ§å†…å­˜å€¼è¢«è¯»å–å’Œå†™å…¥ awatch wxpr [if condition]</li>\n</ul>\n<p><strong>äº‹ä»¶æ–­ç‚¹ï¼š</strong></p>\n<ul>\n<li>C++ exceptionï¼Œä½¿ç”¨catch exception [name]</li>\n<li>Ada exceptionï¼Œä½¿ç”¨catch handlers [name]</li>\n<li>execäº‹ä»¶ï¼Œä½¿ç”¨catch exec</li>\n<li>forkäº‹ä»¶ï¼Œä½¿ç”¨catch fork æˆ–è€… catch vfork</li>\n<li>åŠ è½½å’Œå¸è½½åŠ¨æ€soäº‹ä»¶ï¼Œä½¿ç”¨catch load|unload [regexp]</li>\n<li>ç›‘å¬ç³»ç»Ÿä¿¡å·ï¼Œä½¿ç”¨catch signal [signal]</li>\n<li>ç›‘å¬ç³»ç»Ÿè°ƒç”¨ï¼Œä½¿ç”¨catch syscall[name|number|group:groupname|g:groupname]â€¦</li>\n</ul>\n<p><strong>æ‰“å°å˜é‡ï¼š</strong></p>\n<ul>\n<li>Print [file | func]::variable æŸ¥çœ‹å±€éƒ¨å˜é‡æˆ–å…¨å±€å˜é‡</li>\n<li>Print *array@len  æ•°ç»„é¦–åœ°å€@æŸ¥çœ‹é•¿åº¦</li>\n<li>x&#x2F;[n | u] &lt;addr&gt;\txå‘½ä»¤æŸ¥çœ‹å†…å­˜åœ°å€é’Ÿçš„å€¼ï¼Œnï¼šè¡¨ç¤ºæ˜¾ç¤ºå†…å­˜çš„é•¿åº¦ï¼Œuï¼šè¡¨ç¤ºä»å½“å‰åœ°å€å¾€åè¯·æ±‚çš„å­—èŠ‚æ•°</li>\n</ul>\n<p><strong>æ‰“å°å¯„å­˜å™¨ï¼š</strong></p>\n<p>info register\tæŸ¥çœ‹å¯„å­˜å™¨ï¼ˆé™¤äº†æµ®ç‚¹å¯„å­˜å™¨ï¼‰</p>\n<p>all-registers\tæŸ¥çœ‹æ‰€æœ‰å¯„å­˜å™¨</p>\n<p>info registers &lt;reg_name â€¦&gt;æŸ¥çœ‹æ‰€æŒ‡å®šå¯„å­˜å™¨</p>\n<h3 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h3><p><strong>æ¥æºåŸ¹è®­PPT ä½œè€…ï¼šRelax  é‚®ç®±ï¼š<a href=\"mailto:&#x77;&#x61;&#110;&#x67;&#x77;&#49;&#49;&#x31;&#x40;&#x69;&#x63;&#108;&#x6f;&#117;&#x64;&#46;&#99;&#x6f;&#x6d;\">&#x77;&#x61;&#110;&#x67;&#x77;&#49;&#49;&#x31;&#x40;&#x69;&#x63;&#108;&#x6f;&#117;&#x64;&#46;&#99;&#x6f;&#x6d;</a></strong></p>\n",
            "tags": [
                "Linux"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/19/Matrix002/",
            "url": "https://xingyuanjie.top/2023/02/19/Matrix002/",
            "title": "çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º",
            "date_published": "2023-02-19T09:04:23.000Z",
            "content_html": "<h2 id=\"çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º\"><a href=\"#çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º\" class=\"headerlink\" title=\"çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º\"></a>çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º</h2><h3 id=\"é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ\"><a href=\"#é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ\" class=\"headerlink\" title=\"é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ\"></a>é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ</h3><p><img src=\"/2023/02/19/Matrix002/image-20230219171156738.png\" alt=\"image-20230219171156738\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i++)&#123;\t\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µå„è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt; n; j++)&#123;\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µiè¡Œjåˆ—</span><br>        c[i][j] = <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> p = <span class=\"hljs-number\">0</span>; p &lt; k; p++)&#123;\t\t<span class=\"hljs-comment\">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class=\"hljs-comment\">//è®¡ç®—åŒºåŸŸ</span><br>           C[i][j] += A[i][p] * B[p][j];\t\t<span class=\"hljs-comment\">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n\n\n<h3 id=\"è®¡ç®—æ‹†åˆ†å±•ç¤º\"><a href=\"#è®¡ç®—æ‹†åˆ†å±•ç¤º\" class=\"headerlink\" title=\"è®¡ç®—æ‹†åˆ†å±•ç¤º\"></a>è®¡ç®—æ‹†åˆ†å±•ç¤º</h3><p>å›¾å››å°†è¾“å‡ºè®¡ç®—æ‹†åˆ†ä¸º <strong>1 Ã— 4</strong> çš„å°å—ï¼Œå³å°† <strong>N</strong> ç»´åº¦æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚è®¡ç®—è¯¥å—è¾“å‡ºæ—¶ï¼Œéœ€è¦ä½¿ç”¨ <strong>A</strong> çŸ©é˜µçš„1è¡Œï¼Œå’Œ <strong>B</strong> çŸ©é˜µçš„4åˆ— ã€‚</p>\n<p><img src=\"/2023/02/19/Matrix002/image-20230219171904249.png\" alt=\"image-20230219171904249\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i++)&#123;\t\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µå„è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt; n; j +=<span class=\"hljs-number\">4</span>)&#123;\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µj-j+3åˆ—</span><br>        c[i][j + <span class=\"hljs-number\">0</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i][j + <span class=\"hljs-number\">1</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i][j + <span class=\"hljs-number\">2</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i][j + <span class=\"hljs-number\">3</span>] = <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> p = <span class=\"hljs-number\">0</span>; p &lt; k; p++)&#123;\t\t<span class=\"hljs-comment\">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class=\"hljs-comment\">//è®¡ç®—åŒºåŸŸ</span><br>            <span class=\"hljs-comment\">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>           C[i][j + <span class=\"hljs-number\">0</span>] += A[i][p] * B[p][j + <span class=\"hljs-number\">0</span>];    <br>           C[i][j + <span class=\"hljs-number\">1</span>] += A[i][p] * B[p][j + <span class=\"hljs-number\">1</span>];<br>           C[i][j + <span class=\"hljs-number\">2</span>] += A[i][p] * B[p][j + <span class=\"hljs-number\">2</span>];<br>           C[i][j + <span class=\"hljs-number\">3</span>] += A[i][p] * B[p][j + <span class=\"hljs-number\">3</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>æœ€å†…ä¾§è®¡ç®—ä½¿ç”¨çš„çŸ©é˜µ<strong>A</strong>çš„å…ƒç´ æ˜¯ä¸€è‡´çš„ã€‚å› æ­¤å¯ä»¥å°†**A[i][p]**è¯»å–åˆ°å¯„å­˜å™¨ä¸­ï¼Œä»è€Œå®ç°4æ¬¡æ•°æ®å¤ç”¨ã€‚ä¾‹å¦‚ï¼š</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">register</span> <span class=\"hljs-keyword\">double</span> temp = A[i][p];<br></code></pre></div></td></tr></table></figure>\n\n<p>ä¸€èˆ¬å°†æœ€å†…ä¾§å¾ªç¯ç§°ä½œè®¡ç®—æ ¸(micro kernel)</p>\n<p>ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ‹†åˆ†è¾“å‡º<strong>M</strong>ç»´åº¦ï¼Œä»è€Œåœ¨å†…æµ‹å¾ªç¯ä¸­è®¡ç®— <strong>4 Ã— 4</strong> è¾“å‡ºï¼Œå¦‚å›¾äº”ã€‚</p>\n<p><img src=\"/2023/02/19/Matrix002/image-20230219174355047.png\" alt=\"image-20230219174355047\"></p>\n<p>åŒæ ·çš„ï¼Œå°†è®¡ç®—æ ¸å¿ƒå±•å¼€ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä¼ªä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°† <strong>1 Ã— 4</strong> ä¸­å±•ç¤ºè¿‡çš„Nç»´åº¦çš„è®¡ç®—ç®€åŒ–è¡¨ç¤ºã€‚è¿™ç§æ‹†åˆ†å¯çœ‹æˆæ˜¯<strong>4 Ã— 1 Ã— 4</strong>ï¼Œè¿™æ ·Aå’ŒBçš„è®¿å­˜å‡å¯å¤ç”¨å››æ¬¡ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i+=<span class=\"hljs-number\">4</span>)&#123;\t\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µi-i+3è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt; n; j +=<span class=\"hljs-number\">4</span>)&#123;\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µç¬¬j-j+3åˆ—</span><br>        c[i + <span class=\"hljs-number\">0</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i + <span class=\"hljs-number\">1</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i + <span class=\"hljs-number\">2</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i + <span class=\"hljs-number\">3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> p = <span class=\"hljs-number\">0</span>; p &lt; k; p++)&#123;\t\t<span class=\"hljs-comment\">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class=\"hljs-comment\">//è®¡ç®—åŒºåŸŸ</span><br>            <span class=\"hljs-comment\">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>           C[i + <span class=\"hljs-number\">0</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">0</span>][p] * B[p][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];    <br>           C[i + <span class=\"hljs-number\">1</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">1</span>][p] * B[p][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];<br>           C[i + <span class=\"hljs-number\">2</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">2</span>][p] * B[p][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];<br>           C[i + <span class=\"hljs-number\">3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">3</span>][p] * B[p][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>åˆ°ç›®å‰ä¸ºæ­¢ã€‚æˆ‘ä»¬éƒ½æ˜¯åœ¨è¾“å‡ºçš„ä¸¤ä¸ªç»´åº¦ä¸Šå±•å¼€ï¼Œè€Œæ•´ä¸ªè®¡ç®—è¿˜åŒ…å«ä¸€ä¸ªè§„çº¦(Reduction)ç»´åº¦Kã€‚å›¾å…­å±•ç¤ºäº†åœ¨è®¡ç®—<strong>4 Ã— 4</strong>è¾“å‡ºæ—¶ï¼Œå°†ç»´åº¦Kæ‹†åˆ†ï¼Œä»è€Œæ¯æ¬¡æœ€å†…ä¾§å¾ªç¯è®¡ç®—å‡ºè¾“å‡ºçŸ©é˜µCçš„<strong>4&#x2F;K</strong>çš„éƒ¨åˆ†å’Œã€‚</p>\n<p><img src=\"/2023/02/19/Matrix002/image-20230219180147184.png\" alt=\"image-20230219180147184\"></p>\n<p>ä¸‹é¢å±•ç¤ºçš„æ˜¯è¿™éƒ¨åˆ†è®¡ç®—çš„å±•å¼€ä¼ªä»£ç ï¼Œå…¶ä¸­ç»´åº¦Må’ŒNå·²ç»è¢«ç®€å†™ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; m; i+=<span class=\"hljs-number\">4</span>)&#123;\t\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µi-i+3è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> j = <span class=\"hljs-number\">0</span>; j &lt; n; j +=<span class=\"hljs-number\">4</span>)&#123;\t\t\t<span class=\"hljs-comment\">//éå†CçŸ©é˜µç¬¬j-j+3åˆ—</span><br>        c[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        c[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] = <span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">int</span> p = <span class=\"hljs-number\">0</span>; p &lt; k; p+=<span class=\"hljs-number\">4</span>)&#123;\t\t<span class=\"hljs-comment\">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class=\"hljs-comment\">//è®¡ç®—åŒºåŸŸ</span><br>           C[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][p + <span class=\"hljs-number\">0</span>] * B[p + <span class=\"hljs-number\">0</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];    <br>           C[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][p + <span class=\"hljs-number\">1</span>] * B[p + <span class=\"hljs-number\">1</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];<br>           C[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][p + <span class=\"hljs-number\">2</span>] * B[p + <span class=\"hljs-number\">2</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];<br>           C[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>] += A[i + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>][p + <span class=\"hljs-number\">3</span>] * B[p + <span class=\"hljs-number\">3</span>][j + <span class=\"hljs-number\">0.</span><span class=\"hljs-number\">.3</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>\n\n<p>åœ¨å¯¹Må’ŒNå±•å¼€å¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å¤ç”¨Bå’ŒAçš„æ•°æ®ï¼›åœ¨å¯¹Kå±•å¼€æ—¶ï¼Œå…¶å±€éƒ¨ä½¿ç”¨çš„Cçš„å†…å­˜æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆKè¿­ä»£æ—¶å¯ä»¥å°†éƒ¨åˆ†å’Œç´¯åŠ åœ¨å¯„å­˜å™¨ä¸­â€”â€”æœ€å†…å±‚å¾ªç¯æ•´ä¸ªè¿­ä»£ä¸€æ¬¡å†™åˆ°Cçš„å†…å­˜ä¸­ã€‚</p>\n<h3 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h3><p><a href=\"https://zhenhuaw.me/blog/2019/gemm-optimization.html\">é€šç”¨çŸ©é˜µä¹˜ï¼ˆGEMMï¼‰ä¼˜åŒ–ç®—æ³• | é»æ˜ç°çƒ¬ åšå®¢ (zhenhuaw.me)</a></p>\n",
            "tags": [
                "Matrix",
                "GEMM"
            ]
        },
        {
            "id": "https://xingyuanjie.top/2023/02/18/leetcode11/",
            "url": "https://xingyuanjie.top/2023/02/18/leetcode11/",
            "title": "11. ç››æœ€å¤šæ°´çš„å®¹å™¨",
            "date_published": "2023-02-18T08:27:01.000Z",
            "content_html": "<h2 id=\"11-ç››æœ€å¤šæ°´çš„å®¹å™¨\"><a href=\"#11-ç››æœ€å¤šæ°´çš„å®¹å™¨\" class=\"headerlink\" title=\"11.ç››æœ€å¤šæ°´çš„å®¹å™¨\"></a>11.ç››æœ€å¤šæ°´çš„å®¹å™¨</h2><h2 id=\"é¢˜ç›®é“¾æ¥\"><a href=\"#é¢˜ç›®é“¾æ¥\" class=\"headerlink\" title=\"é¢˜ç›®é“¾æ¥\"></a>é¢˜ç›®é“¾æ¥</h2><h4 id=\"11-ç››æœ€å¤šæ°´çš„å®¹å™¨-1\"><a href=\"#11-ç››æœ€å¤šæ°´çš„å®¹å™¨-1\" class=\"headerlink\" title=\"11. ç››æœ€å¤šæ°´çš„å®¹å™¨\"></a><a href=\"https://leetcode.cn/problems/container-with-most-water/\">11. ç››æœ€å¤šæ°´çš„å®¹å™¨</a></h4><h2 id=\"å®Œæ•´ä»£ç \"><a href=\"#å®Œæ•´ä»£ç \" class=\"headerlink\" title=\"å®Œæ•´ä»£ç \"></a>å®Œæ•´ä»£ç </h2><figure class=\"highlight c++\"><table><tr><td class=\"gutter hljs\"><div class=\"hljs code-wrapper\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></div></td><td class=\"code\"><div class=\"hljs code-wrapper\"><pre><code class=\"hljs c++\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Solution</span> &#123;</span><br><span class=\"hljs-keyword\">public</span>:<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">maxArea</span><span class=\"hljs-params\">(vector&lt;<span class=\"hljs-keyword\">int</span>&gt;&amp; height)</span> </span>&#123;<br>        <span class=\"hljs-comment\">//åŒæŒ‡é’ˆï¼›</span><br>        <span class=\"hljs-keyword\">int</span> ans =<span class=\"hljs-number\">-1</span>;<br>        <span class=\"hljs-keyword\">int</span> left=<span class=\"hljs-number\">0</span>;<br>        <span class=\"hljs-keyword\">int</span> right=height.<span class=\"hljs-built_in\">size</span>()<span class=\"hljs-number\">-1</span>;<br>        <span class=\"hljs-keyword\">while</span>(left&lt;right)&#123;<br>            <span class=\"hljs-keyword\">int</span> temp=<span class=\"hljs-number\">0</span>;<br>            <span class=\"hljs-keyword\">if</span>(height[left]&lt;=height[right])&#123;<br>                temp = height[left]*(right-left);<br>                ans = std::<span class=\"hljs-built_in\">max</span>(ans,temp);<br>                left++;<br>            &#125;<span class=\"hljs-keyword\">else</span>&#123;<br>                temp = height[right]*(right-left);<br>                ans = std::<span class=\"hljs-built_in\">max</span>(ans,temp);<br>                right--;<br>            &#125;<br>            <br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> ans;<br>        <br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒèµ„æ–™\"><a href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"></a>å‚è€ƒèµ„æ–™</h2><p><a href=\"https://leetcode.cn/problems/container-with-most-water/solution/sheng-zui-duo-shui-de-rong-qi-by-leetcode-solution/\">ç››æœ€å¤šæ°´çš„å®¹å™¨ - ç››æœ€å¤šæ°´çš„å®¹å™¨ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>\n",
            "tags": [
                "C++",
                "LeetCode",
                "åŒæŒ‡é’ˆ"
            ]
        }
    ]
}