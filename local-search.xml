<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>BLASï¼ˆBasic Linear Algebra Subprogramsï¼‰-åŸºç¡€çº¿æ€§ä»£æ•°å­ç¨‹åºåº“</title>
    <link href="/2023/05/22/blas/"/>
    <url>/2023/05/22/blas/</url>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><h3 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢:"></a>åšå®¢:</h3><p><a href="https://www.jianshu.com/p/e01024892afb">çŸ©é˜µç›¸ä¹˜åœ¨GPUä¸Šçš„ç»ˆæä¼˜åŒ–ï¼šæ·±åº¦è§£æMaxasæ±‡ç¼–å™¨å·¥ä½œåŸç† - ç®€ä¹¦ (jianshu.com)</a></p><p><a href="https://www.leiphone.com/category/yanxishe/Puevv3ZWxn0heoEv.html">OpenBLASé¡¹ç›®ä¸çŸ©é˜µä¹˜æ³•ä¼˜åŒ– | AI ç ”ä¹ ç¤¾ | é›·å³°ç½‘ (leiphone.com)</a></p><p><a href="https://jcf94.com/2021/08/28/2021-08-28-simd/">çŸ©é˜µä¹˜æ³•ä¸ SIMD | Chenfan Blog (jcf94.com)</a></p><p><a href="https://zhenhuaw.me/blog/2019/gemm-optimization.html">é€šç”¨çŸ©é˜µä¹˜ï¼ˆGEMMï¼‰ä¼˜åŒ–ç®—æ³• | é»æ˜ç°çƒ¬ åšå®¢ (zhenhuaw.me)</a></p><p><a href="https://zhuanlan.zhihu.com/p/383115932">å¤§ä½¬æ˜¯æ€ä¹ˆä¼˜é›…å®ç°çŸ©é˜µä¹˜æ³•çš„ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/65436463">OpenBLAS gemmä»é›¶å…¥é—¨ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://harleyszhang.github.io/cv_note/">Introduction Â· cvç®—æ³•å·¥ç¨‹å¸ˆæˆé•¿ä¹‹è·¯ (harleyszhang.github.io)</a></p><p><a href="https://zhuanlan.zhihu.com/p/435908830">æ·±å…¥æµ…å‡ºGPUä¼˜åŒ–ç³»åˆ—ï¼šGEMMä¼˜åŒ–ï¼ˆä¸€ï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/410278370">CUDA çŸ©é˜µä¹˜æ³•ç»ˆæä¼˜åŒ–æŒ‡å— - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/368870275">çŸ©é˜µä¹˜æ³•çš„å¹¶è¡Œä¼˜åŒ–ï¼ˆ1ï¼‰ï¼šOPENMPã€CUDAå®ç° - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/617296073">å¹¶è¡Œè®¡ç®—å…¥é—¨ UIUC ECE408 Lecture 7&amp;8 - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/143328317">ç§»åŠ¨ç«¯arm cpuä¼˜åŒ–å­¦ä¹ ç¬”è®°ç¬¬4å¼¹â€“å†…è”æ±‡ç¼–å…¥é—¨ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/348372132">Cè¯­è¨€çš„å†…åµŒæ±‡ç¼– - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/105616727">å†…åµŒæ±‡ç¼–å­¦ä¹  - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://blog.csdn.net/unbutun/article/details/6123472">(88æ¡æ¶ˆæ¯) #define barrier() <strong>asm</strong> <strong>volatile</strong>(â€œâ€: : :â€memoryâ€) ä¸­çš„memoryæ˜¯gccçš„ä¸œè¥¿_unbutunçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/weixin_38669561/article/details/105192200?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3.control">(88æ¡æ¶ˆæ¯) MIPSæŒ‡ä»¤é›†ï¼šå†…åµŒæ±‡ç¼–asmè¯­æ³•ä»‹ç»_dadduæŒ‡ä»¤_æ— è‰²äº‘çš„åšå®¢-CSDNåšå®¢</a></p><h3 id="è®ºæ–‡ï¼š"><a href="#è®ºæ–‡ï¼š" class="headerlink" title="è®ºæ–‡ï¼š"></a>è®ºæ–‡ï¼š</h3><p><a href="https://www.cs.utexas.edu/users/flame/FLAMEPublications.html">Publications Related to the FLAME Project (utexas.edu)</a></p><p><a href="https://dl.acm.org/doi/10.1145/1356052.1356053">Anatomy of high-performance matrix multiplication | ACM Transactions on Mathematical Software</a></p><p><a href="https://dl.acm.org/doi/10.1145/3018743.3018755">Understanding the GPU Microarchitecture to Achieve Bare-Metal Performance Tuning | Proceedings of the 22nd ACM SIGPLAN Symposium on Principles and Practice of Parallel Programming</a></p><p>[<a href="https://arxiv.org/abs/1804.06826">1804.06826] Dissecting the NVIDIA Volta GPU Architecture via Microbenchmarking (arxiv.org)</a></p><p><a href="https://ieeexplore.ieee.org/document/6114452">Fast implementation of DGEMM on Fermi GPU | IEEE Conference Publication | IEEE Xplore</a></p><p><a href="https://dl.acm.org/doi/abs/10.1145/3369583.3393611">High Performance is All about Minimizing Data Movement | Proceedings of the 29th International Symposium on High-Performance Parallel and Distributed Computing (acm.org)</a></p><h3 id="ç¤¾åŒº-x2F-è®ºå›"><a href="#ç¤¾åŒº-x2F-è®ºå›" class="headerlink" title="ç¤¾åŒº&#x2F;è®ºå›:"></a>ç¤¾åŒº&#x2F;è®ºå›:</h3><p><a href="http://tvm.d2l.ai/chapter_gpu_schedules/vector_add.html#cuda-programming">2. Vector Add â€” Dive into Deep Learning Compiler 0.1 documentation (d2l.ai)</a></p><p><a href="https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html">IntelÂ® Intrinsics Guide</a></p><p><a href="https://github.com/pytorch/QNNPACK">https://github.com/pytorch/QNNPACK</a></p><p><a href="https://github.com/flame/blis">https://github.com/flame/blis</a></p><p><a href="https://www.mathematik.uni-ulm.de/~lehn/apfel/ulmBLAS/">ulmBLAS (index) (uni-ulm.de)</a></p><p><a href="https://www.mathematik.uni-ulm.de/~lehn/apfel/sghpc/gemm/index.html">work&#x2F;sghpc (index) (uni-ulm.de)</a></p><p><a href="https://shpc.oden.utexas.edu/">The Science of High-Performance Computing Group (utexas.edu)</a></p><p><a href="https://github.com/BBuf/how-to-optimize-gemm">GitHub - BBuf&#x2F;how-to-optimize-gemm</a></p><p><a href="https://github.com/Liu-xiandong/How_to_optimize_in_GPU">GitHub - Liu-xiandong&#x2F;How_to_optimize_in_GPU: This is a series of GPU optimization topics. Here we will introduce how to optimize the CUDA kernel in detail. I will introduce several basic kernel optimizations, including: elementwise, reduce, sgemv, sgemm, etc. The performance of these kernels is basically at or near the theoretical limit.</a></p><p><a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/#">CUDA C++ Programming Guide (nvidia.com)</a></p><p><a href="https://github.com/NervanaSystems/maxas/wiki/SGEMM">SGEMM Â· NervanaSystems&#x2F;maxas Wiki Â· GitHub</a></p><p><a href="https://github.com/Cjkkkk/CUDA_gemm">GitHub - Cjkkkk&#x2F;CUDA_gemm: A simple high performance CUDA GEMM implementation.</a></p><p><a href="https://github.com/yzhaiustc/Optimizing-SGEMM-on-NVIDIA-Turing-GPUs">GitHub - yzhaiustc&#x2F;Optimizing-SGEMM-on-NVIDIA-Turing-GPUs: Optimizing SGEMM kernel functions on NVIDIA GPUs to a close-to-cuBLAS performance.</a></p><p><a href="https://developer.nvidia.com/blog/cutlass-linear-algebra-cuda/">https://developer.nvidia.com/blog/cutlass-linear-algebra-cuda/</a></p><p><a href="https://wiki.illinois.edu/wiki/display/ECE408/Class+Schedule">Class Schedule - ECE408 - Illinois Wiki</a></p><p><a href="https://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html#toc2">GCC-Inline-Assembly-HOWTO (ibiblio.org)</a></p><p><a href="https://missing-semester-cn.github.io/">è®¡ç®—æœºæ•™è‚²ä¸­ç¼ºå¤±çš„ä¸€è¯¾ Â· the missing semester of your cs education (missing-semester-cn.github.io)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blas</tag>
      
      <tag>gemm</tag>
      
      <tag>gemv</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C/C++æšä¸¾ç±»å‹ enum</title>
    <link href="/2023/04/30/enum/"/>
    <url>/2023/04/30/enum/</url>
    
    <content type="html"><![CDATA[<h2 id="C-x2F-C-æšä¸¾ç±»å‹-enum"><a href="#C-x2F-C-æšä¸¾ç±»å‹-enum" class="headerlink" title="C&#x2F;C++æšä¸¾ç±»å‹ enum"></a>C&#x2F;C++æšä¸¾ç±»å‹ enum</h2><p><strong>æšä¸¾ç±»å‹çš„å®šä¹‰ï¼š</strong>æšä¸¾ç±»å‹(enumeration)æ˜¯ C++ ä¸­çš„ä¸€ç§æ´¾ç”Ÿæ•°æ®ç±»å‹ï¼Œå®ƒæ˜¯ç”±ç”¨æˆ·å®šä¹‰çš„è‹¥å¹²æšä¸¾å¸¸é‡çš„é›†åˆã€‚</p><p>å®šä¹‰æ ¼å¼ï¼šæšä¸¾ç±»å‹çš„å®šä¹‰æ ¼å¼ä¸ºï¼š</p><figure class="highlight bnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bnf">enum <span class="hljs-attribute">&lt;ç±»å‹å&gt;</span> &#123;<span class="hljs-attribute">&lt;æšä¸¾å¸¸é‡è¡¨&gt;</span>&#125;;<br></code></pre></div></td></tr></table></figure><p><strong>æ ¼å¼è¯´æ˜ï¼š</strong></p><ul><li>å…³é”®å­—enumâ€”â€”æŒ‡æ˜å…¶åçš„æ ‡è¯†ç¬¦æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹çš„åå­—ã€‚</li><li>æšä¸¾å¸¸é‡è¡¨â€”â€”ç”±æšä¸¾å¸¸é‡æ„æˆã€‚â€æšä¸¾å¸¸é‡â€æˆ–ç§°â€æšä¸¾æˆå‘˜â€ï¼Œæ˜¯ä»¥æ ‡è¯†ç¬¦å½¢å¼è¡¨ç¤ºçš„æ•´å‹é‡ï¼Œè¡¨ç¤ºæšä¸¾ç±»å‹çš„å–å€¼ã€‚æšä¸¾å¸¸é‡è¡¨åˆ—å‡ºæšä¸¾ç±»å‹çš„æ‰€æœ‰å–å€¼ï¼Œå„æšä¸¾å¸¸é‡ä¹‹é—´ä»¥â€ï¼Œâ€é—´éš”ï¼Œä¸”å¿…é¡»å„ä¸ç›¸åŒã€‚å–å€¼ç±»å‹ä¸æ¡ä»¶è¡¨è¾¾å¼ç›¸åŒã€‚</li></ul><p><strong>åº”ç”¨ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">color_set1</span> &#123;</span>RED, BLUE, WHITE, BLACK&#125;; <span class="hljs-comment">// å®šä¹‰æšä¸¾ç±»å‹color_set1</span><br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">week</span> &#123;</span>Sun, Mon, Tue, Wed, Thu, Fri, Sat&#125;; <span class="hljs-comment">// å®šä¹‰æšä¸¾ç±»å‹week</span><br></code></pre></div></td></tr></table></figure><p><strong>é‡è¦æç¤ºï¼š</strong></p><p>æšä¸¾å¸¸é‡ä»£è¡¨è¯¥æšä¸¾ç±»å‹çš„å˜é‡å¯èƒ½å–çš„å€¼ï¼Œç¼–è¯‘ç³»ç»Ÿä¸ºæ¯ä¸ªæšä¸¾å¸¸é‡æŒ‡å®šä¸€ä¸ªæ•´æ•°å€¼ï¼Œé»˜è®¤çŠ¶æ€ä¸‹ï¼Œè¿™ä¸ªæ•´æ•°å°±æ˜¯æ‰€åˆ—ä¸¾å…ƒç´ çš„åºå·ï¼Œåºå·ä»0å¼€å§‹ã€‚ å¯ä»¥åœ¨å®šä¹‰æšä¸¾ç±»å‹æ—¶ä¸ºéƒ¨åˆ†æˆ–å…¨éƒ¨æšä¸¾å¸¸é‡æŒ‡å®šæ•´æ•°å€¼ï¼Œåœ¨æŒ‡å®šå€¼ä¹‹å‰çš„æšä¸¾å¸¸é‡ä»æŒ‰é»˜è®¤æ–¹å¼å–å€¼ï¼Œè€ŒæŒ‡å®šå€¼ä¹‹åçš„æšä¸¾å¸¸é‡æŒ‰ä¾æ¬¡åŠ 1çš„åŸåˆ™å–å€¼ã€‚ å„æšä¸¾å¸¸é‡çš„å€¼å¯ä»¥é‡å¤ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">fruit_set</span> &#123;</span>apple, orange, banana=<span class="hljs-number">1</span>, peach, grape&#125;<br><span class="hljs-comment">//æšä¸¾å¸¸é‡apple=0,orange=1, banana=1,peach=2,grape=3ã€‚</span><br><span class="hljs-keyword">enum</span> week &#123;Sun=<span class="hljs-number">7</span>, Mon=<span class="hljs-number">1</span>, Tue, Wed, Thu, Fri, Sat&#125;;<br><span class="hljs-comment">//æšä¸¾å¸¸é‡Sun,Mon,Tue,Wed,Thu,Fri,Satçš„å€¼åˆ†åˆ«ä¸º7ã€1ã€2ã€3ã€4ã€5ã€6ã€‚</span><br></code></pre></div></td></tr></table></figure><p>æšä¸¾å¸¸é‡åªèƒ½ä»¥æ ‡è¯†ç¬¦å½¢å¼è¡¨ç¤ºï¼Œè€Œä¸èƒ½æ˜¯æ•´å‹ã€å­—ç¬¦å‹ç­‰æ–‡å­—å¸¸é‡ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å®šä¹‰éæ³•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">letter_set</span> &#123;</span><span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>&#125;; <span class="hljs-comment">//æšä¸¾å¸¸é‡ä¸èƒ½æ˜¯å­—ç¬¦å¸¸é‡</span><br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">year_set</span>&#123;</span><span class="hljs-number">2000</span>,<span class="hljs-number">2001</span>,<span class="hljs-number">2002</span>,<span class="hljs-number">2003</span>,<span class="hljs-number">2004</span>,<span class="hljs-number">2005</span>&#125;; <span class="hljs-comment">//æšä¸¾å¸¸é‡ä¸èƒ½æ˜¯æ•´å‹å¸¸é‡</span><br></code></pre></div></td></tr></table></figure><p>å¯æ”¹ä¸ºä»¥ä¸‹å½¢å¼åˆ™å®šä¹‰åˆæ³•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">letter_set</span> &#123;</span>a, d, F, s, T&#125;;<br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">year_set</span>&#123;</span>y2000, y2001, y2002, y2003, y2004, y2005&#125;;<br></code></pre></div></td></tr></table></figure><hr><h2 id="æšä¸¾å˜é‡çš„ä½¿ç”¨"><a href="#æšä¸¾å˜é‡çš„ä½¿ç”¨" class="headerlink" title="æšä¸¾å˜é‡çš„ä½¿ç”¨"></a>æšä¸¾å˜é‡çš„ä½¿ç”¨</h2><p>å®šä¹‰æšä¸¾ç±»å‹çš„ä¸»è¦ç›®çš„æ˜¯ï¼šå¢åŠ ç¨‹åºçš„å¯è¯»æ€§ã€‚æšä¸¾ç±»å‹æœ€å¸¸è§ä¹Ÿæœ€æœ‰æ„ä¹‰çš„ç”¨å¤„ä¹‹ä¸€å°±æ˜¯ç”¨æ¥æè¿°çŠ¶æ€é‡ï¼Œè¿™ç‚¹å°†åœ¨ç¬¬9ç«  è¾“å…¥è¾“å‡ºæµç±»çœ‹åˆ°ã€‚</p><p>å®šä¹‰æ ¼å¼ï¼šå®šä¹‰æšä¸¾ç±»å‹ä¹‹åï¼Œå°±å¯ä»¥å®šä¹‰è¯¥æšä¸¾ç±»å‹çš„å˜é‡ï¼Œå¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">color_set1 color1, color2;<br></code></pre></div></td></tr></table></figure><p>äº¦å¯ç±»å‹ä¸å˜é‡åŒæ—¶å®šä¹‰ï¼ˆç”šè‡³ç±»å‹åå¯çœï¼‰ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span> &#123;</span>Sun,Mon,Tue,Wed,Thu,Fri,Sat&#125; weekday1, weekday2;<br></code></pre></div></td></tr></table></figure><h3 id="ç›¸å…³æ“ä½œ"><a href="#ç›¸å…³æ“ä½œ" class="headerlink" title="ç›¸å…³æ“ä½œ"></a>ç›¸å…³æ“ä½œ</h3><p>æšä¸¾å˜é‡çš„å€¼åªèƒ½å–æšä¸¾å¸¸é‡è¡¨ä¸­æ‰€åˆ—çš„å€¼ï¼Œå°±æ˜¯æ•´å‹æ•°çš„ä¸€ä¸ªå­é›†ã€‚</p><p>æšä¸¾å˜é‡å ç”¨å†…å­˜çš„å¤§å°ä¸æ•´å‹æ•°ç›¸åŒã€‚</p><p>æšä¸¾å˜é‡åªèƒ½å‚ä¸èµ‹å€¼å’Œå…³ç³»è¿ç®—ä»¥åŠè¾“å‡ºæ“ä½œï¼Œå‚ä¸è¿ç®—æ—¶ç”¨å…¶æœ¬èº«çš„æ•´æ•°å€¼ã€‚ä¾‹å¦‚ï¼Œè®¾æœ‰å®šä¹‰ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">color_set1</span> &#123;</span>RED, BLUE, WHITE, BLACK&#125; color1, color2;<br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">color_set2</span> &#123;</span> GREEN, RED, YELLOW, WHITE&#125; color3, color4;<br></code></pre></div></td></tr></table></figure><p>åˆ™å…è®¸çš„èµ‹å€¼æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">color3=RED;           <span class="hljs-comment">//å°†æšä¸¾å¸¸é‡å€¼èµ‹ç»™æšä¸¾å˜é‡</span><br>color4=color3;        <span class="hljs-comment">//ç›¸åŒç±»å‹çš„æšä¸¾å˜é‡èµ‹å€¼ï¼Œcolor4çš„å€¼ä¸ºRED</span><br><span class="hljs-keyword">int</span>  i=color3;        <span class="hljs-comment">//å°†æšä¸¾å˜é‡èµ‹ç»™æ•´å‹å˜é‡ï¼Œiçš„å€¼ä¸º1</span><br><span class="hljs-keyword">int</span>  j=GREEN;         <span class="hljs-comment">//å°†æšä¸¾å¸¸é‡èµ‹ç»™æ•´å‹å˜é‡ï¼Œjçš„å€¼ä¸º0</span><br></code></pre></div></td></tr></table></figure><p>å…è®¸çš„å…³ç³»è¿ç®—æœ‰ï¼š&#x3D;&#x3D;ã€&lt;ã€&gt;ã€&lt;&#x3D;ã€&gt;&#x3D;ã€!&#x3D;ç­‰ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//æ¯”è¾ƒåŒç±»å‹æšä¸¾å˜é‡color3ï¼Œcolor4æ˜¯å¦ç›¸ç­‰</span><br><span class="hljs-keyword">if</span> (color3==color4) cout&lt;&lt;<span class="hljs-string">&quot;ç›¸ç­‰&quot;</span>ï¼›<br><span class="hljs-comment">//è¾“å‡ºçš„æ˜¯å˜é‡color3ä¸WHITEçš„æ¯”è¾ƒç»“æœï¼Œç»“æœä¸º1</span><br>cout&lt;&lt; color3&lt;WHITE;<br></code></pre></div></td></tr></table></figure><p>æšä¸¾å˜é‡å¯ä»¥ç›´æ¥è¾“å‡ºï¼Œè¾“å‡ºçš„æ˜¯å˜é‡çš„æ•´æ•°å€¼ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">cout</span>&lt;&lt; color<span class="hljs-number">3</span>;         //è¾“å‡ºçš„æ˜¯color<span class="hljs-number">3</span>çš„æ•´æ•°å€¼ï¼Œå³REDçš„æ•´æ•°å€¼<span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><h3 id="é‡è¦æç¤º"><a href="#é‡è¦æç¤º" class="headerlink" title="é‡è¦æç¤º"></a>é‡è¦æç¤º</h3><ul><li>æšä¸¾å˜é‡å¯ä»¥ç›´æ¥è¾“å‡ºï¼Œä½†ä¸èƒ½ç›´æ¥è¾“å…¥ã€‚å¦‚ï¼šcout &gt;&gt; color3;  &#x2F;&#x2F;éæ³•</li><li>ä¸èƒ½ç›´æ¥å°†å¸¸é‡èµ‹ç»™æšä¸¾å˜é‡ã€‚å¦‚ï¼š color1&#x3D;1; &#x2F;&#x2F;éæ³•</li><li>ä¸åŒç±»å‹çš„æšä¸¾å˜é‡ä¹‹é—´ä¸èƒ½ç›¸äº’èµ‹å€¼ã€‚å¦‚ï¼š color1&#x3D;color3; &#x2F;&#x2F;éæ³•</li><li>æšä¸¾å˜é‡çš„è¾“å…¥è¾“å‡ºä¸€èˆ¬éƒ½é‡‡ç”¨switchè¯­å¥å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦æˆ–å­—ç¬¦ä¸²ï¼›æšä¸¾ç±»å‹æ•°æ®çš„å…¶ä»–å¤„ç†ä¹Ÿå¾€å¾€åº”ç”¨switchè¯­å¥ï¼Œä»¥ä¿è¯ç¨‹åºçš„åˆæ³•æ€§å’Œå¯è¯»æ€§ã€‚</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.runoob.com/w3cnote/cpp-enum-intro.html">C++ æšä¸¾ç±»å‹è¯¦è§£ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C/C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C/C++ volatileå…³é”®å­—</title>
    <link href="/2023/04/30/violate/"/>
    <url>/2023/04/30/violate/</url>
    
    <content type="html"><![CDATA[<h2 id="C-x2F-C-volatileå…³é”®å­—"><a href="#C-x2F-C-volatileå…³é”®å­—" class="headerlink" title="C&#x2F;C++ volatileå…³é”®å­—"></a>C&#x2F;C++ volatileå…³é”®å­—</h2><p><strong>volatileåé¢çš„å˜é‡ï¼Œæ˜¯å¸¸å˜é‡ï¼Œä¼šç›´æ¥è®¿é—®åœ°å€ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå…³é”®å­—ï¼Œå°±å¯èƒ½ä¼šæš‚æ—¶ä½¿ç”¨å¯„å­˜å™¨çš„å€¼ï¼Œè€Œä¸æ˜¯è¯»å–åœ°å€ã€‚</strong></p><p>C&#x2F;C++ ä¸­çš„ volatile å…³é”®å­—å’Œ const å¯¹åº”ï¼Œç”¨æ¥ä¿®é¥°å˜é‡ã€‚volatile å…³é”®å­—æ˜¯ä¸€ç§ç±»å‹ä¿®é¥°ç¬¦ï¼Œç”¨å®ƒå£°æ˜çš„ç±»å‹å˜é‡è¡¨ç¤ºå¯ä»¥è¢«æŸäº›ç¼–è¯‘å™¨æœªçŸ¥çš„å› ç´ æ›´æ”¹ï¼Œæ¯”å¦‚ï¼šæ“ä½œç³»ç»Ÿã€ç¡¬ä»¶æˆ–è€…å…¶å®ƒçº¿ç¨‹ç­‰ã€‚é‡åˆ°è¿™ä¸ªå…³é”®å­—å£°æ˜çš„å˜é‡ï¼Œç¼–è¯‘å™¨å¯¹è®¿é—®è¯¥å˜é‡çš„ä»£ç å°±ä¸å†è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œå¯ä»¥æä¾›å¯¹ç‰¹æ®Šåœ°å€çš„ç¨³å®šè®¿é—®ã€‚å£°æ˜æ—¶è¯­æ³•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> i=<span class="hljs-number">10</span>;<br></code></pre></div></td></tr></table></figure><p>å½“è¦æ±‚ä½¿ç”¨ volatile å£°æ˜çš„å˜é‡çš„å€¼çš„æ—¶å€™ï¼Œç³»ç»Ÿæ€»æ˜¯é‡æ–°ä»å®ƒæ‰€åœ¨çš„å†…å­˜è¯»å–æ•°æ®ï¼Œå³ä½¿å®ƒå‰é¢çš„æŒ‡ä»¤åˆšåˆšä»è¯¥å¤„è¯»å–è¿‡æ•°æ®ã€‚è€Œä¸”è¯»å–çš„æ•°æ®ç«‹åˆ»è¢«ä¿å­˜ã€‚</p><p>volatile æŒ‡å‡º i æ˜¯éšæ—¶å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ï¼Œæ¯æ¬¡ä½¿ç”¨å®ƒçš„æ—¶å€™å¿…é¡»ä» içš„åœ°å€ä¸­è¯»å–ï¼Œå› è€Œç¼–è¯‘å™¨ç”Ÿæˆçš„æ±‡ç¼–ä»£ç ä¼šé‡æ–°ä»içš„åœ°å€è¯»å–æ•°æ®æ”¾åœ¨ b ä¸­ã€‚è€Œä¼˜åŒ–åšæ³•æ˜¯ï¼Œç”±äºç¼–è¯‘å™¨å‘ç°ä¸¤æ¬¡ä» iè¯»æ•°æ®çš„ä»£ç ä¹‹é—´çš„ä»£ç æ²¡æœ‰å¯¹ i è¿›è¡Œè¿‡æ“ä½œï¼Œå®ƒä¼šè‡ªåŠ¨æŠŠä¸Šæ¬¡è¯»çš„æ•°æ®æ”¾åœ¨ b ä¸­ã€‚è€Œä¸æ˜¯é‡æ–°ä» i é‡Œé¢è¯»ã€‚è¿™æ ·ä»¥æ¥ï¼Œå¦‚æœ iæ˜¯ä¸€ä¸ªå¯„å­˜å™¨å˜é‡æˆ–è€…è¡¨ç¤ºä¸€ä¸ªç«¯å£æ•°æ®å°±å®¹æ˜“å‡ºé”™ï¼Œæ‰€ä»¥è¯´ volatile å¯ä»¥ä¿è¯å¯¹ç‰¹æ®Šåœ°å€çš„ç¨³å®šè®¿é—®ã€‚</p><p><strong>volatileå…³é”®å­—çš„å®ç°ï¼šå¦‚åœ¨å¹¶è¡Œç¯å¢ƒä¸‹ï¼Œè¿›è¡ŒåŒæ­¥æ“ä½œï¼Œç”¨volatileä¿®é¥°å›ç­”å­—åœ°å€ï¼Œå³å¯å®ç°å¹¶è¡Œç¯å¢ƒä¸‹çš„åŒæ­¥ã€‚è¿™ç§æ–¹æ³•ä¸€èˆ¬ä½¿ç”¨åœ¨éé˜»å¡é€šä¿¡ä¸­ã€‚</strong></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/ijn842/article/details/81273232">æµ…è°ˆCè¯­è¨€çš„volatileå…³é”®å­—_ç¼ç¼çš„åšå®¢çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/GreatTang/article/details/90454011">C++ volatile_c++ violate_æ¥æ—¥æ¢¦å¤šé•¿çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/jerry_wuhao/article/details/113247800">C&#x2F;C++ ä¸­ volatile å…³é”®å­—_c++ violateå…³é”®å­—_ç‹ä¿Šæ´ã€ï¿½çš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C/C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦é—¨</title>
    <link href="/2023/04/05/life001/"/>
    <url>/2023/04/05/life001/</url>
    
    <content type="html"><![CDATA[<h1 id="å¦é—¨-å¾…æ›´æ–°å®Œæˆ"><a href="#å¦é—¨-å¾…æ›´æ–°å®Œæˆ" class="headerlink" title="å¦é—¨[å¾…æ›´æ–°å®Œæˆ]"></a>å¦é—¨[å¾…æ›´æ–°å®Œæˆ]</h1><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>è®°å¾—å¤§ä¸‰çš„æ—¶å€™å°±ä¸€ç›´æƒ³å»æµ·è¾¹ï¼Œå› ä¸ºå°æ ¡+ç–«æƒ…ä¹Ÿæ²¡æ€ä¹ˆå»æˆã€‚è€ƒå®Œåï¼Œè‡ªå·±ä¹Ÿæ˜¯ä¸€ç›´æƒ³å‡ºå»èµ°èµ°ï¼Œæ˜¥èŠ‚çœ‹äº†å¾ˆå¤šçš„æ—…æ¸¸åœ°æ–¹ï¼ŒæŒ‘äº†å¥½ä¹…(åˆ¶å®šæ—…æ¸¸è®¡åˆ’)åç»ˆäºå†³å®šå‡ºå‘äº†ï¼Œç»“æœå¤©æ°”é¢„æŠ¥ä¸‹ä¸€å‘¨çš„é›¨ï¼Œåªæœ‰è¢«è¿«å–æ¶ˆäº†ã€‚åé¢å°±æ˜¯å­¦æ ¡æ¯•ä¸šè®¾è®¡å¼€é¢˜ç­”è¾©å’Œæ˜¥æ‹›å¿™äº†ä¸€æ®µæ—¶é—´ï¼Œæœ€åè§£å†³åä¹Ÿæ˜¯é¡ºåˆ©å‡ºå‘ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼</p><h2 id="ç¬¬ä¸€å¤©ï¼š"><a href="#ç¬¬ä¸€å¤©ï¼š" class="headerlink" title="ç¬¬ä¸€å¤©ï¼š"></a>ç¬¬ä¸€å¤©ï¼š</h2><p>å¤§æ—©ä¸Šæ”¶æ‹¾è¡Œæï¼Œå‡ºé—¨åƒäº†å°å­¦å°±å–œæ¬¢åƒçš„ç±³ç²‰(å‘³é“çœŸçš„å¥½)ï¼Œéšåå°±åä¸Šäº†æ‘†æ¸¡è½¦å»æ–°éƒ½çš„åæ¡‚è·¯åœ°é“ç«™ï¼Œå¤©åºœæœºåœºçœŸçš„å¥½è¿œï¼Œåœ°é“åšäº†2ä¸ªå¤šå°æ—¶ï¼Œäººéƒ½éº»äº†(é€”ä¸­å› ä¸ºæ‹…å¿ƒèµ¶ä¸ä¸Šé£æœºè¿˜å¿å¿‘äº†ä¸€ä¼š)ã€‚è¿˜æœ‰åˆ°äº†æœºåœºæˆ‘å·¦é—®è¥¿é—®å¿«é€Ÿè§£å†³(å¤©åºœæœºåœºä¹Ÿå¥½å¤§ï¼Œä½†æ˜¯æ„Ÿè§‰é…å¥—è¿˜ä¸æ˜¯å¾ˆå®Œå–„)ã€‚</p><img src="/2023/04/05/life001/image-20230405203721650.png" height="500px"><img src="/2023/04/05/life001/image-20230405210557733.png" height="500px"><p>å¦é—¨é™è½çš„æ—¶å€™å°±æ„Ÿè§‰æ˜¯åœ¨å±…æ°‘æ¥¼ä¸Šé¢é£ï¼Œçœ‹ç½‘ä¸Šå¾ˆå¤šäººéƒ½åœ¨è¿™è¾¹ï¼ˆæ®¿å‰æ‘ï¼‰æ‹é£æœºå“ˆå“ˆå“ˆï¼é£æœºé¤æ²¡åƒé¥±ï¼Œä»¥ä¸‹é£æœºå°±å›é…’åº—ï¼Œç„¶åå‡ºå‘ä¸­åè¡—äº†ã€‚</p><p>ä¸‹é¢å°±æ˜¯ä¸­åè¡—ä¹°çš„åƒçš„ï¼Œé™¤äº†æµ·é²œ(ä¸»è¦æˆ‘ä¸å–œæ¬¢åƒæµ·é²œå“ˆå“ˆå“ˆ)ï¼Œå…¶ä»–éƒ½è¿˜å¯ä»¥ï¼</p><p>é¸¡è›‹æ±‰å ¡æ’é˜Ÿå·¨å¤šäººï¼Œç„¶åè¿™ä¸ªå¥¶èŒ¶å°±æ˜¯æ‰“å¡ç±»å¥¶èŒ¶(ä¸å¥½å–)</p><img src="/2023/04/05/life001/image-20230405211537092.png" height="500px"><img src="/2023/04/05/life001/image-20230405211633710.png" height="500px"><p>æ²™èŒ¶é‡Œè„Šè‚‰ï¼Œåªèƒ½è¯´æœ‰ç‚¹ç‰¹è‰²ï¼Œä»¥å‰æ²¡åƒè¿‡è¿™ç§å£å‘³çš„ã€‚è¿™ä¸ªå’–å•¡ç¾å¼æœ‰ç‚¹ç„¦å‘³æ„Ÿè§‰å’ŒKFCå·®ä¸å¤šã€‚è¿˜å’Œå–å’–å•¡çš„å°å§å§èŠäº†èŠå“ˆå“ˆå“ˆå¥¹ä¹Ÿæ˜¯å››å·çš„ï¼Œä¸€å¬æˆ‘å£éŸ³å°±æš´éœ²äº†ã€‚ã€‚ã€‚ã€‚</p><img src="/2023/04/05/life001/image-20230405211654127.png" height="500px"><img src="/2023/04/05/life001/image-20230405211803539.png" height="500px">]]></content>
    
    
    <categories>
      
      <category>Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Travel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CMU 15-213 Lecture 01:Course Overview</title>
    <link href="/2023/03/13/CMU15-213001/"/>
    <url>/2023/03/13/CMU15-213001/</url>
    
    <content type="html"><![CDATA[<h2 id="2015-CMU-15-213-CSAPP-æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ-Lecture-01-Course-Overview"><a href="#2015-CMU-15-213-CSAPP-æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ-Lecture-01-Course-Overview" class="headerlink" title="2015 CMU 15-213 CSAPP æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ Lecture 01: Course Overview"></a>2015 CMU 15-213 CSAPP æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ Lecture 01: Course Overview</h2><h3 id="ä¾‹å­ä¸€ï¼š"><a href="#ä¾‹å­ä¸€ï¼š" class="headerlink" title="ä¾‹å­ä¸€ï¼š"></a>ä¾‹å­ä¸€ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-keyword">int</span> a[<span class="hljs-number">2</span>];<br>    <span class="hljs-keyword">double</span> d;<br>&#125;<span class="hljs-keyword">struct_t</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">fun</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>    <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">struct_t</span> s;   <span class="hljs-comment">//volatileå…³é”®å­—</span><br>    s.d = <span class="hljs-number">3.14</span>;<br>    s.a[i] = <span class="hljs-number">1073741824</span>;   <span class="hljs-comment">/*Possibly out of bounds*/</span><br>    <span class="hljs-keyword">return</span> s.d;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">fun(0)   -&gt;   3.14<br>fun(1)   -&gt;   3.14<br>fun(2)   -&gt;   3.1399998664856<br>fun(3)   -&gt;   2.00000061035156<br>fun(4)   -&gt;   3.14<br>fun(6)   -&gt;   Segmentation falut<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/CMU15-213001/image-20230313201550219.png" alt="image-20230313201550219"></p><p>ã€å›¾ä¸­å‡è®¾memory lineå¤§å°ä¸º4Bã€‘æ ¹æ®ç»“æ„ä½“å¯çŸ¥æˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ªintå‹çš„æ•°ç»„å¤§å°ä¸º2ï¼Œä¸€ä¸ªdoubleå‹çš„å˜é‡ã€‚å› ä¸ºintæ•°ç»„çš„å¤§å°ä¸º2ï¼Œå½“fun(0),fun(1)æ—¶ï¼Œs.a[i]è®¿é—®æ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥fun(0),fun(1)è¿”å›æ­£ç¡®å€¼s.dåŠ3.14ã€‚è€Œå½“fun(i):i&gt;1æ—¶ï¼Œå°±ä¼šè¿”å›å¥‡æ€ªçš„ç»“æœï¼Œè¿™æ˜¯å› ä¸ºæ•°ç»„å¤§å°ä¸º2ï¼Œæˆ‘ä»¬è¶Šç•Œäº†ï¼Œå®é™…ä¸Šs.a[i]å†™çš„æ˜¯doubleçš„å†…å­˜ç©ºé—´ï¼Œå¦‚å›¾ä¸­çš„2ï¼Œ3ã€‚è€Œ6ä»£è¡¨ç¨‹åºçŠ¶æ€ï¼Œæˆ‘ä»¬å»ä¿®æ”¹å®ƒå°±ä¼šé€ æˆç¨‹åºçŠ¶æ€çš„æ”¹å˜ï¼Œå¯¼è‡´Segmentation faultã€‚è¿™é‡Œæé†’æˆ‘ä»¬åœ¨å†™Cä»£ç çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„è¾¹ç•Œå¤„ç†ã€‚ã€è¿™é‡Œéœ€è¦æ¸…æ¥šCè¯­è¨€ä¸­å †åŒºå’Œæ ˆåŒºå­˜çš„æ˜¯ä»€ä¹ˆã€‘</p><h3 id="ä¾‹å­äºŒï¼š"><a href="#ä¾‹å­äºŒï¼š" class="headerlink" title="ä¾‹å­äºŒï¼š"></a>ä¾‹å­äºŒï¼š</h3><p><img src="/2023/03/13/CMU15-213001/image-20230313202535864.png" alt="image-20230313202535864"></p><p>ã€srcå’Œdstæ˜¯å¤§å°2048*2048çš„äºŒç»´æ•°ç»„ã€‘ä¸Šé¢çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥ååˆ†æ¸…æ¥šä»£ç çš„é€»è¾‘ã€‚ä»–æƒ³æŠŠsrcæ•°ç»„çš„å€¼æ‹·è´åˆ°dstã€‚è€Œå·¦å³ä»£ç çš„åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œä»…ä»…æ˜¯forå¾ªç¯é¡ºåºä¸ä¸€æ ·ï¼Œä½†æ˜¯å´ä¼šæœ‰è¿™ä¹ˆå¤§çš„æ€§èƒ½å·®è·ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿæ€»çš„æ¥è¯´å°±æ˜¯å·¦è¾¹ä»£ç cacheå‘½ä¸­ç‡é«˜ï¼Œå³è¾¹cacheå‘½ä¸­ç‡çš„ã€‚cacheå‘½ä¸­å’Œcache missçš„é€Ÿåº¦å·®è·å¾ˆå¤§ç”šè‡³æ˜¯æ•°é‡çº§åˆ«çš„å·®è·ï¼Œè¿™æ˜¯å¯¼è‡´ä¸¤è€…å·®è·å·¨å¤§çš„åŸå› ã€‚ã€æ³¨æ„è¿™é‡Œè¿˜å¯ä»¥æ›´ç»†è‡´çš„åˆ†æï¼Œä½†æ˜¯ä¼šæœ‰å¾ˆå¤šå…¶ä»–å› ç´ ä¼šå½±å“ã€‘</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f15/www/index.html">15-213: Introduction to Computer Systems (cmu.edu)</a></p>]]></content>
    
    
    <categories>
      
      <category>Computer Organization</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CMU</tag>
      
      <tag>CSAPP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2015 CMU 15-213 CSAPP æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ</title>
    <link href="/2023/03/13/CMU15-213/"/>
    <url>/2023/03/13/CMU15-213/</url>
    
    <content type="html"><![CDATA[<h1 id="2015-CMU-15-213-CSAPP-æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ"><a href="#2015-CMU-15-213-CSAPP-æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ" class="headerlink" title="2015 CMU 15-213 CSAPP æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ"></a>2015 CMU 15-213 CSAPP æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ</h1><p><strong>é¡¹ç›®åœ°å€ï¼š</strong><a href="https://github.com/EugeneLiu/translationCSAPP">EugeneLiu&#x2F;translationCSAPP: ä¸º CSAPP è§†é¢‘è¯¾ç¨‹æä¾›å­—å¹•ï¼Œç¿»è¯‘ PPTï¼ŒLabã€‚ (github.com)</a></p><p><strong>bilibiliç¿»è¯‘ï¼š</strong><a href="https://www.bilibili.com/video/av31289365/">ã€ç²¾æ ¡ä¸­è‹±å­—å¹•ã€‘2015 CMU 15-213 CSAPP æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ è¯¾ç¨‹è§†é¢‘_å“”å“©å“”å“©_bilibili</a></p><h2 id="CSAPP-3e-å®˜æ–¹é“¾æ¥"><a href="#CSAPP-3e-å®˜æ–¹é“¾æ¥" class="headerlink" title="CSAPP:3e å®˜æ–¹é“¾æ¥"></a>CSAPP:3e å®˜æ–¹é“¾æ¥</h2><ul><li><a href="http://csapp.cs.cmu.edu/">è¯¾ç¨‹ä¸»é¡µ</a></li><li><a href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f15/www/schedule.html">è¯¾ä»¶ä¸‹è½½é“¾æ¥</a></li><li><a href="http://csapp.cs.cmu.edu/3e/labs.html">è¯¾ç¨‹ Lab é¡µé¢</a></li><li><a href="https://scs.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx#folderID=%22b96d90ae-9871-4fae-91e2-b1627b43e25e%22&sortColumn=0&sortAscending=true">è¯¾ç¨‹è§†é¢‘åœ°å€</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Computer Organization</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CMU</tag>
      
      <tag>CSAPP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™</title>
    <link href="/2023/03/13/ML003/"/>
    <url>/2023/03/13/ML003/</url>
    
    <content type="html"><![CDATA[<h2 id="çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™"><a href="#çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™"></a>çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™</h2><p><img src="/2023/03/13/ML003/image-20230313145346118.png" alt="image-20230313145346118"></p><h2 id="Goals"><a href="#Goals" class="headerlink" title="Goals"></a>Goals</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œæ‚¨å°†:</p><ul><li>ä½¿ç”¨æ¢¯åº¦ä¸‹é™è‡ªåŠ¨ä¼˜åŒ–wå’Œbçš„è¿‡ç¨‹</li></ul><h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨:</p><ul><li>NumPyï¼Œä¸€ä¸ªç”¨äºç§‘å­¦è®¡ç®—çš„æµè¡Œåº“</li><li>Matplotlibï¼Œç”¨äºç»˜åˆ¶æ•°æ®çš„æµè¡Œåº“</li><li>åœ¨æœ¬åœ°ç›®å½•çš„lab_utils.pyæ–‡ä»¶ä¸­ç»˜åˆ¶ä¾‹ç¨‹</li></ul><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math, copy<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>plt.style.use(<span class="hljs-string">&#x27;./deeplearning.mplstyle&#x27;</span>)<br><span class="hljs-keyword">from</span> lab_utils_uni <span class="hljs-keyword">import</span> plt_house_x, plt_contour_wgrad, plt_divergence, plt_gradients<br></code></pre></div></td></tr></table></figure><h2 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h2><p>è®©æˆ‘ä»¬ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„ä¸¤ä¸ªæ•°æ®ç‚¹â€”â€”1000å¹³æ–¹è‹±å°ºçš„æˆ¿å­ä»¥30ä¸‡ç¾å…ƒçš„ä»·æ ¼å‡ºå”®ï¼Œ2000å¹³æ–¹è‹±å°ºçš„æˆ¿å­ä»¥50ä¸‡ç¾å…ƒçš„ä»·æ ¼å‡ºå”®ã€‚</p><table><thead><tr><th>Size(1000 sqft)</th><th>Price(1000s of dollars)</th></tr></thead><tbody><tr><td>1</td><td>300</td></tr><tr><td>2</td><td>500</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#Load our data set</span><br>x_train = np.array([<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>])<span class="hljs-comment">#features</span><br>y_train = np.array([<span class="hljs-number">300.0</span>,<span class="hljs-number">500.0</span>])<span class="hljs-comment">#target value</span><br></code></pre></div></td></tr></table></figure><h2 id="Compute-Cost"><a href="#Compute-Cost" class="headerlink" title="Compute_Cost"></a>Compute_Cost</h2><p>è¿™æ˜¯ä¸Šä¸€ä¸ªå®éªŒå®¤å¼€å‘çš„ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œè¿˜ä¼šç”¨åˆ°å®ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pyhton">#Function to calculate the cost<br>def compute_cost(x, y, w, b,):<br><br>m = x.shape[0]<br>cost = 0<br><br>for i in range(m):<br>f_wb = w * x[i] + b<br>cost = cost + (f_wb - y[i])**2<br>total_cost = 1 / (2 * m)*cost<br><br>return total_cost<br></code></pre></div></td></tr></table></figure><h2 id="Gradient-descent-summary"><a href="#Gradient-descent-summary" class="headerlink" title="Gradient descent summary"></a>Gradient descent summary</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨è¿™é—¨è¯¾ç¨‹ä¸­ï¼Œä½ å·²ç»å»ºç«‹äº†ä¸€ä¸ªçº¿æ€§æ¨¡å‹æ¥é¢„æµ‹f_w,b(x^i):</p><p><img src="/2023/03/13/ML003/image-20230313150848463.png" alt="image-20230313150848463"></p><p>åœ¨çº¿æ€§å›å½’ä¸­ï¼Œæ‚¨ä½¿ç”¨è¾“å…¥è®­ç»ƒæ•°æ®æ¥æ‹Ÿåˆå‚æ•°ğ‘¤,ğ‘;æ¥æœ€å°åŒ–æˆ‘ä»¬çš„é¢„æµ‹ä¹‹é—´çš„è¯¯å·®æµ‹é‡f_ğ‘¤ï¼Œğ‘(ğ‘¥^(ğ‘–))å’Œå®é™…æ•°æ®ğ‘¦(ğ‘–)ã€‚è¿™ç§æµ‹é‡æˆä¸ºä»£ä»·ï¼ŒJï¼ˆw,bï¼‰ã€‚åœ¨è®­ç»ƒä¸­ï¼Œä½ å¯ä»¥è¡¡é‡æˆ‘ä»¬æ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„æˆæœ¬ğ‘¥(ğ‘–)ï¼Œğ‘¦(ğ‘–)ã€‚</p><p><img src="/2023/03/13/ML003/image-20230313151251919.png" alt="image-20230313151251919"></p><p>åœ¨è¯¾å ‚ä¸Šï¼Œæ¢¯åº¦ä¸‹é™è¢«æè¿°ä¸º:</p><p><img src="/2023/03/13/ML003/image-20230313151329621.png" alt="image-20230313151329621"></p><p>å…¶ä¸­å‚æ•°ğ‘¤,ğ‘åŒæ—¶æ›´æ–°ã€‚</p><p><img src="/2023/03/13/ML003/image-20230313151450500.png" alt="image-20230313151450500"></p><p>è¿™é‡ŒåŒæ—¶æ„å‘³ç€åœ¨æ›´æ–°ä»»ä½•å‚æ•°ä¹‹å‰è®¡ç®—æ‰€æœ‰å‚æ•°çš„åå¯¼æ•°ã€‚</p><h2 id="Implement-Gradient-Descent"><a href="#Implement-Gradient-Descent" class="headerlink" title="Implement Gradient Descent"></a>Implement Gradient Descent</h2><p>ä½ å°†ä¸ºä¸€ä¸ªç‰¹å¾å®ç°æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚ä½ éœ€è¦ä¸‰ä¸ªå‡½æ•°ã€‚</p><ul><li>compute_gradientå®ç°ä¸Šè¿°å¼(4)å’Œ(5)</li><li>ä¸Šé¢çš„compute_costå®ç°æ–¹ç¨‹(2)(ä»£ç æ¥è‡ªä»¥å‰çš„å®éªŒå®¤)</li><li>gradient_descentï¼Œä½¿ç”¨compute_gradientå’Œcompute_cost</li></ul><p>Conventions:</p><p><img src="/2023/03/13/ML003/image-20230313151857315.png" alt="image-20230313151857315"></p><h2 id="compute-gradient"><a href="#compute-gradient" class="headerlink" title="compute_gradient"></a>compute_gradient</h2><p><img src="/2023/03/13/ML003/image-20230313151947363.png" alt="image-20230313151947363"></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_gradient</span>(<span class="hljs-params">x, y, w, b</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Computes the gradient for linear regression</span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">    x (ndarray (m,)): Data, m examples</span><br><span class="hljs-string">    y (ndarray (m,)): target values</span><br><span class="hljs-string">    w,b (scalar): model parameters</span><br><span class="hljs-string">    Returns</span><br><span class="hljs-string">    dj_dw (scalar): The gradient of the cost w.r.t. the parameters w</span><br><span class="hljs-string">    dj_db (scalar): The gradient of the cost w.r.t. the parameter b </span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <br>    <span class="hljs-comment">#Number of training examples</span><br>    m = x.shape[<span class="hljs-number">0</span>]<br>    dj_de = <span class="hljs-number">0</span><br>    dj_db = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        f_wb = w * x[i] + b;<br>        dj_dw_i = (f_wb - y[i]) * x[i]<br>        dj_db_i = f_wb - y[i]<br>        dj_db += dj_db_i<br>        dj_dw += dj_dw_i<br>    dj_dw = dj_dw / m<br>    dj_db = dj_db / m<br>    <br>    <span class="hljs-keyword">return</span> dj_dw, dj_db<br></code></pre></div></td></tr></table></figure><p>è¯¾ç¨‹æè¿°äº†æ¢¯åº¦ä¸‹é™å¦‚ä½•åˆ©ç”¨åœ¨æŸä¸€ç‚¹ä¸Šå¯¹å‚æ•°ä»£ä»·çš„åå¯¼æ•°æ¥æ›´æ–°è¯¥å‚æ•°ã€‚</p><p>è®©æˆ‘ä»¬ä½¿ç”¨compute_gradientå‡½æ•°æ¥æŸ¥æ‰¾å¹¶ç»˜åˆ¶ä»£ä»·å‡½æ•°ç›¸å¯¹äºå…¶ä¸­ä¸€ä¸ªå‚æ•°ğ‘¤0çš„åå¯¼æ•°ã€‚</p><p><img src="/2023/03/13/ML003/image-20230313154012173.png" alt="image-20230313154012173"></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">plt_gradients(x_train,y_train, compute_cost, compute_gradient)<br>plt.show()<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/ML003/image-20230313154210478.png" alt="image-20230313154210478"></p><p><img src="/2023/03/13/ML003/image-20230313154333429.png" alt="image-20230313154333429"></p><h2 id="Gradient-Descent"><a href="#Gradient-Descent" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h2><p>ç°åœ¨å¯ä»¥è®¡ç®—æ¢¯åº¦ï¼Œä¸Šé¢å…¬å¼(3)ä¸­æè¿°çš„æ¢¯åº¦ä¸‹é™å¯ä»¥åœ¨ä¸‹é¢çš„gradient_descentä¸­å®ç°ã€‚æ³¨é‡Šä¸­æè¿°äº†å®ç°çš„ç»†èŠ‚ã€‚ä¸‹é¢ï¼Œæ‚¨å°†åˆ©ç”¨è¿™ä¸ªå‡½æ•°åœ¨è®­ç»ƒæ•°æ®ä¸Šæ‰¾åˆ°wå’Œbçš„æœ€ä½³å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gradient_descent</span>(<span class="hljs-params">x, y, w_in, b_in, alpha, num_iters, cost_function, gradient_function</span>):</span> <br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Performs gradient descent to fit w,b. Updates w,b by taking </span><br><span class="hljs-string">    num_iters gradient steps with learning rate alpha</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">      x (ndarray (m,))  : Data, m examples </span><br><span class="hljs-string">      y (ndarray (m,))  : target values</span><br><span class="hljs-string">      w_in,b_in (scalar): initial values of model parameters  </span><br><span class="hljs-string">      alpha (float):     Learning rate</span><br><span class="hljs-string">      num_iters (int):   number of iterations to run gradient descent</span><br><span class="hljs-string">      cost_function:     function to call to produce cost</span><br><span class="hljs-string">      gradient_function: function to call to produce gradient</span><br><span class="hljs-string">      </span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">      w (scalar): Updated value of parameter after running gradient descent</span><br><span class="hljs-string">      b (scalar): Updated value of parameter after running gradient descent</span><br><span class="hljs-string">      J_history (List): History of cost values</span><br><span class="hljs-string">      p_history (list): History of parameters [w,b] </span><br><span class="hljs-string">      &quot;&quot;&quot;</span><br>    <br>    w = copy.deepcopy(w_in) <span class="hljs-comment"># avoid modifying global w_in</span><br>    <span class="hljs-comment"># An array to store cost J and w&#x27;s at each iteration primarily for graphing later</span><br>    J_history = []<br>    p_history = []<br>    b = b_in<br>    w = w_in<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_iters):<br>        <span class="hljs-comment"># Calculate the gradient and update the parameters using gradient_function</span><br>        dj_dw, dj_db = gradient_function(x, y, w , b)     <br><br>        <span class="hljs-comment"># Update Parameters using equation (3) above</span><br>        b = b - alpha * dj_db                            <br>        w = w - alpha * dj_dw                            <br><br>        <span class="hljs-comment"># Save cost J at each iteration</span><br>        <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">100000</span>:      <span class="hljs-comment"># prevent resource exhaustion </span><br>            J_history.append( cost_function(x, y, w , b))<br>            p_history.append([w,b])<br>        <span class="hljs-comment"># Print cost every at intervals 10 times or as many iterations if &lt; 10</span><br>        <span class="hljs-keyword">if</span> i% math.ceil(num_iters/<span class="hljs-number">10</span>) == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Iteration <span class="hljs-subst">&#123;i:<span class="hljs-number">4</span>&#125;</span>: Cost <span class="hljs-subst">&#123;J_history[-<span class="hljs-number">1</span>]:<span class="hljs-number">0.2</span>e&#125;</span> &quot;</span>,<br>                  <span class="hljs-string">f&quot;dj_dw: <span class="hljs-subst">&#123;dj_dw: <span class="hljs-number">0.3</span>e&#125;</span>, dj_db: <span class="hljs-subst">&#123;dj_db: <span class="hljs-number">0.3</span>e&#125;</span>  &quot;</span>,<br>                  <span class="hljs-string">f&quot;w: <span class="hljs-subst">&#123;w: <span class="hljs-number">0.3</span>e&#125;</span>, b:<span class="hljs-subst">&#123;b: <span class="hljs-number">0.5</span>e&#125;</span>&quot;</span>)<br> <br>    <span class="hljs-keyword">return</span> w, b, J_history, p_history <span class="hljs-comment">#return w and J,w history for graphing</span><br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">Iteration    <span class="hljs-number">0</span>: Cost <span class="hljs-number">7.93e+04</span>  dj_dw: -<span class="hljs-number">6.500e+02</span>, dj_db: -<span class="hljs-number">4.000e+02</span>   w:  <span class="hljs-number">6.500e+00</span>, b: <span class="hljs-number">4.00000e+00</span><br>Iteration <span class="hljs-number">1000</span>: Cost <span class="hljs-number">3.41e+00</span>  dj_dw: -<span class="hljs-number">3.712e-01</span>, dj_db:  <span class="hljs-number">6.007e-01</span>   w:  <span class="hljs-number">1.949e+02</span>, b: <span class="hljs-number">1.08228e+02</span><br>Iteration <span class="hljs-number">2000</span>: Cost <span class="hljs-number">7.93e-01</span>  dj_dw: -<span class="hljs-number">1.789e-01</span>, dj_db:  <span class="hljs-number">2.895e-01</span>   w:  <span class="hljs-number">1.975e+02</span>, b: <span class="hljs-number">1.03966e+02</span><br>Iteration <span class="hljs-number">3000</span>: Cost <span class="hljs-number">1.84e-01</span>  dj_dw: -<span class="hljs-number">8.625e-02</span>, dj_db:  <span class="hljs-number">1.396e-01</span>   w:  <span class="hljs-number">1.988e+02</span>, b: <span class="hljs-number">1.01912e+02</span><br>Iteration <span class="hljs-number">4000</span>: Cost <span class="hljs-number">4.28e-02</span>  dj_dw: -<span class="hljs-number">4.158e-02</span>, dj_db:  <span class="hljs-number">6.727e-02</span>   w:  <span class="hljs-number">1.994e+02</span>, b: <span class="hljs-number">1.00922e+02</span><br>Iteration <span class="hljs-number">5000</span>: Cost <span class="hljs-number">9.95e-03</span>  dj_dw: -<span class="hljs-number">2.004e-02</span>, dj_db:  <span class="hljs-number">3.243e-02</span>   w:  <span class="hljs-number">1.997e+02</span>, b: <span class="hljs-number">1.00444e+02</span><br>Iteration <span class="hljs-number">6000</span>: Cost <span class="hljs-number">2.31e-03</span>  dj_dw: -<span class="hljs-number">9.660e-03</span>, dj_db:  <span class="hljs-number">1.563e-02</span>   w:  <span class="hljs-number">1.999e+02</span>, b: <span class="hljs-number">1.00214e+02</span><br>Iteration <span class="hljs-number">7000</span>: Cost <span class="hljs-number">5.37e-04</span>  dj_dw: -<span class="hljs-number">4.657e-03</span>, dj_db:  <span class="hljs-number">7.535e-03</span>   w:  <span class="hljs-number">1.999e+02</span>, b: <span class="hljs-number">1.00103e+02</span><br>Iteration <span class="hljs-number">8000</span>: Cost <span class="hljs-number">1.25e-04</span>  dj_dw: -<span class="hljs-number">2.245e-03</span>, dj_db:  <span class="hljs-number">3.632e-03</span>   w:  <span class="hljs-number">2.000e+02</span>, b: <span class="hljs-number">1.00050e+02</span><br>Iteration <span class="hljs-number">9000</span>: Cost <span class="hljs-number">2.90e-05</span>  dj_dw: -<span class="hljs-number">1.082e-03</span>, dj_db:  <span class="hljs-number">1.751e-03</span>   w:  <span class="hljs-number">2.000e+02</span>, b: <span class="hljs-number">1.00024e+02</span><br>(w,b) found by gradient descent: (<span class="hljs-number">199.9929</span>,<span class="hljs-number">100.0116</span>)<br></code></pre></div></td></tr></table></figure><p>èŠ±ç‚¹æ—¶é—´ï¼Œæ³¨æ„ä¸Šé¢æ‰“å°çš„æ¢¯åº¦ä¸‹é™è¿‡ç¨‹çš„ä¸€äº›ç‰¹å¾ã€‚</p><ul><li>æ­£å¦‚è¯¾å ‚ä¸Šçš„å¹»ç¯ç‰‡æ‰€æè¿°çš„ï¼Œæˆæœ¬å¼€å§‹å¾ˆå¤§ï¼Œç„¶åè¿…é€Ÿä¸‹é™ã€‚</li><li>åå¯¼æ•°dj_dwå’Œdj_dbä¹Ÿå˜å°äº†ï¼Œèµ·åˆå¾ˆå¿«ï¼Œç„¶åå˜æ…¢ã€‚æ­£å¦‚è¯¾å ‚ä¸Šçš„å›¾è¡¨æ‰€ç¤ºï¼Œéšç€è¿‡ç¨‹æ¥è¿‘â€œç¢—åº•â€ï¼Œç”±äºåœ¨è¿™ä¸€ç‚¹ä¸Šçš„å¯¼æ•°å€¼è¾ƒå°ï¼Œè¿›ç¨‹ä¼šå˜æ…¢ã€‚</li><li>å°½ç®¡å­¦ä¹ ç‡alphaä¿æŒä¸å˜ï¼Œä½†è¿›ç¨‹ä¼šå‡æ…¢</li></ul><p><img src="/2023/03/13/ML003/image-20230313155614815.png" alt="image-20230313155614815"></p><h2 id="Cost-versus-iterations-of-gradient-descent"><a href="#Cost-versus-iterations-of-gradient-descent" class="headerlink" title="Cost versus iterations of gradient descent"></a>Cost versus iterations of gradient descent</h2><p>æˆæœ¬ä¸è¿­ä»£çš„å…³ç³»å›¾æ˜¯è¡¡é‡æ¢¯åº¦ä¸‹é™æŠ€æœ¯è¿›å±•çš„æœ‰ç”¨æ–¹æ³•ã€‚åœ¨æˆåŠŸçš„è¿è¡Œä¸­ï¼Œæˆæœ¬æ€»æ˜¯ä¼šé™ä½ã€‚æœ€åˆæˆæœ¬çš„å˜åŒ–å¦‚æ­¤ä¹‹å¿«ï¼Œç”¨ä¸åŒäºæœ€ç»ˆä¸‹é™çš„å°ºåº¦æ¥æç»˜æœ€åˆçš„ä¸Šå‡æ˜¯æœ‰ç”¨çš„ã€‚</p><p>åœ¨ä¸‹é¢çš„å›¾è¡¨ä¸­ï¼Œè¯·æ³¨æ„è½´ä¸Šçš„æˆæœ¬è§„æ¨¡å’Œè¿­ä»£æ­¥éª¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># plot cost versus iteration  </span><br>fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, constrained_layout=<span class="hljs-literal">True</span>, figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">4</span>))<br>ax1.plot(J_hist[:<span class="hljs-number">100</span>])<br>ax2.plot(<span class="hljs-number">1000</span> + np.arange(<span class="hljs-built_in">len</span>(J_hist[<span class="hljs-number">1000</span>:])), J_hist[<span class="hljs-number">1000</span>:])<br>ax1.set_title(<span class="hljs-string">&quot;Cost vs. iteration(start)&quot;</span>);  ax2.set_title(<span class="hljs-string">&quot;Cost vs. iteration (end)&quot;</span>)<br>ax1.set_ylabel(<span class="hljs-string">&#x27;Cost&#x27;</span>)            ;  ax2.set_ylabel(<span class="hljs-string">&#x27;Cost&#x27;</span>) <br>ax1.set_xlabel(<span class="hljs-string">&#x27;iteration step&#x27;</span>)  ;  ax2.set_xlabel(<span class="hljs-string">&#x27;iteration step&#x27;</span>) <br>plt.show()<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/ML003/image-20230313160112122.png" alt="image-20230313160112122"></p><h2 id="Predictions"><a href="#Predictions" class="headerlink" title="Predictions"></a>Predictions</h2><p>ç°åœ¨æ‚¨å·²ç»å‘ç°äº†å‚æ•°ğ‘¤çš„æœ€ä½³å€¼å’Œğ‘ï¼Œæ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨è¯¥æ¨¡å‹æ ¹æ®æˆ‘ä»¬å­¦ä¹ çš„å‚æ•°æ¥é¢„æµ‹æˆ¿å±‹ä»·å€¼ã€‚æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œåœ¨ç›¸åŒçš„ä½æˆ¿æ¡ä»¶ä¸‹ï¼Œé¢„æµ‹å€¼ä¸è®­ç»ƒå€¼å‡ ä¹ç›¸åŒã€‚è¿›ä¸€æ­¥ï¼Œä¸åœ¨é¢„æµ‹ä¸­çš„å€¼ä¸æœŸæœ›å€¼ä¸€è‡´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;1000 sqft house prediction <span class="hljs-subst">&#123;w_final*<span class="hljs-number">1.0</span> + b_final:<span class="hljs-number">0.1</span>f&#125;</span> Thousand dollars&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;1200 sqft house prediction <span class="hljs-subst">&#123;w_final*<span class="hljs-number">1.2</span> + b_final:<span class="hljs-number">0.1</span>f&#125;</span> Thousand dollars&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;2000 sqft house prediction <span class="hljs-subst">&#123;w_final*<span class="hljs-number">2.0</span> + b_final:<span class="hljs-number">0.1</span>f&#125;</span> Thousand dollars&quot;</span>)<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-number">1000</span> sqft house prediction <span class="hljs-number">300.0</span> Thousand dollars<br><span class="hljs-number">1200</span> sqft house prediction <span class="hljs-number">340.0</span> Thousand dollars<br><span class="hljs-number">2000</span> sqft house prediction <span class="hljs-number">500.0</span> Thousand dollars<br></code></pre></div></td></tr></table></figure><h2 id="Plotting"><a href="#Plotting" class="headerlink" title="Plotting"></a>Plotting</h2><p>æ‚¨å¯ä»¥é€šè¿‡åœ¨ä»£ä»·(w,b)çš„ç­‰é«˜çº¿å›¾ä¸Šç»˜åˆ¶è¿­ä»£çš„ä»£ä»·æ¥æ˜¾ç¤ºæ¢¯åº¦ä¸‹é™åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¿›åº¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">fig, ax = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))<br>plt_contour_wgrad(x_train, y_train, p_hist, ax)<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/ML003/image-20230313160446994.png" alt="image-20230313160446994"></p><p>ä¸Šé¢çš„ç­‰é«˜çº¿å›¾æ˜¾ç¤ºäº†ğ‘¤å’Œğ‘èŒƒå›´å†…çš„ğ‘ğ‘œğ‘ ğ‘¡(ğ‘¤ï¼Œğ‘)ã€‚æˆæœ¬æ°´å¹³ç”±åœ†ç¯è¡¨ç¤ºã€‚ç”¨çº¢è‰²ç®­å¤´è¦†ç›–çš„æ˜¯æ¢¯åº¦ä¸‹é™çš„è·¯å¾„ã€‚è¿™é‡Œæœ‰ä¸€äº›éœ€è¦æ³¨æ„çš„äº‹æƒ…:</p><ul><li>è¿™æ¡è·¯å¾„æœç€å®ƒçš„ç›®æ ‡ç¨³æ­¥(å•è°ƒ)å‰è¿›ã€‚</li><li>æœ€åˆçš„æ­¥éª¤æ¯”æ¥è¿‘ç›®æ ‡çš„æ­¥éª¤è¦å¤§å¾—å¤šã€‚</li></ul><p>æ”¾å¤§ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¢¯åº¦ä¸‹é™çš„æœ€åæ­¥éª¤ã€‚æ³¨æ„ï¼Œé˜¶æ¢¯ä¹‹é—´çš„è·ç¦»éšç€æ¢¯åº¦è¶‹è¿‘äºé›¶è€Œç¼©å°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">fig, ax = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">4</span>))<br>plt_contour_wgrad(x_train, y_train, p_hist, ax, w_range=[<span class="hljs-number">180</span>, <span class="hljs-number">220</span>, <span class="hljs-number">0.5</span>], b_range=[<span class="hljs-number">80</span>, <span class="hljs-number">120</span>, <span class="hljs-number">0.5</span>],<br>            contours=[<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">20</span>],resolution=<span class="hljs-number">0.5</span>)<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/ML003/image-20230313160944244.png" alt="image-20230313160944244"></p><h2 id="Increased-Learning-Rate"><a href="#Increased-Learning-Rate" class="headerlink" title="Increased Learning Rate"></a>Increased Learning Rate</h2><p>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œåœ¨å¼(3)ä¸­æœ‰ä¸€ä¸ªå…³äºå­¦ä¹ ç‡çš„åˆé€‚å€¼ğ›¼çš„è®¨è®ºã€‚ğ›¼è¶Šå¤§ï¼Œæ¢¯åº¦ä¸‹é™æ”¶æ•›åˆ°è§£çš„é€Ÿåº¦å°±è¶Šå¿«ã€‚ä½†æ˜¯ï¼Œå¦‚æœå®ƒå¤ªå¤§ï¼Œæ¢¯åº¦ä¸‹é™å°±ä¼šå‘æ•£ã€‚ä¸Šé¢æœ‰ä¸€ä¸ªå¾ˆå¥½æ”¶æ•›çš„è§£çš„ä¾‹å­ã€‚è®©æˆ‘ä»¬è¯•ç€å¢åŠ ğ›¼çš„å€¼çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ:</p><p><img src="/2023/03/13/ML003/image-20230313161516209.png" alt="image-20230313161516209"></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># initialize parameters</span><br>w_init = <span class="hljs-number">0</span><br>b_init = <span class="hljs-number">0</span><br><span class="hljs-comment"># set alpha to a large value</span><br>iterations = <span class="hljs-number">10</span><br>tmp_alpha = <span class="hljs-number">8.0e-1</span><br><span class="hljs-comment"># run gradient descent</span><br>w_final, b_final, J_hist, p_hist = gradient_descent(x_train ,y_train, w_init, b_init, tmp_alpha, <br>                                                    iterations, compute_cost, compute_gradient)<br></code></pre></div></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pyhton">Iteration    0: Cost 2.58e+05  dj_dw: -6.500e+02, dj_db: -4.000e+02   w:  5.200e+02, b: 3.20000e+02<br>Iteration    1: Cost 7.82e+05  dj_dw:  1.130e+03, dj_db:  7.000e+02   w: -3.840e+02, b:-2.40000e+02<br>Iteration    2: Cost 2.37e+06  dj_dw: -1.970e+03, dj_db: -1.216e+03   w:  1.192e+03, b: 7.32800e+02<br>Iteration    3: Cost 7.19e+06  dj_dw:  3.429e+03, dj_db:  2.121e+03   w: -1.551e+03, b:-9.63840e+02<br>Iteration    4: Cost 2.18e+07  dj_dw: -5.974e+03, dj_db: -3.691e+03   w:  3.228e+03, b: 1.98886e+03<br>Iteration    5: Cost 6.62e+07  dj_dw:  1.040e+04, dj_db:  6.431e+03   w: -5.095e+03, b:-3.15579e+03<br>Iteration    6: Cost 2.01e+08  dj_dw: -1.812e+04, dj_db: -1.120e+04   w:  9.402e+03, b: 5.80237e+03<br>Iteration    7: Cost 6.09e+08  dj_dw:  3.156e+04, dj_db:  1.950e+04   w: -1.584e+04, b:-9.80139e+03<br>Iteration    8: Cost 1.85e+09  dj_dw: -5.496e+04, dj_db: -3.397e+04   w:  2.813e+04, b: 1.73730e+04<br>Iteration    9: Cost 5.60e+09  dj_dw:  9.572e+04, dj_db:  5.916e+04   w: -4.845e+04, b:-2.99567e+04<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/ML003/image-20230313161636772.png" alt="image-20230313161636772"></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">plt_divergence(p_hist, J_hist,x_train, y_train)<br>plt.show()<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/13/ML003/image-20230313161959222.png" alt="image-20230313161959222"></p><p>ä¸Šå›¾ä¸­ï¼Œå·¦å›¾æ˜¾ç¤ºäº†ğ‘¤åœ¨æ¢¯åº¦ä¸‹é™çš„å‰å‡ ä¸ªæ­¥éª¤ä¸­çš„è¿›å±•ã€‚ğ‘¤ä»æ­£æŒ¯è¡åˆ°è´Ÿï¼Œæˆæœ¬è¿…é€Ÿå¢é•¿ã€‚æ¢¯åº¦ä¸‹é™åŒæ—¶åœ¨ğ‘¤å’Œğ‘ä¸Šè¿è¡Œï¼Œæ‰€ä»¥éœ€è¦å³è¾¹çš„3då›¾æ‰èƒ½çœ‹åˆ°å®Œæ•´çš„å›¾ç‰‡ã€‚</p><h2 id="Congratulations"><a href="#Congratulations" class="headerlink" title="Congratulations!"></a>Congratulations!</h2><p>åœ¨è¿™ä¸ªå®éªŒå®¤é‡Œï¼Œä½ :</p><ul><li>æ·±å…¥ç ”ç©¶å•ä¸ªå˜é‡çš„æ¢¯åº¦ä¸‹é™çš„ç»†èŠ‚ã€‚</li><li>å¼€å‘äº†ä¸€ä¸ªè®¡ç®—æ¢¯åº¦çš„ç¨‹åº</li><li>çœ‹çœ‹æ¢¯åº¦æ˜¯ä»€ä¹ˆ</li><li>å®Œæˆä¸€ä¸ªæ¢¯åº¦ä¸‹é™ç¨‹åº</li><li>åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•å¯»æ‰¾å‚æ•°</li><li>æ£€æŸ¥äº†å­¦ä¹ ç‡å¤§å°çš„å½±å“</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797">https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797</a></p><p><a href="https://github.com/kaieye/2022-Machine-Learning-Specialization">kaieye&#x2F;2022-Machine-Learning-Specialization (github.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tensorflow</tag>
      
      <tag>Machine Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»£ä»·å‡½æ•°</title>
    <link href="/2023/03/12/ML002/"/>
    <url>/2023/03/12/ML002/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»£ä»·å‡½æ•°"><a href="#ä»£ä»·å‡½æ•°" class="headerlink" title="ä»£ä»·å‡½æ•°"></a>ä»£ä»·å‡½æ•°</h2><p><img src="/2023/03/12/ML002/image-20230312164306128.png" alt="image-20230312164306128"></p><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œä½ å°†:</p><ul><li>ä½ å°†å®ç°å’Œæ¢ç´¢æˆæœ¬å‡½æ•°çš„çº¿æ€§å›å½’ä¼´éšä¸€ä¸ªå˜é‡ã€‚</li></ul><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>åœ¨æœ¬å®éªŒå®¤ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨:</p><ul><li>NumPyï¼Œä¸€ä¸ªç”¨äºç§‘å­¦è®¡ç®—çš„æµè¡Œåº“</li><li>Matplotlibï¼Œç”¨äºç»˜åˆ¶æ•°æ®çš„æµè¡Œåº“</li><li>æœ¬åœ°ç›®å½•çš„lab_utils_uni.pyæ–‡ä»¶ä¸­çš„æœ¬åœ°ç»˜å›¾ä¾‹ç¨‹</li></ul><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> nunpy <span class="hljs-keyword">as</span> np<br>%matplotlib widget<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> lab_utils_uni <span class="hljs-keyword">import</span> plt_intuition, plt_stationary, plt_updata_onclick, soup_bowl<br>plt.style.use(<span class="hljs-string">&#x27;./deeplearning.mplstyle&#x27;</span>)<br></code></pre></div></td></tr></table></figure><h2 id="é—®é¢˜æ„å¢ƒ"><a href="#é—®é¢˜æ„å¢ƒ" class="headerlink" title="é—®é¢˜æ„å¢ƒ"></a>é—®é¢˜æ„å¢ƒ</h2><p>ä½ æƒ³è¦ä¸€ä¸ªæ¨¡å‹ï¼Œå®ƒå¯ä»¥æ ¹æ®æˆ¿å­çš„å¤§å°é¢„æµ‹æˆ¿ä»·ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¸ä¸Šä¸€ä¸ªå®éªŒå®¤ä¹‹å‰ç›¸åŒçš„ä¸¤ä¸ªæ•°æ®ç‚¹â€”â€”ä¸€ä¸ª1000å¹³æ–¹è‹±å°ºçš„æˆ¿å­å–äº†30ä¸‡ç¾å…ƒï¼Œä¸€ä¸ª2000å¹³æ–¹è‹±å°ºçš„æˆ¿å­å–äº†50ä¸‡ç¾å…ƒã€‚</p><table><thead><tr><th>Size(1000 sqft)</th><th>Price(1000s of dollars)</th></tr></thead><tbody><tr><td>1</td><td>300</td></tr><tr><td>2</td><td>500</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">x_train = np.array([<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>])   <span class="hljs-comment">#(size in 1000 square feet)</span><br>y_train = np.zrray([<span class="hljs-number">300.0</span>, <span class="hljs-number">500.0</span>])<span class="hljs-comment">#(price in 1000s of dollars)</span><br></code></pre></div></td></tr></table></figure><h2 id="è®¡ç®—ä»£ä»·"><a href="#è®¡ç®—ä»£ä»·" class="headerlink" title="è®¡ç®—ä»£ä»·"></a>è®¡ç®—ä»£ä»·</h2><p>è¿™ä¸ªä½œä¸šä¸­çš„æœ¯è¯­â€œæˆæœ¬â€å¯èƒ½ä¼šè®©äººæœ‰ç‚¹å›°æƒ‘ï¼Œå› ä¸ºæ•°æ®æ˜¯ä½æˆ¿æˆæœ¬ã€‚åœ¨è¿™é‡Œï¼Œæˆæœ¬æ˜¯è¡¡é‡æˆ‘ä»¬çš„æ¨¡å‹é¢„æµ‹æˆ¿å­ç›®æ ‡ä»·æ ¼çš„å¥½åã€‚â€œä»·æ ¼â€ä¸€è¯æŒ‡çš„æ˜¯ä½æˆ¿æ•°æ®ã€‚</p><p>å«ä¸€ä¸ªå˜é‡çš„æˆæœ¬æ–¹ç¨‹ä¸º:</p><p><img src="/2023/03/12/ML002/image-20230312165434160.png" alt="image-20230312165434160"></p><p>åœ¨è¿™é‡Œ</p><p><img src="/2023/03/12/ML002/image-20230312165503613.png" alt="image-20230312165503613"></p><ul><li>f_w,b(x^i)æ˜¯æˆ‘ä»¬ä½¿ç”¨å‚æ•°w,bæ¥é¢„æµ‹ä¾‹å­iã€‚</li><li>ï¼ˆf_w,b(x^i) - y^iï¼‰^2  æ˜¯ç›®æ ‡å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„å·®çš„å¹³æ–¹</li><li>è¿™äº›å·®å¼‚è¢«åŠ åœ¨æ‰€æœ‰mä¾‹å­ä¸Šï¼Œå†é™¤ä»¥2mï¼Œå¾—åˆ°ä»£ä»·å‡½æ•° <strong>Jï¼ˆw,bï¼‰</strong></li></ul><p>æ³¨æ„ï¼Œåœ¨è®²åº§ä¸­ï¼Œæ€»å’Œçš„èŒƒå›´é€šå¸¸æ˜¯ä»1åˆ°mï¼Œè€Œä»£ç å°†ä»0åˆ°m-1ã€‚</p><p>ä¸‹é¢çš„ä»£ç é€šè¿‡éå†æ¯ä¸ªç¤ºä¾‹æ¥è®¡ç®—æˆæœ¬ã€‚åœ¨æ¯ä¸ªå¾ªç¯ä¸­:</p><ul><li>f_wbï¼Œè®¡ç®—ä¸€ä¸ªé¢„æµ‹</li><li>ç›®æ ‡å’Œé¢„æµ‹ä¹‹é—´çš„å·®å€¼è¢«è®¡ç®—å’Œå¹³æ–¹ã€‚</li><li>è¿™è¢«åŠ åˆ°æ€»æˆæœ¬ä¸­ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_cost</span>(<span class="hljs-params">x, y, w, b</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Computes the cost function for linear regression</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">    x (ndarray (m,)):Data, m examples</span><br><span class="hljs-string">    y (ndarray (m,)):target values</span><br><span class="hljs-string">    w,b (scalar):model parameters</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    Returns</span><br><span class="hljs-string">    total_cost (float):The cost of using w,b as the parameters for linear regression to fit the data points in x and y</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment">#number of training examples</span><br>    m = x.shape[<span class="hljs-number">0</span>]<br>    <br>    cost_sum = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        f_wb = w * x[i] + b<br>        cost = (f_wb - y[i])**<span class="hljs-number">2</span><br>        cost_sum = cost_sum + cost<br>    total_cost = (<span class="hljs-number">1</span>/(<span class="hljs-number">2</span>*m)) * cost_sum<br>    <br>    <span class="hljs-keyword">return</span> total_cost<br></code></pre></div></td></tr></table></figure><h2 id="Cost-Function-Intuition"><a href="#Cost-Function-Intuition" class="headerlink" title="Cost Function Intuition"></a>Cost Function Intuition</h2><p><img src="/2023/03/12/ML002/image-20230312172325465.png" alt="image-20230312172325465"></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">plt_intuition(x_train, y_train)<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/12/ML002/image-20230313144221393.png" alt="image-20230313144221393"></p><p>æƒ…èŠ‚ä¸­æœ‰å‡ ç‚¹å€¼å¾—ä¸€æã€‚</p><ul><li>å½“ğ‘¤&#x3D;200æ—¶ï¼Œæˆæœ¬æœ€å°åŒ–ï¼Œè¿™ä¸ä¹‹å‰å®éªŒå®¤çš„ç»“æœç›¸å»åˆã€‚</li><li>å› ä¸ºåœ¨æˆæœ¬æ–¹ç¨‹ä¸­ï¼Œç›®æ ‡å’Œé¢„æµ‹ä¹‹é—´çš„å·®å¼‚æ˜¯å¹³æ–¹ï¼Œå½“ğ‘¤æ—¶ï¼Œæˆæœ¬è¿…é€Ÿå¢åŠ ä¸æ˜¯å¤ªå¤§å°±æ˜¯å¤ªå°ã€‚</li><li>ä½¿ç”¨é€šè¿‡æœ€å°åŒ–æˆæœ¬é€‰æ‹©çš„wå’Œbï¼Œå¯ä»¥å¾—åˆ°ä¸æ•°æ®å®Œç¾åŒ¹é…çš„ç›´çº¿ã€‚</li></ul><h2 id="Cost-Function-Visualiztion-3D"><a href="#Cost-Function-Visualiztion-3D" class="headerlink" title="Cost Function Visualiztion-3D"></a>Cost Function Visualiztion-3D</h2><p>ä½ å¯ä»¥é€šè¿‡ä¸‰ç»´ç»˜å›¾æˆ–ç­‰é«˜çº¿å›¾çœ‹åˆ°æˆæœ¬æ˜¯å¦‚ä½•éšwå’Œbå˜åŒ–çš„ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é—¨è¯¾çš„ä¸€äº›æƒ…èŠ‚ä¼šå˜å¾—ç›¸å½“å¤æ‚ã€‚æœ¬æ–‡æä¾›äº†ç»˜å›¾ä¾‹ç¨‹ï¼Œè™½ç„¶é€šè¯»ä»£ç ä»¥ç†Ÿæ‚‰è¿™äº›æ–¹æ³•æ˜¯æœ‰æŒ‡å¯¼æ„ä¹‰çš„ï¼Œä½†è¦æˆåŠŸå®Œæˆè¯¾ç¨‹å¹¶ä¸éœ€è¦è¿™æ ·åšã€‚ä¾‹ç¨‹åœ¨æœ¬åœ°ç›®å½•lab_utils_uni.pyä¸­ã€‚</p><h2 id="Larger-Data-Set"><a href="#Larger-Data-Set" class="headerlink" title="Larger Data Set"></a>Larger Data Set</h2><p>è¾ƒå¤§çš„æ•°æ®é›†ç”¨æ›´å¤šçš„æ•°æ®ç‚¹æ¥è§‚å¯Ÿä¸€ä¸ªåœºæ™¯æ˜¯å¾ˆæœ‰æŒ‡å¯¼æ„ä¹‰çš„ã€‚è¯¥æ•°æ®é›†åŒ…æ‹¬ä¸åœ¨åŒä¸€çº¿ä¸Šçš„æ•°æ®ç‚¹ã€‚è¿™å¯¹æˆæœ¬æ–¹ç¨‹æ„å‘³ç€ä»€ä¹ˆ?æˆ‘ä»¬èƒ½æ‰¾åˆ°ğ‘¤ã€ğ‘é‚£æ ·ä½¿å¾—ä»£ä»·æ˜¯0?</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">x_train = np.array([<span class="hljs-number">1.0</span>,<span class="hljs-number">1.7</span>,<span class="hljs-number">2.0</span>,<span class="hljs-number">2.5</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">3.2</span>])<br>y_train = np.array([<span class="hljs-number">250</span>,<span class="hljs-number">300</span>,<span class="hljs-number">480</span>,<span class="hljs-number">430</span>,<span class="hljs-number">630</span>,<span class="hljs-number">730</span>])<br></code></pre></div></td></tr></table></figure><p>åœ¨ç­‰é«˜çº¿å›¾ä¸­ï¼Œç‚¹å‡»ä¸€ä¸ªç‚¹ï¼Œé€‰æ‹©wå’Œbï¼Œä»¥è¾¾åˆ°æœ€ä½çš„æˆæœ¬ã€‚ä½¿ç”¨è½®å»“æ¥æŒ‡å¯¼ä½ çš„é€‰æ‹©ã€‚æ³¨æ„ï¼Œæ›´æ–°å›¾å½¢å¯èƒ½éœ€è¦å‡ ç§’é’Ÿçš„æ—¶é—´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">plt.close(<span class="hljs-string">&#x27;all&#x27;</span>)<br>fig, ax ,dyn_items = plt_stationary(x_train, y_train)<br>updater = plt_update_onclick(fig, ax, x_train,y_train,dyn_items)<br></code></pre></div></td></tr></table></figure><p>ä¸Šé¢ï¼Œæ³¨æ„å·¦è¾¹å›¾ä¸­çš„è™šçº¿ã€‚è¿™äº›ä»£è¡¨äº†ä½ çš„è®­ç»ƒé›†ä¸­æ¯ä¸ªä¾‹å­æ‰€è´¡çŒ®çš„ä»£ä»·çš„éƒ¨åˆ†ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå€¼çº¦ä¸ºğ‘¤&#x3D;209å’Œğ‘&#x3D; 2.4æä¾›ä½ä»£ä»·ã€‚è¯·æ³¨æ„ï¼Œå› ä¸ºæˆ‘ä»¬çš„è®­ç»ƒç¤ºä¾‹ä¸åœ¨ä¸€æ¡çº¿ä¸Šï¼Œæ‰€ä»¥æœ€å°ä»£ä»·ä¸ä¸ºé›¶ã€‚</p><h2 id="Convex-Cost-surface"><a href="#Convex-Cost-surface" class="headerlink" title="Convex Cost surface"></a>Convex Cost surface</h2><p>æˆæœ¬å‡½æ•°å¹³æ–¹æŸå¤±çš„äº‹å®ç¡®ä¿äº†â€œè¯¯å·®æ›²é¢â€åƒæ±¤ç¢—ä¸€æ ·å‡¸å‡ºã€‚å®ƒæ€»æ˜¯æœ‰ä¸€ä¸ªæœ€å°å€¼ï¼Œå¯ä»¥é€šè¿‡åœ¨æ‰€æœ‰ç»´åº¦ä¸Šè·Ÿéšæ¢¯åº¦æ¥è¾¾åˆ°ã€‚åœ¨å‰é¢çš„å›¾ä¸­ï¼Œå› ä¸ºğ‘¤å’Œğ‘å°ºå¯¸æ¯”ä¾‹ä¸åŒï¼Œè¿™æ˜¯ä¸å®¹æ˜“è¯†åˆ«çš„ã€‚ä¸‹å›¾ï¼Œå…¶ä¸­ğ‘¤å’Œğ‘éƒ½æ˜¯å¯¹ç§°çš„ï¼Œåœ¨è®²åº§ä¸­å±•ç¤ºè¿‡:</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">soup_bowl()<br></code></pre></div></td></tr></table></figure><h2 id="Congratulations"><a href="#Congratulations" class="headerlink" title="Congratulations!"></a>Congratulations!</h2><p>æ‚¨å·²ç»å­¦ä¹ äº†ä»¥ä¸‹å†…å®¹:</p><ul><li>æˆæœ¬æ–¹ç¨‹æä¾›äº†ä¸€ç§è¡¡é‡é¢„æµ‹ä¸è®­ç»ƒæ•°æ®åŒ¹é…ç¨‹åº¦çš„æ–¹æ³•ã€‚</li><li>æœ€å°åŒ–æˆæœ¬å¯ä»¥æä¾›ğ‘¤å’Œbçš„æœ€ä¼˜å€¼ã€‚</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797">https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797</a></p><p><a href="https://github.com/kaieye/2022-Machine-Learning-Specialization">kaieye&#x2F;2022-Machine-Learning-Specialization (github.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tensorflow</tag>
      
      <tag>Machine Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•ä½¿ç”¨AVXå’ŒAVX2å¤„ç†æ•°æ®(ä¸ªäººç¿»è¯‘)</title>
    <link href="/2023/03/10/avx006/"/>
    <url>/2023/03/10/avx006/</url>
    
    <content type="html"><![CDATA[<h2 id="1-æ–‡ç« æ¥æº"><a href="#1-æ–‡ç« æ¥æº" class="headerlink" title="1.æ–‡ç« æ¥æº"></a>1.æ–‡ç« æ¥æº</h2><p><strong>Matt Scarpinoï¼ˆUSAï¼‰</strong></p><p><a href="https://www.codeproject.com/Articles/874396/Crunching-Numbers-with-AVX-and-AVX">Crunching Numbers with AVX and AVX2 - CodeProject</a></p><h2 id="2-ä»‹ç»"><a href="#2-ä»‹ç»" class="headerlink" title="2.ä»‹ç»"></a>2.ä»‹ç»</h2><p>åœ¨2003å¹´ï¼Œ<a href="https://www.codeproject.com/script/Membership/View.aspx?mid=22834">Alex Fr</a>å†™äº†ä¸€ç¯‡ä¼˜ç§€çš„<a href="https://www.codeproject.com/Articles/4522/Introduction-to-SSE-Programming">æ–‡ç« </a>[è¯¥æ–‡ç« ç°åœ¨å·²ç»è¢«åŸä½œè€…åˆ é™¤]ï¼Œè§£é‡Šäº†å¦‚ä½•ä½¿ç”¨Intelçš„æµå¼SIMDæ‰©å±•(SSE)æ‰§è¡ŒSIMD(å•æŒ‡ä»¤ï¼Œå¤šæ•°æ®)å¤„ç†ã€‚SSEæ˜¯è‹±ç‰¹å°”å¤„ç†å™¨æ”¯æŒçš„ä¸€ç»„æŒ‡ä»¤ï¼Œå¯å¯¹å¤§é‡æ•°æ®æ‰§è¡Œé«˜é€Ÿè¿ç®—ã€‚</p><p>2008å¹´ï¼Œè‹±ç‰¹å°”æ¨å‡ºäº†ä¸€å¥—æ–°çš„é«˜æ€§èƒ½æŒ‡ä»¤ï¼Œç§°ä¸ºé«˜çº§å‘é‡æ‰©å±•(AVX)ã€‚AVXæ‰§è¡Œè®¸å¤šä¸SSEæŒ‡ä»¤ç›¸åŒçš„æ“ä½œï¼Œä½†ä»¥æ›´å¿«çš„é€Ÿåº¦å¯¹æ›´å¤§çš„æ•°æ®å—è¿›è¡Œæ“ä½œã€‚æœ€è¿‘ï¼Œè‹±ç‰¹å°”åœ¨AVX2å’ŒAVX512ç³»åˆ—ä¸­å‘å¸ƒäº†é¢å¤–çš„æŒ‡ä»¤ã€‚æœ¬æ–‡çš„é‡ç‚¹æ˜¯é€šè¿‡ç§°ä¸ºintrinsic funtionsçš„ç‰¹æ®ŠCå‡½æ•°è®¿é—®AVXå’ŒAVX2æŒ‡ä»¤ã€‚</p><p>æœ¬æ–‡ä¸ä»‹ç»æ•´ä¸ªAVX&#x2F;AVX2 intrinsicsï¼Œè€Œæ˜¯ä¾§é‡äºæ•°å­¦è®¡ç®—ã€‚ç‰¹åˆ«åœ°ï¼Œç›®æ ‡æ˜¯å¤æ•°ç›¸ä¹˜ã€‚è¦ä½¿ç”¨AVX&#x2F;AVX2æ‰§è¡Œæ­¤æ“ä½œï¼Œéœ€è¦ä¸‰ç§ç±»å‹çš„intrinsic:</p><ol><li>Initialization intrinscis</li><li>Arithmetic intrinsics</li><li>Permute&#x2F;shuffle intrinsics</li></ol><p></p><p>æœ¬æ–‡è®¨è®ºæ¯ä¸ªç±»åˆ«ä¸­çš„intrinsicsï¼Œå¹¶è§£é‡Šå¦‚ä½•åœ¨ä»£ç ä¸­ä½¿ç”¨å®ƒä»¬ã€‚æœ¬æ–‡çš„æœ€åå°†å±•ç¤ºå¦‚ä½•ç”¨è¿™äº›intrinsicè¿›è¡Œä¹˜æ³•å¤æ•°è¿ç®—ã€‚</p><p>ç†è§£å¤„ç†å™¨æŒ‡ä»¤å’Œintrinsic functionä¹‹é—´çš„åŒºåˆ«æ˜¯å¾ˆé‡è¦çš„ã€‚AVXæŒ‡ä»¤æ˜¯æ‰§è¡Œä¸å¯åˆ†å‰²æ“ä½œçš„æ±‡ç¼–å‘½ä»¤ã€‚ä¾‹å¦‚ï¼ŒAVXæŒ‡ä»¤vaddpsæ·»åŠ äº†ä¸¤ä¸ªæ“ä½œæ•°ï¼Œå¹¶å°†ç»“æœæ”¾åœ¨ç¬¬ä¸‰ä¸ªæ“ä½œæ•°ä¸­ã€‚</p><p>è¦åœ¨C&#x2F;C++ä¸­æ‰§è¡Œæ“ä½œï¼Œthe intrinsic funtion _mm256_add_ps()ç›´æ¥æ˜ å°„åˆ°vaddpsï¼Œå°†æ±‡ç¼–çš„æ€§èƒ½ä¸é«˜çº§å‡½æ•°çš„ä¾¿åˆ©æ€§ç»“åˆèµ·æ¥ã€‚An intrinsic funtionä¸ä¸€å®šæ˜ å°„åˆ°å•ä¸ªæŒ‡ä»¤ï¼Œä½†ä¸å…¶ä»–C&#x2F; C++å‡½æ•°ç›¸æ¯”ï¼ŒAVX&#x2F;AVX2 intrinsicsæä¾›äº†å¯é çš„é«˜æ€§èƒ½ã€‚</p><h2 id="3-åŸºæœ¬è¦æ±‚"><a href="#3-åŸºæœ¬è¦æ±‚" class="headerlink" title="3.åŸºæœ¬è¦æ±‚"></a>3.åŸºæœ¬è¦æ±‚</h2><p>è¦ç†è§£æœ¬æ–‡çš„å†…å®¹ï¼Œæ‚¨éœ€è¦åŸºæœ¬ç†Ÿæ‚‰Cè¯­è¨€å’ŒSIMDå¤„ç†ã€‚è¦æ‰§è¡Œä»£ç ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªæ”¯æŒAVXæˆ–AVX&#x2F;AVX2çš„CPUã€‚ä»¥ä¸‹æ˜¯æ”¯æŒAVXçš„cpu:</p><ul><li>Intelâ€™s Sandy Bridge&#x2F;Sandy Bridge E&#x2F;Ivy Bridge&#x2F;Ivy Bridge E</li><li>Intelâ€™s Haswell&#x2F;Haswell E&#x2F;Broadwell&#x2F;Broadwell E</li><li>AMDâ€™s Bulldozer&#x2F;Piledriver&#x2F;Steamroller&#x2F;Excavator</li></ul><p>æ”¯æŒAVX2çš„CPUä¹Ÿæ”¯æŒAVXã€‚ä»¥ä¸‹æ˜¯è¿™äº›è®¾å¤‡:</p><ul><li>Intelâ€™s Haswell&#x2F;Haswell E&#x2F;Broadwell&#x2F;Broadwell E</li><li>AMDâ€™s Excavator</li></ul><p>æœ¬æ–‡ä¸­è®¨è®ºçš„å¤§å¤šæ•°å‡½æ•°éƒ½æ˜¯ç”±AVXæä¾›çš„ã€‚ä½†ä¹Ÿæœ‰ä¸€äº›æ˜¯AVX2ç‰¹æœ‰çš„ã€‚ä¸ºäº†åŒºåˆ†å®ƒä»¬ï¼Œåœ¨æœ¬æ–‡çš„è¡¨ä¸­ï¼Œæˆ‘åœ¨AVX2 intrinsicçš„åç§°å‰é¢åŠ ä¸Š(2)ã€‚</p><p>[ä¸ªäººè¡¥å……]</p><p>åˆ¤æ–­è‡ªå·±ç”µè„‘CPUæ˜¯å¦æ”¯æŒAVXå’ŒAVX2ï¼Œæœ€ç®€å•çš„å°±æ˜¯åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">lscpu<br></code></pre></div></td></tr></table></figure><p>ä½ ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p><p><img src="/2023/03/10/avx006/image-20230129153048825.png" alt="image-20230129153048825"></p><p>åœ¨Flagsé‡Œé¢ä½ å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ä½ çš„ç”µè„‘æ˜¯å¦æ”¯æŒAVXä»¥åŠAVX2ã€‚</p><h2 id="4-å‘é‡åŒ–æ¦‚è¿°"><a href="#4-å‘é‡åŒ–æ¦‚è¿°" class="headerlink" title="4.å‘é‡åŒ–æ¦‚è¿°"></a>4.å‘é‡åŒ–æ¦‚è¿°</h2><p>AVXæŒ‡ä»¤é€šè¿‡åŒæ—¶å¤„ç†å¤§å—å€¼è€Œä¸æ˜¯å•ç‹¬å¤„ç†å€¼æ¥æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚è¿™äº›å€¼å¤§å—ç§°ä¸ºå‘é‡ï¼ŒAVXå‘é‡æœ€å¤šå¯ä»¥åŒ…å«256ä½æ•°æ®ã€‚</p><p>å¸¸è§çš„AVXå‘é‡åŒ…å«4ä¸ªdouble (4 x 64ä½&#x3D; 256)ï¼Œ8ä¸ªfloat (8 x 32ä½&#x3D; 256)æˆ–8ä¸ªint (8 x 32ä½&#x3D; 256)ã€‚[double 8B, flout 4B, int 4B]</p><p>ä¸€ä¸ªç¤ºä¾‹å°†æ¼”ç¤ºAVX&#x2F;AVX2å¤„ç†çš„å¼ºå¤§åŠŸèƒ½ã€‚å‡è®¾ä¸€ä¸ªå‡½æ•°éœ€è¦å°†ä¸€ä¸ªæ•°ç»„çš„8ä¸ªæµ®ç‚¹æ•°ä¹˜ä»¥ç¬¬äºŒä¸ªæ•°ç»„çš„8ä¸ªæµ®ç‚¹æ•°ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ°ç¬¬ä¸‰ä¸ªæ•°ç»„ã€‚å¦‚æœæ²¡æœ‰å‘é‡åŒ–ï¼Œå‡½æ•°å¯èƒ½æ˜¯è¿™æ ·çš„:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">multiply_and_add</span>(<span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span>* a, <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span>* b, <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span>* c, <span class="hljs-keyword">float</span>* d) &#123;  <br><br>  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">8</span>; i++) &#123;<br>    d[i] = a[i] * b[i];<br>    d[i] = d[i] + c[i];<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä½¿ç”¨AVX2å‡½æ•°çš„ä¾‹å­:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">__m256 <span class="hljs-title">multiply_and_add</span><span class="hljs-params">(__m256 a, __m256 b, __m256 c)</span> </span>&#123;<br><br>  <span class="hljs-keyword">return</span> _mm256_fmadd_ps(a, b, c);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>This AVX2 intrinsic funtion <strong>_mm256_fmadd_ps</strong>å¤„ç†24ä¸ªfloatsï¼Œä½†å®ƒä¸æ˜ å°„åˆ°å•ä¸ªæŒ‡ä»¤ã€‚ç›¸åï¼Œå®ƒæ‰§è¡Œä¸‰ä¸ªæŒ‡ä»¤:<strong>vfmadd132ps</strong>ã€<strong>vfmadd213ps</strong>å’Œ<strong>vfmadd231ps</strong>ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒæ‰§è¡Œå¾—å¾ˆå¿«ï¼Œæ¯”éå†å•ä¸ªå…ƒç´ å¿«å¾—å¤šã€‚</p><p>å°½ç®¡è‹±ç‰¹å°”çš„intrinsicsåŠŸèƒ½å¼ºå¤§ï¼Œä½†å®ƒä»¬è¿˜æ˜¯è®©è®¸å¤šç¨‹åºå‘˜æ„Ÿåˆ°ç´§å¼ ã€‚è¿™é€šå¸¸æœ‰ä¸¤ä¸ªåŸå› ã€‚é¦–å…ˆï¼Œæ•°æ®ç±»å‹æœ‰å¥‡æ€ªçš„åå­—ï¼Œæ¯”å¦‚**__m256<strong>ã€‚å…¶æ¬¡ï¼Œå‡½æ•°æœ‰å¥‡æ€ªçš„åç§°ï¼Œå¦‚</strong>_mm256_fmadd_ps**ã€‚å› æ­¤ï¼Œåœ¨è¯¦ç»†è®¨è®ºintrinsic funtionsä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè®¨è®ºä¸€ä¸‹Intelçš„æ•°æ®ç±»å‹å’Œå‘½åçº¦å®šã€‚</p><h2 id="5-AVXç¼–ç¨‹åŸºç¡€"><a href="#5-AVXç¼–ç¨‹åŸºç¡€" class="headerlink" title="5.AVXç¼–ç¨‹åŸºç¡€"></a>5.AVXç¼–ç¨‹åŸºç¡€</h2><p>æœ¬æ–‡ä¸»è¦å…³æ³¨AVXå’ŒAVX2æä¾›çš„ä¸æ•°å­¦ç›¸å…³çš„intrinsic functionsã€‚ä½†åœ¨çœ‹å‡½æ•°ä¹‹å‰ï¼Œæœ‰ä¸‰ç‚¹å¾ˆé‡è¦:</p><ul><li>Data types</li><li>Function naming conventions</li><li>Compiling AVX applications</li></ul><p>æœ¬èŠ‚æ¶‰åŠè¿™äº›è¦ç‚¹ï¼Œå¹¶æä¾›ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œç”¨äºä¸€ä¸ªå‘é‡å‡å»å¦ä¸€ä¸ªå‘é‡ã€‚</p><h3 id="5-1æ•°æ®ç±»å‹"><a href="#5-1æ•°æ®ç±»å‹" class="headerlink" title="5.1æ•°æ®ç±»å‹"></a>5.1æ•°æ®ç±»å‹</h3><p>å°‘æ•°intrinsicæ¥å—ä¼ ç»Ÿçš„æ•°æ®ç±»å‹ï¼Œå¦‚<strong>int</strong>æˆ–<strong>float</strong>ï¼Œä½†å¤§å¤šæ•°intrinsicæ“ä½œæœ‰ç‰¹å®šçš„AVXå’ŒAVX2çš„æ•°æ®ç±»å‹ã€‚æœ‰å…­ç§ä¸»è¦çš„å‘é‡ç±»å‹ï¼Œè¡¨1åˆ—å‡ºäº†å®ƒä»¬ã€‚</p><p><strong>Table 1:AVX&#x2F;AVX2 Data Types</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>__m128</code></td><td>128-bit vector containing 4 <code>float</code>s</td></tr><tr><td><code>__m128d</code></td><td>128-bit vector containing 2 <code>double</code>s</td></tr><tr><td><code>__m128i</code></td><td>128-bit vector containing integers</td></tr><tr><td><code>__m256</code></td><td>256-bit vector containing 8 <code>float</code>s</td></tr><tr><td><code>__m256d</code></td><td>256-bit vector containing 4 <code>double</code>s</td></tr><tr><td><code>__m256i</code></td><td>256-bit vector containing integers</td></tr></tbody></table><p>æ¯ç§ç±»å‹éƒ½ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿ã€ä¸€ä¸ªmå’Œå‘é‡çš„å®½åº¦(ä»¥ä½ä¸ºå•ä½)å¼€å§‹ã€‚AVX512æ”¯æŒä»¥_m512å¼€å¤´çš„512ä½å‘é‡ç±»å‹ï¼Œä½†AVX&#x2F;AVX2å‘é‡ä¸è¶…è¿‡256ä½ã€‚å¦‚æœå‘é‡ç±»å‹ä»¥dç»“å°¾ï¼Œåˆ™ä»£è¡¨doubleï¼Œå¦‚æœæ²¡æœ‰åç¼€ï¼Œåˆ™ä»£è¡¨floatã€‚çœ‹èµ·æ¥_m128iå’Œ_m256iå‘é‡å¿…é¡»åŒ…å«intå‹ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚æ•´æ•°å‘é‡ç±»å‹å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„æ•´æ•°ï¼Œfrom chars to shorts to unsigned long longs.That is, an _m256i may contain 32 chars, 16 shorts, 8 ints, or 4 longs.  These integers can be signed or unsigned.</p><h3 id="5-3å‡½æ•°å‘½åçº¦å®š"><a href="#5-3å‡½æ•°å‘½åçº¦å®š" class="headerlink" title="5.3å‡½æ•°å‘½åçº¦å®š"></a>5.3å‡½æ•°å‘½åçº¦å®š</h3><p>AVX&#x2F;AVX2 intrinsicsçš„åç§°ä¸€å¼€å§‹å¯èƒ½ä»¤äººå›°æƒ‘ï¼Œä½†å‘½åçº¦å®šç¡®æ˜¯éå¸¸ç›´ç™½çš„ã€‚ä¸€æ—¦ä½ ç†è§£äº†å®ƒï¼Œä½ å°±å¯ä»¥é€šè¿‡çœ‹å®ƒçš„åå­—æ¥å¤§è‡´åˆ¤æ–­ä¸€ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆçš„ã€‚AVX&#x2F;AVX2 intrinsicsçš„ä¸€èˆ¬å½¢å¼å¦‚ä¸‹:</p><p>_mm<bit_width>_<name>_<data_type></data_type></name></bit_width></p><p>è¯¥æ ¼å¼çš„å„éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤º:</p><ol><li><code>&lt;bit_width&gt;</code> identifies the size of the vector returned by the function. For 128-bit vectors, this is empty. For 256-bit vectors, this is set to <code>256</code>.</li><li><code>&lt;name&gt;</code> describes the operation performed by the intrinsic</li><li><code>&lt;data_type&gt;</code> identifies the data type of the functionâ€™s primary arguments</li></ol><p>æœ€åä¸€éƒ¨åˆ†<data_type>æœ‰ç‚¹å¤æ‚ã€‚å®ƒæ ‡è¯†è¾“å…¥å€¼çš„å†…å®¹ï¼Œå¯ä»¥è®¾ç½®ä¸ºä»¥ä¸‹ä»»ä½•å€¼:</data_type></p><ul><li><code>ps</code> - vectors contain <code>float</code>s (<code>ps</code> stands for packed single-precision)</li><li><code>pd</code> - vectors contain <code>double</code>s (<code>pd</code> stands for packed double-precision)</li><li><code>epi8/epi16/epi32/epi64</code> - vectors contain 8-bit&#x2F;16-bit&#x2F;32-bit&#x2F;64-bit signed integers</li><li><code>epu8/epu16/epu32/epu64</code> - vectors contain 8-bit&#x2F;16-bit&#x2F;32-bit&#x2F;64-bit unsigned integers</li><li><code>si128</code>&#x2F;<code>si256</code> - unspecified 128-bit vector or 256-bit vector</li><li><code>m128/m128i/m128d/m256/m256i/m256d</code> - identifies input vector types when theyâ€™re different than the type of the returned vector</li></ul><p>ä¾‹å¦‚ï¼Œè€ƒè™‘_mm256_srlv_epi64ã€‚å³ä½¿æ‚¨ä¸çŸ¥é“srlvæ˜¯ä»€ä¹ˆæ„æ€ï¼Œ_mm256å‰ç¼€å‘Šè¯‰æ‚¨è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª256ä½å‘é‡ï¼Œ_epi64å‘Šè¯‰æ‚¨å‚æ•°åŒ…å«64ä½æœ‰ç¬¦å·æ•´æ•°ã€‚</p><p>ä½œä¸ºç¬¬äºŒä¸ªç¤ºä¾‹ï¼Œè€ƒè™‘_mm_testnzc_psã€‚_mmè¡¨ç¤ºå‡½æ•°è¿”å›ä¸€ä¸ª128ä½çš„å‘é‡ã€‚æœ«å°¾çš„_psè¡¨ç¤ºå‚æ•°å‘é‡åŒ…å«æµ®ç‚¹æ•°ã€‚</p><p>AVXæ•°æ®ç±»å‹ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿å’Œä¸€ä¸ªmå¼€å¤´ã€‚å‡½æ•°ä»¥ä¸€ä¸ªä¸‹åˆ’çº¿å’Œä¸¤ä¸ªmå¼€å¤´ã€‚æˆ‘å¾ˆå®¹æ˜“ææ··è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘æƒ³å‡ºäº†ä¸€ç§æ–¹æ³•æ¥è®°ä½å®ƒä»¬çš„åŒºåˆ«:æ•°æ®ç±»å‹ä»£è¡¨å†…å­˜ï¼ˆ<strong>m</strong>emoryï¼‰ï¼Œå‡½æ•°ä»£è¡¨å¤šåª’ä½“æ“ä½œï¼ˆ<strong>m</strong>ulti<strong>m</strong>ediaï¼‰ã€‚è¿™æ˜¯æˆ‘èƒ½åšçš„æœ€å¥½çš„äº†ã€‚</p><h3 id="5-4æ„å»ºAVXåº”ç”¨ç¨‹åº"><a href="#5-4æ„å»ºAVXåº”ç”¨ç¨‹åº" class="headerlink" title="5.4æ„å»ºAVXåº”ç”¨ç¨‹åº"></a>5.4æ„å»ºAVXåº”ç”¨ç¨‹åº</h3><p>è¦æ„å»ºä½¿ç”¨AVX intrinsicçš„åº”ç”¨ç¨‹åºï¼Œä¸éœ€è¦é“¾æ¥ä»»ä½•åº“ã€‚ä½†æ˜¯æ‚¨éœ€è¦åŒ…å«<strong>imminrin .h</strong>å¤´æ–‡ä»¶ã€‚æ­¤å¤´æ–‡ä»¶åŒ…æ‹¬å°†AVX&#x2F;AVX2å‡½æ•°æ˜ å°„åˆ°æŒ‡ä»¤çš„å…¶ä»–å¤´æ–‡ä»¶ã€‚</p><p>hello_avx.cä¸­çš„ä»£ç æ˜¾ç¤ºäº†ä¸€ä¸ªåŸºæœ¬çš„AVXåº”ç”¨ç¨‹åºçš„æ ·å­:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>  <span class="hljs-comment">/* Initialize the two argument vectors */</span><span class="hljs-comment">//åˆå§‹åŒ–</span><br>  __m256 evens = _mm256_set_ps(<span class="hljs-number">2.0</span>, <span class="hljs-number">4.0</span>, <span class="hljs-number">6.0</span>, <span class="hljs-number">8.0</span>, <span class="hljs-number">10.0</span>, <span class="hljs-number">12.0</span>, <span class="hljs-number">14.0</span>, <span class="hljs-number">16.0</span>);<br>  __m256 odds = _mm256_set_ps(<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">7.0</span>, <span class="hljs-number">9.0</span>, <span class="hljs-number">11.0</span>, <span class="hljs-number">13.0</span>, <span class="hljs-number">15.0</span>);<br><br>  <span class="hljs-comment">/* Compute the difference between the two vectors */</span><br>  __m256 result = _mm256_sub_ps(evens, odds);<span class="hljs-comment">//å‡æ³•</span><br><br>  <span class="hljs-comment">/* Display the elements of the result vector */</span><br>  <span class="hljs-keyword">float</span>* f = (<span class="hljs-keyword">float</span>*)&amp;result;<span class="hljs-comment">//ç±»å‹è½¬æ¢</span><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f %f %f %f %f %f %f %f\n&quot;</span>,<br>    f[<span class="hljs-number">0</span>], f[<span class="hljs-number">1</span>], f[<span class="hljs-number">2</span>], f[<span class="hljs-number">3</span>], f[<span class="hljs-number">4</span>], f[<span class="hljs-number">5</span>], f[<span class="hljs-number">6</span>], f[<span class="hljs-number">7</span>]);<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¦æ„å»ºåº”ç”¨ç¨‹åºï¼Œéœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨è¯¥ä½“ç³»ç»“æ„æ”¯æŒAVXã€‚è¿™ä¸ªæ ‡å¿—å–å†³äºç¼–è¯‘å™¨ï¼Œgccéœ€è¦-mavxæ ‡å¿—ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘hello_avx.cæºæ–‡ä»¶:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">gcc -mavx -o hello_avx hello_avx.c<br></code></pre></div></td></tr></table></figure><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæ‰€æœ‰å‡½æ•°éƒ½ä»¥_mm256å¼€å§‹ï¼Œä»¥_psç»“æŸï¼Œå› æ­¤æˆ‘å¸Œæœ›æ‰€æœ‰æ“ä½œéƒ½æ¸…æ¥šåœ°æ¶‰åŠåŒ…å«floatsçš„256ä½å‘é‡ã€‚æˆ‘è¿˜å¸Œæœ›ç»“æœå‘é‡ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ç­‰äº1.0ã€‚å¦‚æœè¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ‚¨å°†çœ‹åˆ°æƒ…å†µå°±æ˜¯è¿™æ ·ã€‚</p><p>[è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„å‘é‡å‡æ³•ä¾‹å­ï¼Œå¤§å®¶å¯ä»¥å¯¹åº”æ•°æ®çœ‹ä¸€ä¸‹]</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000<br></code></pre></div></td></tr></table></figure><h3 id="5-5åˆå§‹åŒ–intrinsics"><a href="#5-5åˆå§‹åŒ–intrinsics" class="headerlink" title="5.5åˆå§‹åŒ–intrinsics"></a>5.5åˆå§‹åŒ–intrinsics</h3><p>åœ¨å¯¹AVXå‘é‡è¿›è¡Œæ“ä½œä¹‹å‰ï¼Œéœ€è¦ç”¨æ•°æ®å¡«å……å‘é‡ã€‚å› æ­¤ï¼Œæœ¬æ–‡è®¨è®ºçš„ç¬¬ä¸€ç»„intrinsicsç”¨æ•°æ®åˆå§‹åŒ–å‘é‡ã€‚æœ‰ä¸¤ç§æ–¹æ³•:ç”¨æ ‡é‡å€¼åˆå§‹åŒ–å‘é‡å’Œç”¨ä»å†…å­˜åŠ è½½çš„æ•°æ®åˆå§‹åŒ–å‘é‡ã€‚</p><h4 id="5-5-1ä½¿ç”¨æ ‡é‡å€¼åˆå§‹åŒ–"><a href="#5-5-1ä½¿ç”¨æ ‡é‡å€¼åˆå§‹åŒ–" class="headerlink" title="5.5.1ä½¿ç”¨æ ‡é‡å€¼åˆå§‹åŒ–"></a>5.5.1ä½¿ç”¨æ ‡é‡å€¼åˆå§‹åŒ–</h4><p>AVXæä¾›äº†å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ç»„åˆæˆ256ä½å‘é‡çš„intrinsics funtionsã€‚è¡¨2åˆ—å‡ºäº†å®ƒä»¬çš„åç§°ï¼Œå¹¶æä¾›äº†æ¯ä¸ªåç§°çš„æè¿°ã€‚ä¹Ÿæœ‰ç±»ä¼¼çš„intrinsicsåˆå§‹åŒ–128ä½å‘é‡ï¼Œä½†å®ƒä»¬æ˜¯ç”±SSEæä¾›çš„ï¼Œè€Œä¸æ˜¯AVXã€‚å‡½æ•°åçš„å”¯ä¸€åŒºåˆ«æ˜¯_mm256_è¢«æ›¿æ¢ä¸º_mm_ã€‚</p><p><strong>Table 2: Initialization Intrinsics</strong></p><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>_mm256_setzero_ps/pd</code></td><td>Returns a floating-point vector filled with zeros</td></tr><tr><td><code>_mm256_setzero_si256</code></td><td>Returns an integer vector whose bytes are set to zero</td></tr><tr><td><code>_mm256_set1_ps/pd</code></td><td>Fill a vector with a floating-point value</td></tr><tr><td><code>_mm256_set1_epi8/epi16</code> <code>_mm256_set1_epi32/epi64</code></td><td>Fill a vector with an integer</td></tr><tr><td><code>_mm256_set_ps/pd</code></td><td>Initialize a vector with eight floats (ps) or four doubles (pd)</td></tr><tr><td><code>_mm256_set_epi8/epi16</code> <code>_mm256_set_epi32/epi64</code></td><td>Initialize a vector with integers</td></tr><tr><td><code>_mm256_set_m128/m128d/</code> <code>_mm256_set_m128i</code></td><td>Initialize a 256-bit vector with two 128-bit vectors</td></tr><tr><td><code>_mm256_setr_ps/pd</code></td><td>Initialize a vector with eight floats (ps) or four doubles (pd) in reverse order</td></tr><tr><td><code>_mm256_setr_epi8/epi16</code> <code>_mm256_setr_epi32/epi64</code></td><td>Initialize a vector with integers in reverse order</td></tr></tbody></table><p>è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚_m256_setzero_psè¿”å›ä¸€ä¸ª__m256å‘é‡ï¼ŒåŒ…å«8ä¸ªè®¾ç½®ä¸º0çš„æµ®ç‚¹æ•°ã€‚ç±»ä¼¼åœ°ï¼Œ_m256_setzero_si256è¿”å›ä¸€ä¸ª__m256iå‘é‡ï¼Œå…¶å­—èŠ‚è¢«è®¾ç½®ä¸º0ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ª256ä½çš„å‘é‡ï¼Œå…¶ä¸­åŒ…å«4ä¸ªè®¾ä¸º0çš„double:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">_m256d dbl_vector = _m256_setzero_pd();<br></code></pre></div></td></tr></table></figure><p>åç§°ä¸­åŒ…å«set1çš„å‡½æ•°æ¥å—ä¸€ä¸ªå€¼ï¼Œå¹¶åœ¨æ•´ä¸ªå‘é‡ä¸­é‡å¤è¯¥å€¼ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ª__m256iï¼Œå®ƒçš„16ä¸ªshort valueè¢«è®¾ç½®ä¸º47:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">_m256i short_vector = _m256_set1_pd();<br></code></pre></div></td></tr></table></figure><p>è¡¨2ä¸­çš„å…¶ä»–å‡½æ•°åŒ…å«_set_æˆ–_setr_ã€‚è¿™äº›å‡½æ•°æ¥å—ä¸€ç³»åˆ—å€¼ï¼Œæ¯ä¸ªå‘é‡çš„å…ƒç´ å¯¹åº”ä¸€ä¸ªå€¼ã€‚è¿™äº›å€¼è¢«æ”¾ç½®åœ¨è¿”å›çš„å‘é‡ä¸­ï¼Œç†è§£é¡ºåºå¾ˆé‡è¦ã€‚ä¸‹é¢çš„å‡½æ•°è°ƒç”¨è¿”å›ä¸€ä¸ªåŒ…å«8ä¸ªæ•´æ•°çš„å‘é‡ï¼Œå…¶å€¼èŒƒå›´ä¸º1åˆ°8:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">_m256i int_vector = _m256_set_epi32(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>);<br></code></pre></div></td></tr></table></figure><p>æ‚¨å¯èƒ½å¸Œæœ›å€¼æŒ‰ç…§ç»™å®šçš„é¡ºåºå­˜å‚¨ã€‚ä½†è‹±ç‰¹å°”çš„æ¶æ„æ˜¯<strong>å°ç«¯</strong>å­˜å‚¨ç±»å‹çš„[è¿™é‡Œå¾ˆé‡è¦]ï¼Œæ‰€ä»¥æœ€ä½æœ‰æ•ˆå€¼(8)å…ˆå­˜å‚¨ï¼Œæœ€é«˜æœ‰æ•ˆå€¼(1)æœ€åå­˜å‚¨ã€‚æ‚¨å¯ä»¥é€šè¿‡å°†int_vectorè½¬æ¢ä¸ºintæŒ‡é’ˆå¹¶æ‰“å°å­˜å‚¨çš„å€¼æ¥éªŒè¯è¿™ä¸€ç‚¹ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤º:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256i int_vector = _mm256_set_epi32(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>);<br><span class="hljs-keyword">int</span> *ptr = (<span class="hljs-keyword">int</span>*)&amp;int_vector;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d %d %d %d %d %d %d\n&quot;</span>, ptr[<span class="hljs-number">0</span>], ptr[<span class="hljs-number">1</span>], ptr[<span class="hljs-number">2</span>], ptr[<span class="hljs-number">3</span>], ptr[<span class="hljs-number">4</span>], ptr[<span class="hljs-number">5</span>], ptr[<span class="hljs-number">6</span>], ptr[<span class="hljs-number">7</span>]);<br>--&gt; <span class="hljs-number">8</span> <span class="hljs-number">7</span> <span class="hljs-number">6</span> <span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><p>å¦‚æœå¸Œæœ›å€¼æŒ‰ç»™å®šé¡ºåºå­˜å‚¨ï¼Œå¯ä»¥ä½¿ç”¨_setr_å‡½æ•°ä¹‹ä¸€åˆ›å»ºå‘é‡ï¼Œå…¶ä¸­rå¯èƒ½ä»£è¡¨reverseã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256i int_vector = _mm256_setr_epi32(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>);<br><span class="hljs-keyword">int</span> *ptr = (<span class="hljs-keyword">int</span>*)&amp;int_vector;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d %d %d %d %d %d %d\n&quot;</span>, ptr[<span class="hljs-number">0</span>], ptr[<span class="hljs-number">1</span>], ptr[<span class="hljs-number">2</span>], ptr[<span class="hljs-number">3</span>], ptr[<span class="hljs-number">4</span>], ptr[<span class="hljs-number">5</span>], ptr[<span class="hljs-number">6</span>], ptr[<span class="hljs-number">7</span>]);<br>--&gt; <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span><br></code></pre></div></td></tr></table></figure><p>æœ‰è¶£çš„æ˜¯ï¼ŒAVXå’ŒAVX2éƒ½æ²¡æœ‰æä¾›ç”¨æ— ç¬¦å·æ•´æ•°åˆå§‹åŒ–å‘é‡çš„intrinsicã€‚ä½†æ˜¯ï¼Œå®ƒä»¬æä¾›äº†å¯¹å¸¦æ— ç¬¦å·æ•´æ•°çš„å‘é‡è¿›è¡Œæ“ä½œçš„å‡½æ•°ã€‚</p><h4 id="5-5-2ä»å†…å­˜åŠ è½½æ•°æ®"><a href="#5-5-2ä»å†…å­˜åŠ è½½æ•°æ®" class="headerlink" title="5.5.2ä»å†…å­˜åŠ è½½æ•°æ®"></a>5.5.2ä»å†…å­˜åŠ è½½æ•°æ®</h4><p>AVX&#x2F;AVX2çš„ä¸€ä¸ªå¸¸è§ç”¨æ³•æ˜¯å°†æ•°æ®ä»å†…å­˜åŠ è½½åˆ°å‘é‡ä¸­ï¼Œå¯¹å‘é‡è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†ç»“æœå­˜å‚¨å›å†…å­˜ã€‚ç¬¬ä¸€æ­¥æ˜¯ä½¿ç”¨è¡¨3ä¸­åˆ—å‡ºçš„intrinsic funtionså®Œæˆçš„ã€‚æœ€åä¸¤ä¸ªå‡½æ•°å‰é¢æœ‰(2)ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”±AVX2è€Œä¸æ˜¯AVXæä¾›çš„ã€‚</p><p><strong>Table 3: Vector Load Intrinsics</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_mm256_load_ps/pd</code></td><td>Loads a floating-point vector from an  aligned memory address</td></tr><tr><td><code>_mm256_load_si256</code></td><td>Loads an integer vector from an aligned memory address</td></tr><tr><td><code>_mm256_loadu_ps/pd</code></td><td>Loads a floating-point vector from an  unaligned memory address</td></tr><tr><td><code>_mm256_loadu_si256</code></td><td>Loads an integer vector from an unaligned memory address</td></tr><tr><td><code>_mm_maskload_ps/pd</code> <code>_mm256_maskload_ps/pd</code></td><td>Load portions of a 128-bit&#x2F;256-bit floating-point vector according to a mask</td></tr><tr><td><code>(2)_mm_maskload_epi32/64</code> <code>(2)_mm256_maskload_epi32/64</code></td><td>Load portions of a 128-bit&#x2F;256-bit integer vector according to a mask</td></tr></tbody></table><p>å½“å°†æ•°æ®åŠ è½½åˆ°å‘é‡ä¸­æ—¶ï¼Œå†…å­˜å¯¹é½å˜å¾—ç‰¹åˆ«é‡è¦ã€‚æ¯ä¸ª<strong>_mm256_load_</strong>* intrinsicæ¥å—ä¸€ä¸ªå¿…é¡»åœ¨32å­—èŠ‚è¾¹ç•Œä¸Šå¯¹é½çš„å†…å­˜åœ°å€ã€‚å³åœ°å€å¿…é¡»èƒ½è¢«32æ•´é™¤ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨å®è·µä¸­ä½¿ç”¨å®ƒ:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">float</span>* aligned_floats = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">aligned_alloc</span>(<span class="hljs-number">32</span>, <span class="hljs-number">64</span> * <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>));<span class="hljs-comment">//è¿™é‡Œä½¿ç”¨äº†å†…å­˜å¯¹é½</span><br>... Initialize data ...<br>__m256 vec = _mm256_load_ps(aligned_floats);<br></code></pre></div></td></tr></table></figure><p>ã€ä¸ªäººè¡¥å……ã€‘å…³äºå†…å­˜å¯¹é½ä»¥åŠç›¸å…³å‡½æ•°</p><p><a href="https://xingyuanjie.top/2022/06/12/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/">å†…å­˜å¯¹é½ - Amicoyuan (xingyuanjie.top)</a></p><p><a href="https://xingyuanjie.top/2022/06/12/AVX%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%A6%E4%B9%A0(%E4%BA%8C)-%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E7%9A%84%E5%BA%94%E7%94%A8/">AVXå‘é‡åŒ–å­¦ä¹ (äºŒ)-å†…å­˜å¯¹é½çš„åº”ç”¨ - Amicoyuan (xingyuanjie.top)</a></p><p>ä»»ä½•ä½¿ç”¨_m256_load_*åŠ è½½æœªå¯¹é½æ•°æ®çš„å°è¯•éƒ½ä¼šé€ æˆ<strong>segmentation fault</strong>ã€‚å¦‚æœæ•°æ®ä¸æ˜¯ä»¥32ä½è¾¹ç•Œå¯¹é½ï¼Œåˆ™åº”è¯¥ä½¿ç”¨_m256_loadu_*å‡½æ•°ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤º:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">float</span>* unaligned_floats = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">64</span> * <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>));<span class="hljs-comment">//æœªä½¿ç”¨å†…å­˜å¯¹é½</span><br>... Initialize data ...<br>__m256 vec = _mm256_loadu_ps(unaligned_floats);<br></code></pre></div></td></tr></table></figure><p>å‡è®¾ä½ æƒ³ç”¨AVXå‘é‡å¤„ç†ä¸€ä¸ªæµ®ç‚¹æ•°ç»„(float)ï¼Œä½†æ˜¯æ•°ç»„çš„é•¿åº¦æ˜¯11ï¼Œä¸èƒ½è¢«8æ•´é™¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬äºŒä¸ª__m256å‘é‡çš„æœ€åäº”ä¸ªæµ®ç‚¹æ•°éœ€è¦è®¾ç½®ä¸º0[æˆ–è€…ä½¿ç”¨éå‘é‡è®¡ç®—æ‰‹æ®µ]ï¼Œè¿™æ ·å®ƒä»¬å°±ä¸ä¼šå½±å“è®¡ç®—ã€‚è¿™ç§é€‰æ‹©æ€§åŠ è½½å¯ä»¥ç”¨è¡¨3åº•éƒ¨çš„**_maskload_**å‡½æ•°æ¥å®Œæˆã€‚</p><p>æ¯ä¸ª_maskload_å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°:ä¸€ä¸ªå†…å­˜åœ°å€å’Œä¸€ä¸ªä¸è¿”å›å‘é‡å…ƒç´ æ•°é‡ç›¸åŒçš„æ•´æ•°å‘é‡ã€‚å¯¹äºæ•´æ•°å‘é‡ä¸­æœ€é«˜ä½ä¸º1çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†ä»å†…å­˜ä¸­è¯»å–è¿”å›å‘é‡ä¸­ç›¸åº”çš„å…ƒç´ ã€‚å¦‚æœæ•´æ•°å‘é‡ä¸­çš„æœ€é«˜ä½ä¸ºé›¶ï¼Œåˆ™è¿”å›å‘é‡ä¸­çš„ç›¸åº”å…ƒç´ è¢«è®¾ç½®ä¸ºé›¶ã€‚</p><p>ä¸€ä¸ªç¤ºä¾‹å°†è¯´æ˜å¦‚ä½•ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚mask_load.cä¸­çš„ä»£ç å°†8ä¸ªæ•´å‹è¯»å…¥ä¸€ä¸ªå‘é‡ï¼Œæœ€å3ä¸ªåº”è¯¥è®¾ç½®ä¸º0ã€‚è¦ä½¿ç”¨çš„å‡½æ•°æ˜¯_mm256_maskload_epi32ï¼Œå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°åº”è¯¥æ˜¯__m256iæ©ç å‘é‡ã€‚è¿™ä¸ªæ©ç å‘é‡åŒ…å«5ä¸ªæœ€é«˜ä½ä¸º1çš„æ•´æ•°å’Œ3ä¸ªæœ€é«˜ä½ä¸º0çš„æ•´æ•°ã€‚ä¸‹é¢æ˜¯ä»£ç çš„æ ·å­:</p><p>ã€intå‹åœ¨è®¡ç®—æœºçš„å­˜å‚¨æ˜¯è¡¥ç ï¼Œæ­£æ•°çš„è¡¥ç æœ€é«˜ä½ä¸º0ï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›0ï¼Œè´Ÿæ•°çš„è¡¥ç æœ€é«˜ä½ä¸º1ï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›çš„æ˜¯å†…å­˜ä¸­ç›¸åº”çš„å…ƒç´ ã€‘</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>  <span class="hljs-keyword">int</span> i;<br>  <br>  <span class="hljs-keyword">int</span> int_array[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">400</span>, <span class="hljs-number">500</span>, <span class="hljs-number">600</span>, <span class="hljs-number">700</span>, <span class="hljs-number">800</span>&#125;;<br>  <br>  <span class="hljs-comment">/* Initialize the mask vector */</span><br>  __m256i mask = _mm256_setr_epi32(<span class="hljs-number">-20</span>, <span class="hljs-number">-72</span>, <span class="hljs-number">-48</span>, <span class="hljs-number">-9</span>, <span class="hljs-number">-100</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>);<span class="hljs-comment">//è¿™é‡Œéœ€è¦å……åˆ†ç†è§£è®¡ç®—æœºç»„æˆåŸç†ä¸­çš„è¡¥ç </span><br><br>  <span class="hljs-comment">/* Selectively load data into the vector */</span><br>  __m256i result = _mm256_maskload_epi32(int_array, mask);<br>  <br>  <span class="hljs-comment">/* Display the elements of the result vector */</span><br>  <span class="hljs-keyword">int</span>* res = (<span class="hljs-keyword">int</span>*)&amp;result;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d %d %d %d %d %d %d\n&quot;</span>, <br>    res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>], res[<span class="hljs-number">2</span>], res[<span class="hljs-number">3</span>], res[<span class="hljs-number">4</span>], res[<span class="hljs-number">5</span>], res[<span class="hljs-number">6</span>], res[<span class="hljs-number">7</span>]);<br>  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœæ‚¨åœ¨æ”¯æŒAVX2çš„ç³»ç»Ÿä¸Šè¿è¡Œæ­¤åº”ç”¨ç¨‹åºï¼Œå®ƒå°†æ‰“å°ä»¥ä¸‹ç»“æœ:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">100</span> <span class="hljs-number">200</span> <span class="hljs-number">300</span> <span class="hljs-number">400</span> <span class="hljs-number">500</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p>æœ‰ä¸‰ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼š</p><ol><li>ä»£ç ä½¿ç”¨_setr_å‡½æ•°è€Œä¸æ˜¯_set_æ¥è®¾ç½®æ©ç å‘é‡çš„å†…å®¹ï¼Œå› ä¸ºå®ƒåœ¨å°†å‘é‡å…ƒç´ ä¼ é€’ç»™å‡½æ•°æ—¶å¯¹å®ƒä»¬è¿›è¡Œæ’åºã€‚</li><li>è´Ÿæ•´æ•°çš„æœ€é«˜ä½æ€»æ˜¯1ã€‚è¿™å°±æ˜¯æ©ç å‘é‡åŒ…å«äº”ä¸ªè´Ÿæ•°å’Œä¸‰ä¸ªæ­£æ•°çš„åŸå› ã€‚</li><li>_mm256_maskload_epi32å‡½æ•°ç”±AVX2æä¾›ï¼Œè€Œä¸æ˜¯AVXã€‚å› æ­¤ï¼Œè¦ç”¨gccç¼–è¯‘è¿™æ®µä»£ç ï¼Œå¿…é¡»ä½¿ç”¨-mavx2æ ‡å¿—è€Œä¸æ˜¯-mavxã€‚</li></ol><p>é™¤äº†è¡¨3ä¸­åˆ—å‡ºçš„å‡½æ•°ä¹‹å¤–ï¼ŒAVX2è¿˜æä¾›äº†ä»å†…å­˜åŠ è½½ç´¢å¼•æ•°æ®çš„é›†åˆå‡½æ•°ã€‚</p><h2 id="6-Arithmetic-Intrinsics"><a href="#6-Arithmetic-Intrinsics" class="headerlink" title="6.Arithmetic Intrinsics"></a>6.Arithmetic Intrinsics</h2><p>æ•°å­¦æ˜¯AVXå­˜åœ¨çš„ä¸»è¦åŸå› ï¼ŒåŸºæœ¬æ“ä½œæ˜¯åŠ ã€å‡ã€ä¹˜å’Œé™¤ã€‚æœ¬èŠ‚å°†ä»‹ç»æ‰§è¡Œè¿™äº›æ“ä½œçš„intrinsic funtionsï¼Œè¿˜å°†ä»‹ç»AVX2æä¾›çš„æ–°çš„èåˆä¹˜æ³•å’ŒåŠ æ³•å‡½æ•°ã€‚</p><h3 id="6-1åŠ æ³•å’Œå‡æ³•"><a href="#6-1åŠ æ³•å’Œå‡æ³•" class="headerlink" title="6.1åŠ æ³•å’Œå‡æ³•"></a>6.1åŠ æ³•å’Œå‡æ³•</h3><p>è¡¨4åˆ—å‡ºäº†æ‰§è¡ŒåŠ æ³•å’Œå‡æ³•çš„AVX&#x2F;AVX2 intrinsicã€‚ç”±äºè€ƒè™‘åˆ°é¥±å’Œåº¦ï¼Œå®ƒä»¬å¤§å¤šæ•°éƒ½ä½œç”¨äºåŒ…å«æ•´æ•°çš„å‘é‡ã€‚</p><p><strong>Table 4: Addition and Subtraction Intrinsics</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_mm256_add_ps/pd</code></td><td>Add two floating-point vectors</td></tr><tr><td><code>_mm256_sub_ps/pd</code></td><td>Subtract two floating-point vectors</td></tr><tr><td><code>(2)_mm256_add_epi8/16/32/64 </code></td><td>Add two integer vectors</td></tr><tr><td><code>(2)_mm236_sub_epi8/16/32/64</code></td><td>Subtract two integer vectors</td></tr><tr><td><code>(2)_mm256_adds_epi8/16</code> <code>(2)_mm256_adds_epu8/16 </code></td><td>Add two integer vectors with saturation</td></tr><tr><td><code>(2)_mm256_subs_epi8/16</code> <code>(2)_mm256_subs_epu8/16</code></td><td>Subtract two integer vectors with saturation</td></tr><tr><td><code>_mm256_hadd_ps/pd</code></td><td>Add two floating-point vectors horizontally</td></tr><tr><td><code>_mm256_hsub_ps/pd</code></td><td>Subtract two floating-point vectors horizontally</td></tr><tr><td><code>(2)_mm256_hadd_epi16/32</code></td><td>Add two integer vectors horizontally</td></tr><tr><td><code>(2)_mm256_hsub_epi16/32</code></td><td>Subtract two integer vectors horizontally</td></tr><tr><td><code>(2)_mm256_hadds_epi16</code></td><td>Add two vectors containing shorts horizontally with saturation</td></tr><tr><td><code>(2)_mm256_hsubs_epi16</code></td><td>Subtract two vectors containing shorts horizontally with saturation</td></tr><tr><td><code>_mm256_addsub_ps/pd</code></td><td>Add and subtract two floating-point vectors</td></tr></tbody></table><p>åŠ æ³•å’Œå‡æ³•æ•´æ•°å‘é‡æ—¶ï¼Œé‡è¦çš„æ˜¯è¦æŸ¥çœ‹_add_&#x2F;_sub_å‡½æ•°å’Œ_adds_&#x2F;_subs_å‡½æ•°ä¹‹é—´çš„åŒºåˆ«ã€‚é¢å¤–çš„sä»£è¡¨é¥±å’Œï¼Œå½“ç»“æœéœ€è¦çš„å†…å­˜è¶…è¿‡å‘é‡å¯ä»¥å­˜å‚¨çš„å†…å­˜æ—¶ï¼Œå°±ä¼šäº§ç”Ÿé¥±å’Œã€‚Functions that take saturation into account clamp the result to the minimum&#x2F;maximum value that can be stored.æ²¡æœ‰é¥±å’Œçš„å‡½æ•°åœ¨å‘ç”Ÿé¥±å’Œæ—¶å¿½ç•¥å†…å­˜é—®é¢˜ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªå‘é‡åŒ…å«æœ‰ç¬¦å·å­—èŠ‚ï¼Œé‚£ä¹ˆæ¯ä¸ªå…ƒç´ çš„æœ€å¤§å€¼æ˜¯127 (0x7F)ã€‚å¦‚æœä¸€ä¸ªè¿ç®—å°†98åŠ åˆ°85ï¼Œæ•°å­¦å’Œæ˜¯183 (0xB7)ã€‚</p><ul><li>å¦‚æœä½¿ç”¨_mm256_add_epi8æ·»åŠ è¿™äº›å€¼ï¼Œé¥±å’Œåº¦å°†è¢«å¿½ç•¥ï¼Œå­˜å‚¨çš„ç»“æœå°†æ˜¯-73 (0xB7)ã€‚</li><li>å¦‚æœä½¿ç”¨_mm256_adds_epi8æ·»åŠ è¿™äº›å€¼ï¼Œç»“æœå°†è¢«å›ºå®šä¸ºæœ€å¤§å€¼127 (0x7F)ã€‚</li></ul><p>ä½œä¸ºå¦ä¸€ä¸ªä¾‹å­ï¼Œè€ƒè™‘ä¸¤ä¸ªåŒ…å«æœ‰ç¬¦å·çŸ­æ•´æ•°çš„å‘é‡ã€‚æœ€å°å€¼ä¸º-32,768ã€‚å¦‚æœè®¡ç®—-18,000 - 19,000ï¼Œæ•°å­¦ç»“æœæ˜¯-37,000 (0xFFFF6F78ä½œä¸º32ä½æ•´æ•°)ã€‚</p><ul><li>å¦‚æœç”¨_mm256_sub_epi16å‡å»è¿™äº›å€¼ï¼Œé¥±å’Œåº¦å°†è¢«å¿½ç•¥ï¼Œå­˜å‚¨çš„ç»“æœå°†æ˜¯28,536 (0x6F78)ã€‚</li><li>å¦‚æœç”¨_mm256_subs_epi16å‡å»è¿™äº›å€¼ï¼Œç»“æœå°†è¢«å‹ç¼©åˆ°æœ€å°å€¼-32,768 (0x8000)ã€‚</li></ul><p>_hadd_&#x2F;_hsub_å‡½æ•°æ°´å¹³æ‰§è¡ŒåŠ æ³•å’Œå‡æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä¸æ˜¯æ·»åŠ æˆ–å‡å»ä¸åŒå‘é‡çš„å…ƒç´ ï¼Œè€Œæ˜¯åœ¨æ¯ä¸ªå‘é‡ä¸­æ·»åŠ æˆ–å‡å»<strong>ç›¸é‚»</strong>çš„å…ƒç´ ã€‚ç»“æœä»¥äº¤é”™çš„æ–¹å¼å­˜å‚¨ã€‚å›¾1æ˜¾ç¤ºäº†_mm256_hadd_pdçš„å·¥ä½œåŸç†ï¼Œå®ƒæ°´å¹³åœ°æ·»åŠ äº†ä¸¤ä¸ªå‘é‡Aå’ŒB:</p><p><img src="/2023/03/10/avx006/Fig1.jpg" alt="Image 1"></p><p><strong>Figure 1: Horizontal Addition of Two Vectors</strong></p><p>æ°´å¹³åŠ å‡å…ƒç´ çœ‹èµ·æ¥å¯èƒ½å¾ˆå¥‡æ€ªï¼Œä½†è¿™äº›æ“ä½œåœ¨å¤æ•°ç›¸ä¹˜æ—¶å¾ˆæœ‰ç”¨ã€‚æœ¬æ–‡ç¨åå°†å¯¹æ­¤è¿›è¡Œè§£é‡Šã€‚è¡¨4ä¸­çš„æœ€åä¸€ä¸ªå‡½æ•°_mm256_addsub_ps&#x2F;pdäº¤æ›¿å‡æ³•å’ŒåŠ æ³•ä¸¤ä¸ªæµ®ç‚¹å‘é‡çš„å…ƒç´ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¶æ•°å…ƒç´ è¢«å‡å»ï¼Œå¥‡æ•°å…ƒç´ è¢«åŠ ä¸Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœvec_aåŒ…å«(0.1,0.2,0.3,0.4)ï¼Œvec_båŒ…å«(0.5,0.6,0.7,0.8)ï¼Œåˆ™_mm256_addsub_pd(vec_a, vec_b)ç­‰äº(-0.4,0.8ï¼Œ-0.4,1.2)ã€éœ€è¦æ³¨æ„æ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹ã€‘ã€‚</p><h3 id="6-2ä¹˜æ³•å’Œé™¤æ³•"><a href="#6-2ä¹˜æ³•å’Œé™¤æ³•" class="headerlink" title="6.2ä¹˜æ³•å’Œé™¤æ³•"></a>6.2ä¹˜æ³•å’Œé™¤æ³•</h3><p>è¡¨5åˆ—å‡ºäº†æ‰§è¡Œä¹˜æ³•å’Œé™¤æ³•çš„AVX&#x2F;AVX2 intrinsicã€‚ä¸åŠ æ³•å’Œå‡æ³•ä¸€æ ·ï¼Œå¯¹æ•´æ•°è¿›è¡Œè¿ç®—ä¹Ÿæœ‰ä¸€äº›ç‰¹æ®Šçš„ç‰¹æ€§ã€‚</p><p><strong>Table 5: Multiplication and Division Intrinsics</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_mm256_mul_ps/pd</code></td><td>Multiply two floating-point vectors</td></tr><tr><td><code>(2)_mm256_mul_epi32/</code> <code>(2)_mm256_mul_epu32 </code></td><td>Multiply the lowest four elements of vectors containing 32-bit integers</td></tr><tr><td><code>(2)_mm256_mullo_epi16/32</code></td><td>Multiply integers and store low halves</td></tr><tr><td><code>(2)_mm256_mulhi_epi16/</code> <code>(2)_mm256_mulhi_epu16</code></td><td>Multiply integers and store high halves</td></tr><tr><td><code>(2)_mm256_mulhrs_epi16</code></td><td>Multiply 16-bit elements to form 32-bit elements</td></tr><tr><td><code>_mm256_div_ps/pd</code></td><td>Divide two floating-point vectors</td></tr></tbody></table><p>å¦‚æœä¸¤ä¸ªNä½çš„æ•°å­—åœ¨è®¡ç®—æœºä¸Šç›¸ä¹˜ï¼Œç»“æœå¯ä»¥å ç”¨2Nä½ã€è¿™é‡Œä½ éœ€è¦ç†Ÿæ‚‰è®¡ç®—æœºç»„æˆåŸç†ä¸­çš„ä¹˜æ³•åŸç†ï¼ŒåŒæ—¶æ€è€ƒä¼šä¸ä¼šåœ¨æŸäº›å‡½æ•°å‡ºç°ç²¾åº¦æŸå¤±çš„æƒ…å†µã€‘ã€‚å› æ­¤ï¼Œåªæœ‰_mm256_mul_epi32å’Œ_mm256_mul_epu32çš„å››ä¸ªä½å…ƒç´ è¢«ä¹˜åœ¨ä¸€èµ·ï¼Œç»“æœæ˜¯ä¸€ä¸ªåŒ…å«å››ä¸ªé•¿æ•´æ•°çš„å‘é‡ã€‚</p><p><strong>___m256i _mm256_mul_epi32 (m256i a, __m256i b)</strong></p><p><strong>Description</strong></p><p>Multiply the low signed 32-bit integers from each packed 64-bit element in a and b, and store the signed 64-bit results in dst.</p><p><strong>Operation</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">FOR</span> j := <span class="hljs-number">0</span> to <span class="hljs-number">3</span> <br><span class="hljs-attribute">i</span> := j*<span class="hljs-number">64</span> <br><span class="hljs-attribute">dst</span>[i+<span class="hljs-number">63</span>:i] := SignExtend<span class="hljs-number">64</span>(a[i+<span class="hljs-number">31</span>:i]) * SignExtend<span class="hljs-number">64</span>(b[i+<span class="hljs-number">31</span>:i]) <br><span class="hljs-attribute">ENDFOR</span> <br><span class="hljs-attribute">dst</span>[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p><strong>å›¾2:æ•´æ•°å‘é‡çš„ä½å…ƒç´ ç›¸ä¹˜</strong></p><p>_mullo_å‡½æ•°ç±»ä¼¼äºæ•´æ•°_mul_å‡½æ•°ï¼Œä½†å®ƒä»¬ä¸æ˜¯ä¹˜ä½å…ƒç´ ï¼Œè€Œæ˜¯ä¹˜ä¸¤ä¸ªå‘é‡çš„æ¯ä¸ªå…ƒç´ ï¼Œåªå­˜å‚¨æ¯ä¸ªä¹˜ç§¯çš„ä½ä¸€åŠã€‚</p><p><strong>Synopsis</strong></p><p><strong>m256i _mm256_mullo_epi32 (m256i a, __m256i b)</strong><br>#include &lt;immintrin.h&gt;<br>Instruction: vpmulld ymm, ymm, ymm<br>CPUID Flags: AVX2</p><p><strong>Description</strong></p><p>Multiply the packed signed 32-bit integers in a and b, producing intermediate 64-bit integers, and store the low 32 bits of the intermediate integers in dst.</p><p><strong>Operation</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">FOR</span> j := <span class="hljs-number">0</span> to <span class="hljs-number">7</span> <br><span class="hljs-attribute">i</span> := j*<span class="hljs-number">32</span> <br><span class="hljs-attribute">tmp</span>[<span class="hljs-number">63</span>:<span class="hljs-number">0</span>] := a[i+<span class="hljs-number">31</span>:i] * b[i+<span class="hljs-number">31</span>:i] <br><span class="hljs-attribute">dst</span>[i+<span class="hljs-number">31</span>:i] := tmp[<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] <br><span class="hljs-attribute">ENDFOR</span> <br><span class="hljs-attribute">dst</span>[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p><strong>å›¾3:æ•´æ•°ç›¸ä¹˜å’Œå­˜å‚¨ä½äºŒåˆ†ä¹‹ä¸€</strong></p><p>_mm256_mulhi_epi16å’Œ_mm256_mulhi_epu16 intrinsicsç±»ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬å­˜å‚¨æ•´æ•°ç§¯çš„é«˜ä¸€åŠã€‚</p><p><strong>Synopsis</strong></p><p><strong>m256i _mm256_mulhi_epi16 (m256i a, __m256i b)</strong><br>#include &lt;immintrin.h&gt;<br>Instruction: vpmulhw ymm, ymm, ymm<br>CPUID Flags: AVX2</p><p><strong>Description</strong></p><p>Multiply the packed signed 16-bit integers in a and b, producing intermediate 32-bit integers, and store the high 16 bits of the intermediate integers in dst.</p><p><strong>Operation</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">FOR</span> j := <span class="hljs-number">0</span> to <span class="hljs-number">15</span> <br><span class="hljs-attribute">i</span> := j*<span class="hljs-number">16</span> <br><span class="hljs-attribute">tmp</span>[<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] := SignExtend<span class="hljs-number">32</span>(a[i+<span class="hljs-number">15</span>:i]) * SignExtend<span class="hljs-number">32</span>(b[i+<span class="hljs-number">15</span>:i])       dst[i+<span class="hljs-number">15</span>:i] := tmp[<span class="hljs-number">31</span>:<span class="hljs-number">16</span>] <br><span class="hljs-attribute">ENDFOR</span> <br><span class="hljs-attribute">dst</span>[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h3 id="6-3Fused-Multiply-and-Add-FMA"><a href="#6-3Fused-Multiply-and-Add-FMA" class="headerlink" title="6.3Fused Multiply and Add (FMA)"></a>6.3Fused Multiply and Add (FMA)</h3><p>å¦‚å‰æ‰€è¿°ï¼Œä¸¤ä¸ªNä½æ•°å­—ç›¸ä¹˜çš„ç»“æœå¯ä»¥å ç”¨2Nä½ã€‚å› æ­¤ï¼Œå½“æ‚¨å°†ä¸¤ä¸ªæµ®ç‚¹å€¼aå’Œbç›¸ä¹˜æ—¶ï¼Œç»“æœå®é™…ä¸Šæ˜¯å››èˆäº”å…¥(a * b)ï¼Œå…¶ä¸­å››èˆäº”å…¥(x)è¿”å›æœ€æ¥è¿‘xçš„æµ®ç‚¹å€¼ã€‚éšç€è¿›ä¸€æ­¥æ“ä½œçš„æ‰§è¡Œï¼Œè¿™ç§ç²¾åº¦æŸå¤±ä¼šå¢åŠ ã€‚ã€è¿™é‡Œéœ€è¦æ³¨æ„åˆ†éƒ¨ä¹˜åŠ ï¼Œå…ˆä¹˜æ³•ååŠ æ³•å’Œä½¿ç”¨FMAä¸¤è€…çš„è®¡ç®—ç²¾åº¦ã€‘</p><p>AVX2æä¾›äº†å°†ä¹˜æ³•å’ŒåŠ æ³•èåˆåœ¨ä¸€èµ·çš„æŒ‡ä»¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä¸æ˜¯è¿”å›æ•´æ•°(æ•´æ•°(a * b) + c)ï¼Œè€Œæ˜¯è¿”å›æ•´æ•°(a * b + c)ã€‚å› æ­¤ï¼Œè¿™äº›æŒ‡ä»¤æ¯”åˆ†åˆ«æ‰§è¡Œä¹˜æ³•å’ŒåŠ æ³•æä¾›äº†æ›´é«˜çš„é€Ÿåº¦å’Œå‡†ç¡®æ€§ã€è¿™é‡Œæ­£æ˜¯FMAçš„ç‰¹ç‚¹ã€‘ã€‚</p><p>è¡¨6åˆ—å‡ºäº†AVX2æä¾›çš„FMA intrinsicï¼Œå¹¶åŒ…æ‹¬å¯¹æ¯ä¸ªå‡½æ•°çš„æè¿°ã€‚è¡¨ä¸­çš„æ¯æ¡æŒ‡ä»¤éƒ½æ¥å—ä¸‰ä¸ªè¾“å…¥å‘é‡ï¼Œæˆ‘æŠŠå®ƒä»¬åˆ†åˆ«ç§°ä¸ºaã€bå’Œcã€‚</p><p><strong>Table 6: FMA Intrinsics</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>(2)_mm_fmadd_ps/pd/</code> <code>(2)_mm256_fmadd_ps/pd</code></td><td>Multiply two vectors and add the product to a third (res &#x3D; a * b + c)</td></tr><tr><td><code>(2)_mm_fmsub_ps/pd/</code> <code>(2)_mm256_fmsub_ps/pd</code></td><td>Multiply two vectors and subtract a vector from the product (res &#x3D; a * b - c)</td></tr><tr><td><code>(2)_mm_fmadd_ss/sd </code></td><td>Multiply and add the lowest element in the vectors (res[0] &#x3D; a[0] * b[0] + c[0])</td></tr><tr><td><code>(2)_mm_fmsub_ss/sd</code></td><td>Multiply and subtract the lowest element in the vectors (res[0] &#x3D; a[0] * b[0] - c[0])</td></tr><tr><td><code>(2)_mm_fnmadd_ps/pd</code> <code>(2)_mm256_fnmadd_ps/pd </code></td><td>Multiply two vectors and add the negated product to a third (res &#x3D; -(a * b) + c)</td></tr><tr><td><code>(2)_mm_fnmsub_ps/pd/</code> <code>(2)_mm256_fnmsub_ps/pd</code></td><td>Multiply two vectors and add the negated product to a third (res &#x3D; -(a * b) - c)</td></tr><tr><td><code>(2)_mm_fnmadd_ss/sd</code></td><td>Multiply the two lowest elements and add the negated product to the lowest element of the third vector (res[0] &#x3D; -(a[0] * b[0]) + c[0])</td></tr><tr><td><code>(2)_mm_fnmsub_ss/sd</code></td><td>Multiply the lowest elements and subtract the lowest element of the third vector from the negated product (res[0] &#x3D; -(a[0] * b[0]) - c[0])</td></tr><tr><td><code>(2)_mm_fmaddsub_ps/pd/</code> <code>(2)_mm256_fmaddsub_ps/pd</code></td><td>Multiply two vectors and alternately add and subtract from the product (res &#x3D; a * b - c)</td></tr><tr><td><code>(2)_mm_fmsubadd_ps/pd/</code> <code>(2)_mmf256_fmsubadd_ps/pd </code></td><td>Multiply two vectors and alternately subtract and add from the product (res &#x3D; a * b - c)</td></tr></tbody></table><p>å¦‚æœä¸€ä¸ªå†…å¾çš„åç§°ä»¥_psæˆ–_pdç»“å°¾ï¼Œåˆ™è¾“å…¥å‘é‡çš„æ¯ä¸ªå…ƒç´ éƒ½åŒ…å«åœ¨è¿ç®—ä¸­ã€‚å¦‚æœintrinsicçš„åç§°ä»¥_ssæˆ–_sdç»“å°¾ï¼Œåˆ™åªåŒ…æ‹¬æœ€ä½çš„å…ƒç´ ã€‚è¾“å‡ºå‘é‡ä¸­çš„å…¶ä½™å…ƒç´ è¢«è®¾ç½®ä¸ºä¸ç¬¬ä¸€ä¸ªè¾“å…¥å‘é‡ä¸­çš„å…ƒç´ ç›¸ç­‰ã€‚ä¾‹å¦‚,å‡è®¾vec_a &#x3D; (1.0, 2.0)ï¼Œ vec_b &#x3D; (5.0, 10.0)ï¼Œ vec_c &#x3D;(7.0, 14.0)ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ_mm_fmadd_sd(vec_a, vec_b, vec_c)è¿”å›(12.0,2.0)ï¼Œå› ä¸º(1.0 * 5.0)+ 7.0 &#x3D; 12.0,2.0æ˜¯vec_açš„ç¬¬äºŒä¸ªå…ƒç´ ã€‚</p><p>äº†è§£_fmadd_&#x2F;_fmsub_å’Œ_fnmadd_&#x2F;_fnmsub_ intrinsicä¹‹é—´çš„åŒºåˆ«å¾ˆé‡è¦ã€‚åä¸€ç§å‡½æ•°åœ¨åŠ ä¸Šæˆ–å‡å»ç¬¬ä¸‰ä¸ªè¾“å…¥å‘é‡ä¹‹å‰ï¼Œå¯¹å‰ä¸¤ä¸ªè¾“å…¥å‘é‡çš„ä¹˜ç§¯æ±‚åã€‚</p><p><strong>Synopsis</strong></p><p><strong>__m256d _mm256_fnmadd_pd (m256d a, m256d b, m256d c)</strong><br>#include &lt;immintrin.h&gt;<br>Instruction: vfnmadd132pd ymm, ymm, ymm<br>       vfnmadd213pd ymm, ymm, ymm<br>       vfnmadd231pd ymm, ymm, ymm<br>CPUID Flags: FMA</p><p><strong>Description</strong></p><p>Multiply packed double-precision (64-bit) floating-point elements in a and b, add the negated intermediate result to packed elements in c, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">FOR</span> j := <span class="hljs-number">0</span> to <span class="hljs-number">3</span> <br><span class="hljs-attribute">i</span> := j*<span class="hljs-number">64</span> <br><span class="hljs-attribute">dst</span>[i+<span class="hljs-number">63</span>:i] := -(a[i+<span class="hljs-number">63</span>:i] * b[i+<span class="hljs-number">63</span>:i]) + c[i+<span class="hljs-number">63</span>:i] <br><span class="hljs-attribute">ENDFOR</span> <br><span class="hljs-attribute">dst</span>[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p>_fmaddsub_å’Œ_fmsubadd_å†…åœ¨å‡½æ•°åœ¨ç¬¬ä¸‰ä¸ªå‘é‡çš„åŠ æ³•å’Œå‡æ³•å…ƒç´ ä¹‹é—´äº¤æ›¿ä½¿ç”¨ã€‚_fmaddsub_ intrinsicå¥‡æ•°å…ƒç´ åšåŠ æ³•è€Œå¶æ•°å…ƒç´ åšå‡æ³•ã€‚_fmsubadd_ intrinsicå¥‡æ•°å…ƒç´ åšå‡æ³•è€Œå¶æ•°å…ƒç´ åšåŠ æ³•ã€‚fmatest.cä¸­çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨å®è·µä¸­ä½¿ç”¨_mm256_fmaddsub_pd intrinsicã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>  <br>  __m256d veca = _mm256_setr_pd(<span class="hljs-number">6.0</span>, <span class="hljs-number">6.0</span>, <span class="hljs-number">6.0</span>, <span class="hljs-number">6.0</span>);<br><br>  __m256d vecb = _mm256_setr_pd(<span class="hljs-number">2.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">2.0</span>);<br>  <br>  __m256d vecc = _mm256_setr_pd(<span class="hljs-number">7.0</span>, <span class="hljs-number">7.0</span>, <span class="hljs-number">7.0</span>, <span class="hljs-number">7.0</span>);<br>  <br>  <span class="hljs-comment">/* Alternately subtract and add the third vector</span><br><span class="hljs-comment">     from the product of the first and second vectors */</span><br>  __m256d result = _mm256_fmaddsub_pd(veca, vecb, vecc);<br>  <br>  <span class="hljs-comment">/* Display the elements of the result vector */</span><br>  <span class="hljs-keyword">double</span>* res = (<span class="hljs-keyword">double</span>*)&amp;result;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf %lf %lf %lf\n&quot;</span>, res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>], res[<span class="hljs-number">2</span>], res[<span class="hljs-number">3</span>]);<br>  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å½“è¿™æ®µä»£ç åœ¨æ”¯æŒAVX2çš„å¤„ç†å™¨ä¸Šç¼–è¯‘å’Œæ‰§è¡Œæ—¶ï¼Œæ‰“å°çš„ç»“æœå¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">5.000000</span> <span class="hljs-number">19.000000</span> <span class="hljs-number">5.000000</span> <span class="hljs-number">19.000000</span><br></code></pre></div></td></tr></table></figure><p>FMAæŒ‡ä»¤æ˜¯ç”±AVX2æä¾›çš„ï¼Œå› æ­¤æ‚¨å¯èƒ½è®¤ä¸ºä½¿ç”¨gccæ„å»ºåº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨-mavx2æ ‡å¿—ã€‚ä½†æ˜¯æˆ‘å‘ç°-mfmaæ ‡å¿—æ˜¯<strong>å¿…éœ€</strong>çš„ã€‚å¦åˆ™ï¼Œæˆ‘ä¼šå¾—åˆ°å¥‡æ€ªçš„ç¼–è¯‘é”™è¯¯ã€‚</p><h2 id="7-Permuting-and-Shuffling"><a href="#7-Permuting-and-Shuffling" class="headerlink" title="7.Permuting and Shuffling"></a>7.Permuting and Shuffling</h2><p>è®¸å¤šåº”ç”¨ç¨‹åºå¿…é¡»é‡æ–°æ’åˆ—å‘é‡å…ƒç´ ï¼Œä»¥ç¡®ä¿æ­£ç¡®æ‰§è¡Œæ“ä½œã€‚</p><p>AVX&#x2F;AVX2ä¸ºæ­¤ç›®çš„æä¾›äº†è®¸å¤šintrinsic funtionï¼Œå…¶ä¸­ä¸¤å¤§ç±»æ˜¯_permute_å‡½æ•°å’Œ_shuffle_å‡½æ•°ã€‚æœ¬èŠ‚ä»‹ç»è¿™ä¸¤ç§ç±»å‹çš„intrinsicã€‚</p><h3 id="7-1Permuting"><a href="#7-1Permuting" class="headerlink" title="7.1Permuting"></a>7.1Permuting</h3><p>AVXæä¾›äº†è¿”å›ä¸€ä¸ªå‘é‡çš„å‡½æ•°ï¼Œè¯¥å‘é‡åŒ…å«ä¸€ä¸ªå‘é‡çš„é‡æ–°æ’åˆ—çš„å…ƒç´ ã€‚è¡¨7åˆ—å‡ºäº†è¿™äº›æ’åˆ—å‡½æ•°ï¼Œå¹¶æä¾›äº†å¯¹æ¯ä¸ªå‡½æ•°çš„æè¿°ã€‚</p><p><strong>Table 7: Permute Intrinsics</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_mm_permute_ps/pd/</code> <code>_mm256_permute_ps/pd</code></td><td>Select elements from the input vector based on an 8-bit control value</td></tr><tr><td><code>(2)_mm256_permute4x64_pd/</code> <code>(2)_mm256_permute4x64_epi64</code></td><td>Select 64-bit elements from the input vector based on an 8-bit control value</td></tr><tr><td><code>_mm256_permute2f128_ps/pd</code></td><td>Select 128-bit chunks from two input vectors based on an 8-bit control value</td></tr><tr><td><code>_mm256_permute2f128_si256 </code></td><td>Select 128-bit chunks from two input vectors based on an 8-bit control value</td></tr><tr><td><code>_mm_permutevar_ps/pd</code> <code>_mm256_permutevar_ps/pd </code></td><td>Select elements from the input vector based on bits in an integer vector</td></tr><tr><td><code>(2)_mm256_permutevar8x32_ps</code>&#x2F; <code>(2)_mm256_permutevar8x32_epi32</code></td><td>Select 32-bit elements (<code>float</code>s and <code>int</code>s) using indices in an integer vector</td></tr></tbody></table><p>_permute_ intrinsicæ¥å—ä¸¤ä¸ªå‚æ•°:ä¸€ä¸ªè¾“å…¥å‘é‡å’Œä¸€ä¸ª8ä½æ§åˆ¶å€¼ã€‚æ§åˆ¶å€¼çš„ä½å†³å®šè¾“å…¥å‘é‡çš„å“ªä¸ªå…ƒç´ æ’å…¥åˆ°è¾“å‡ºä¸­ã€‚</p><p>å¯¹äº_mm256_permute_psï¼Œæ¯å¯¹æ§åˆ¶ä½é€šè¿‡é€‰æ‹©è¾“å…¥å‘é‡ä¸­çš„ä¸€ä¸ªä¸Šæˆ–ä¸‹å…ƒç´ æ¥ç¡®å®šä¸€ä¸ªä¸Šæˆ–ä¸‹è¾“å‡ºå…ƒç´ ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>  <br>  __m128 v1 = _mm_setr_ps(<span class="hljs-number">2.3</span>, <span class="hljs-number">4.1</span>, <span class="hljs-number">6.2</span>, <span class="hljs-number">8.4</span>);<br>  <span class="hljs-keyword">float</span> * a =(<span class="hljs-keyword">float</span>*)&amp;v1;<br>   <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i&lt; <span class="hljs-number">4</span> ;i++)<br>   &#123;<br>    cout&lt;&lt;a[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>   &#125;<br>   cout&lt;&lt;endl;<br>   __m128 v2 = _mm_permute_ps (v1, <span class="hljs-number">3</span>);<br>   <span class="hljs-keyword">float</span> * b =(<span class="hljs-keyword">float</span>*)&amp;v2;<br>   <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i&lt; <span class="hljs-number">4</span> ;i++)<br>   &#123;<br>    cout&lt;&lt;b[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>   &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>.<span class="hljs-number">3</span> <span class="hljs-number">4</span>.<span class="hljs-number">1</span> <span class="hljs-number">6</span>.<span class="hljs-number">2</span> <span class="hljs-number">8</span>.<span class="hljs-number">4</span><br><span class="hljs-attribute">8</span>.<span class="hljs-number">4</span> <span class="hljs-number">2</span>.<span class="hljs-number">3</span> <span class="hljs-number">2</span>.<span class="hljs-number">3</span> <span class="hljs-number">2</span>.<span class="hljs-number">3</span><br></code></pre></div></td></tr></table></figure><p><strong>Figure 4: Operation of the Permute Intrinsic Function</strong></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œè¾“å…¥å‘é‡çš„å€¼å¯ä»¥åœ¨è¾“å‡ºä¸­é‡å¤å¤šæ¬¡ã€‚å…¶ä»–è¾“å…¥å€¼å¯èƒ½æ ¹æœ¬ä¸è¢«é€‰æ‹©ã€‚</p><p>åœ¨_mm256_permute_pdä¸­ï¼Œæ§åˆ¶å€¼çš„ä½å››ä½åœ¨ç›¸é‚»çš„åŒç²¾åº¦æ•°å¯¹ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚_mm256_permute4x4_pdç±»ä¼¼ï¼Œä½†ä½¿ç”¨æ‰€æœ‰æ§åˆ¶ä½æ¥é€‰æ‹©å°†å“ªä¸ª64ä½å…ƒç´ æ”¾åœ¨è¾“å‡ºä¸­ã€‚åœ¨_permute2f128_ intrinsicä¸­ï¼Œæ§åˆ¶å€¼ä»ä¸¤ä¸ªè¾“å…¥å‘é‡ä¸­é€‰æ‹©128ä½å—ï¼Œè€Œä¸æ˜¯ä»ä¸€ä¸ªè¾“å…¥å‘é‡ä¸­é€‰æ‹©å…ƒç´ ã€‚</p><p>_permutevar_ intrinsicæ‰§è¡Œä¸_permute_ intrinsicç›¸åŒçš„æ“ä½œã€‚ä½†æ˜¯å®ƒä»¬ä¸æ˜¯ä½¿ç”¨8ä½æ§åˆ¶å€¼æ¥é€‰æ‹©å…ƒç´ ï¼Œè€Œæ˜¯ä¾èµ–äºä¸è¾“å…¥å‘é‡å¤§å°ç›¸åŒçš„æ•´æ•°å‘é‡ã€‚ä¾‹å¦‚ï¼Œ_mm256_permute_psçš„è¾“å…¥å‘é‡æ˜¯_mm256ï¼Œå› æ­¤æ•´æ•°å‘é‡æ˜¯_mm256iã€‚æ•´æ•°å‘é‡çš„é«˜ä½æ‰§è¡Œé€‰æ‹©çš„æ–¹å¼ä¸_permute_ intrinsicçš„8ä½æ§åˆ¶å€¼çš„ä½ç›¸åŒã€‚</p><h3 id="7-2Shuffling"><a href="#7-2Shuffling" class="headerlink" title="7.2Shuffling"></a>7.2Shuffling</h3><p>åƒ_permute_ intrinsicä¸€æ ·ï¼Œ_shuffle_ intrinsicä»ä¸€ä¸ªæˆ–ä¸¤ä¸ªè¾“å…¥å‘é‡ä¸­é€‰æ‹©å…ƒç´ ï¼Œå¹¶å°†å®ƒä»¬æ”¾åœ¨è¾“å‡ºå‘é‡ä¸­ã€‚è¡¨8åˆ—å‡ºäº†è¿™äº›åŠŸèƒ½ï¼Œå¹¶æä¾›äº†æ¯ä¸ªåŠŸèƒ½çš„æè¿°ã€‚</p><p><strong>Table 8: Shuffle Intrinsics</strong></p><table><thead><tr><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_mm256_shuffle_ps/pd</code></td><td>Select floating-point elements according to an 8-bit value</td></tr><tr><td><code>_mm256_shuffle_epi8/</code> <code>_mm256_shuffle_epi32</code></td><td>Select integer elements according to an 8-bit value</td></tr><tr><td><code>(2)_mm256_shufflelo_epi16/ </code> <code>(2)_mm256_shufflehi_epi16</code></td><td>Select 128-bit chunks from two input vectors based on an 8-bit control value</td></tr></tbody></table><p>æ‰€æœ‰çš„shuffle_ intrinsicè¿ç®—äº256ä½å‘é‡ã€‚åœ¨æ¯ç§æƒ…å†µä¸‹ï¼Œæœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª8ä½çš„å€¼ï¼Œå®ƒå†³å®šå“ªäº›è¾“å…¥å…ƒç´ åº”è¯¥æ”¾åœ¨è¾“å‡ºå‘é‡ä¸­ã€‚</p><p>å¯¹äº_mm256_shuffle_psï¼Œåªä½¿ç”¨æ§ä»¶å€¼çš„é«˜å››ä½ã€‚å¦‚æœè¾“å…¥å‘é‡åŒ…å«æ•´å‹æˆ–æµ®ç‚¹æ•°ï¼Œåˆ™ä½¿ç”¨æ‰€æœ‰æ§åˆ¶ä½ã€‚å¯¹äº_mm256_shuffle_psï¼Œå‰ä¸¤å¯¹ä½é€‰æ‹©ç¬¬ä¸€ä¸ªå‘é‡ä¸­çš„å…ƒç´ ï¼Œåä¸¤å¯¹ä½é€‰æ‹©ç¬¬äºŒä¸ªå‘é‡ä¸­çš„å…ƒç´ ã€‚</p><p><strong>Synopsis</strong></p><p><strong>m256 _mm256_shuffle_ps (m256 a, __m256 b, const int imm8)</strong><br>#include &lt;immintrin.h&gt;<br>Instruction: vshufps ymm, ymm, ymm, imm8<br>CPUID Flags: AVX</p><p><strong>Description</strong></p><p>Shuffle single-precision (32-bit) floating-point elements in a within 128-bit lanes using the control in imm8, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">DEFINE SELECT4(<span class="hljs-attribute">src</span>, control) &#123; <br>CASE(control<span class="hljs-selector-attr">[1:0]</span>) OF <br><span class="hljs-number">0</span>:tmp<span class="hljs-selector-attr">[31:0]</span> := <span class="hljs-attribute">src</span>[<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] <br><span class="hljs-number">1</span>:tmp<span class="hljs-selector-attr">[31:0]</span> := <span class="hljs-attribute">src</span>[<span class="hljs-number">63</span>:<span class="hljs-number">32</span>] <br><span class="hljs-number">2</span>:tmp<span class="hljs-selector-attr">[31:0]</span> := <span class="hljs-attribute">src</span>[<span class="hljs-number">95</span>:<span class="hljs-number">64</span>] <br><span class="hljs-number">3</span>:tmp<span class="hljs-selector-attr">[31:0]</span> := <span class="hljs-attribute">src</span>[<span class="hljs-number">127</span>:<span class="hljs-number">96</span>] <br>ESAC <br>RETURN tmp<span class="hljs-selector-attr">[31:0]</span> <br>&#125; <br>dst<span class="hljs-selector-attr">[31:0]</span> := SELECT4(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[127:0]</span>, imm8<span class="hljs-selector-attr">[1:0]</span>) <br>dst<span class="hljs-selector-attr">[63:32]</span> := SELECT4(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[127:0]</span>, imm8<span class="hljs-selector-attr">[3:2]</span>) <br>dst<span class="hljs-selector-attr">[95:64]</span> := SELECT4(<span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[127:0]</span>, imm8<span class="hljs-selector-attr">[5:4]</span>) <br>dst<span class="hljs-selector-attr">[127:96]</span> := SELECT4(<span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[127:0]</span>, imm8<span class="hljs-selector-attr">[7:6]</span>) <br>dst<span class="hljs-selector-attr">[159:128]</span> := SELECT4(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[255:128]</span>, imm8<span class="hljs-selector-attr">[1:0]</span>) <br>dst<span class="hljs-selector-attr">[191:160]</span> := SELECT4(<span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[255:128]</span>, imm8<span class="hljs-selector-attr">[3:2]</span>) <br>dst<span class="hljs-selector-attr">[223:192]</span> := SELECT4(<span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[255:128]</span>, imm8<span class="hljs-selector-attr">[5:4]</span>) <br>dst<span class="hljs-selector-attr">[255:224]</span> := SELECT4(<span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[255:128]</span>, imm8<span class="hljs-selector-attr">[7:6]</span>) <br>dst<span class="hljs-selector-attr">[MAX:256]</span> := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p>ä¸ºäº†shuffle16ä½å€¼ï¼ŒAVX2æä¾›äº†_mm256_shufflelo_epi16å’Œ_mm256_shufflehi_epi16ã€‚ä¸_mm256_shuffle_psä¸€æ ·ï¼Œæ§åˆ¶å€¼è¢«åˆ†æˆå››å¯¹ä»å…«ä¸ªå…ƒç´ ä¸­é€‰æ‹©çš„ä½ã€‚ä½†æ˜¯å¯¹äº_mm256_shufflelo_epi16, 8ä¸ªå…ƒç´ æ˜¯ä»8ä¸ªä½çš„16ä½å€¼ä¸­å–å‡ºçš„ã€‚å¯¹äº_mm256_shufflehi_epi16, 8ä¸ªå…ƒç´ å–è‡ª8ä¸ªé«˜çš„16ä½å€¼ã€‚</p><h2 id="8-Complex-Multiplication"><a href="#8-Complex-Multiplication" class="headerlink" title="8.Complex Multiplication"></a>8.Complex Multiplication</h2><p>åœ¨ä¿¡å·å¤„ç†åº”ç”¨ä¸­ï¼Œå¤æ•°ä¹˜æ³•æ˜¯ä¸€é¡¹å¿…é¡»åå¤æ‰§è¡Œçš„è€—æ—¶æ“ä½œã€‚æˆ‘ä¸ä¼šæ·±å…¥è®¨è®ºè¿™ä¸ªç†è®ºï¼Œä½†æ¯ä¸ªå¤æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸ºa + biï¼Œå…¶ä¸­aå’Œbæ˜¯æµ®ç‚¹å€¼ï¼Œiæ˜¯-1çš„å¹³æ–¹æ ¹ã€‚Aæ˜¯å®éƒ¨ï¼Œbæ˜¯è™šéƒ¨ã€‚å¦‚æœ(a + bi)å’Œ(c + di)ç›¸ä¹˜ï¼Œä¹˜ç§¯ç­‰äº(ac - bd) + (ad + bc)iã€‚</p><p>å¤æ•°å¯ä»¥ä»¥äº¤é”™çš„æ–¹å¼å­˜å‚¨ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå®æ•°éƒ¨åˆ†åé¢è·Ÿç€è™šæ•°éƒ¨åˆ†ã€‚å‡è®¾vec1æ˜¯ä¸€ä¸ª__m256dï¼Œå­˜å‚¨ä¸¤ä¸ªå¤æ•°(a + bi)å’Œ(x + yi)ï¼Œ vec2æ˜¯ä¸€ä¸ª__m256dï¼Œå­˜å‚¨(c + di)å’Œ(z + wi)ã€‚å›¾6è¯´æ˜äº†å¦‚ä½•å­˜å‚¨è¿™äº›å€¼ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œprodå‘é‡å­˜å‚¨äº†ä¸¤ä¸ªäº§ç‰©:(ac - bd) + (ad + bc)iå’Œ(xz - yw) + (xw + yz)iã€‚</p><p>ã€å›¾ç‰‡ä¸¢å¤±ã€‘</p><p><strong>Figure 6: Complex Multiplication Using Vectors</strong></p><p>æˆ‘ä¸çŸ¥é“ç”¨AVX&#x2F;AVX2è®¡ç®—å¤æ‚ä¹˜ç§¯çš„æœ€å¿«æ–¹æ³•ã€‚ä½†æˆ‘æƒ³å‡ºäº†ä¸€ä¸ªæ–¹æ³•ï¼Œæ•ˆæœå¾ˆå¥½ã€‚å®ƒåŒ…æ‹¬äº”ä¸ªæ­¥éª¤:</p><ol><li>å°†vec1å’Œvec2ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨vec3ä¸­ã€‚</li><li>åˆ‡æ¢vec2çš„å®&#x2F;è™šå€¼ã€‚</li><li>æ±‚vec2çš„è™šæ•°çš„è´Ÿæ•°ã€‚</li><li>å°†vec1å’Œvec2ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨vec4ä¸­ã€‚</li><li>å¯¹vec3å’Œvec4è¿›è¡Œæ°´å¹³ç›¸å‡ï¼Œå¾—åˆ°vec1ä¸­çš„ç­”æ¡ˆã€‚</li></ol><p>complex_multi .cä¸­çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨AVX intrinsicæ‰§è¡Œæ­¤æ“ä½œ:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>  __m256d vec1 = _mm256_setr_pd(<span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">13.0</span>, <span class="hljs-number">6.0</span>);<br>  __m256d vec2 = _mm256_setr_pd(<span class="hljs-number">9.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">6.0</span>, <span class="hljs-number">7.0</span>);<br>  __m256d neg = _mm256_setr_pd(<span class="hljs-number">1.0</span>, <span class="hljs-number">-1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">-1.0</span>);<br>  <br>  <span class="hljs-comment">/* Step 1: Multiply vec1 and vec2 */</span><br>  __m256d vec3 = _mm256_mul_pd(vec1, vec2);<br><br>  <span class="hljs-comment">/* Step 2: Switch the real and imaginary elements of vec2 */</span><br>  vec2 = _mm256_permute_pd(vec2, <span class="hljs-number">0x5</span>);<br>  <br>  <span class="hljs-comment">/* Step 3: Negate the imaginary elements of vec2 */</span><br>  vec2 = _mm256_mul_pd(vec2, neg);  <br>  <br>  <span class="hljs-comment">/* Step 4: Multiply vec1 and the modified vec2 */</span><br>  __m256d vec4 = _mm256_mul_pd(vec1, vec2);<br><br>  <span class="hljs-comment">/* Horizontally subtract the elements in vec3 and vec4 */</span><br>  vec1 = _mm256_hsub_pd(vec3, vec4);<br>  <br>  <span class="hljs-comment">/* Display the elements of the result vector */</span><br>  <span class="hljs-keyword">double</span>* res = (<span class="hljs-keyword">double</span>*)&amp;vec1;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf %lf %lf %lf\n&quot;</span>, res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>], res[<span class="hljs-number">2</span>], res[<span class="hljs-number">3</span>]);<br>  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">21</span>.<span class="hljs-number">000000</span> <span class="hljs-number">57</span>.<span class="hljs-number">000000</span> <span class="hljs-number">36</span>.<span class="hljs-number">000000</span> <span class="hljs-number">127</span>.<span class="hljs-number">000000</span><br></code></pre></div></td></tr></table></figure><p>è¿™æ®µä»£ç ä½œç”¨äºåŒå‘é‡ï¼Œä½†æ˜¯å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•è¯¥æ–¹æ³•ä»¥æ”¯æŒæµ®ç‚¹å‘é‡ã€‚</p><h2 id="9-Points-of-Interest"><a href="#9-Points-of-Interest" class="headerlink" title="9.Points of Interest"></a>9.Points of Interest</h2><p>è®¸å¤šå¼€å‘äººå‘˜å¯èƒ½ä¼šé¿å…å­¦ä¹ AVX&#x2F;AVX2ï¼Œå¸Œæœ›ç¼–è¯‘å™¨èƒ½å¤Ÿæ‰§è¡Œè‡ªåŠ¨å‘é‡åŒ–ã€‚è‡ªåŠ¨å‘é‡åŒ–æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œä½†æ˜¯å¦‚æœæ‚¨äº†è§£æœ¬è´¨ï¼Œå°±å¯ä»¥é‡æ–°å®‰æ’ç®—æ³•ä»¥æ›´å¥½åœ°åˆ©ç”¨SIMDå¤„ç†ã€‚é€šè¿‡æ’å…¥AVX&#x2F;AVX2 intrinsicï¼Œæˆ‘æå¤§åœ°æé«˜äº†ä¿¡å·å¤„ç†åº”ç”¨ç¨‹åºçš„å¤„ç†é€Ÿåº¦ã€‚</p><h2 id="10-History"><a href="#10-History" class="headerlink" title="10.History"></a>10.History</h2><p>2&#x2F;20 - Fixed formatting and image links</p><p>4&#x2F;2 - Fixed a couple typographical errors</p><h2 id="11-License"><a href="#11-License" class="headerlink" title="11.License"></a>11.License</h2><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx">The Code Project Open License (CPOL)</a></p><p>Written By</p><p><strong><a href="https://www.codeproject.com/Members/mattscar">Matt Scarpino</a></strong></p><p><img src="/2023/03/10/avx006/US.gif" alt="United States"> United States</p><p>Iâ€™ve been a programmer and engineer for over 20 years. Iâ€™m a certified Azure Developer Associate and an Azure IoT Developer Specialist.</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AVX</tag>
      
      <tag>AVX2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAä½¿ç”¨äºŒç»´ç½‘æ ¼å’ŒäºŒä½å—å¯¹çŸ©é˜µæ±‚å’Œ</title>
    <link href="/2023/03/09/cuda015/"/>
    <url>/2023/03/09/cuda015/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAä½¿ç”¨äºŒç»´ç½‘æ ¼å’ŒäºŒä½å—å¯¹çŸ©é˜µæ±‚å’Œ"><a href="#CUDAä½¿ç”¨äºŒç»´ç½‘æ ¼å’ŒäºŒä½å—å¯¹çŸ©é˜µæ±‚å’Œ" class="headerlink" title="CUDAä½¿ç”¨äºŒç»´ç½‘æ ¼å’ŒäºŒä½å—å¯¹çŸ©é˜µæ±‚å’Œ"></a>CUDAä½¿ç”¨äºŒç»´ç½‘æ ¼å’ŒäºŒä½å—å¯¹çŸ©é˜µæ±‚å’Œ</h2><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªäºŒç»´ç½‘æ ¼å’ŒäºŒä½å—æ¥ç¼–å†™ä¸€ä¸ªçŸ©é˜µåŠ æ³•æ ¸å‡½æ•°ã€‚é¦–å…ˆï¼Œåº”è¯¥ç¼–å†™ä¸€ä¸ªæ ¡éªŒä¸»å‡½æ•°ä»¥éªŒè¯çŸ©é˜µåŠ æ³•æ ¸å‡½æ•°æ˜¯å¦èƒ½å¾—å‡ºæ­£ç¡®çš„ç»“æœï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sumMatrixOnhost</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> nx, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> ny)</span></span>&#123;<br>    <span class="hljs-keyword">float</span> *ia = A;<br>    <span class="hljs-keyword">float</span> *ib = B;<br>    <span class="hljs-keyword">float</span> *ic = C;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> iy=<span class="hljs-number">0</span>;iy&lt;ny;iy++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> ix=<span class="hljs-number">0</span>;ix&lt;nx;ix++)&#123;<br>            ic[ix]=ia[ix]+ib[ix];<br>        &#125;<br>        ia += nx;<br>        ib += nx;<br>        ic += nx;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ ¸å‡½æ•°ï¼Œç›®çš„æ˜¯é‡‡ç”¨ä¸€ä¸ªäºŒç»´çº¿ç¨‹å—æ¥è¿›è¡ŒçŸ©é˜µæ±‚å’Œï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">sumMatrixOnGPU2D</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *MatA, <span class="hljs-keyword">float</span> *MatB, <span class="hljs-keyword">float</span> *MatC, <span class="hljs-keyword">int</span> nx, <span class="hljs-keyword">int</span> ny)</span></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> ix = threadIdx.x + blockIdx.x * blockDim.x;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> iy = threadIdx.y + blockIdx.y * blockDim.y;<br>    ubsigned <span class="hljs-keyword">int</span> idx = iy*nx + ix;<br>    <br>    <span class="hljs-keyword">if</span>(ix &lt; nx &amp;&amp; iy &lt;ny)<br>        MatC[idx] = MatA[idx] + MatB[idx];<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™ä¸ªæ ¸å‡½æ•°çš„å…³é”®æ­¥éª¤æ˜¯å°†æ¯ä¸ªçº¿ç¨‹ä»å®ƒçš„çº¿ç¨‹ç´¢å¼•æ˜ å°„åˆ°å…¨å±€çº¿æ€§å†…å­˜ç´¢å¼•ä¸­ï¼Œå¦‚å›¾2-12æ‰€ç¤ºã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæ¯ä¸ªç»´åº¦ä¸‹çš„çŸ©é˜µå¤§å°å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹æ³•è®¾ç½®ä¸º16384ä¸ªå…ƒç´ ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> nx = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">14</span>;<br><span class="hljs-keyword">int</span> ny = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">14</span>;<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªäºŒç»´ç½‘æ ¼å’ŒäºŒç»´å—æŒ‰å¦‚ä¸‹æ–¹æ³•è®¾ç½®æ ¸å‡½æ•°çš„æ‰§è¡Œé…ç½®ï¼š</p><p><img src="/2023/03/09/cuda015/image-20230309125059653.png" alt="image-20230309125059653"></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> dimx = <span class="hljs-number">32</span>;<br><span class="hljs-keyword">int</span> dimy = <span class="hljs-number">32</span>;<br><span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(dimx, dimy)</span></span>;<br><span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">((nx + block.x - <span class="hljs-number">1</span>)/block.x, (ny + block.y - <span class="hljs-number">1</span>)/block.y)</span></span>;<br></code></pre></div></td></tr></table></figure><p>æŠŠæ‰€æœ‰çš„ä»£ç æ•´åˆåˆ°åä¸ºsumMatrixOnGPU-2D-grid-2D-block.cuçš„æ–‡ä»¶ä¸­ã€‚ä¸»å‡½æ•°ä»£ç å¦‚ä»£ç æ¸…å•2-7æ‰€ç¤ºã€‚</p><p>ä»£ç æ¸…å•2-7 ä½¿ç”¨ä¸€ä¸ªäºŒç»´ç½‘æ ¼å’ŒäºŒç»´å—çš„çŸ©é˜µåŠ æ³•(sumMatrixOnGPU-2D-grid-2D-block.cu)</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s Starting...\n&quot;</span>,zrgv[<span class="hljs-number">0</span>]);<br>    <br>    <span class="hljs-comment">//set up device</span><br>    <span class="hljs-keyword">int</span> dev = <span class="hljs-number">0</span>;<br>    cudaDeviceProp deviceProp;<br>    <span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">cudaGetDeviceProperties</span>(&amp;deviceProp, dev));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Using Device %d: %s\n&quot;</span>,dev, deviceProp.name);<br>    <span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">cudaSetDevice</span>(dev));<br>    <br>    <span class="hljs-comment">//set up data size of matrix</span><br>    <span class="hljs-keyword">int</span> nx = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">14</span>;<br>    <span class="hljs-keyword">int</span> ny = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">14</span>;<br>    <br>    <span class="hljs-keyword">int</span> nxy = nx*ny;<br>    <span class="hljs-keyword">int</span> nBytes = nxy *<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Matrix size: nx %d ny %d\n&quot;</span>,nx,ny);<br>    <br>    <span class="hljs-comment">//malloc host memory</span><br>    <span class="hljs-keyword">float</span> *h_A, *h_B, *hostRef, *gpuRef;<br>    h_A = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    h_B = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    hostRef = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    gpuRef = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    <br>    <span class="hljs-comment">//initialize data at host side</span><br>    <span class="hljs-keyword">double</span> iStart = <span class="hljs-built_in">cpuSecond</span>();<br>    <span class="hljs-built_in">initialData</span> (h_A, nxy);<br>    <span class="hljs-built_in">initialData</span> (h_B, nxy);<br>    <span class="hljs-keyword">double</span> iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br>    <br>    <span class="hljs-built_in">memset</span>(hostRef, <span class="hljs-number">0</span>, nBytes);<br>    <span class="hljs-built_in">memset</span>(gpuRef, <span class="hljs-number">0</span>, nBytes);<br>    <br>    <span class="hljs-comment">//add matrix at host side for result checks</span><br>    iStart = <span class="hljs-built_in">cpuSecond</span>();<br>    <span class="hljs-built_in">sumMatrixOnHost</span> (h_A, h_B, hostRef, nx,ny);<br>    iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br>    <br>    <span class="hljs-comment">//malloc device global memory</span><br>    <span class="hljs-keyword">float</span> *d_MatA, *d_MatB, *d_MatC;<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">void</span> **)&amp;d_MatA,nBytes);<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">void</span> **)&amp;d_MatB,nBytes);<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">void</span> **)&amp;d_MatC,nBytes);<br>    <br>    <span class="hljs-comment">//transfer data from host to device</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(d_MatA, h_A, nBytes, cudaMemcpyHostToDevice);<br>    <span class="hljs-built_in">cudaMemcpy</span>(d_MatB, h_B, nBytes, cudaMemcpyHostToDevice);<br>    <br>    <span class="hljs-comment">//invoke kernel at host side</span><br>    <span class="hljs-keyword">int</span> dimx = <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">int</span> dimy = <span class="hljs-number">32</span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(dimx,dimy)</span></span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">((nx+block.x<span class="hljs-number">-1</span>)/block.x,(ny+block.y<span class="hljs-number">-1</span>)/block.y)</span></span>;<br>    <br>    iStart = <span class="hljs-built_in">cpuSecond</span>();<br>    sumMatrixOnGPU2D&lt;&lt;&lt;grid,block&gt;&gt;&gt;(d_MatA, d_MatB, d_MatC, nx,ny);<br>    <span class="hljs-built_in">cudaDeviceSynchronize</span>();<br>    iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;sumMatrixOnGPU2D&lt;&lt;&lt;(%d,%d),(%d,%d)&gt;&gt;&gt; elapsed %f sec\n&quot;</span>,grid.x, grid.y, block.x,block.y,iElaps);<br>    <br>    <span class="hljs-comment">//copy kernel result back to host side</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(gpuRef, d_MatC, nBytes, cudaMemcpyDeviceToHost);<br>    <br>    <span class="hljs-comment">//check device results</span><br>    <span class="hljs-built_in">checkResult</span>(hostRef, gpuRef,nxy);<br>    <br>    <span class="hljs-comment">//free device global memory</span><br>    <span class="hljs-built_in">cudaFree</span>(d_MatA);<br>    <span class="hljs-built_in">cudaFree</span>(d_MatB);<br>    <span class="hljs-built_in">cudaFree</span>(d_MatC);<br>    <br>    <span class="hljs-comment">//free host memory</span><br>    <span class="hljs-built_in">free</span>(h_A);<br>    <span class="hljs-built_in">free</span>(h_B);<br>    <span class="hljs-built_in">free</span>(hostRef);<br>    <span class="hljs-built_in">free</span>(gpuRef);<br>    <br>    <span class="hljs-comment">//reset device</span><br>    <span class="hljs-built_in">cudaDeviceReset</span>();<br>    <br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>);<br>&#125; <br></code></pre></div></td></tr></table></figure><p>ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘å¹¶è¿è¡Œè¯¥ä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc -arch=sm_20 sumMatrixOnGPU-2D-grid-2D-block.cu -o matrix2D<br>./matrix2D<br></code></pre></div></td></tr></table></figure><p>åœ¨Tesla M2070ä¸Šè¿è¡Œçš„ç»“æœï¼š</p><p><img src="/2023/03/09/cuda015/image-20230309224513603.png" alt="image-20230309224513603"></p><p>æ¥ä¸‹æ¥ï¼Œè°ƒæ•´å—çš„å°ºå¯¸ä¸º32Ã—16å¹¶é‡æ–°ç¼–è¯‘å’Œè¿è¡Œè¯¥ä»£ç ã€‚æ ¸å‡½æ•°çš„æ‰§è¡Œé€Ÿåº¦å‡ ä¹å¿«äº†ä¸¤å€ï¼š</p><p><img src="/2023/03/09/cuda015/image-20230309224626772.png" alt="image-20230309224626772"></p><p>ä½ å¯èƒ½å¥½å¥‡ä¸ºä»€ä¹ˆåªæ˜¯æ”¹å˜äº†æ‰§è¡Œé…ç½®ï¼Œå†…æ ¸æ€§èƒ½å°±å‡ ä¹ç¿»äº†ä¸€å€ã€‚ç›´è§‚åœ°è¯´ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è¿™æ˜¯å› ä¸ºç¬¬äºŒæ¬¡é…ç½®çš„çº¿ç¨‹å—æ•°æ˜¯ç¬¬ä¸€æ¬¡é…ç½®å—æ•°çš„ä¸¤å€ï¼Œæ‰€ä»¥å¹¶è¡Œæ€§ä¹Ÿæ˜¯ä¸¤å€ã€‚ä½ çš„ç›´è§‰æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯ï¼Œå¦‚æœè¿›ä¸€æ­¥å‡å°å—çš„å¤§å°å˜ä¸º16Ã—16ï¼Œç›¸æ¯”ç¬¬ä¸€æ¬¡é…ç½®ä½ å·²ç»å°†å—çš„æ•°é‡ç¿»äº†å››å€ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™ç§é…ç½®æ¯”ç¬¬ä¸€ä¸ªç»“æœå¥½ä½†æ˜¯ä¸å¦‚ç¬¬äºŒä¸ªã€‚</p><p><img src="/2023/03/09/cuda015/image-20230309224912499.png" alt="image-20230309224912499"></p><p>è¡¨2-3æ€»ç»“äº†ä¸åŒæ‰§è¡Œé…ç½®çš„æ€§èƒ½ã€‚ç»“æœæ˜¾ç¤ºï¼Œå¢åŠ å—çš„æ•°é‡ä¸ä¸€å®šèƒ½æå‡å†…æ ¸æ€§èƒ½ã€‚</p><p><img src="/2023/03/09/cuda015/image-20230309225004531.png" alt="image-20230309225004531"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAä½¿ç”¨å—å’Œçº¿ç¨‹å»ºç«‹çŸ©é˜µç´¢å¼•</title>
    <link href="/2023/03/09/cuda014/"/>
    <url>/2023/03/09/cuda014/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAä½¿ç”¨å—å’Œçº¿ç¨‹å»ºç«‹çŸ©é˜µç´¢å¼•"><a href="#CUDAä½¿ç”¨å—å’Œçº¿ç¨‹å»ºç«‹çŸ©é˜µç´¢å¼•" class="headerlink" title="CUDAä½¿ç”¨å—å’Œçº¿ç¨‹å»ºç«‹çŸ©é˜µç´¢å¼•"></a>CUDAä½¿ç”¨å—å’Œçº¿ç¨‹å»ºç«‹çŸ©é˜µç´¢å¼•</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªçŸ©é˜µç”¨è¡Œä¼˜å…ˆçš„æ–¹æ³•åœ¨å…¨å±€å†…å­˜ä¸­è¿›è¡Œçº¿æ€§å­˜å‚¨ã€‚å›¾2-9æ‰€ç¤ºçš„æ˜¯ä¸€ä¸ª8Ã—6çŸ©é˜µçš„å°ä¾‹å­ã€‚</p><p>åœ¨ä¸€ä¸ªçŸ©é˜µåŠ æ³•æ ¸å‡½æ•°ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹é€šå¸¸è¢«åˆ†é…ä¸€ä¸ªæ•°æ®å…ƒç´ æ¥å¤„ç†ã€‚é¦–å…ˆè¦å®Œæˆçš„ä»»åŠ¡æ˜¯ä½¿ç”¨å—å’Œçº¿ç¨‹ç´¢å¼•ä»å…¨å±€å†…å­˜ä¸­è®¿é—®æŒ‡å®šçš„æ•°æ®ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯¹ä¸€ä¸ªäºŒç»´ç¤ºä¾‹æ¥è¯´ï¼Œéœ€è¦ç®¡ç†3ç§ç´¢å¼•ã€‚</p><p><img src="/2023/03/09/cuda014/image-20230309113733674.png" alt="image-20230309113733674"></p><ul><li>çº¿ç¨‹å’Œå—ç´¢å¼•</li><li>çŸ©é˜µä¸­ç»™å®šç‚¹çš„åæ ‡</li><li>å…¨å±€çº¿æ€§å†…å­˜ä¸­çš„åç§»é‡</li></ul><p>å¯¹äºä¸€ä¸ªç»™å®šçš„çº¿ç¨‹ï¼Œé¦–å…ˆå¯ä»¥é€šè¿‡æŠŠçº¿ç¨‹å’Œå—ç´¢å¼•æ˜ å°„åˆ°çŸ©é˜µåæ ‡ä¸Šæ¥è·å–çº¿ç¨‹å—å’Œçº¿ç¨‹ç´¢å¼•çš„å…¨å±€å†…å­˜åç§»é‡ï¼Œç„¶åå°†è¿™äº›çŸ©é˜µåæ ‡æ˜ å°„åˆ°å…¨å±€å†…å­˜çš„å­˜å‚¨å•å…ƒä¸­ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å…¬å¼æŠŠçº¿ç¨‹å’Œå—ç´¢å¼•æ˜ å°„åˆ°çŸ©é˜µåæ ‡ä¸Šï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">ix = threadIdx.x + blockIdx.x * blockDim.x;<br>iy = threadIdx.y + blockIdx.y * blockDim.y;<br></code></pre></div></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å…¬å¼æŠŠçŸ©é˜µåæ ‡æ˜ å°„åˆ°å…¨å±€å†…å­˜ä¸­çš„ç´¢å¼•&#x2F;å­˜å‚¨å•å…ƒä¸Š:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">idx = iy * nx + ix<br></code></pre></div></td></tr></table></figure><p>å›¾2-10è¯´æ˜äº†å—å’Œçº¿ç¨‹ç´¢å¼•ï¼ŒçŸ©é˜µåæ ‡ä»¥åŠçº¿æ€§å…¨å±€å†…å­˜ç´¢å¼•ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚</p><p><img src="/2023/03/09/cuda014/image-20230309114815497.png" alt="image-20230309114815497"></p><p>printThreadInfoå‡½æ•°è¢«ç”¨äºè¾“å‡ºå…³äºæ¯ä¸ªçº¿ç¨‹çš„ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li>çº¿ç¨‹ç´¢å¼•</li><li>å—ç´¢å¼•</li><li>çŸ©é˜µåæ ‡</li><li>çº¿æ€§å…¨å±€å†…å­˜åç§»é‡</li><li>ç›¸åº”å…ƒç´ çš„å€¼</li></ul><p>ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘å¹¶è¿è¡Œè¯¥ç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc -arch=sm_20 checkThreadIndex.cu -o checkIndex<br>./checkIndex<br></code></pre></div></td></tr></table></figure><p>å¯¹äºæ¯ä¸ªçº¿ç¨‹ï¼Œä½ å¯ä»¥è·å–ä»¥ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">thread_id</span>(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<span class="hljs-built_in">block_id</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<span class="hljs-built_in">coordinate</span>(<span class="hljs-number">6</span>,<span class="hljs-number">1</span>)global index <span class="hljs-number">14</span> ival <span class="hljs-number">14</span><br></code></pre></div></td></tr></table></figure><p>å›¾2-11è¯´æ˜äº†è¿™ä¸‰é¡¹ç´¢å¼•ä¹‹é—´çš„å…³ç³»ã€‚</p><p><img src="/2023/03/09/cuda014/image-20230309115229368.png" alt="image-20230309115229368"></p><p>ä»£ç æ¸…å•2-6 æ£€æŸ¥å—å’Œçº¿ç¨‹ç´¢å¼•ï¼ˆcheckTå’ŒreadIndex.cuï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cuda_runtime.h&gt;</span></span><br><span class="hljs-meta">#inclde <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CHECK(call)</span><br>&#123;<br>    <span class="hljs-keyword">const</span> cudaError_t error = call;<br>    <span class="hljs-keyword">if</span>(error != cudaSuccess)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error: %s:%d, &quot;</span>,__FILE__, __LINE__);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;code:%d, reason: %s\n&quot;</span>,error, <span class="hljs-built_in">cudaGetErrorString</span>(error));<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">-10</span>*error);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initialInt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *p, <span class="hljs-keyword">int</span> size)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;size;i++)&#123;<br>        ip[i] = i;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printMateix</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *C,<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> nx, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> ny)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> *ic = C;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\nMatrix:(%d.%d)\n&quot;</span>.nx,ny);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> iy=<span class="hljs-number">0</span>;iy&lt;ny;iy++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> ix=<span class="hljs-number">0</span>; ix&lt;nx;ix++)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%3d&quot;</span>,ic[ix]);<br>        &#125;<br>        ic += nx;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br><br><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">printThreadIndex</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *A, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> nx, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> ny)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> ix = threadIdx.x + blockIdx.x * blockDim.x;<br>    <span class="hljs-keyword">int</span> iy = threadIdx.y + blockIdx.y * blockDim.y;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> idx = iy*nx + ix;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;thread_id (%d,%d) block_id (%d,%d) coordinate (%d,%d) global index %2d ival %2d\n&quot;</span>, threadIdx.x, threadIdx.y, blockIdx.x,blockIdx.y,ix,iy,idx,A[idx]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s Starting...\n&quot;</span>,argv[<span class="hljs-number">0</span>]);<br>    <br>    <span class="hljs-comment">//get device information</span><br>    <span class="hljs-keyword">int</span> dev = <span class="hljs-number">0</span>;<br>    cudaDeviceProp deviceProp;<br>    <span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">cudaGetDeviceProperties</span>(&amp;deviceProp, dev));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Using Device %d: %s\n&quot;</span>, dev, deviceProp.name);<br>    <br>    <span class="hljs-comment">//set matrix dimension</span><br>    <span class="hljs-keyword">int</span> nx = <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">int</span> ny = <span class="hljs-number">6</span>;<br>    <span class="hljs-keyword">int</span> nxy = nx*ny;<br>    <span class="hljs-keyword">int</span> nBytes = nxy * <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>);<br>    <br>    <span class="hljs-comment">//malloc host memory</span><br>    <span class="hljs-keyword">int</span> *h_A;<br>    h_A = (<span class="hljs-keyword">int</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    <br>    <span class="hljs-comment">//initialize host matrix with interger</span><br>    <span class="hljs-built_in">initialInt</span>(h_A, nxy);<br>    <span class="hljs-built_in">printMatrix</span>(h_A, nx, ny);<br>    <br>    <span class="hljs-comment">//malloc device memory</span><br>    <span class="hljs-keyword">int</span> *d_MatA;<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">void</span>**)&amp;d_MatA, nBytes);<br>    <br>    <span class="hljs-comment">//transfer data from host to device</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(d_MatA, h_A, nBytes, cudaMemcpyHostToDevice);<br>    <br>    <span class="hljs-comment">//set up execution configuration</span><br>    <span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(<span class="hljs-number">4</span>,<span class="hljs-number">2</span>)</span></span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">((nx+block.x<span class="hljs-number">-1</span>)/block.x,(ny+block.y<span class="hljs-number">-1</span>)/block.y)</span></span>;<br>    <br>    <span class="hljs-comment">//invoke the kernel</span><br>    printThreadIndex&lt;&lt;&lt;grid,block&gt;&gt;&gt;(d_MatA,nx,ny);<br>    <span class="hljs-built_in">cudaDeviceSynchronize</span>();<br>    <br>    <span class="hljs-comment">//free host and device memory</span><br>    <span class="hljs-built_in">cudaFree</span>(d_MatA);<br>    <span class="hljs-built_in">free</span>(h_A);<br>    <br>    <span class="hljs-comment">//reset device</span><br>    <span class="hljs-built_in">cudaDeviceReset</span>();<br>    <br>    <span class="hljs-keyword">return</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç»„ç»‡å¹¶è¡Œç¼–ç¨‹</title>
    <link href="/2023/03/08/cuda013/"/>
    <url>/2023/03/08/cuda013/</url>
    
    <content type="html"><![CDATA[<h2 id="ç»„ç»‡å¹¶è¡Œç¼–ç¨‹"><a href="#ç»„ç»‡å¹¶è¡Œç¼–ç¨‹" class="headerlink" title="ç»„ç»‡å¹¶è¡Œç¼–ç¨‹"></a>ç»„ç»‡å¹¶è¡Œç¼–ç¨‹</h2><p>ä»å‰é¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœä½¿ç”¨äº†åˆé€‚çš„ç½‘æ ¼å’Œå—å¤§å°æ¥æ­£ç¡®åœ°ç»„ç»‡çº¿ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥å¯¹å†…æ ¸æ€§èƒ½äº§ç”Ÿå¾ˆå¤§çš„å½±å“ã€‚åœ¨å‘é‡åŠ æ³•çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†å®ç°æœ€ä½³æ€§èƒ½æˆ‘ä»¬è°ƒæ•´äº†å—çš„å¤§å°ï¼Œå¹¶åŸºäºå—å¤§å°å’Œå‘é‡æ•°æ®å¤§å°è®¡ç®—å‡ºäº†ç½‘æ ¼å¤§å°ã€‚</p><p>ç°åœ¨é€šè¿‡ä¸€ä¸ªçŸ©é˜µåŠ æ³•çš„ä¾‹å­è¯´æ˜è¿™ä¸€ç‚¹ã€‚å¯¹äºçŸ©é˜µè¿ç®—ï¼Œä¼ ç»Ÿçš„æ–¹æ³•æ˜¯åœ¨å†…æ ¸ä¸­ä½¿ç”¨ä¸€ä¸ªåŒ…å«äºŒç»´ç½‘æ ¼ä¸äºŒä½å—çš„å¸ƒå±€æ¥ç»„ç»‡çº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œè¿™ç§ä¼ ç»Ÿçš„æ–¹æ³•æ— æ³•è·å¾—æœ€ä½³æ€§èƒ½ã€‚åœ¨çŸ©é˜µåŠ æ³•ä¸­ä½¿ç”¨ä»¥ä¸‹å¸ƒå±€å°†æœ‰åŠ©äºäº†è§£æ›´å¤šå…³äºç½‘æ ¼å’Œå—çš„å¯å‘æ€§çš„ç”¨æ³•ï¼š</p><ol><li>æœ‰äºŒç»´çº¿ç¨‹å—æ„æˆçš„äºŒç»´ç½‘æ ¼</li><li>ç”±ä¸€ç»´çº¿ç¨‹å—æ„æˆçš„ä¸€ç»´ç½‘æ ¼</li><li>ç”±ä¸€ç»´çº¿ç¨‹å—æ„æˆçš„äºŒç»´ç½‘æ ¼</li></ol><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç»™æ ¸å‡½æ•°è®¡æ—¶</title>
    <link href="/2023/03/07/CUDA012/"/>
    <url>/2023/03/07/CUDA012/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAç»™æ ¸å‡½æ•°è®¡æ—¶"><a href="#CUDAç»™æ ¸å‡½æ•°è®¡æ—¶" class="headerlink" title="CUDAç»™æ ¸å‡½æ•°è®¡æ—¶"></a>CUDAç»™æ ¸å‡½æ•°è®¡æ—¶</h2><p>åœ¨å†…æ ¸çš„æ€§èƒ½è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œäº†è§£æ ¸å‡½æ•°çš„æ‰§è¡Œéœ€è¦å¤šé•¿æ—¶é—´æ˜¯å¾ˆæœ‰å¸®åŠ©å¹¶ä¸”ååˆ†å…³é”®çš„ã€‚è¡¡é‡æ ¸å‡½æ•°æ€§èƒ½çš„æ–¹æ³•æœ‰å¾ˆå¤šã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨ä¸»æœºç«¯ä½¿ç”¨ä¸€ä¸ªCPUæˆ–GPUè®¡æ—¶å™¨æ¥è®¡ç®—å†…æ ¸çš„æ‰§è¡Œæ—¶é—´ã€‚åœ¨æœ¬èŠ‚ï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ªCPUè®¡æ—¶å™¨ï¼Œå¹¶ä½¿ç”¨NVIDIAåˆ†æå·¥å…·æ¥è®¡ç®—æ‰§è¡Œæ—¶é—´ã€‚</p><h3 id="ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶"><a href="#ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶" class="headerlink" title="ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶"></a>ç”¨CPUè®¡æ—¶å™¨è®¡æ—¶</h3><p>å¯ä»¥ä½¿ç”¨gettimeofdayç³»ç»Ÿè°ƒç”¨æ¥åˆ›å»ºä¸€ä¸ªCPUè®¡æ—¶å™¨ï¼Œä»¥è·å–ç³»ç»Ÿçš„æ—¶é’Ÿæ—¶é—´ï¼Œå®ƒå°†è¿”å›è‡ª1970å¹´1æœˆ1æ—¥é›¶ç‚¹ä»¥æ¥ï¼Œåˆ°ç°åœ¨çš„ç§’æ•°ã€‚ç¨‹åºä¸­éœ€è¦æ·»åŠ sys&#x2F;time.hå¤´æ–‡ä»¶ï¼Œå¦‚ä»£ç æ¸…å•2-5æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">cpuSecond</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">timeval</span> <span class="hljs-title">tp</span>;</span><br>    <span class="hljs-built_in">gettimeofday</span>(&amp;tp,<span class="hljs-literal">NULL</span>);<br>    <br>    <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">double</span>)tp.tv_sec + (<span class="hljs-keyword">double</span>)tp.tv_usec*<span class="hljs-number">1.e-6</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä½ å¯ä»¥ç”¨cpuSecondå‡½æ•°æ¥æµ‹è¯•ä½ çš„æ ¸å‡½æ•°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span> iStart = <span class="hljs-built_in">cpuSecond</span>();<br>kernel_name&lt;&lt;&lt;grid,block&gt;&gt;&gt;(argument list);<br><span class="hljs-built_in">cudaDeviceSynchronize</span>();<br><span class="hljs-keyword">double</span> iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br></code></pre></div></td></tr></table></figure><p>ç”±äºæ ¸å‡½æ•°è°ƒç”¨ä¸ä¸»æœºç«¯ç¨‹åºæ˜¯å¼‚æ­¥çš„ï¼Œä½ éœ€è¦ç”¨cudaDeviceSynchronizeå‡½æ•°æ¥ç­‰å¾…æ‰€æœ‰çš„GPUçº¿ç¨‹è¿è¡Œç»“æŸã€‚å˜é‡iElapsè¡¨ç¤ºç¨‹åºè¿è¡Œçš„æ—¶é—´ï¼Œå°±åƒä½ ç”¨æ‰‹è¡¨è®°å½•çš„æ ¸å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ï¼ˆç”¨ç§’è®¡ç®—ï¼‰ã€‚</p><p>ç°åœ¨ï¼Œé€šè¿‡è®¾ç½®æ•°æ®é›†å¤§å°æ¥å¯¹ä¸€ä¸ªæœ‰16Mä¸ªå…ƒç´ çš„å¤§å‘é‡è¿›è¡Œæµ‹è¯•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> nElem = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">24</span>;<br></code></pre></div></td></tr></table></figure><p>ç”±äºGPUçš„å¯æ‰©å±•æ€§ï¼Œä½ éœ€è¦å€ŸåŠ©å—å’Œçº¿ç¨‹çš„ç´¢å¼•æ¥è®¡ç®—ä¸€ä¸ªæŒ‰è¡Œä¼˜å…ˆçš„æ•°ç»„ç´¢å¼• i ï¼Œå¹¶å¯¹æ ¸å‡½æ•°è¿›è¡Œä¿®æ”¹ï¼Œæ·»åŠ é™å®šæ¡ä»¶ï¼ˆi &lt; Nï¼‰æ¥æ£€éªŒç´¢å¼•å€¼æ˜¯å¦è¶Šç•Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">sumArraysOnGPU</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> i = blockIdx.x * blockDim.x + threadIdx.x;<br>    <span class="hljs-keyword">if</span>( n &lt; N) C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ‰äº†è¿™äº›æ›´æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ‰§è¡Œé…ç½®æ¥è¡¡é‡æ ¸å‡½æ•°ã€‚ä¸ºäº†è§£å†³åˆ›å»ºçš„çº¿ç¨‹æ€»æ•°å¤§äºå‘é‡å…ƒç´ æ€»æ•°çš„æƒ…å†µï¼Œä½ éœ€è¦é™åˆ¶å†…æ ¸ä¸èƒ½éæ³•è®¿é—®å…¨å±€å†…å­˜ï¼Œå¦‚å›¾2-7æ‰€ç¤ºã€‚</p><p><img src="/2023/03/07/CUDA012/image-20230307120643741.png" alt="image-20230307120643741"></p><p>ä»£ç æ¸…å•2-5å±•ç¤ºäº†å¦‚ä½•åœ¨ä¸»å‡½æ•°ä¸­ç”¨CPUè®¡æ—¶å™¨æµ‹è¯•å‘é‡åŠ æ³•çš„æ ¸å‡½æ•°ã€‚</p><p>ä»£ç æ¸…å•2-5æµ‹è¯•å‘é‡åŠ æ³•çš„æ ¸å‡½æ•°ï¼ˆsumArraysOnGPU-timer.cuï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cuda_runtime.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/time.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s Starting...\n&quot;</span>,argv[<span class="hljs-number">0</span>]);<br>    <br>    <span class="hljs-comment">//set up device</span><br>    <span class="hljs-keyword">int</span> dev = <span class="hljs-number">0</span>;<br>    cudaDeviceProp deviceProp;<br>    <span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">cudaGetDeviceProperties</span>(&amp;deviceProp, dev));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Using Device %d: %s\n&quot;</span>, dev, deviceProp.name);<br>    <span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">cudaSetDevice</span>(dev));<br>    <br>    <span class="hljs-comment">//set up data size of vectors</span><br>    <span class="hljs-keyword">int</span> nElem = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">24</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Vector size %d\n&quot;</span>,nElem);<br>    <br>    <span class="hljs-comment">//malloc host memory</span><br>    <span class="hljs-keyword">size_t</span> nBytes = nElem * <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>);<br>    <br>    <span class="hljs-keyword">float</span> *h_A, *h_B, *hostRef, *gpuRef;<br>    h_A = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    h_B = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    hostRef = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    gpuRef = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    <br>    <span class="hljs-keyword">double</span> iStart,iElaps;<br>    <br>    <span class="hljs-comment">//initialize data at host side</span><br>    iStart = <span class="hljs-built_in">cpuSecond</span>();<br>    <span class="hljs-built_in">initialData</span>(h_A, nElem);<br>    <span class="hljs-built_in">initialData</span>(h_B, nElem);<br>    iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br>    <br>    <span class="hljs-built_in">memset</span>(hostRef, <span class="hljs-number">0</span> ,nBytes);<br>    <span class="hljs-built_in">memset</span>(gpuRef, <span class="hljs-number">0</span> ,nBytes);<br>    <br>    <span class="hljs-comment">//add vector at host side for result checks</span><br>    iStart = <span class="hljs-built_in">cpuSecond</span>();<br>    <span class="hljs-built_in">sumArraysOnHost</span>(h_A, h_B, hostRef, nElem);<br>    iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br>    <br>    <span class="hljs-comment">//malloc device global memory</span><br>    <span class="hljs-keyword">float</span> *d_A, *d_B, *d_C;<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_A, nBytes);<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_B, nBytes);<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_C, nBytes);<br>    <br>    <span class="hljs-comment">//transfer data from host to device</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(d_A, h_A, nBytes, cudaMemcpyHostTodevice);<br>    <span class="hljs-built_in">cudaMemcpy</span>(d_B, h_B, nBytes, cudaMemcpyHostTodevice);<br>    <br>    <span class="hljs-comment">//invoke kernel at host side</span><br>    <span class="hljs-keyword">int</span> iLen = <span class="hljs-number">1024</span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(iLen)</span></span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">((nElem+block.x<span class="hljs-number">-1</span>))</span>/block.x)</span>;<br>    <br>    iStart = <span class="hljs-built_in">cpuSecond</span>();<br>    sumArraysOnGPU&lt;&lt;&lt;grid,block&gt;&gt;&gt;(d_A, d_B, d_C,nElem);<br>    <span class="hljs-built_in">cudaDeviceSynchronize</span>();<br>    iElaps = <span class="hljs-built_in">cpuSecond</span>() - iStart;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;sumArraysOnGPU&lt;&lt;&lt;%d,%d&gt;&gt;&gt; Time elapsed %f sec\n&quot;</span>,grid.x, block.x, iElaps);<br>    <br>    <span class="hljs-comment">//copy kernel result back to host side</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(gpuRef, d_C, nBytes, cudaMemcpyDeviceToHost);<br>    <br>    <span class="hljs-comment">//check device results</span><br>    <span class="hljs-built_in">checkResult</span>(hostRef, gpuRef, nElem);<br>    <br>    <span class="hljs-comment">//free device global memory</span><br>    <span class="hljs-built_in">cudaFree</span>(d_A);<br>    <span class="hljs-built_in">cudaFree</span>(d_B);<br>    <span class="hljs-built_in">cudaFree</span>(d_C);<br>    <br>    <span class="hljs-comment">//free host memory</span><br>    <span class="hljs-built_in">free</span>(h_A);<br>    <span class="hljs-built_in">free</span>(h_B);<br>    <span class="hljs-built_in">free</span>(hostRef);<br>    <span class="hljs-built_in">free</span>(gpuRef);<br>    <br>    <span class="hljs-keyword">return</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é»˜è®¤çš„æ‰§è¡Œé…ç½®è¢«è®¾ç½®ä¸ºä¸€ä¸ªåŒ…å«16384ä¸ªå—çš„ä¸€ç»´ç½‘æ ¼ï¼Œæ¯ä¸ªå—åŒ…å«1024ä¸ªçº¿ç¨‹ã€‚ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc sumArraysOnGPU-timer.cu -o sumArraysOnGPU-timer<br>./sumArraysOnGPU-timer<br></code></pre></div></td></tr></table></figure><p>åœ¨åŸºäºè‹±ç‰¹å°”Sandy Bridgeæ¶æ„çš„ç³»ç»Ÿä¸Šè¿›è¡Œæµ‹è¯•ï¼Œä»ä»£ç æ¸…å•2-5çš„ç¤ºä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨GPUä¸Šè¿›è¡Œçš„å‘é‡åŠ æ³•çš„è¿ç®—é€Ÿåº¦æ˜¯åœ¨CPUä¸Šè¿è¡Œå‘é‡åŠ æ³•çš„3.86å€ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">./sumArraysOnGPU-timer Starting...<br>Using Device 0:Tesia M2070<br>Vector size 16777216<br>sumArraysOnGPU&lt;&lt;&lt;16384, 1024&gt;&gt;&gt;Time elapsed 0.002456 sec<br>Arrays match.<br></code></pre></div></td></tr></table></figure><p>æŠŠå—çš„ç»´åº¦å‡å°‘åˆ°512å¯ä»¥åˆ›å»º32768ä¸ªå—ã€‚åœ¨è¿™ä¸ªæ–°çš„é…ç½®ä¸‹ï¼Œå†…æ ¸çš„æ€§èƒ½æå‡äº†1.19å€ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sumArraysOnGPU&lt;&lt;&lt;32768, 512&gt;&gt;&gt;Time elapsed 0.002058 sec<br></code></pre></div></td></tr></table></figure><p>å¦‚æœè¿›ä¸€æ­¥å°†å—çš„ç»´åº¦é™ä½åˆ°256ï¼Œç³»ç»Ÿå°†æç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼Œä¿¡æ¯è¡¨ç¤ºå—çš„æ€»æ•°è¶…è¿‡ä¸€ç»´ç½‘æ ¼çš„é™åˆ¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">./sumArraysOnGPU-timer Starting...<br>Using Device 0:Tesla M2070<br>Vector size 16777216<br>sumArraysOnGPU&lt;&lt;&lt;65536, 256&gt;&gt;&gt;  Time elapsed 0.000183 sec<br>Error: sumArraysOnGPU-timer.cu:153, code:9, reason: invalid configuration argument<br></code></pre></div></td></tr></table></figure><h3 id="äº†è§£è‡ªèº«å±€é™æ€§"><a href="#äº†è§£è‡ªèº«å±€é™æ€§" class="headerlink" title="äº†è§£è‡ªèº«å±€é™æ€§"></a>äº†è§£è‡ªèº«å±€é™æ€§</h3><p>åœ¨è°ƒæ•´æ‰§è¡Œé…ç½®æ—¶éœ€è¦äº†è§£çš„ä¸€ä¸ªå…³é”®ç‚¹æ˜¯å¯¹ç½‘æ ¼å’Œå—ç»´åº¦çš„é™åˆ¶ã€‚çº¿ç¨‹å±‚æ¬¡ç»“æ„ä¸­æ¯ä¸ªå±‚æ¬¡çš„æœ€å¤§å°ºå¯¸å–å†³äºè®¾å¤‡ã€‚</p><p>CUDAæä¾›äº†é€šè¿‡æŸ¥è¯¢GPUæ¥äº†è§£è¿™äº›é™åˆ¶çš„èƒ½åŠ›ã€‚</p><p>å¯¹äºFermiè®¾å¤‡ï¼Œæ¯ä¸ªå—çš„æœ€å¤§çº¿ç¨‹æ•°æ˜¯1024ï¼Œä¸”ç½‘æ ¼çš„x,y,zä¸‰ä¸ªæ–¹å‘ä¸Šçš„ç»´åº¦æœ€å¤§å€¼æ˜¯65535</p><h3 id="ç”¨nvprofå·¥å…·è®¡æ—¶"><a href="#ç”¨nvprofå·¥å…·è®¡æ—¶" class="headerlink" title="ç”¨nvprofå·¥å…·è®¡æ—¶"></a>ç”¨nvprofå·¥å…·è®¡æ—¶</h3><p>è‡ªCUDA 5.0ä»¥æ¥ï¼ŒNVIDIAæä¾›äº†ä¸€ä¸ªåä¸ºnvprofçš„å‘½ä»¤è¡Œåˆ†æå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä»åº”ç”¨ç¨‹åºçš„CPUå’ŒGPUæ´»åŠ¨æƒ…å†µä¸­è·å–æ—¶é—´çº¿ä¿¡æ¯ï¼Œå…¶åŒ…æ‹¬å†…æ ¸æ‰§è¡Œï¼Œå†…å­˜ä¼ è¾“ä»¥åŠCUDA APIçš„è°ƒç”¨ã€‚å…¶ç”¨æ³•å¦‚ä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvprof [nvprof_args] &lt;application&gt;  [application_args]<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–æ›´å¤šå…³äºnvprofçš„å¸®åŠ©ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvprof --help<br></code></pre></div></td></tr></table></figure><p>ä½ å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤å»æµ‹è¯•å†…æ ¸ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvprof  ./sumArraysOnGPU-timer<br></code></pre></div></td></tr></table></figure><p>nvprofçš„è¾“å‡ºç»“æœä¼šå› ä¸ºä½ ä½¿ç”¨çš„GPUç±»å‹ä¸åŒè€Œæœ‰æ‰€å·®å¼‚ã€‚ä»¥ä¸‹ç»“æœæ˜¯ä»Tesla GPUä¸­å¾—åˆ°çš„ï¼š</p><p><img src="/2023/03/07/CUDA012/image-20230307142027522.png" alt="image-20230307142027522"></p><p>ä»¥ä¸Šç»“æœçš„å‰åŠéƒ¨åˆ†æ¥è‡ªäºç¨‹åºçš„è¾“å‡ºï¼ŒååŠéƒ¨åˆ†æ¥è‡ªäºnvprofçš„è¾“å‡ºã€‚å¯ä»¥æ³¨æ„åˆ°ï¼ŒCPUè®¡æ—¶å™¨æ˜¾ç¤ºæ¶ˆè€—çš„å†…æ ¸æ—¶é—´ä¸º3.26msï¼Œè€Œnvprofæ˜¾ç¤ºæ¶ˆè€—çš„å†…æ ¸æ—¶é—´ä¸º2.90msã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œnvprofçš„ç»“æœæ›´ä¸ºç²¾ç¡®ï¼Œå› ä¸ºCPUè®¡æ—¶å™¨æµ‹é‡çš„æ—¶é—´ä¸­åŒ…å«äº†æ¥è‡ªnvprofé™„åŠ çš„æ—¶é—´ã€‚</p><p>nvprofæ˜¯ä¸€ä¸ªèƒ½å¸®åŠ©ä½ ç†è§£åœ¨æ‰§è¡Œåº”ç”¨ç¨‹åºæ—¶æ‰€èŠ±è´¹çš„æ—¶é—´ä¸»è¦ç”¨åœ¨ä½•å¤„çš„å¼ºå¤§å·¥å…·ã€‚å¯ä»¥æ³¨æ„åˆ°ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“éœ€è¦çš„æ—¶é—´æ¯”å†…æ ¸æ‰§è¡Œçš„æ—¶é—´è¦å¤šã€‚å›¾2-8æ‰€æç»˜çš„æ—¶é—´çº¿ï¼ˆæœªæŒ‰æ¯”ä¾‹ç»˜åˆ¶ï¼‰ï¼Œæ˜¾ç¤ºäº†åœ¨CPUä¸Šæ¶ˆè€—çš„æ—¶é—´ï¼Œæ•°æ®ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ä»¥åŠåœ¨GPUä¸Šè®¡ç®—æ‰€ç”¨çš„æ—¶é—´ã€‚</p><p><img src="/2023/03/07/CUDA012/image-20230307145539161.png" alt="image-20230307145539161"></p><p>å¯¹äºHPCå·¥ä½œè´Ÿè½½ï¼Œç†è§£ç¨‹åºä¸­é€šä¿¡æ¯”çš„è®¡ç®—æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºç”¨äºè®¡ç®—çš„æ—¶é—´å¤§äºæ•°æ®ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ï¼Œé‚£ä¹ˆæˆ–è®¸å¯ä»¥å‹ç¼©è¿™äº›æ“ä½œï¼Œå¹¶å®Œå…¨éšè—ä¸ä¼ è¾“æ•°æ®æœ‰å…³çš„å»¶è¿Ÿã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºç”¨äºè®¡ç®—çš„æ—¶é—´å°‘äºæ•°æ®ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ï¼Œé‚£ä¹ˆéœ€è¦å°½é‡å‡å°‘ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„ä¼ è¾“ã€‚</p><h3 id="æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–"><a href="#æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–" class="headerlink" title="æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–"></a>æ¯”è¾ƒåº”ç”¨ç¨‹åºçš„æ€§èƒ½å°†ç†è®ºç•Œé™æœ€å¤§åŒ–</h3><p>åœ¨è¿›è¡Œç¨‹åºä¼˜åŒ–æ—¶ï¼Œå¦‚ä½•å°†åº”ç”¨ç¨‹åºå’Œç†è®ºç•Œé™è¿›è¡Œæ¯”è¾ƒæ˜¯å¾ˆé‡è¦çš„ã€‚ç”±nvprofå¾—åˆ°çš„è®¡æ•°å™¨å¯ä»¥å¸®åŠ©ä½ è·å–åº”ç”¨ç¨‹åºçš„æŒ‡ä»¤å’Œå†…å­˜ååé‡ã€‚å¦‚æœå°†åº”ç”¨ç¨‹åºçš„æµ‹é‡å€¼ä¸ç†è®ºå³°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¯ä»¥åˆ¤å®šä½ çš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½æ˜¯å—é™äºç®—æ³•è¿˜æ˜¯å—é™äºå†…å­˜å¸¦å®½çš„ã€‚ä»¥Tesla K10ä¸ºä¾‹ï¼Œå¯ä»¥å¾—åˆ°ç†è®ºä¸Šçš„æ¯”ç‡ï¼š</p><p>Tesla K10å•ç²¾åº¦å³°å€¼æµ®ç‚¹è¿ç®—æ¬¡æ•°</p><p>745 MHzæ ¸å¿ƒé¢‘ç‡*2 GPU&#x2F;èŠ¯ç‰‡*  ï¼ˆ8ä¸ªå¤šå¤„ç†å™¨<em>192ä¸ªæµ®ç‚¹å•å…ƒ</em>32æ ¸å¿ƒ&#x2F;å¤šå¤„ç†å™¨ï¼‰*2OPS&#x2F;å‘¨æœŸ &#x3D; 4.58 TFLOPS ï¼ˆFLOPSè¡¨ç¤ºæ¯ç§’æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼‰</p><p>Tesla K10å†…å­˜å¸¦å®½å³°å€¼</p><p>2 GPU&#x2F;èŠ¯ç‰‡<em>256ä½</em>2500 MHzå†…å­˜æ—¶é’Ÿ*2 DDR&#x2F;8ä½&#x2F;å­—èŠ‚ &#x3D; 320 GB&#x2F;s</p><p>æŒ‡ä»¤æ¯”ï¼šå­—èŠ‚</p><p>4.58 TFLOPS&#x2F;320 GB&#x2F;s,ä¹Ÿå°±æ˜¯13.6ä¸ªæŒ‡ä»¤ï¼š1ä¸ªå­—èŠ‚</p><p>å¯¹äºTesla K10è€Œè¨€ï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ¯è®¿é—®ä¸€ä¸ªå­—èŠ‚æ‰€äº§ç”Ÿçš„æŒ‡ä»¤æ•°å¤šäº13.6ï¼Œé‚£ä¹ˆä½ çš„åº”ç”¨ç¨‹åºå—ç®—æ³•æ€§èƒ½é™åˆ¶ã€‚å¤§å¤šæ•°HPCå·¥ä½œè´Ÿè½½å—å†…å­˜å¸¦å®½çš„é™åˆ¶ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§å›å½’æ¨¡å‹</title>
    <link href="/2023/03/06/ML001/"/>
    <url>/2023/03/06/ML001/</url>
    
    <content type="html"><![CDATA[<h2 id="çº¿æ€§å›å½’æ¨¡å‹"><a href="#çº¿æ€§å›å½’æ¨¡å‹" class="headerlink" title="çº¿æ€§å›å½’æ¨¡å‹"></a>çº¿æ€§å›å½’æ¨¡å‹</h2><h3 id="MOdel-Representation"><a href="#MOdel-Representation" class="headerlink" title="MOdel Representation"></a>MOdel Representation</h3><p><img src="/2023/03/06/ML001/image-20230306195956356.png" alt="image-20230306195956356"></p><h3 id="Goals"><a href="#Goals" class="headerlink" title="Goals"></a>Goals</h3><p>In this lab you will:</p><ul><li>learn to implement the model f_{w,b} for linear regression with one variable</li></ul><h3 id="Notation"><a href="#Notation" class="headerlink" title="Notation"></a>Notation</h3><p>Here is a summary of some of the notation you will encounter.</p><p><img src="/2023/03/06/ML001/image-20230306200250050.png" alt="image-20230306200250050"></p><h3 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h3><p>In this lab you will make use of:</p><ul><li><p>NumPy,a popular library for scientific computing</p></li><li><p>Matplotlib,a popular library for plotting data</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>plt.style.use(<span class="hljs-string">&#x27;./deeplearning.mpstyle&#x27;</span>)<br></code></pre></div></td></tr></table></figure></li></ul><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p><img src="/2023/03/06/ML001/image-20230306200642937.png" alt="image-20230306200642937"></p><p>As in the lecture,you will use the motivating example of housing price prediction. This lab will use a simple data set with only two data points - a house with 1000 square feet(sqft) sold for $300,000 and a house with 2000 square feet sold for $500,000.These two points will constitute our data or training set. In this lab, the units of size are 1000 sqft and the units of price are 1000s of dollars.</p><table><thead><tr><th>Size (1000 sqft)</th><th>Price (1000s of dollars)</th></tr></thead><tbody><tr><td>1.0</td><td>300</td></tr><tr><td>2.0</td><td>500</td></tr></tbody></table><p>You would like to fit a linear regression model(shown above as the blue straight line)through these two points, so you can then predict price for other houses - say, a house with 1200 sqft.</p><p>Please run the following code cell to create your x_train and y_train variables. The data is stored in one-dimensional NumPy arrays.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#x_train is the input variable (size in 1000 square feet)</span><br><span class="hljs-comment">#y_train is the target (price in 1000s of dollars)</span><br>x_train = np.array([<span class="hljs-number">1.0</span>,<span class="hljs-number">2.0</span>])<br>y_train = np.array([<span class="hljs-number">300.0</span>,<span class="hljs-number">500.0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;x_train = <span class="hljs-subst">&#123;x_train&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;y_train = <span class="hljs-subst">&#123;y_train&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure><h3 id="Number-of-training-examples-m"><a href="#Number-of-training-examples-m" class="headerlink" title="Number of training examples m"></a>Number of training examples m</h3><p>you will use m to denote the number of training examples. Numpy arrays have a .shape parameter. x_train.shape return a python tuple with an entry for each dimension. x_train.shape[0] is the length of the array and number of examples as shown below.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># m is the number of training examples</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;x_train.shape: <span class="hljs-subst">&#123;x_train.shape&#125;</span>&quot;</span>)<br>m = x_train.shape[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Number of training example is: <span class="hljs-subst">&#123;m&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure><p>x.train.shape: (2,)</p><p>Number of training examples is: 2</p><p><strong>One can also use the Python len() function as shown below.</strong></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># m is the number of training examples</span><br>m = <span class="hljs-built_in">len</span>(x_train)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Number of training example is: <span class="hljs-subst">&#123;m&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure><p>Number of training examples  is:2</p><h3 id="Training-example-x-i-y-i"><a href="#Training-example-x-i-y-i" class="headerlink" title="Training example x_i, y_i"></a>Training example x_i, y_i</h3><p>You will use (x(ğ‘–), y(ğ‘–)) to denote the ğ‘–(th) training example. Since Python is zero indexed, (x(0), y(0) is (1.0, 300.0) and (x(1), y(1) is (2.0, 500.0).</p><p>To access a value in a Numpy array, one indexes the array with the desired offset. For example the syntax to access location zero of x_train is x_train[0]. Run the next code block below to get the i(th) training example.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">i = <span class="hljs-number">0</span> <span class="hljs-comment">#Change this to 1 to see (x^1,y^1)</span><br><br>x_i = x_train[i]<br>y_i = y_train[i]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;(x^(<span class="hljs-subst">&#123;i&#125;</span>), y^(<span class="hljs-subst">&#123;i&#125;</span>)) = (<span class="hljs-subst">&#123;x_i&#125;</span>, <span class="hljs-subst">&#123;y_i&#125;</span>)&quot;</span>)<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">(x^(<span class="hljs-number">0</span>), y^(<span class="hljs-number">0</span>)) = (<span class="hljs-number">1.0</span>, <span class="hljs-number">300.0</span>)<br></code></pre></div></td></tr></table></figure><h3 id="Plotting-the-data"><a href="#Plotting-the-data" class="headerlink" title="Plotting the data"></a>Plotting the data</h3><p>You can plot these two points using the scatter() function is the matplotlib library,as shown in the cell below.</p><ul><li>The function arguments marker and c show the points as red crosses(the default is blue dots.)</li></ul><p>You can use other functions in the matplotlib library to set title and labels to display.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#Plot the data points</span><br>plt.scatter(x_train, y_train, marker=<span class="hljs-string">&#x27;x&#x27;</span> c=<span class="hljs-string">&#x27;r&#x27;</span>)<br><span class="hljs-comment">#Set the title</span><br>plt.title(<span class="hljs-string">&quot;Housing Prices&quot;</span>)<br><span class="hljs-comment">#Set the y-axis label</span><br>plt.ylabel(<span class="hljs-string">&#x27;Price (in 1000s of dollars)&#x27;</span>)<br><span class="hljs-comment">#Set the x-axis lbel</span><br>plt.xlabel(<span class="hljs-string">&#x27;Size (1000 sqft)&#x27;</span>)<br>plt.show()<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/06/ML001/image-20230306204822102.png" alt="image-20230306204822102"></p><h3 id="Model-function"><a href="#Model-function" class="headerlink" title="Model function"></a>Model function</h3><p><img src="/2023/03/06/ML001/image-20230306204918585.png" alt="image-20230306204918585"></p><p>As described in lecture, the model function for linear regression (which is a function that maps from x to y)is represented as</p><p><img src="/2023/03/06/ML001/image-20230306205107527.png" alt="image-20230306205107527"></p><p>The formula above is how you can represent straight lines - different values of w and b give you different straight lines on the plot.</p><p>Letâ€™s try to get a better intuition for this through the code blocks below. Letâ€™s start with w &#x3D; 100 and b &#x3D;100.</p><p>Note: You can come back to this cell to adjust the modelâ€™s w and b parameters.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">w = <span class="hljs-number">100</span><br>b = <span class="hljs-number">100</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;w: <span class="hljs-subst">&#123;w&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;b: <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">w:<span class="hljs-number">100</span><br>b:<span class="hljs-number">100</span><br></code></pre></div></td></tr></table></figure><p>Now,letâ€™s compute the value of f_{w,b}(x^i) for your two data points. You can explicitly write this out for each data poins as -</p><p>for x(0),f_wb &#x3D; w * x[0] + b</p><p>for x(1),f_wb &#x3D; w * x[1] + b</p><p>For a large number of data points, this can get unwieldy and repetitive. So instead, you can calculate the function output in a for loop as shown in the compute_model_output function below.</p><p>Note:The argument description (ndarray (m,)) describes a Numpy n-dimensional array of shape (m,). (scalar) describes an argument without dimensions, just a magnitude.</p><p>Note: np.zero(n) will return a one-dimensional numpy array with n entries</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_model_output</span>(<span class="hljs-params">x, w, b</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Computes the prediction of a linear model</span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">    x (ndarray (m,)):Data, m examples</span><br><span class="hljs-string">    w,b (scalar):model parameters</span><br><span class="hljs-string">    Returns</span><br><span class="hljs-string">    y (ndarray (m,)):target values</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <br>    m = x.shape[<span class="hljs-number">0</span>]<br>    f_wb = np.zeros(m)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)<br>    f_wb[i] = w * x[i] + b<br>    <br>    <span class="hljs-keyword">return</span> f_wb<br></code></pre></div></td></tr></table></figure><p>Now letâ€™s call the compute_model_output function and plot the output.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">tmp_f_wb = compute_model_output(x_train, w, b,)<br><br><span class="hljs-comment">#Plot our model prediction</span><br>plt.plot(x_train, tmp_f_wb, c=<span class="hljs-string">&#x27;b&#x27;</span>,label=<span class="hljs-string">&#x27;Our Prediction&#x27;</span>)<br><br><span class="hljs-comment">#Plot the data points</span><br>plt.scatter(x_train, y_train, marker=<span class="hljs-string">&#x27;x&#x27;</span>, c=<span class="hljs-string">&#x27;r&#x27;</span>,label=<span class="hljs-string">&#x27;Actual Values&#x27;</span>)<br><br><span class="hljs-comment">#Set the title</span><br>plt.title(<span class="hljs-string">&quot;Housing Prices&quot;</span>)<br><span class="hljs-comment">#Set the y-axis label</span><br>plt.ylabel(<span class="hljs-string">&#x27;Price (in 1000s of dollars)&#x27;</span>)<br><span class="hljs-comment">#Set the x-axis label</span><br>plt.xlabel(<span class="hljs-string">&#x27;Size (1000 sqft)&#x27;</span>)<br>plt.legend()<br>plt.show()<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/06/ML001/image-20230306211337338.png" alt="image-20230306211337338"></p><p>As you can see, setting w &#x3D; 100 and b &#x3D; 100 does not result in a line that fits our data.</p><h3 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h3><p>Try experimenting with different values of w and b. What should the values be for a line that fits our data?</p><p><strong>Tips:</strong></p><p>You can use  your mouse to click on the triangle to the left of the green â€œHintsâ€ below to reveal some hints for choosing b and w.</p><p><strong>Hints</strong></p><h3 id="Prediction"><a href="#Prediction" class="headerlink" title="Prediction"></a>Prediction</h3><p>Now that we have a model, we can use it to make our original prediction. Letâ€™s predict the price of a house with 1200 sqft. Since the units of x are in 1000â€™s of sqft, x is 1.2.</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">w = <span class="hljs-number">200</span><br>b = <span class="hljs-number">100</span><br>x_i = <span class="hljs-number">1.2</span><br>cost_1200sqft = w * x_i + b<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;$<span class="hljs-subst">&#123;cost_1200sqft:<span class="hljs-number">.0</span>f&#125;</span> thousand dollars&quot;</span> )<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">$<span class="hljs-number">340</span> thousand dollars<br></code></pre></div></td></tr></table></figure><h3 id="Congratulations"><a href="#Congratulations" class="headerlink" title="Congratulations!"></a>Congratulations!</h3><p>In this lab you have learned:</p><ul><li>Linear regression bulids a model which establishes a relationship between features and targets</li><li>In the example above, the feature was house size and the target was house price</li><li>for simple linear regression, the model has two parameters w and b whose calue are â€˜fitâ€™ using training data.</li><li>once a modelâ€™s parameters have been determined, the model can be used to make predictions on novel data.</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797">https://www.bilibili.com/video/BV1Pa411X76s?p=5&amp;vd_source=3ae32e36058f58c5b85935fca9b77797</a></p><p><a href="https://github.com/kaieye/2022-Machine-Learning-Specialization">kaieye&#x2F;2022-Machine-Learning-Specialization (github.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tensorflow</tag>
      
      <tag>Machine Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç¼–è¯‘ä¸æ‰§è¡Œ</title>
    <link href="/2023/03/06/cuda011/"/>
    <url>/2023/03/06/cuda011/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAç¼–è¯‘ä¸æ‰§è¡Œ"><a href="#CUDAç¼–è¯‘ä¸æ‰§è¡Œ" class="headerlink" title="CUDAç¼–è¯‘ä¸æ‰§è¡Œ"></a>CUDAç¼–è¯‘ä¸æ‰§è¡Œ</h2><p>ç°åœ¨æŠŠæ‰€æœ‰çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶åä¸ºsumArraysOnGPU-small-case.cuçš„æ–‡ä»¶ä¸­ï¼Œå¦‚ä»£ç æ¸…å•2-4æ‰€ç¤ºã€‚</p><p><strong>ä»£ç æ¸…å•2-4åŸºäºGPUçš„å‘é‡åŠ æ³•ï¼ˆsumArraysOnGPU-small-case.cuï¼‰</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cuda_runtime.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">#define CHECK(call)</span><br><span class="hljs-comment">&#123;</span><br><span class="hljs-comment">    const cudaError_t error = call;</span><br><span class="hljs-comment">    if(error != cudaSuccess)</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        printf(&quot;Error:%s:%d, &quot;, __FILE__, __LINE__);</span><br><span class="hljs-comment">        printf(&quot;code:%d, reason: %s\n&quot;, error, cudaGetErrorString(error));</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkResult</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *hostRef, <span class="hljs-keyword">float</span> *gpuRef, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N)</span></span>&#123;<br>    <span class="hljs-keyword">double</span> epsilon = <span class="hljs-number">1.0E-8</span>;<br>    <span class="hljs-keyword">int</span> match = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ;i &lt; N; i++)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(hostRef[i] - gpuRef[i]) &gt; epsilon)&#123;<br>            match = <span class="hljs-number">0</span>;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Arrays do not match!\n&quot;</span>);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;host %5.2f gpu %5.2f at current %d\n&quot;</span>,hostRef[i],gpuRef[i],i);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(match) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Arrays match.\n\n&quot;</span>);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initialData</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *ip,<span class="hljs-keyword">int</span> size)</span></span>&#123;<br>    <span class="hljs-comment">//generate different seed for random number</span><br>    <span class="hljs-keyword">time_t</span> t;<br>    <span class="hljs-built_in">srand</span>((<span class="hljs-keyword">unsigned</span>) <span class="hljs-built_in">time</span>(&amp;t));<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i&lt;size;i++)&#123;<br>        ip[i] = (<span class="hljs-keyword">float</span>)(<span class="hljs-built_in">rand</span>() &amp; <span class="hljs-number">0xFF</span>) /<span class="hljs-number">10.0f</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sumArraysOnHost</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A,<span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> i = threadIdx.x;<br>    C[i] = A[i] + B[i];<br>&#125;<br><br><span class="hljs-function">__gloal__ <span class="hljs-keyword">void</span> <span class="hljs-title">sumArraysOnGPU</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> i = threadIdx.x;<br>    C[i] = A[i] + B[i];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s Starting...\n&quot;</span>,argv[<span class="hljs-number">0</span>]);<br>    <br>    <span class="hljs-comment">//set up device</span><br>    <span class="hljs-keyword">int</span> dev = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">cudaSetDevice</span>(dev);<br>    <br>    <span class="hljs-comment">//set up data size of vectors</span><br>    <span class="hljs-keyword">int</span> nElem = <span class="hljs-number">32</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Vector size %d\n&quot;</span>,nElem);<br>    <br>    <span class="hljs-comment">//malloc host memory</span><br>    <span class="hljs-keyword">size_t</span> nBytes = nElem * <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>);<br>    <br>    <span class="hljs-keyword">float</span> *h_A, *h_B, *hostRef, *gpuRef;<br>    h_A = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    h_B = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    hostRef = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    gpuRef = (<span class="hljs-keyword">float</span>*)<span class="hljs-built_in">malloc</span>(nBytes);<br>    <br>    <span class="hljs-comment">//initialize data at host side</span><br>    <span class="hljs-built_in">initialData</span>(h_A, nElem);<br>    <span class="hljs-built_in">initialData</span>(h_B, nElem);<br>    <br>    <span class="hljs-built_in">memset</span>(hostRef, <span class="hljs-number">0</span> ,nBytes);<br>    <span class="hljs-built_in">memset</span>(gpuRef, <span class="hljs-number">0</span> ,nBytes);<br>    <br>    <span class="hljs-comment">//malloc device global memory</span><br>    <span class="hljs-keyword">float</span> *d_A, *d_B, *d_C;<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_A, nBytes);<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_B, nBytes);<br>    <span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_C, nBytes);<br>    <br>    <span class="hljs-comment">//transfer data from host to device</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(d_A, h_A, nBytes, cudaMemcpyHostTodevice);<br>    <span class="hljs-built_in">cudaMemcpy</span>(d_B, h_B, nBytes, cudaMemcpyHostTodevice);<br>    <br>    <span class="hljs-comment">//invoke kernel at host side</span><br>    <span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(nElem)</span></span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">(nElem/block.x)</span></span>;<br>    <br>    sumArraysOnGPU&lt;&lt;&lt;grid,block&gt;&gt;&gt;(d_A, d_B, d_C);<br>    <span class="hljs-built_in">pritnf</span>(<span class="hljs-string">&quot;Execution configuration &lt;&lt;&lt;%d, %d&gt;&gt;&gt;\n&quot;</span>,grid.x,block.x);<br>    <br>    <span class="hljs-comment">//copy kernel result back to host side</span><br>    <span class="hljs-built_in">cudaMemcpy</span>(gpuRef, d_C, nBytes, cudaMemcpyDeviceToHost);<br>    <br>    <span class="hljs-comment">//add vector at host side for result checks</span><br>    <span class="hljs-built_in">sumArraysOnHost</span>(h_A, h_B, hostRef, nElem);<br>    <br>    <span class="hljs-comment">//check device results</span><br>    <span class="hljs-built_in">checkResult</span>(hostRef, gpuRef, nElem);<br>    <br>    <span class="hljs-comment">//free device global memory</span><br>    <span class="hljs-built_in">cudaFree</span>(d_A);<br>    <span class="hljs-built_in">cudaFree</span>(d_B);<br>    <span class="hljs-built_in">cudaFree</span>(d_C);<br>    <br>    <span class="hljs-comment">//free host memory</span><br>    <span class="hljs-built_in">free</span>(h_A);<br>    <span class="hljs-built_in">free</span>(h_B);<br>    <span class="hljs-built_in">free</span>(hostRef);<br>    <span class="hljs-built_in">free</span>(gpuRef);<br>    <br>    <span class="hljs-keyword">return</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå‘é‡å¤§å°è¢«è®¾ç½®ä¸º32ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> nElem = <span class="hljs-number">32</span>;<br></code></pre></div></td></tr></table></figure><p>æ‰§è¡Œé…ç½®è¢«æ”¾å…¥ä¸€ä¸ªå—å†…ï¼Œå…¶ä¸­åŒ…å«32ä¸ªå…ƒç´ ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(nElem)</span></span>;<br><span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">(nElem/block.x)</span></span>;<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘å’Œæ‰§è¡Œè¯¥å¸¦å•Šå—ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc sumArraysOnGPU-small-case.cu -o addvector<br>./addvector<br></code></pre></div></td></tr></table></figure><p>ç³»ç»ŸæŠ¥å‘Šå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">./addvector Starting...<br>Vector size 32<br>Execution configuration &lt;&lt;&lt;1,32&gt;&gt;&gt;<br>Arrays match.<br></code></pre></div></td></tr></table></figure><p>å¦‚æœä½ å°†æ‰§è¡Œé…ç½®é‡æ–°å®šä¹‰ä¸º32ä¸ªå—ï¼Œæ¯ä¸ªå—åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼›</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>;<br><span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">(nElem)</span></span>;<br></code></pre></div></td></tr></table></figure><p>é‚£ä¹ˆå°±éœ€è¦åœ¨ä»£ç æ¸…å•2-4ä¸­å¯¹æ ¸å‡½æ•°sumArraysOnGPUè¿›è¡Œä¿®æ”¹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">ç”¨<span class="hljs-keyword">int</span> i = threadIdx.x;    æ›¿æ¢<span class="hljs-keyword">int</span> i = blockIdx.x;<br></code></pre></div></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥åŸºäºç»™å®šçš„ä¸€ç»´ç½‘æ ¼å’Œå—çš„ä¿¡æ¯æ¥è®¡ç®—å…¨å±€æ•°æ®è®¿é—®çš„å”¯ä¸€ç´¢å¼•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">__gloal__ <span class="hljs-keyword">void</span> <span class="hljs-title">sumArraysOnGPU</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> i = blockIdx.x * blockDim.x * threadIdx.x;<br>    C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä½ éœ€è¦ç¡®ä¿ä¸€èˆ¬æƒ…å†µä¸‹è¿›è¡Œæ›´æ”¹æ‰€äº§ç”Ÿç»“æœçš„æ­£ç¡®æ€§ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAå¤„ç†é”™è¯¯</title>
    <link href="/2023/03/06/cuda010/"/>
    <url>/2023/03/06/cuda010/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAå¤„ç†é”™è¯¯"><a href="#CUDAå¤„ç†é”™è¯¯" class="headerlink" title="CUDAå¤„ç†é”™è¯¯"></a>CUDAå¤„ç†é”™è¯¯</h2><p>ç”±äºè®¸å¤šCUDAè°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æœ‰æ—¶å¯èƒ½å¾ˆéš¾ç¡®å®šæŸä¸ªé”™è¯¯æ˜¯ç”±å“ªä¸€æ­¥ç¨‹åºå¼•èµ·çš„ã€‚å®šä¹‰ä¸€ä¸ªé”™è¯¯å¤„ç†å®å°è£…æ‰€æœ‰çš„CUDA APIè°ƒç”¨ï¼Œè¿™ç®€åŒ–äº†é”™è¯¯æ£€æŸ¥è¿‡ç¨‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CHECK(call)</span><br>&#123;<br>    <span class="hljs-keyword">const</span> cudaError_t error = call;<br>    <span class="hljs-keyword">if</span>(error != cudaSuccess)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error:%s:%d, &quot;</span>, __FILE__, __LINE__);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;code:%d, reason: %s\n&quot;</span>, error, <span class="hljs-built_in">cudaGetErrorString</span>(error));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ä»¥ä¸‹ä»£ç ä¸­ä½¿ç”¨å®ï¼š</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml"><span class="hljs-constructor">CHECK(<span class="hljs-params">cudaMemcpy</span>(<span class="hljs-params">d_C</span>, <span class="hljs-params">gpuRef</span>, <span class="hljs-params">nBytes</span>, <span class="hljs-params">cudaMemcpyHostToDevice</span>)</span>);<br></code></pre></div></td></tr></table></figure><p>å¦‚æœå†…å­˜æ‹·è´æˆ–ä¹‹å‰çš„å¼‚æ­¥æ“ä½œäº§ç”Ÿäº†é”™è¯¯ï¼Œè¿™ä¸ªå®ä¼šæŠ¥å‘Šé”™è¯¯ä»£ç ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªå¯è¯»ä¿¡æ¯ï¼Œç„¶ååœæ­¢ç¨‹åºã€‚ä¹Ÿå¯ä»¥ç”¨ä¸‹è¿°æ–¹æ³•ï¼Œåœ¨æ ¸å‡½æ•°è°ƒç”¨åæ£€æŸ¥æ ¸å‡½æ•°é”™è¯¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">kernel_function&lt;&lt;&lt;grid,block&gt;&gt;&gt;(argument list);<br><span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">cudaDeviceSynchronize</span>());<br></code></pre></div></td></tr></table></figure><p>CHECK(cudaDeviceSynchronize())ä¼šé˜»å¡ä¸»æœºç«¯çº¿ç¨‹çš„è¿è¡Œç›´åˆ°è®¾å¤‡ç«¯æ‰€æœ‰çš„è¯·æ±‚ä»»åŠ¡éƒ½ç»“æŸï¼Œå¹¶ç¡®ä¿æœ€åçš„æ ¸å‡½æ•°å¯åŠ¨éƒ¨åˆ†ä¸ä¼šå‡ºé”™ã€‚ä»¥ä¸Šä»…æ˜¯ä»¥è°ƒè¯•ä¸ºç›®çš„çš„ï¼Œå› ä¸ºåœ¨æ ¸å‡½æ•°å¯åŠ¨åæ·»åŠ è¿™ä¸ªæ£€æŸ¥ç‚¹ä¼šé˜»å¡ä¸»æœºç«¯çº¿ç¨‹ï¼Œä½¿è¯¥æ£€æŸ¥ç‚¹æˆä¸ºå…¨å±€å±éšœã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAéªŒè¯æ ¸å‡½æ•°</title>
    <link href="/2023/03/06/cuda009/"/>
    <url>/2023/03/06/cuda009/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAéªŒè¯æ ¸å‡½æ•°"><a href="#CUDAéªŒè¯æ ¸å‡½æ•°" class="headerlink" title="CUDAéªŒè¯æ ¸å‡½æ•°"></a>CUDAéªŒè¯æ ¸å‡½æ•°</h2><p>æ—¢ç„¶ä½ å·²ç»ç¼–å†™äº†æ ¸å‡½æ•°ï¼Œä½ å¦‚ä½•èƒ½çŸ¥é“å®ƒæ˜¯å¦æ­£ç¡®è¿è¡Œï¼Ÿä½ éœ€è¦ä¸€ä¸ªä¸»æœºå‡½æ•°æ¥éªŒè¯æ ¸å‡½æ•°çš„ç»“æœã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkResult</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *hostRef, <span class="hljs-keyword">float</span> *gpuRef, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N)</span></span>&#123;<br>    <span class="hljs-keyword">double</span> epsilon = <span class="hljs-number">1.0E-8</span>;<br>    <span class="hljs-keyword">int</span> match = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span> ;i &lt; N; i++)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(hostRef[i] - gpuRef[i]) &gt; epsilon)&#123;<br>            match = <span class="hljs-number">0</span>;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Arrays do not match!\n&quot;</span>);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;host %5.2f gpu %5.2f at current %d\n&quot;</span>,hostRef[i],gpuRef[i],i);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(match) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Arrays match.\n\n&quot;</span>);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="éªŒè¯æ ¸å‡½æ•°ä»£ç "><a href="#éªŒè¯æ ¸å‡½æ•°ä»£ç " class="headerlink" title="éªŒè¯æ ¸å‡½æ•°ä»£ç "></a>éªŒè¯æ ¸å‡½æ•°ä»£ç </h3><p>é™¤äº†è®¸å¤šå¯ç”¨çš„è°ƒè¯•å·¥å…·å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªéå¸¸ç®€å•å®ç”¨çš„æ–¹æ³•å¯ä»¥éªŒè¯æ ¸å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œä½ å¯ä»¥åœ¨FermiåŠæ›´é«˜ç‰ˆæœ¬çš„è®¾å¤‡ç«¯çš„æ ¸å‡½æ•°ä¸­ä½¿ç”¨printfå‡½æ•°ã€‚</p><p>å…¶æ¬¡ï¼Œå¯ä»¥å°†æ‰§è¡Œå‚æ•°è®¾ç½®ä¸º&lt;&lt;&lt;1,1&gt;&gt;&gt;ï¼Œå› æ­¤å¼ºåˆ¶ç”¨ä¸€ä¸ªå—å’Œä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ ¸å‡½æ•°ï¼Œè¿™æ¨¡æ‹Ÿäº†ä¸²è¡Œæ‰§è¡Œç¨‹åºã€‚è¿™å¯¹äºè°ƒè¯•å’ŒéªŒè¯ç»“æœæ˜¯å¦æ­£ç¡®æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œè€Œä¸”ï¼Œå¦‚æœä½ é‡åˆ°äº†è¿ç®—æ¬¡åºçš„é—®é¢˜ï¼Œè¿™æœ‰åŠ©äºä½ å¯¹æ¯”éªŒè¯æ•°å€¼ç»“æœæ˜¯å¦æ˜¯æŒ‰ä½ç²¾ç¡®çš„ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç¼–å†™æ ¸å‡½æ•°</title>
    <link href="/2023/03/06/cuda008/"/>
    <url>/2023/03/06/cuda008/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¼–å†™æ ¸å‡½æ•°"><a href="#ç¼–å†™æ ¸å‡½æ•°" class="headerlink" title="ç¼–å†™æ ¸å‡½æ•°"></a>ç¼–å†™æ ¸å‡½æ•°</h2><p>æ ¸å‡½æ•°æ˜¯åœ¨è®¾å¤‡ç«¯æ‰§è¡Œçš„ä»£ç ã€‚åœ¨æ ¸å‡½æ•°ä¸­ï¼Œéœ€è¦ä¸ºä¸€ä¸ªçº¿ç¨‹è§„å®šè¦è¿›è¡Œçš„è®¡ç®—ä»¥åŠè¦è¿›è¡Œçš„æ•°æ®è®¿é—®ã€‚å½“æ ¸å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè®¸å¤šä¸åŒçš„CUDAçº¿ç¨‹å¹¶è¡Œæ‰§è¡ŒåŒä¸€ä¸ªè®¡ç®—ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯ç”¨_<em>global</em>_</p><p>å£°æ˜å®šä¹‰æ ¸å‡½æ•°ï¼š</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">__global__  void kernel<span class="hljs-constructor">_name(<span class="hljs-params">argument</span> <span class="hljs-params">list</span>)</span>;<br></code></pre></div></td></tr></table></figure><p>æ ¸å‡½æ•°å¿…é¡»æœ‰ä¸€ä¸ªvoidè¿”å›ç±»å‹ã€‚</p><p>è¡¨2-2æ€»ç»“äº†CUDA Cç¨‹åºä¸­çš„å‡½æ•°ç±»å‹é™å®šç¬¦ã€‚å‡½æ•°ç±»å‹é™å®šç¬¦æŒ‡å®šä¸€ä¸ªå‡½æ•°åœ¨ä¸»æœºä¸Šæ‰§è¡Œè¿˜æ˜¯åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œï¼Œä»¥åŠå¯è¢«ä¸»æœºè°ƒç”¨è¿˜æ˜¯è¢«è®¾å¤‡è°ƒç”¨ã€‚</p><p><img src="/2023/03/06/cuda008/image-20230306155126122.png" alt="image-20230306155126122"></p><p>_<em>device</em>_   å’Œ __host__é™å®šç¬¦å¯ä»¥ä¸€é½ä½¿ç”¨ï¼Œè¿™æ ·å‡½æ•°å¯ä»¥åŒæ—¶åœ¨ä¸»æœºå’Œè®¾å¤‡ç«¯è¿›è¡Œç¼–è¯‘ã€‚</p><h3 id="CUDAæ ¸å‡½æ•°çš„é™åˆ¶"><a href="#CUDAæ ¸å‡½æ•°çš„é™åˆ¶" class="headerlink" title="CUDAæ ¸å‡½æ•°çš„é™åˆ¶"></a>CUDAæ ¸å‡½æ•°çš„é™åˆ¶</h3><p>ä»¥ä¸‹é™åˆ¶é€‚ç”¨äºæ‰€æœ‰æ ¸å‡½æ•°ï¼š</p><ul><li>åªèƒ½è®¿é—®è®¾å¤‡å†…å­˜</li><li>å¿…é¡»å…·æœ‰voidè¿”å›ç±»å‹</li><li>ä¸æ”¯æŒå¯å˜æ•°é‡çš„å‚æ•°</li><li>ä¸æ”¯æŒé™æ€å˜é‡</li><li>æ˜¾ç¤ºå¼‚æ­¥è¡Œä¸º</li></ul><p>è€ƒè™‘ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šå°†ä¸¤ä¸ªå¤§å°ä¸ºNçš„å‘é‡Aå’ŒBç›¸åŠ ï¼Œä¸»æœºç«¯çš„å‘é‡åŠ æ³•Cä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sumArrayOnHost</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i &lt; N; i++)<br>        C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªè¿­ä»£Næ¬¡çš„ä¸²è¡Œç¨‹åºï¼Œå¾ªç¯ç»“æŸåå°†äº§ç”Ÿä»¥ä¸‹æ ¸å‡½æ•°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">sumArrayOnHost</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> i = threadIdx.x;<br>        C[i] = A[i] + B[i];<br>&#125;<br></code></pre></div></td></tr></table></figure><p>Cå‡½æ•°å’Œæ ¸å‡½æ•°ä¹‹é—´æœ‰ä»€ä¹ˆä¸åŒï¼Ÿä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°å¾ªç¯ä½“æ¶ˆå¤±äº†ï¼Œå†…ç½®çš„çº¿ç¨‹åæ ‡å˜é‡æ›¿æ¢äº†æ•°ç»„ç´¢å¼•ï¼Œç”±äºNæ˜¯è¢«éšå¼å®šä¹‰ç”¨æ¥å¯åŠ¨Nä¸ªçº¿ç¨‹çš„ï¼Œæ‰€ä»¥Næ²¡æœ‰ä»€ä¹ˆå‚è€ƒä»·å€¼ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸º32ä¸ªå…ƒç´ çš„å‘é‡ï¼Œä½ å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹æ³•ç”¨32ä¸ªçº¿ç¨‹æ¥è°ƒç”¨æ ¸å‡½æ•°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">sumArraysOnGPU&lt;&lt;&lt;<span class="hljs-number">1</span>,<span class="hljs-number">32</span>&gt;&gt;&gt;(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C);<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°</title>
    <link href="/2023/03/06/cuda007/"/>
    <url>/2023/03/06/cuda007/</url>
    
    <content type="html"><![CDATA[<h2 id="å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°"><a href="#å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°" class="headerlink" title="å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°"></a>å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°</h2><p>ä½ åº”è¯¥å¯¹ä¸‹åˆ—Cè¯­è¨€å‡½æ•°è°ƒç”¨è¯­å¥å¾ˆç†Ÿæ‚‰ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">function_name</span> (argument list);<br></code></pre></div></td></tr></table></figure><p>CUDAå†…æ ¸è°ƒç”¨æ˜¯å¯¹Cè¯­è¨€å‡½æ•°è°ƒç”¨è¯­å¥çš„å»¶ç”³ï¼Œ&lt;&lt;&lt;&gt;&gt;&gt;è¿ç®—ç¬¦å†…æ˜¯æ ¸å‡½æ•°çš„æ‰§è¡Œé…ç½®ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">kerbel_name&lt;&lt;&lt;grid,block&gt;&gt;&gt;(srgument list);<br></code></pre></div></td></tr></table></figure><p>æ­£å¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ï¼ŒCUDAç¼–ç¨‹æ¨¡å‹æ­ç¤ºäº†çº¿ç¨‹å±‚æ¬¡ç»“æ„ã€‚åˆ©ç”¨æ‰§è¡Œé…ç½®å¯ä»¥æŒ‡å®šçº¿ç¨‹åœ¨GPUä¸Šè°ƒåº¦è¿è¡Œçš„æ–¹å¼ã€‚æ‰§è¡Œé…ç½®çš„ç¬¬ä¸€ä¸ªå€¼æ˜¯ç½‘æ ¼ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨å—çš„æ•°ç›®ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯å—ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå—ä¸­çº¿ç¨‹çš„æ•°ç›®ã€‚é€šè¿‡æŒ‡å®šç½‘æ ¼å’Œå—çš„ç»´åº¦ï¼Œä½ å¯ä»¥è¿›è¡Œä¸€ä¸‹é…ç½®ï¼š</p><ul><li>å†…æ ¸ä¸­çº¿ç¨‹çš„æ•°ç›®</li><li>å†…æ ¸ä¸­ä½¿ç”¨çš„çº¿ç¨‹å¸ƒå±€</li></ul><p>åŒä¸€ä¸ªå—ä¸­çš„çº¿ç¨‹ä¹‹é—´å¯ä»¥ç›¸äº’åä½œï¼Œä¸åŒå—å†…çš„çº¿ç¨‹ä¸èƒ½åä½œã€‚å¯¹äºä¸€ä¸ªç»™å®šçš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ç½‘æ ¼å’Œå—å¸ƒå±€æ¥ç»„ç»‡ä½ çš„çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰32ä¸ªæ•°æ®å…ƒç´ ç”¨äºè®¡ç®—ï¼Œæ¯8ä¸ªå…ƒç´ ä¸€ä¸ªå—ï¼Œéœ€è¦å¯åŠ¨4ä¸ªå—ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">kernel_name&lt;&lt;&lt;<span class="hljs-number">4</span>,<span class="hljs-number">8</span>&gt;&gt;&gt;(argument list);<br></code></pre></div></td></tr></table></figure><p><img src="/2023/03/06/cuda007/image-20230306140924311.png" alt="image-20230306140924311"></p><p>ç”±äºæ•°æ®åœ¨å…¨å±€å†…å­˜ä¸­æ˜¯çº¿æ€§å­˜å‚¨çš„ï¼Œå› æ­¤å¯ä»¥ç”¨å˜é‡blockIdx.xå’ŒthreadIdx.xæ¥è¿›è¡Œä»¥ä¸‹æ“ä½œã€‚</p><ul><li>åœ¨ç½‘æ ¼ä¸­æ ‡è¯†ä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹</li><li>å»ºç«‹çº¿ç¨‹å’Œæ•°æ®å…ƒç´ ä¹‹é—´çš„æ˜ å°„å…³ç³»</li></ul><p>å¦‚æœæŠŠ32ä¸ªå…ƒç´ æ”¾åˆ°ä¸€ä¸ªå—é‡Œï¼Œé‚£ä¹ˆåªä¼šå¾—åˆ°ä¸€ä¸ªå—ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">kernel_name&lt;&lt;&lt;<span class="hljs-number">1</span>,<span class="hljs-number">32</span>&gt;&gt;&gt;(argument list);<br></code></pre></div></td></tr></table></figure><p>å¦‚æœæ¯ä¸ªå—åªå«ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆä¼šæœ‰32ä¸ªå—ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">kernel_name&lt;&lt;&lt;<span class="hljs-number">32</span>,<span class="hljs-number">1</span>&gt;&gt;&gt;(argument list);<br></code></pre></div></td></tr></table></figure><p>æ ¸å‡½æ•°çš„è°ƒç”¨ä¸ä¸»æœºçº¿ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚æ ¸å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œæ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™ä¸»æœºç«¯ã€‚ä½ å¯ä»¥è°ƒç”¨ä»¥ä¸‹å‡½æ•°æ¥å¼ºåˆ¶ä¸»æœºç«¯ç¨‹åºç­‰å¾…æ‰€æœ‰çš„æ ¸å‡½æ•°æ‰§è¡Œç»“æŸï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">cudaError_t <span class="hljs-title">cudaDeviceSynchronize</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;<br></code></pre></div></td></tr></table></figure><p>ä¸€äº›CUDAè¿è¡Œæ—¶APIåœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´æ˜¯éšå¼åŒæ­¥çš„ã€‚å½“ä½¿ç”¨cudaMemcpyå‡½æ•°åœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´æ‹·è´æ•°æ®æ—¶ï¼Œä¸»æœºç«¯éšå¼åŒæ­¥ï¼Œå³ä¸»æœºç«¯ç¨‹åºå¿…é¡»ç­‰å¾…æ•°æ®æ‹·è´å®Œæˆåæ‰èƒ½ç»§ç»­æ‰§è¡Œç¨‹åºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">cudaError_t <span class="hljs-title">cudaMemcpy</span><span class="hljs-params">(<span class="hljs-keyword">void</span>* dst, <span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span>* src, <span class="hljs-keyword">size_t</span> count, cudaMemcpyKind kind)</span></span>;<br></code></pre></div></td></tr></table></figure><p>ä¹‹å‰æ‰€æœ‰çš„æ ¸å‡½æ•°è°ƒç”¨å®Œæˆåå¼€å§‹æ‹·è´æ•°æ®ã€‚å½“æ‹·è´å®Œæˆåï¼Œæ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™ä¸»æœºç«¯ã€‚</p><h3 id="å¼‚æ­¥è¡Œä¸º"><a href="#å¼‚æ­¥è¡Œä¸º" class="headerlink" title="å¼‚æ­¥è¡Œä¸º"></a>å¼‚æ­¥è¡Œä¸º</h3><p>ä¸åŒäºCè¯­è¨€çš„å‡½æ•°è°ƒç”¨ï¼Œæ‰€æœ‰çš„CUDAæ ¸å‡½æ•°çš„å¯åŠ¨éƒ½æ˜¯å¼‚æ­¥çš„ã€‚CUDAå†…æ ¸è°ƒç”¨å®Œæˆåï¼Œæ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™CPUã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>205.åŒæ„å­—ç¬¦ä¸²</title>
    <link href="/2023/03/02/leetcode205/"/>
    <url>/2023/03/02/leetcode205/</url>
    
    <content type="html"><![CDATA[<h2 id="205-åŒæ„å­—ç¬¦ä¸²"><a href="#205-åŒæ„å­—ç¬¦ä¸²" class="headerlink" title="205.åŒæ„å­—ç¬¦ä¸²"></a>205.åŒæ„å­—ç¬¦ä¸²</h2><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://leetcode.cn/problems/isomorphic-strings/">205. åŒæ„å­—ç¬¦ä¸² - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isIsomorphic</span><span class="hljs-params">(string s, string t)</span> </span>&#123;<br>        string ss;<br>        string st;<br>        <span class="hljs-keyword">int</span> hash[<span class="hljs-number">255</span>];<br>        <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">memset</span>(hash, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(hash));<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;s.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(hash[<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(s[i])]==<span class="hljs-number">0</span>)<br>            &#123;<br>                index++;<br>                hash[<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(s[i])]=index;<br>                ss.<span class="hljs-built_in">push_back</span>(index+<span class="hljs-string">&#x27;0&#x27;</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                ss.<span class="hljs-built_in">push_back</span>(hash[<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(s[i])]+<span class="hljs-string">&#x27;0&#x27;</span>);<br>            &#125;<br>        &#125;<br>        index=<span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">memset</span>(hash, <span class="hljs-number">0</span>, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(hash));<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;t.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(hash[<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(t[i])]==<span class="hljs-number">0</span>)<br>            &#123;<br>                index++;<br>                hash[<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(t[i])]=index;<br>                st.<span class="hljs-built_in">push_back</span>(index+<span class="hljs-string">&#x27;0&#x27;</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                st.<span class="hljs-built_in">push_back</span>(hash[<span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(t[i])]+<span class="hljs-string">&#x27;0&#x27;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">int</span> ans = ss.<span class="hljs-built_in">compare</span>(st);<br>        <span class="hljs-keyword">if</span>(ans==<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h2><p><img src="/2023/03/02/leetcode205/image-20230302204605581.png" alt="image-20230302204605581"></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isIsomorphic</span><span class="hljs-params">(string s, string t)</span> </span>&#123;<br>        unordered_map&lt;<span class="hljs-keyword">char</span>, <span class="hljs-keyword">char</span>&gt; s2t;<br>        unordered_map&lt;<span class="hljs-keyword">char</span>, <span class="hljs-keyword">char</span>&gt; t2s;<br>        <span class="hljs-keyword">int</span> len = s.<span class="hljs-built_in">length</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i) &#123;<br>            <span class="hljs-keyword">char</span> x = s[i], y = t[i];<br>            <span class="hljs-keyword">if</span> ((s2t.<span class="hljs-built_in">count</span>(x) &amp;&amp; s2t[x] != y) || (t2s.<span class="hljs-built_in">count</span>(y) &amp;&amp; t2s[y] != x)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            s2t[x] = y;<br>            t2s[y] = x;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://leetcode.cn/problems/isomorphic-strings/solution/tong-gou-zi-fu-chuan-by-leetcode-solutio-s6fd/">åŒæ„å­—ç¬¦ä¸² - åŒæ„å­—ç¬¦ä¸² - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>189.è½®è½¬æ•°ç»„</title>
    <link href="/2023/03/02/leetcode189/"/>
    <url>/2023/03/02/leetcode189/</url>
    
    <content type="html"><![CDATA[<h2 id="189-è½®è½¬æ•°ç»„"><a href="#189-è½®è½¬æ•°ç»„" class="headerlink" title="189.è½®è½¬æ•°ç»„"></a>189.è½®è½¬æ•°ç»„</h2><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://leetcode.cn/problems/rotate-array/">189. è½®è½¬æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><img src="/2023/03/02/leetcode189/image-20230302200538871.png" alt="image-20230302200538871"></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">reverse</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums,<span class="hljs-keyword">int</span> begin,<span class="hljs-keyword">int</span> end)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">while</span>(begin&lt;end)&#123;<br>            <span class="hljs-built_in">swap</span>(nums[begin], nums[end]);<br>            begin++;<br>            end--;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">rotate</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;<br>        <span class="hljs-comment">//æ•°ç»„ç¿»è½¬</span><br>        <span class="hljs-keyword">int</span> p = k%nums.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-built_in">reverse</span>(nums,<span class="hljs-number">0</span>,nums.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>);<br>        <span class="hljs-built_in">reverse</span>(nums,<span class="hljs-number">0</span>,p<span class="hljs-number">-1</span>);<br>        <span class="hljs-built_in">reverse</span>(nums,p,nums.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>);<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://leetcode.cn/problems/rotate-array/solution/xuan-zhuan-shu-zu-by-leetcode-solution-nipk/">æ—‹è½¬æ•°ç»„ - è½®è½¬æ•°ç»„ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>LeetCode</tag>
      
      <tag>æ•°ç»„ç¿»è½¬</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>724.å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡</title>
    <link href="/2023/03/01/leetcode724/"/>
    <url>/2023/03/01/leetcode724/</url>
    
    <content type="html"><![CDATA[<h1 id="724-å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡"><a href="#724-å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡" class="headerlink" title="724.å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡"></a>724.å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡</h1><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://leetcode.cn/problems/find-pivot-index/">724. å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><img src="/2023/03/01/leetcode724/image-20230301173931031.png" alt="image-20230301173931031"></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">pivotIndex</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> total=<span class="hljs-built_in">accumulate</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>(),<span class="hljs-number">0</span>);<span class="hljs-comment">//ç¬¬ä¸‰ä¸ªå½¢å‚æ˜¯ç´¯åŠ çš„åˆå§‹å€¼</span><br>        <span class="hljs-keyword">int</span> sum=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;nums.<span class="hljs-built_in">size</span>();i++)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*sum+nums[i] == total)&#123;<br>                <span class="hljs-keyword">return</span> i;<br>            &#125;<br>            sum+=nums[i];<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://leetcode.cn/problems/find-pivot-index/solution/xun-zhao-shu-zu-de-zhong-xin-suo-yin-by-gzjle/">å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒç´¢å¼• - å¯»æ‰¾æ•°ç»„çš„ä¸­å¿ƒä¸‹æ ‡ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>LeetCode</tag>
      
      <tag>å‰ç¼€å’Œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vector&lt;bool&gt;ä¸vector&lt;T&gt;</title>
    <link href="/2023/02/28/vectorbool/"/>
    <url>/2023/02/28/vectorbool/</url>
    
    <content type="html"><![CDATA[<h1 id="vector-lt-bool-gt-ä¸vector-lt-T-gt"><a href="#vector-lt-bool-gt-ä¸vector-lt-T-gt" class="headerlink" title="vector&lt;bool&gt;ä¸vector&lt;T&gt;"></a>vector&lt;bool&gt;ä¸vector&lt;T&gt;</h1><p>vector&lt;bool&gt; ä¸åƒå…¶ä»–å®¹å™¨ä¸€æ ·æŒ‰Byteå­˜å‚¨çš„ï¼Œå®ƒæ˜¯æŒ‰bitå­˜å‚¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ­£å¸¸çš„boolç±»å‹çš„ç©ºé—´å¯ä»¥å­˜æ”¾vector&lt;bool&gt;ä¸­çš„8ä¸ªï¼Œç©ºé—´ä¸Šç¡®å®ä¼˜åŒ–äº†å¾ˆå¤šï¼Œç„¶è€Œï¼Œc++æ˜¯ä¸èƒ½ç›´æ¥å–å¯¹bitæ“ä½œçš„ï¼ˆå› ä¸ºC++çš„æœ€å°å¯å¯»å€å€¼é€šå¸¸ä»¥byteä¸ºå•ä½ï¼‰ï¼Œå¯¹å…¶ä½¿ç”¨operator[]å…¶å®è¿”å›çš„ä¸æ˜¯boolçš„å¼•ç”¨è€Œæ˜¯ä¸€ä¸ªâ€proxy referenceâ€æ˜¯â€std::vector&lt; bool&gt;:referenceâ€ç±»å‹çš„å¯¹è±¡ã€‚</p><p>æ­£å› ä¸ºå¦‚æ­¤ï¼Œvector&lt;bool&gt;é€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œå­˜å–è®¿é—®æ—¶éœ€è¦æ‰§è¡Œé€ä½å¤„ç†ï¼Œè®¿é—®é€šå¸¸æ¯”intä¹‹ç±»çš„æ™®é€šç±»å‹æ“ä½œè¦æ…¢å¾ˆå¤šã€‚</p><p>å› æ­¤ï¼Œå¯¹vecotr&lt;bool&gt;çš„ä½¿ç”¨éœ€æ…é‡è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š<br>(1)æ˜¯å¦éœ€è¦ç‰ºç‰²é€Ÿåº¦æ¥è·å–ç©ºé—´ä¸Šçš„ä¼˜åŒ–<br>(2)ç®—æ³•ä¸­ä¼šå¦æœ‰å¯¹vecotråœ°å€è¿›è¡Œè§£å¼•ç”¨æ“ä½œçš„å¯èƒ½ã€‚</p><p>å¦‚æœä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œå»ºè®®ä½¿ç”¨deque&lt;bool&gt;æ¥å–ä»£vector&lt;bool&gt;ï¼ŒåŠŸèƒ½åŸºæœ¬ç›¸åŒï¼Œä½†deque&lt;bool&gt;æœªå¯¹å…¶è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p><p>ä¸‹é¢æ˜¯vector&lt;bool&gt;ä¸vector&lt;T&gt;ç®€å•çš„å¯¹æ¯”ä¾‹å­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>vector&lt;<span class="hljs-keyword">char</span>&gt; ch;<br>vector&lt;<span class="hljs-keyword">int</span>&gt; in;<br>vector&lt;<span class="hljs-keyword">bool</span>&gt; bo;<br> <br><span class="hljs-keyword">int</span> m = <span class="hljs-number">1e6</span>;<br><span class="hljs-keyword">clock_t</span> t1, t2, t3;<br> <br>t1 = <span class="hljs-built_in">clock</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>ch.<span class="hljs-built_in">push_back</span>(<span class="hljs-string">&#x27;0&#x27;</span>);<br>&#125;<br>t1 = <span class="hljs-built_in">clock</span>() - t1;<br> <br>t2 = <span class="hljs-built_in">clock</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>in.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">0</span>);<br>&#125;<br>t2 = <span class="hljs-built_in">clock</span>() - t2;<br> <br>t3 = <span class="hljs-built_in">clock</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>bo.<span class="hljs-built_in">push_back</span>(<span class="hljs-literal">true</span>);<br>&#125;<br>t3 = <span class="hljs-built_in">clock</span>() - t3;<br> <br>cout &lt;&lt;<span class="hljs-string">&quot;vector&lt;char&gt; &quot;</span>&lt;&lt; t1 &lt;&lt; <span class="hljs-string">&quot;\n vector&lt;int&gt; &quot;</span> &lt;&lt; t2 &lt;&lt; <span class="hljs-string">&quot;\nvector&lt;bool&gt; &quot;</span> &lt;&lt; t3 &lt;&lt; endl;<br>cout &lt;&lt; endl;<br> <br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp">vector&lt;<span class="hljs-keyword">char</span>&gt; <span class="hljs-number">216</span><br>vextor&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-number">229</span><br>vector&lt;<span class="hljs-keyword">bool</span>&gt; <span class="hljs-number">16535</span><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œå‘ç°vector&lt;bool&gt;ç›¸è¾ƒäºå…¶ä»–vector&lt;T&gt;é€Ÿåº¦è¦æ…¢çš„å¤šï¼</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/qq_52134928/article/details/121066304?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-121066304-blog-86603050.pc_relevant_3mothn_strategy_and_data_recovery&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-121066304-blog-86603050.pc_relevant_3mothn_strategy_and_data_recovery&utm_relevant_index=1">(65æ¡æ¶ˆæ¯) ã€C++ã€‘vectorï¼œboolï¼çš„ç‰¹åˆ«ä¹‹å¤„_å°é™¶åŒå­¦_çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/u013249689/article/details/25297657">(65æ¡æ¶ˆæ¯) ä¸ä½¿ç”¨vectorçš„åŸå› å’Œæ›¿ä»£æ–¹æ³•_jackycmuçš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>STL</tag>
      
      <tag>Vector</tag>
      
      <tag>C/C++</tag>
      
      <tag>bool</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C/C++å…³é”®å­—ä¹‹restrict</title>
    <link href="/2023/02/28/Linux004/"/>
    <url>/2023/02/28/Linux004/</url>
    
    <content type="html"><![CDATA[<h1 id="C-x2F-C-å…³é”®å­—ä¹‹restrict"><a href="#C-x2F-C-å…³é”®å­—ä¹‹restrict" class="headerlink" title="C&#x2F;C++å…³é”®å­—ä¹‹restrict"></a>C&#x2F;C++å…³é”®å­—ä¹‹restrict</h1><p>åœ¨Cè¯­è¨€ä¸­ï¼Œrestrictå…³é”®å­—ç”¨äºä¿®é¥°æŒ‡é’ˆï¼ˆC99æ ‡å‡†ï¼‰ã€‚é€šè¿‡åŠ ä¸Šrestrictå…³é”®å­—ï¼Œç¨‹åºå‘˜å¯æç¤ºç¼–è¯‘å™¨ï¼šåœ¨è¯¥æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå…¶æŒ‡å‘çš„å¯¹è±¡ä¸ä¼šè¢«åˆ«çš„æŒ‡é’ˆæ‰€å¼•ç”¨ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨C++ä¸­ï¼Œå¹¶æ— æ˜ç¡®ç»Ÿä¸€çš„æ ‡å‡†æ”¯æŒrestrictå…³é”®å­—ã€‚ä½†æ˜¯å¾ˆå¤šç¼–è¯‘å™¨å®ç°äº†åŠŸèƒ½ç›¸åŒçš„å…³é”®å­—ï¼Œä¾‹å¦‚gccå’Œclangä¸­çš„__restrictå…³é”®å­—ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add1</span><span class="hljs-params">(<span class="hljs-keyword">int</span>*a, <span class="hljs-keyword">int</span>* b)</span></span><br><span class="hljs-function"></span>&#123;<br>    *a = <span class="hljs-number">10</span>;<br>    *b = <span class="hljs-number">12</span>;<br>    <span class="hljs-keyword">return</span> *a + *b;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>add1å‡½æ•°çš„è¿”å›å€¼ä¼šæ°¸è¿œæ˜¯10 + 12 &#x3D; 22å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚åœ¨æŒ‡é’ˆaå’Œbçš„åœ°å€ä¸åŒæ—¶ï¼Œè¿”å›22æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯å½“æŒ‡é’ˆaä¸bæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªintå¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡å…ˆè¢«èµ‹å€¼ä¸º10ï¼Œåè¢«èµ‹å€¼ä¸º12ï¼Œå› æ­¤aå’Œbéƒ½è¿”å›12ï¼Œå› æ­¤add1å‡½æ•°æœ€ç»ˆè¿”å›24ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add1</span><span class="hljs-params">(<span class="hljs-keyword">int</span>* a, <span class="hljs-keyword">int</span>* b)</span></span><br><span class="hljs-function"></span>&#123;<br>    *a = <span class="hljs-number">10</span>;<br>    *b = <span class="hljs-number">12</span>;<br>    <span class="hljs-keyword">return</span> *a + *b;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">int</span>* c;<br>    <span class="hljs-keyword">int</span>* d;<br>    d=(<span class="hljs-keyword">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">int</span>)*<span class="hljs-number">1</span>);<br>    c=(<span class="hljs-keyword">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">int</span>)*<span class="hljs-number">1</span>);<br>    *c=<span class="hljs-number">10</span>;<br>    *d=<span class="hljs-number">12</span>;<br>    *d=<span class="hljs-number">12</span>;<br>    cout&lt;&lt;<span class="hljs-string">&quot;c:&quot;</span>&lt;&lt;*c&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;d:&quot;</span>&lt;&lt;*d&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;When Pointers a and b have different addresses&quot;</span>&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-built_in">add1</span>(c,d)&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;When Pointers a and b have the same address&quot;</span>&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-built_in">add1</span>(c,c)&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç¨‹åºè¾“å‡ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">c:<span class="hljs-number">10</span><br>d:<span class="hljs-number">12</span><br>When Pointers a <span class="hljs-keyword">and</span> b have different addresses<br><span class="hljs-number">22</span><br>When Pointers a <span class="hljs-keyword">and</span> b have the same address<br><span class="hljs-number">24</span><br></code></pre></div></td></tr></table></figure><p>å¼€å¯-O3ä¼˜åŒ–ï¼Œadd1å¯¹åº”çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹:</p><p>ä¸ºäº†å¾—åˆ°<code>*a</code>çš„å€¼è®¿é—®äº†1æ¬¡å†…å­˜ï¼Œè€Œä¸ç®¡åœ¨ä½•ç§æ¡ä»¶ä¸‹(<code>a == b</code> or <code>a != b</code>)ï¼Œ<code>*b</code>çš„å€¼éƒ½æ˜¯12ã€‚å› æ­¤ç¼–è¯‘å™¨å°†<code>*a</code>çš„å€¼è½½å…¥<code>eax</code>å¯„å­˜å™¨åï¼Œç›´æ¥åŠ ä¸Šç«‹å³æ•°12ï¼Œè€Œæ— éœ€å†è®¿é—®å†…å­˜è·å–<code>*b</code>çš„å€¼ã€‚åœ¨æ— æ³•ç¡®å®šæŒ‡é’ˆaå’Œbæ˜¯å¦ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨åªèƒ½å¸®ä½ ä¼˜åŒ–åˆ°è¿™é‡Œäº†ã€‚</p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran"><span class="hljs-number">0000000000400</span>a10 &lt;_Z4add1PiS_&gt;:<br>  <span class="hljs-number">400</span>a10:   c7 <span class="hljs-number">07</span> <span class="hljs-number">0</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>       movl   $<span class="hljs-number">0</span>xa,(%rdi) ; *a = <span class="hljs-number">10</span><br>  <span class="hljs-number">400</span>a16:   c7 <span class="hljs-number">06</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>       movl   $<span class="hljs-number">0</span>xc,(%rsi) ; *b = <span class="hljs-number">10</span><br>  <span class="hljs-number">400</span>a1c:   <span class="hljs-number">8</span>b <span class="hljs-number">07</span>                   mov    (%rdi),%eax ; ç»“æœ = *a<br>  <span class="hljs-number">400</span>a1e:   <span class="hljs-number">83</span> c0 <span class="hljs-number">0</span>c                add    $<span class="hljs-number">0</span>xc,%eax   ; ç»“æœ += <span class="hljs-number">12</span> <br>  <span class="hljs-number">400</span>a21:   c3                      retq<br></code></pre></div></td></tr></table></figure><p>åŠ ä¸Šäº†restrictå…³é”®å­—è¿‡åï¼ŒåŒæ ·å¼€å¯-O3ä¼˜åŒ–ï¼Œadd1å¯¹åº”çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š</p><p>åŠ ä¸Šå…³é”®å­—restrictåï¼Œç¼–è¯‘å™¨èƒ½å¤Ÿç¡®è®¤æŒ‡é’ˆaå’Œbä¸å¯èƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤åœ¨æ±‚*a + *bæ—¶ï¼Œæ— è™šè®¿é—®å†…å­˜ï¼Œå› ä¸º*aå¿…ç„¶ç­‰äºç«‹å³æ•°10ï¼Œ*bå¿…ç„¶ç­‰äºç«‹å³æ•°12ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add2</span><span class="hljs-params">(<span class="hljs-keyword">int</span>* __restrict  a, <span class="hljs-keyword">int</span>* __restrict b)</span> </span><br><span class="hljs-function"></span>&#123;<br>    *a = <span class="hljs-number">10</span>;<br>    *b = <span class="hljs-number">12</span>;<br>    <span class="hljs-keyword">return</span> *a + *b ;<br>&#125;<br><span class="hljs-number">0000000000400</span>a30 &lt;_Z4add2PiS_&gt;:<br>  <span class="hljs-number">400</span>a30:   c7 <span class="hljs-number">07</span> <span class="hljs-number">0</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>       movl   $<span class="hljs-number">0xa</span>,(%rdi) ; *a = <span class="hljs-number">10</span><br>  <span class="hljs-number">400</span>a36:   b8 <span class="hljs-number">16</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>          mov    $<span class="hljs-number">0x16</span>,%eax  ; ç»“æœ = <span class="hljs-number">22</span><br>  <span class="hljs-number">400</span>a3b:   c7 <span class="hljs-number">06</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>       movl   $<span class="hljs-number">0xc</span>,(%rsi) ; *b = <span class="hljs-number">12</span><br>  <span class="hljs-number">400</span>a41:   c3  <br></code></pre></div></td></tr></table></figure><p>æœ‰æ— restrictå…³é”®å­—çš„ä¸¤ç§æƒ…å†µä¸‹çš„æ±‡ç¼–æŒ‡ä»¤å¯çœ‹åˆ°ï¼Œåè€…æ¯”å‰è€…å°‘è®¿é—®ä¸€æ¬¡å†…å­˜ï¼Œä¸”å°‘æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ã€‚å°±æ˜¯å› ä¸ºæ²¡åŠ restructå…³é”®å­—æ—¶ï¼Œç¼–è¯‘å™¨ä¸èƒ½ç¡®å®šåˆ«çš„åœ°æ–¹æ˜¯ä¸æ˜¯ä¼šä¿®æ”¹æ­¤å€¼ï¼Œæ‰€ä»¥ä¼šå»ç›¸åº”çš„åœ°å€æŸ¥çœ‹ã€‚</p><p><strong>è¿™æ ·å½“æˆ‘ä»¬æ˜ç¡®çŸ¥é“ä¸¤ä¸ªæŒ‡é’ˆä¸å¯èƒ½æŒ‡å‘åŒä¸€ä¸ªåœ°å€æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä½¿ç”¨restrictå…³é”®å­—æ¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚</strong></p><p>æ³¨æ„ä½¿ç”¨restrictçš„æ—¶å€™ï¼Œç¨‹åºå‘˜å¿…é¡»ç¡®ä¿ä¸ä¼šå‡ºç°<strong>pointer aliasing</strong>ï¼Œå³åŒä¸€å—å†…å­˜æ— æ³•é€šè¿‡ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„æŒ‡é’ˆå˜é‡åè®¿é—®ã€‚ä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶å¼ºè¡ŒæŒ‡å®šrestrictï¼Œå°†ä¼šå‡ºç°<strong>underfined behavior</strong>ã€‚</p><p>é€šå¸¸ç¼–å†™ä»£ç æ—¶ä¼šå¿½ç•¥pointer aliasingçš„é—®é¢˜ã€‚æ›´å¸¸è§æ˜¯åœ¨æ€§èƒ½åˆ†ææ—¶ï¼Œé€šè¿‡åæ±‡ç¼–çœ‹åˆ°å¾ˆå¤šå†—ä½™çš„è¯»å–æŒ‡ä»¤ï¼Œæ‰ä¼šæƒ³åˆ°åŠ å…¥restrictå…³é”®å­—æ¥æå‡æ€§èƒ½ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://zhuanlan.zhihu.com/p/349726808">C&#x2F;C++å…³é”®å­—ä¹‹restrict - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://github.com/ClickHouse/ClickHouse/pull/19946">Improve performance of aggregate functions by alexey-milovidov Â· Pull Request #19946 Â· ClickHouse&#x2F;ClickHouse (github.com)</a></p><p><a href="https://en.cppreference.com/w/c/language/restrict">restrict type qualifier - cppreference.com</a></p><p><a href="https://www.zhihu.com/question/41653775/answer/2535730128">å¦‚ä½•ç†è§£Cè¯­è¨€å…³é”®å­—restrictï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://blog.csdn.net/qq_41822235/article/details/83479562">(65æ¡æ¶ˆæ¯) å…³é”®å­—_restrict___restrict_æ¥šæ¥šå¯è–‡çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_41950508/article/details/126619881?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-126619881-blog-102577325.pc_relevant_3mothn_strategy_recovery&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-126619881-blog-102577325.pc_relevant_3mothn_strategy_recovery&utm_relevant_index=1">(65æ¡æ¶ˆæ¯) ã€C++ã€‘å…³é”®å­—restrictçš„ä½œç”¨_restrictå…³é”®å­—çš„ä½œç”¨_ä¸çŸ¥æ‰€æªçš„æ¸£æ¸£è¾‰çš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>Operating System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>unroll_and_jam/nounroll_and_jam</title>
    <link href="/2023/02/26/intel001/"/>
    <url>/2023/02/26/intel001/</url>
    
    <content type="html"><![CDATA[<h1 id="unroll-and-jam-x2F-nounroll-and-jam"><a href="#unroll-and-jam-x2F-nounroll-and-jam" class="headerlink" title="unroll_and_jam&#x2F;nounroll_and_jam"></a>unroll_and_jam&#x2F;nounroll_and_jam</h1><p>å¯ç”¨æˆ–ç¦ç”¨å¾ªç¯å±•å¼€å’Œé˜»å¡ã€‚è¿™äº›æŒ‡ä»¤åªèƒ½åº”ç”¨äºè¿­ä»£forå¾ªç¯ã€‚</p><h2 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h2><p>#pragma unroll_and_jam#pragma unroll_and_jam (n)#pragma nounroll_and_jam</p><h2 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h2><p>å±•å¼€å› å­ï¼Œè¡¨ç¤ºå±•å¼€å¾ªç¯çš„æ¬¡æ•°;å¿…é¡»æ˜¯0åˆ°255ä¹‹é—´çš„æ•´æ•°å¸¸æ•°</p><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>unroll_and_jamæŒ‡ä»¤éƒ¨åˆ†å±•å¼€å¥—ä¸­æ¯”æœ€å†…å±‚å¾ªç¯æ›´é«˜çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¾ªç¯ï¼Œå¹¶å°†ç»“æœå¾ªç¯èåˆ&#x2F;é˜»å¡å›ä¸€èµ·ã€‚è¿™ç§è½¬æ¢å…è®¸åœ¨å¾ªç¯ä¸­è¿›è¡Œæ›´å¤šçš„é‡ç”¨ã€‚</p><p>æ­¤pragmaå¯¹æœ€å†…å±‚å¾ªç¯æ— æ•ˆã€‚ç¡®ä¿ç´§éšå…¶åçš„å¾ªç¯ä¸æ˜¯ç¼–è¯‘å™¨å‘èµ·çš„äº¤æ¢å®Œæˆåçš„æœ€å†…å±‚å¾ªç¯ã€‚</p><p>æŒ‡å®šæ­¤pragmaæ˜¯å‘ç¼–è¯‘å™¨æç¤ºå±•å¼€å’Œé˜»å¡åºåˆ—æ˜¯åˆæ³•ä¸”æœ‰åˆ©å¯å›¾çš„ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ä»»ä½•å¯èƒ½çš„æƒ…å†µä¸‹å¯ç”¨è¿™ç§è½¬æ¢ã€‚</p><p>å¯¹äºå®ƒå½±å“çš„æ¯ä¸ªforå¾ªç¯ï¼Œunroll_and_jamæŒ‡ä»¤å¿…é¡»åœ¨forè¯­å¥ä¹‹å‰ã€‚å¦‚æœæŒ‡å®šäº†nï¼Œä¼˜åŒ–å™¨å°†å±•å¼€å¾ªç¯næ¬¡ã€‚å¦‚æœnè¢«çœç•¥æˆ–è¶…å‡ºå…è®¸çš„èŒƒå›´ï¼Œä¼˜åŒ–å™¨å°†åˆ†é…å±•å¼€å¾ªç¯çš„æ¬¡æ•°ã€‚ç¼–è¯‘å™¨é€šè¿‡æ¯”è¾ƒnå’Œå¾ªç¯è®¡æ•°ç”Ÿæˆæ­£ç¡®çš„ä»£ç ã€‚</p><p>åªæœ‰åœ¨è®¾ç½®äº†ç¼–è¯‘å™¨é€‰é¡¹O3æ—¶ï¼Œæ‰æ”¯æŒæ­¤pragmaã€‚unroll_and_jamæŒ‡ä»¤å°†è¦†ç›–ä»å‘½ä»¤è¡Œå±•å¼€å¾ªç¯çš„ä»»ä½•è®¾ç½®ã€‚</p><p>å½“å±•å¼€å¾ªç¯ä¼šå¢åŠ å¯„å­˜å™¨å‹åŠ›å’Œä»£ç å¤§å°æ—¶ï¼Œå¯èƒ½éœ€è¦é˜²æ­¢å±•å¼€åµŒå¥—å¾ªç¯æˆ–ä¸å®Œç¾çš„åµŒå¥—å¾ªç¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨nounroll_and_jamç¼–è¯‘æŒ‡ä»¤ã€‚nounroll_and_jam pragmaæç¤ºç¼–è¯‘å™¨ä¸è¦å±•å¼€æŒ‡å®šçš„å¾ªç¯ã€‚</p><p><strong>Examples</strong></p><p><strong>Use the unroll_and_jam pragma:</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> a[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>]; <br><span class="hljs-keyword">int</span> b[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>]; <br><span class="hljs-keyword">int</span> c[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>]; <br><span class="hljs-keyword">int</span> d[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>]; <br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unroll</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;<br>Â Â Â Â <span class="hljs-keyword">int</span> i,j,k;<br>Â Â Â Â <span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> unroll_and_jam (6)</span><br>Â Â Â Â <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; n; i++) &#123;<br>Â Â Â Â Â Â Â <span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> unroll_and_jam (6)</span><br>Â Â Â Â Â Â Â <span class="hljs-keyword">for</span> (j = <span class="hljs-number">1</span>; j &lt; n; j++) &#123;<br>Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span> (k = <span class="hljs-number">1</span>; k &lt; n; k++)&#123;<br>Â Â Â Â Â Â Â Â Â Â Â Â a[i][j] += b[i][k]*c[k][j];<br>Â Â Â Â Â Â Â Â Â Â Â Â &#125;<br>Â Â Â Â Â Â Â &#125;<br>Â Â Â Â &#125; <br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.intel.com/content/www/us/en/develop/documentation/cpp-compiler-developer-guide-and-reference/top/compiler-reference/pragmas/intel-specific-pragma-reference/unroll-and-jam-nounroll-and-jam.html">unroll_and_jam nounroll_and_jam (intel.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Intel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cache Blocking Techniquesã€ä¸ªäººç¿»è¯‘ã€‘</title>
    <link href="/2023/02/26/cache001/"/>
    <url>/2023/02/26/cache001/</url>
    
    <content type="html"><![CDATA[<h2 id="Cache-Blocking-Techniques"><a href="#Cache-Blocking-Techniques" class="headerlink" title="Cache Blocking Techniques"></a>Cache Blocking Techniques</h2><p><strong>æ–‡ç« æ¥æºï¼š</strong><a href="https://www.intel.cn/content/www/cn/zh/developer/articles/technical/cache-blocking-techniques.html">Cache Blocking Techniques (intel.cn)</a></p><p><strong>æ–‡ç« ä½œè€…ï¼š</strong><a href="https://community.intel.com/cipcp26785/plugins/custom/intel/intel/custom.userprofile?id=3UpJu61CDTyShonSVJNwDw==&iv=8843887237217530">Amanda K Sharp</a></p><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>ä¸€ç±»é‡è¦çš„ç®—æ³•æ›´æ”¹æ¶‰åŠåˆ†å—æ•°æ®ç»“æ„ä»¥é€‚åº”ç¼“å­˜ã€‚é€šè¿‡ç»„ç»‡æ•°æ®å†…å­˜è®¿é—®ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªå¤§å¾—å¤šçš„æ•°æ®é›†çš„ä¸€ä¸ªå°å­é›†åŠ è½½ç¼“å­˜ã€‚æ¥ä¸‹æ¥çš„æƒ³æ³•æ˜¯åœ¨ç¼“å­˜ä¸­å¤„ç†è¿™ä¸ªæ•°æ®å—ã€‚é€šè¿‡åœ¨ç¼“å­˜ä¸­ä½¿ç”¨&#x2F;é‡ç”¨è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å‡å°‘äº†è®¿é—®å†…å­˜çš„éœ€è¦(å‡å°‘å†…å­˜å¸¦å®½å‹åŠ›)ã€‚</p><h3 id="Topic"><a href="#Topic" class="headerlink" title="Topic"></a>Topic</h3><p>åˆ†å—æ˜¯ä¸€ç§è‘—åçš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©é¿å…è®¸å¤šåº”ç”¨ç¨‹åºä¸­çš„å†…å­˜å¸¦å®½ç“¶é¢ˆã€‚åˆ†å—èƒŒåçš„å…³é”®æ€æƒ³æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­å›ºæœ‰çš„æ•°æ®é‡ç”¨ï¼Œç¡®ä¿æ•°æ®åœ¨å¤šä¸ªç”¨é€”ä¹‹é—´ä¿æŒåœ¨ç¼“å­˜ä¸­ã€‚åˆ†å—å¯ä»¥åœ¨1-Dã€2-Dæˆ–3-Dç©ºé—´æ•°æ®ç»“æ„ä¸Šæ‰§è¡Œã€‚ä¸€äº›è¿­ä»£åº”ç”¨ç¨‹åºå¯ä»¥è¿›ä¸€æ­¥å—ç›Šäºå¤šæ¬¡è¿­ä»£çš„åˆ†å—(é€šå¸¸ç§°ä¸ºæ—¶é—´åˆ†å—)ï¼Œä»¥è¿›ä¸€æ­¥ç¼“è§£å¸¦å®½ç“¶é¢ˆã€‚å°±ä»£ç æ›´æ”¹è€Œè¨€ï¼Œåˆ†å—é€šå¸¸æ¶‰åŠå¾ªç¯åˆ†å‰²å’Œäº¤æ¢çš„ç»„åˆã€‚åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºä»£ç ä¸­ï¼Œé€šè¿‡å¯¹åˆ†å—å› å­è¿›è¡Œä¸€äº›å‚æ•°åŒ–ï¼Œå¯¹æºè¿›è¡Œæ­£ç¡®çš„æ›´æ”¹ï¼Œç”¨æˆ·å¯ä»¥æœ€å¥½åœ°æ‰§è¡Œåˆ†å—ã€‚</p><h3 id="Original-Source"><a href="#Original-Source" class="headerlink" title="Original Source"></a>Original Source</h3><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">for (body1 = <span class="hljs-number">0</span>; body1 &lt; NBODIES; body1 ++) &#123;<br>   for (body2=<span class="hljs-number">0</span>; body2 &lt; NBODIES; body2++) &#123;<br>     <span class="hljs-keyword">OUT</span>[body1] += compute(body1, body2);<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæ•°æ®(body2)æ¥è‡ªå†…å­˜ã€‚å‡è®¾NBODIESå¾ˆå¤§ï¼Œæˆ‘ä»¬å°†æ— æ³•åœ¨ç¼“å­˜ä¸­é‡ç”¨ã€‚æ­¤åº”ç”¨ç¨‹åºå—å†…å­˜å¸¦å®½é™åˆ¶ã€‚åº”ç”¨ç¨‹åºå°†ä»¥å†…å­˜åˆ°CPUçš„é€Ÿåº¦è¿è¡Œï¼Œè€Œä¸æ˜¯æœ€ä½³é€Ÿåº¦ã€‚</p><p><strong>Modified Source (with 1-D blocking):</strong></p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">for (body2 = <span class="hljs-number">0</span>; body2 &lt; NBODIES; body2 += <span class="hljs-keyword">BLOCK</span>) &#123;<br>   for (body1=<span class="hljs-number">0</span>; body1 &lt; NBODIES; body1 ++) &#123;<br>      for (body22=<span class="hljs-number">0</span>; body22 &lt; <span class="hljs-keyword">BLOCK</span>; body22 ++) &#123;<br>         <span class="hljs-keyword">OUT</span>[body1] += compute(body1, body2 + body22);<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨ä¿®æ”¹åçš„ä»£ç ä¸­ï¼Œæ•°æ®(body22)åœ¨ç¼“å­˜ä¸­è¢«ä¿ç•™å’Œé‡ç”¨ï¼Œä»è€Œè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸Šé¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†ä¸€ä¸ªåˆ†å—NBodyä»£ç çš„ç¤ºä¾‹ã€‚æœ‰ä¸¤ä¸ªå¾ªç¯(body1å’Œbody2)éå†æ‰€æœ‰ä¸»ä½“ã€‚é¡¶éƒ¨çš„åŸå§‹ä»£ç æµç»å†…éƒ¨å¾ªç¯ä¸­çš„æ•´ä¸ªä¸»ä½“é›†ï¼Œå¹¶ä¸”å¿…é¡»åœ¨æ¯æ¬¡è¿­ä»£ä¸­ä»å†…å­˜ä¸­åŠ è½½body2å€¼ã€‚åº•éƒ¨çš„åˆ†å—ä»£ç æ˜¯é€šè¿‡å°†body2å¾ªç¯åˆ†è§£ä¸ºä¸€ä¸ªè¿­ä»£å¤šä¸ªBLOCKä¸­çš„bodyçš„å¤–éƒ¨å¾ªç¯å’Œä¸€ä¸ªè¿­ä»£BLOCKä¸­çš„å…ƒç´ çš„å†…éƒ¨body22å¾ªç¯ï¼Œå¹¶äº¤ç»‡body1å’Œbody2å¾ªç¯æ¥è·å¾—çš„ã€‚è¿™æ®µä»£ç åœ¨body1å¾ªç¯çš„å¤šæ¬¡è¿­ä»£ä¸­é‡ç”¨äº†ä¸€ç»„BLOCK body2å€¼ã€‚å¦‚æœBLOCKè¢«é€‰ä¸­ï¼Œä½¿å¾—è¿™ç»„å€¼é€‚åˆç¼“å­˜ï¼Œå†…å­˜æµé‡å°±ä¼šé™ä½ä¸€ä¸ªBLOCKçš„å› å­ã€‚</p><p>ä»¥ä¸‹æ˜¯æ¥è‡ªOpenMP*ç‰ˆæœ¬çš„NBodyåŸºå‡†æµ‹è¯•çš„ç›¸å…³ä»£ç ç‰‡æ®µ(ä½¿ç”¨CHUNK_SIZEå› å­è¿›è¡Œåˆ†å—åº”ç”¨)ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ªç¯å±•å¼€-é˜»å¡è½¬æ¢è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªpragmaï¼Œå¹¶ç”±ç¼–è¯‘å™¨å®Œæˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç ”ç©¶-opt-reportçš„è¾“å‡ºå¯ä»¥ç¡®è®¤ç¼–è¯‘å™¨ç¡®å®ä¸ºä½ çš„å¾ªç¯æ‰§è¡Œäº†å±•å¼€é˜»å¡ä¼˜åŒ–ã€‚</p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">#define CHUNK_SIZE <span class="hljs-number">8192</span><br><br>#pragma omp parallel <span class="hljs-keyword">private</span>(body_start_index)<br>  for(body_start_index = <span class="hljs-number">0</span>; body_start_index &lt; global_number_of_bodies; body_start_index += CHUNK_SIZE) &#123;<br>    <span class="hljs-built_in">int</span> i;<br>    <span class="hljs-built_in">int</span> body_end_index = body_start_index + CHUNK_SIZE;<br><br>    #pragma omp for <span class="hljs-keyword">private</span>(i) schedule(guided)<br>    #pragma unroll_and_jam (<span class="hljs-number">4</span>)<br>    for(i=starting_index; i&lt;ending_index; i++) &#123;<br>      <span class="hljs-built_in">int</span> j;<br>      <span class="hljs-keyword">TYPE</span> acc_x_0 = <span class="hljs-number">0</span>, acc_y_0 = <span class="hljs-number">0</span>, acc_z_0 = <span class="hljs-number">0</span>;<br>      for(j=body_start_index; j&lt;body_end_index; j+=<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">TYPE</span> delta_x_0 = Input_Position_X[(j+<span class="hljs-number">0</span>)] - Input_Position_X[i];<br>        <span class="hljs-keyword">TYPE</span> delta_y_0 = Input_Position_Y[(j+<span class="hljs-number">0</span>)] - Input_Position_Y[i];<br>        <span class="hljs-keyword">TYPE</span> delta_z_0 = Input_Position_Z[(j+<span class="hljs-number">0</span>)] - Input_Position_Z[i];<br><br>        <span class="hljs-keyword">TYPE</span> gamma_0 = delta_x_0*delta_x_0 + delta_y_0*delta_y_0 + delta_z_0*delta_z_0 + epsilon_sqr;<br>        <span class="hljs-keyword">TYPE</span> s_0 = Mass[j+<span class="hljs-number">0</span>]/(gamma_0 * <span class="hljs-built_in">SQRT</span>(gamma_0));<br>        acc_x_0 += s_0*delta_x_0;<br>        acc_y_0 += s_0*delta_y_0;<br>        acc_z_0 += s_0*delta_z_0;<br>      &#125;<br>      Output_Acceleration[<span class="hljs-number">3</span>*(i+<span class="hljs-number">0</span>)+<span class="hljs-number">0</span>] += acc_x_0;<br>      Output_Acceleration[<span class="hljs-number">3</span>*(i+<span class="hljs-number">0</span>)+<span class="hljs-number">1</span>] += acc_y_0;<br>      Output_Acceleration[<span class="hljs-number">3</span>*(i+<span class="hljs-number">0</span>)+<span class="hljs-number">2</span>] += acc_z_0;<br>    &#125;<br>  &#125;<br></code></pre></div></td></tr></table></figure><p>ä¸‹é¢æ˜¯Fortranä¸­çš„ä¸€ä¸ªçŸ©é˜µä¹˜æ³•ä»£ç ç¤ºä¾‹ï¼Œå…¶ä¸­ç”¨æˆ·æ‰§è¡Œé«˜çº§å—å±•å¼€-åˆ†å—è½¬æ¢(åœ¨ä¿®æ”¹ç‰ˆæœ¬ä¸­)ï¼Œæ¶‰åŠæœ¬åœ°å¤åˆ¶æ•°ç»„ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚</p><p><strong>Fortran Source Example:</strong></p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran"><span class="hljs-keyword">do</span> j=<span class="hljs-number">1</span>,N<br>  <span class="hljs-keyword">do</span> k = <span class="hljs-number">1</span>,N<br>    <span class="hljs-keyword">do</span> i = <span class="hljs-number">1</span>,N<br>      c(i,j) = c(i,j) + a(i,k) * b(k,j)<br>    <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>  <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br><span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br></code></pre></div></td></tr></table></figure><p><strong>Modified Fortran Source:</strong></p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran"><span class="hljs-keyword">do</span> JJ = <span class="hljs-number">1</span>, N, TJ<br><br>       <span class="hljs-keyword">do</span> KK = <span class="hljs-number">1</span>, N, TK<br>         <span class="hljs-keyword">do</span> jjj = <span class="hljs-number">1</span>,<span class="hljs-built_in">min</span>(tj,N-jj+<span class="hljs-number">1</span>)                     <span class="hljs-comment">! BCOPY - no transpose</span><br>           <span class="hljs-keyword">do</span> kkk = <span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>(tk,N-kk+<span class="hljs-number">1</span>)<br>             p(kkk,jjj-<span class="hljs-number">1</span>+<span class="hljs-number">1</span>) = B(kk+kkk-<span class="hljs-number">1</span>, jj+jjj-<span class="hljs-number">1</span>)<br>           <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>         <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>         <span class="hljs-keyword">do</span> II = <span class="hljs-number">1</span>, N, TI<br>           <span class="hljs-keyword">do</span> iii = <span class="hljs-number">1</span>,<br>             <span class="hljs-built_in">min</span>(ti,N-ii+<span class="hljs-number">1</span>)                   <span class="hljs-comment">!ACOPY - transpose</span><br>             <span class="hljs-keyword">do</span> kkk = <span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>(tk,N-kk+<span class="hljs-number">1</span>)<br>                Q(kkk,iii) = A(ii+iii-<span class="hljs-number">1</span>, kk+kkk-<span class="hljs-number">1</span>)<br>             <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>           <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>           <span class="hljs-keyword">do</span> J = <span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>(tj,N-jj+<span class="hljs-number">1</span>), <span class="hljs-number">4</span><br>             <span class="hljs-keyword">do</span> I = <span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>(ti,N-ii+<span class="hljs-number">1</span>), <span class="hljs-number">2</span><br>                t1 = <span class="hljs-number">0</span> ; t2 = <span class="hljs-number">0</span> ; t5 = <span class="hljs-number">0</span> ; t6 = <span class="hljs-number">0</span> ; t9 = <span class="hljs-number">0</span> ; t10 = <span class="hljs-number">0</span> ; t13 =<span class="hljs-number">0</span> ; t14 = <span class="hljs-number">0</span><br>                <span class="hljs-comment">!DIR$ vector aligned                      !DIR$ unroll(2)</span><br>                <span class="hljs-keyword">do</span> K = <span class="hljs-number">1</span>,<span class="hljs-built_in">min</span>(TK,N-kk+<span class="hljs-number">1</span>)      <span class="hljs-comment">! Innermost loop, vectorized and unrolled by 2 after that</span><br>                   qi = Q(K,I)           ;    qi1 = Q(K,I+<span class="hljs-number">1</span>)  <br>                   t1 = t1+qi*P(K,J)     ;    t2 = t2+ qi1*P(K,J)<br>                   t5 = t5+ qi*P(K,J+<span class="hljs-number">1</span>)  ;    t6 = t6+ qi1*P(K,J+<span class="hljs-number">1</span>)<br>                   t9 = t9+ qi*P(K,J+<span class="hljs-number">2</span>)  ;    t10 = t10+ qi1*P(K,J+<span class="hljs-number">2</span>)<br>                   t13 = t13+ qi*P(K,J+<span class="hljs-number">3</span>);    t14 = t14+qi1*P(K,J+<span class="hljs-number">3</span>)<br>                <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>               c(i+ii-<span class="hljs-number">1</span>,j+jj-<span class="hljs-number">1</span>) = c(i+ii-<span class="hljs-number">1</span>,j+jj-<span class="hljs-number">1</span>) +t1          ; c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+jj-<span class="hljs-number">1</span>) = c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+jj-<span class="hljs-number">1</span>) + t2<br>               c(i+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">1</span>+jj-<span class="hljs-number">1</span>) = c(i+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">1</span>+jj-<span class="hljs-number">1</span>) + t5     ; c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">1</span>+jj-<span class="hljs-number">1</span>) = c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">1</span>+jj-<span class="hljs-number">1</span>) + t6<br>               c(i+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">2</span>+jj-<span class="hljs-number">1</span>) = c(i+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">2</span>+jj-<span class="hljs-number">1</span>) + t9     ; c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">2</span>+jj-<span class="hljs-number">1</span>) = c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">2</span>+jj-<span class="hljs-number">1</span>) + t10<br>               c(i+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">3</span>+jj-<span class="hljs-number">1</span>) = c(i+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">3</span>+jj-<span class="hljs-number">1</span>) + t13    ; c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">3</span>+jj-<span class="hljs-number">1</span>) = c(i+<span class="hljs-number">1</span>+ii-<span class="hljs-number">1</span>,j+<span class="hljs-number">3</span>+jj-<span class="hljs-number">1</span>) + t14<br>             <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>           <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>         <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>       <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br>     <span class="hljs-keyword">end</span> <span class="hljs-keyword">do</span><br></code></pre></div></td></tr></table></figure><h3 id="Take-Aways"><a href="#Take-Aways" class="headerlink" title="Take Aways"></a>Take Aways</h3><p>ç¼“å­˜åˆ†å—æ˜¯ä¸€ç§é‡æ–°å®‰æ’æ•°æ®è®¿é—®çš„æŠ€æœ¯ï¼Œå°†æ•°æ®å­é›†(å—)æ‹‰å…¥ç¼“å­˜ï¼Œå¹¶å¯¹è¿™ä¸ªå—è¿›è¡Œæ“ä½œï¼Œä»¥é¿å…ä¸å¾—ä¸é‡å¤ä»ä¸»å­˜ä¸­è·å–æ•°æ®ã€‚æ­£å¦‚ä¸Šé¢çš„ç¤ºä¾‹æ‰€ç¤ºï¼Œå¯ä»¥ä»¥è¿™ç§æ–¹å¼æ‰‹åŠ¨åˆ†å—å¾ªç¯æ•°æ®ä»¥é‡ç”¨ç¼“å­˜ã€‚</p><p>å¯¹äºæ€§èƒ½å…³é”®çš„å¾ªç¯ï¼Œå…¶ä¸­æ€§èƒ½åˆ†æè¡¨æ˜å†…å­˜å¸¦å®½é™åˆ¶ï¼Œè€Œ-opt-reportæ˜¾ç¤ºç¼–è¯‘å™¨æ²¡æœ‰ä»¥æœ€ä½³æ–¹å¼åˆ†å—å¾ªç¯ï¼Œæ‚¨å¯ä»¥è€ƒè™‘æ‰‹åŠ¨å±•å¼€å¾ªç¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°åˆ†å—æ•°æ®ä»¥å®ç°ç¼“å­˜é‡ç”¨ã€‚</p><h3 id="NEXT-STEPS"><a href="#NEXT-STEPS" class="headerlink" title="NEXT STEPS"></a>NEXT STEPS</h3><p>æ‚¨å¿…é¡»ä»å¤´åˆ°å°¾é˜…è¯»æœ¬æŒ‡å—ï¼Œä½¿ç”¨å†…ç½®çš„è¶…é“¾æ¥æ¥æŒ‡å¯¼æ‚¨åœ¨IntelÂ®Xeonå¤„ç†å™¨ä¸ŠæˆåŠŸåœ°ç§»æ¤å’Œè°ƒä¼˜åº”ç”¨ç¨‹åºã€‚æœ¬æŒ‡å—ä¸­æä¾›çš„è·¯å¾„åæ˜ äº†è·å¾—æœ€ä½³åº”ç”¨ç¨‹åºæ€§èƒ½æ‰€éœ€çš„æ­¥éª¤ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Cache</tag>
      
      <tag>Blocking</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMP:Internal Control Variables</title>
    <link href="/2023/02/26/openmp008/"/>
    <url>/2023/02/26/openmp008/</url>
    
    <content type="html"><![CDATA[<h2 id="2-5-Internal-Control-Variables"><a href="#2-5-Internal-Control-Variables" class="headerlink" title="2.5 Internal Control Variables"></a>2.5 Internal Control Variables</h2><p>OpenMPå®ç°å¿…é¡»åƒå†…éƒ¨æ§åˆ¶å˜é‡(icv)ä¸€æ ·æ§åˆ¶OpenMPç¨‹åºçš„è¡Œä¸ºã€‚è¿™äº›icvå­˜å‚¨çš„ä¿¡æ¯åŒ…æ‹¬ç”¨äºæœªæ¥å¹¶è¡ŒåŒºåŸŸçš„çº¿ç¨‹æ•°ã€ç”¨äºå·¥ä½œå…±äº«å¾ªç¯çš„è°ƒåº¦ä»¥åŠæ˜¯å¦å¯ç”¨åµŒå¥—å¹¶è¡Œã€‚åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œicvåœ¨ä¸åŒçš„æ—¶é—´è¢«èµ‹äºˆå€¼(å¦‚ä¸‹æ‰€è¿°)ã€‚å®ƒä»¬æ˜¯ç”±å®ç°æœ¬èº«åˆå§‹åŒ–çš„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡OpenMPç¯å¢ƒå˜é‡å’Œè°ƒç”¨OpenMP APIä¾‹ç¨‹æ¥èµ‹å€¼ã€‚ç¨‹åºåªèƒ½é€šè¿‡OpenMP APIä¾‹ç¨‹æ£€ç´¢è¿™äº›icvçš„å€¼ã€‚</p><p>å‡ºäºè¯´æ˜çš„ç›®çš„ï¼Œæœ¬æ–‡æ¡£ä½¿ç”¨ç‰¹å®šçš„åç§°æ¥å¼•ç”¨icvï¼Œä½†æ˜¯å®ç°ä¸éœ€è¦ä½¿ç”¨è¿™äº›åç§°ï¼Œä¹Ÿä¸éœ€è¦æä¾›è®¿é—®å˜é‡çš„ä»»ä½•æ–¹æ³•ï¼Œé™¤éé€šè¿‡ç¬¬<a href="https://www.openmp.org/spec-html/5.0/openmpsu31.html#x50-680002.5.2">189</a>é¡µç¬¬<a href="https://www.openmp.org/spec-html/5.0/openmpsu31.html#x50-680002.5.2">2.5.2èŠ‚</a>æ‰€ç¤ºçš„æ–¹æ³•ã€‚</p><p>2.5.1 <a href="https://www.openmp.org/spec-html/5.0/openmpsu30.html#x49-670002.5.1">ICV Descriptions</a></p><p>2.5.2 <a href="https://www.openmp.org/spec-html/5.0/openmpsu31.html#x50-680002.5.2">ICV Initialization</a></p><p>2.5.3 <a href="https://www.openmp.org/spec-html/5.0/openmpsu32.html#x51-710002.5.3">Modifying and Retrieving ICV Values</a></p><p>2.5.4 <a href="https://www.openmp.org/spec-html/5.0/openmpsu33.html#x52-740002.5.4">How ICVs are Scoped</a></p><p>â€‹ 2.5.4.1 <a href="https://www.openmp.org/spec-html/5.0/openmpsu33.html#x52-760002.5.4.1">How the Per-Data Environment ICVs Work</a></p><p>2.5.5 <a href="https://www.openmp.org/spec-html/5.0/openmpsu34.html#x53-770002.5.5">ICV Override Relationships</a></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.openmp.org/spec-html/5.0/openmpse13.html#x48-660002.5">Internal Control Variables (openmp.org)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMPçº¿ç¨‹ç»‘å®šã€æœªå®Œç»“ã€‘</title>
    <link href="/2023/02/26/openmp007/"/>
    <url>/2023/02/26/openmp007/</url>
    
    <content type="html"><![CDATA[<h2 id="OpenMPçº¿ç¨‹ç»‘å®š"><a href="#OpenMPçº¿ç¨‹ç»‘å®š" class="headerlink" title="OpenMPçº¿ç¨‹ç»‘å®š"></a>OpenMPçº¿ç¨‹ç»‘å®š</h2><h3 id="OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤"><a href="#OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤" class="headerlink" title="OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤"></a>OpenMPç›¸å…³ç¯å¢ƒå˜é‡ä¸æŒ‡ä»¤</h3><h4 id="OMP-PROC-BIND"><a href="#OMP-PROC-BIND" class="headerlink" title="OMP_PROC_BIND"></a>OMP_PROC_BIND</h4><p>OMP_PROC_BINDç¯å¢ƒå˜é‡è®¾ç½®bind-var ICVçš„åˆå§‹å€¼ã€‚è¿™ä¸ªç¯å¢ƒå˜é‡çš„å€¼å¯ä»¥æ˜¯trueã€falseï¼Œæˆ–è€…ç”¨é€—å·åˆ†éš”çš„masterã€closeæˆ–spreadåˆ—è¡¨ã€‚åˆ—è¡¨çš„å€¼è®¾ç½®äº†å¯¹åº”åµŒå¥—çº§åˆ«çš„å¹¶è¡ŒåŒºåŸŸè¦ä½¿ç”¨çš„çº¿ç¨‹äº²å’Œç­–ç•¥ã€‚</p><p>å¦‚æœç¯å¢ƒå˜é‡è®¾ç½®ä¸ºfalseï¼Œåˆ™æ‰§è¡Œç¯å¢ƒå¯èƒ½ä¼šåœ¨OpenMPä½ç½®ä¹‹é—´ç§»åŠ¨OpenMPçº¿ç¨‹ï¼Œçº¿ç¨‹ç›¸å…³æ€§å°†è¢«ç¦ç”¨ï¼Œå¹¶è¡Œæ„é€ ä¸Šçš„proc_bindå­å¥å°†è¢«å¿½ç•¥ã€‚</p><p>å¦åˆ™ï¼Œæ‰§è¡Œç¯å¢ƒä¸åº”è¯¥åœ¨OpenMPä½ç½®ä¹‹é—´ç§»åŠ¨OpenMPçº¿ç¨‹ï¼Œçº¿ç¨‹äº²å’Œæ€§è¢«å¯ç”¨ï¼Œå¹¶ä¸”åˆå§‹çº¿ç¨‹è¢«ç»‘å®šåˆ°OpenMPä½ç½®åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œå…ˆäºç¬¬ä¸€ä¸ªæ´»åŠ¨å¹¶è¡ŒåŒºåŸŸã€‚</p><p>å¦‚æœOMP_PROC_BINDç¯å¢ƒå˜é‡ä¸­çš„å€¼ä¸æ˜¯trueã€falseæˆ–masterã€closeæˆ–spreadçš„é€—å·åˆ†éš”åˆ—è¡¨ï¼Œåˆ™ç¨‹åºçš„è¡Œä¸ºæ˜¯å®ç°å®šä¹‰çš„ã€‚å¦‚æœåˆå§‹çº¿ç¨‹ä¸èƒ½ç»‘å®šåˆ°OpenMPä½ç½®åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œåˆ™è¯¥è¡Œä¸ºä¹Ÿæ˜¯å®ç°å®šä¹‰çš„ã€‚</p><p>ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">setenv OMP_PROC_BIND false<br>setenv OMP_PROC_BIND &quot;spread,spread, close&quot;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://harrychen.xyz/2022/05/08/numa-processor-and-cpu-binding/">NUMA å¤„ç†å™¨ä¸è¿›ç¨‹ç»‘å®š - Harry Chenâ€™s Blog</a></p><p><a href="https://www.openmp.org/spec-html/5.0/openmpse52.html">OMP_PROC_BIND (openmp.org)</a></p><p><a href="https://www.openmp.org/spec-html/5.0/openmpsu36.html#x56-900002.6.2">Controlling OpenMP Thread Affinity</a></p><p><a href="https://www.openmp.org/spec-html/5.0/openmpse53.html">OMP_PLACES (openmp.org)</a></p><p><a href="https://www.intel.com/content/www/us/en/develop/documentation/cpp-compiler-developer-guide-and-reference/top/optimization-and-programming/openmp-support/openmp-library-support/thread-affinity-interface.html">Thread Affinity Interface (intel.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºGDBçš„ç¨‹åºè°ƒè¯•</title>
    <link href="/2023/02/24/Linux003/"/>
    <url>/2023/02/24/Linux003/</url>
    
    <content type="html"><![CDATA[<h2 id="åŸºäºGDBçš„ç¨‹åºè°ƒè¯•"><a href="#åŸºäºGDBçš„ç¨‹åºè°ƒè¯•" class="headerlink" title="åŸºäºGDBçš„ç¨‹åºè°ƒè¯•"></a>åŸºäºGDBçš„ç¨‹åºè°ƒè¯•</h2><h3 id="ç¨‹åºè°ƒè¯•å·¥å…·GDB"><a href="#ç¨‹åºè°ƒè¯•å·¥å…·GDB" class="headerlink" title="ç¨‹åºè°ƒè¯•å·¥å…·GDB"></a>ç¨‹åºè°ƒè¯•å·¥å…·GDB</h3><p>ç¼–è¯‘å™¨GCCï¼Œé¡¹ç›®æ„å»ºå·¥å…·Makeï¼ˆåˆç§°gmakeï¼‰ï¼Œä»¥åŠGDBã€‚</p><p><img src="/2023/02/24/Linux003/image-20230224165344672.png" alt="image-20230224165344672"></p><p><strong>GDBæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>GDBï¼šGNU symbolic debuggeræ˜¯Linuxä¸‹å¸¸ç”¨çš„ç¨‹åºè°ƒè¯•å™¨</p><p><strong>GDBå¯ä»¥åšä»€ä¹ˆï¼Ÿ</strong></p><p><img src="/2023/02/24/Linux003/image-20230224165606636.png" alt="image-20230224165606636"></p><p><strong>GDBå®˜ç½‘ï¼š</strong><a href="https://www.sourceware.org/gdb/">GDB: The GNU Project Debugger (sourceware.org)</a></p><h3 id="è°ƒè¯•æ¡ˆä¾‹ä¸€"><a href="#è°ƒè¯•æ¡ˆä¾‹ä¸€" class="headerlink" title="è°ƒè¯•æ¡ˆä¾‹ä¸€"></a>è°ƒè¯•æ¡ˆä¾‹ä¸€</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">int</span> n,sum;<br>    n = <span class="hljs-number">1</span>;<br>    sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>( n &lt;= <span class="hljs-number">100</span>)<br>    &#123;<br>        sum = sum + n;<br>        n = n + <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨ç¼–è¯‘ç¨‹åºçš„æ—¶å€™ï¼Œéœ€è¦åŠ è°ƒè¯•é€‰é¡¹ï¼š -g</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">gcc gdb001.c -g -o ex1<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨gdbå¯åŠ¨ç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">gdb ./ex1<br></code></pre></div></td></tr></table></figure><p><strong>è¿›å…¥gdbè°ƒè¯•ç¯å¢ƒ</strong>ï¼š</p><p><img src="/2023/02/24/Linux003/image-20230224170419171.png" alt="image-20230224170419171"></p><p><strong>åœ¨è°ƒè¯•ç¯å¢ƒä¸­ï¼šä½¿ç”¨lé€‰é¡¹ä¼šæ˜¾ç¤ºå¸¦è¡Œå·çš„æºä»£ç </strong></p><p><img src="/2023/02/24/Linux003/image-20230224170620617.png" alt="image-20230224170620617"></p><p><strong>ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œlé€‰é¡¹åªæ˜¾ç¤º10è¡Œæºä»£ç ï¼Œå¦‚æœæŸ¥çœ‹åç»­ä»£ç ï¼Œåœ¨è°ƒè¯•ç•Œé¢Enterå›è½¦å³å¯</strong></p><p><img src="/2023/02/24/Linux003/image-20230224170804048.png" alt="image-20230224170804048"></p><p><strong>åœ¨ç¬¬7è¡Œæºä»£ç å¤„æ‰“æ–­ç‚¹ï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224171858691.png" alt="image-20230224171858691"></p><p><strong>è¿è¡Œç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœæ­¢ï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172105514.png" alt="image-20230224172105514"></p><p><strong>æŸ¥çœ‹ä»£ç ä¸­å˜é‡nçš„å€¼</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172200662.png" alt="image-20230224172200662"></p><p>å½“å‰nçš„å€¼ä¸º1ï¼Œ$1è¡¨ç¤ºè¯¥å˜é‡æ‰€åœ¨å­˜å‚¨åŒºçš„åç§°</p><p><strong>åœ¨ç¨‹åºç¬¬12è¡Œå¤„æ‰“æ–­ç‚¹</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172321002.png" alt="image-20230224172321002"></p><p><strong>ç»§ç»­æ‰§è¡Œç¨‹åº</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172356622.png" alt="image-20230224172356622"></p><p><strong>æŸ¥çœ‹å½“å‰nå˜é‡çš„å€¼</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172422998.png" alt="image-20230224172422998"></p><p>å½“å‰nçš„å€¼ä¸º101</p><p><strong>é€€å‡ºè°ƒè¯•</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172456626.png" alt="image-20230224172456626"></p><p><strong>æŸ¥çœ‹è°ƒè¯•ç¯å¢ƒæ‰€æœ‰æ–­ç‚¹ï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172650422.png" alt="image-20230224172650422"></p><p><strong>åˆ é™¤ç¬¬7è¡Œçš„æ–­ç‚¹ï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172745323.png" alt="image-20230224172745323"></p><p><strong>ç¦ç”¨ç¼–å·ä¸º2çš„æ–­ç‚¹ï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224172832507.png" alt="image-20230224172832507"></p><p>æ³¨æ„æ–­ç‚¹çŠ¶æ€Enb(enable)ç”±yå˜æˆnï¼Œä»£è¡¨ç¦ç”¨</p><p><strong>æ¢å¤ç¼–å·ä¸º2çš„æ–­ç‚¹ï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224173006975.png" alt="image-20230224173006975"></p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>GDBæœ‰ä¸‰ç§è°ƒè¯•æ¨¡å¼ï¼š</p><p><strong>è°ƒè¯•æ‰§è¡Œç¨‹åºï¼š</strong>ï¼ˆå‰é¢çš„æ¡ˆä¾‹ï¼‰ï¼Œæ³¨æ„ç¼–è¯‘åŠ è°ƒè¯•ä¿¡æ¯(-g)</p><p><strong>è°ƒè¯•coreæ–‡ä»¶   ï¼š</strong>éœ€è¦å¯¹ç³»ç»Ÿè®¾ç½®çš„coreæ–‡ä»¶å¤§å°ä½œè°ƒæ•´ï¼ˆulimit - c unlimlitedï¼‰ï¼Œå¦åˆ™å¯èƒ½æ— æ³•  äº§ç”Ÿcoreæ–‡ä»¶</p><p><strong>è°ƒè¯•æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºï¼ˆgdb attachï¼‰ ï¼š</strong>Topæ‰¾åˆ°è¿›ç¨‹ç¼–å·pidï¼ŒGdb attach pid</p><p><strong>GDBç»“æ„ç»„æˆï¼š</strong></p><p><img src="/2023/02/24/Linux003/image-20230224173613247.png" alt="image-20230224173613247"></p><h3 id="å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š"><a href="#å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š" class="headerlink" title="å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š"></a>å¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼š</h3><h4 id="å¯åŠ¨æŒ‡ä»¤"><a href="#å¯åŠ¨æŒ‡ä»¤" class="headerlink" title="å¯åŠ¨æŒ‡ä»¤"></a>å¯åŠ¨æŒ‡ä»¤</h4><p>è°ƒè¯•ç¨‹åºï¼šgdb program</p><p>æ ¹æ®coreæ–‡ä»¶è°ƒè¯•ç¨‹åºï¼šgdb program corefile</p><p>è·Ÿè¸ªè°ƒè¯•è¿›ç¨‹ï¼šgdb attach pid</p><h4 id="ç¨‹åºè¿è¡Œ"><a href="#ç¨‹åºè¿è¡Œ" class="headerlink" title="ç¨‹åºè¿è¡Œ"></a>ç¨‹åºè¿è¡Œ</h4><p>runï¼Œè¯¥å‘½ä»¤ä¼šè¿è¡Œè‡³ç¨‹åºç»“æŸï¼Œé™¤éé‡åˆ°æ–­ç‚¹æˆ–æŠ¥é”™</p><h4 id="å•æ­¥æ‰§è¡Œ"><a href="#å•æ­¥æ‰§è¡Œ" class="headerlink" title="å•æ­¥æ‰§è¡Œ"></a>å•æ­¥æ‰§è¡Œ</h4><p>æ­¥è¿›æ‰§è¡Œä¸è¿›æ ˆï¼Ÿnext</p><p>æ­¥è¿›æ‰§è¡Œï¼Œè¿›æ ˆstep</p><h4 id="ä»£ç æŸ¥çœ‹"><a href="#ä»£ç æŸ¥çœ‹" class="headerlink" title="ä»£ç æŸ¥çœ‹"></a>ä»£ç æŸ¥çœ‹</h4><p>åˆ—å‡ºæ–­ç‚¹é™„è¿‘æˆ–ç¨‹åºæ‰€æœ‰ä»£ç list</p><p>è®¾ç½®ç°å®ä»£ç çš„è¡Œæ•° set listsize &lt;n&gt;</p><h4 id="é€€å‡ºè°ƒè¯•"><a href="#é€€å‡ºè°ƒè¯•" class="headerlink" title="é€€å‡ºè°ƒè¯•"></a>é€€å‡ºè°ƒè¯•</h4><p>quit</p><h4 id="æŸ¥çœ‹æ ˆä¿¡æ¯"><a href="#æŸ¥çœ‹æ ˆä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ ˆä¿¡æ¯"></a>æŸ¥çœ‹æ ˆä¿¡æ¯</h4><p>btæ‰“å°å½“å‰çš„å‡½æ•°è°ƒç”¨æ ˆçš„æ‰€æœ‰ä¿¡æ¯</p><p>bt &lt;n&gt;næ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºåªæ‰“å°æ ˆé¡¶ä¸Šnå±‚çš„æ ˆä¿¡æ¯</p><p>bt &lt;-n&gt;è¡¨ç¤ºåªæ‰“å°æ ˆåº•ä¸‹nå±‚çš„æ ˆä¿¡æ¯</p><h4 id="è®¾ç½®æ–­ç‚¹"><a href="#è®¾ç½®æ–­ç‚¹" class="headerlink" title="è®¾ç½®æ–­ç‚¹"></a>è®¾ç½®æ–­ç‚¹</h4><p><strong>ä»£ç æ–­ç‚¹ï¼š</strong></p><ul><li>break lineNumber | functionName</li><li>break lineNumber | functionName if condition</li><li>tbreak lineNumber | functionName  ä¸´æ—¶æ–­ç‚¹ï¼Œä»…èƒ½ä½¿ç”¨ä¸€æ¬¡</li></ul><p><strong>å†…å­˜æ–­ç‚¹ï¼ˆè§‚å¯Ÿç‚¹ï¼‰ï¼š</strong></p><ul><li>ç›‘æ§å†…å­˜å€¼æ”¹å˜ watch expr [if condition]</li><li>ç›‘æ§å†…å­˜å€¼è¢«è¯»å– rwatch expr [if condition]</li><li>ç›‘æ§å†…å­˜å€¼è¢«è¯»å–å’Œå†™å…¥ awatch wxpr [if condition]</li></ul><p><strong>äº‹ä»¶æ–­ç‚¹ï¼š</strong></p><ul><li>C++ exceptionï¼Œä½¿ç”¨catch exception [name]</li><li>Ada exceptionï¼Œä½¿ç”¨catch handlers [name]</li><li>execäº‹ä»¶ï¼Œä½¿ç”¨catch exec</li><li>forkäº‹ä»¶ï¼Œä½¿ç”¨catch fork æˆ–è€… catch vfork</li><li>åŠ è½½å’Œå¸è½½åŠ¨æ€soäº‹ä»¶ï¼Œä½¿ç”¨catch load|unload [regexp]</li><li>ç›‘å¬ç³»ç»Ÿä¿¡å·ï¼Œä½¿ç”¨catch signal [signal]</li><li>ç›‘å¬ç³»ç»Ÿè°ƒç”¨ï¼Œä½¿ç”¨catch syscall[name|number|group:groupname|g:groupname]â€¦</li></ul><p><strong>æ‰“å°å˜é‡ï¼š</strong></p><ul><li>Print [file | func]::variable æŸ¥çœ‹å±€éƒ¨å˜é‡æˆ–å…¨å±€å˜é‡</li><li>Print *array@len  æ•°ç»„é¦–åœ°å€@æŸ¥çœ‹é•¿åº¦</li><li>x&#x2F;[n | u] &lt;addr&gt;xå‘½ä»¤æŸ¥çœ‹å†…å­˜åœ°å€é’Ÿçš„å€¼ï¼Œnï¼šè¡¨ç¤ºæ˜¾ç¤ºå†…å­˜çš„é•¿åº¦ï¼Œuï¼šè¡¨ç¤ºä»å½“å‰åœ°å€å¾€åè¯·æ±‚çš„å­—èŠ‚æ•°</li></ul><p><strong>æ‰“å°å¯„å­˜å™¨ï¼š</strong></p><p>info registeræŸ¥çœ‹å¯„å­˜å™¨ï¼ˆé™¤äº†æµ®ç‚¹å¯„å­˜å™¨ï¼‰</p><p>all-registersæŸ¥çœ‹æ‰€æœ‰å¯„å­˜å™¨</p><p>info registers &lt;reg_name â€¦&gt;æŸ¥çœ‹æ‰€æŒ‡å®šå¯„å­˜å™¨</p><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><strong>æ¥æºåŸ¹è®­PPT ä½œè€…ï¼šRelax  é‚®ç®±ï¼š<a href="mailto:&#x77;&#x61;&#x6e;&#103;&#119;&#x31;&#49;&#49;&#64;&#105;&#x63;&#x6c;&#x6f;&#x75;&#x64;&#x2e;&#99;&#x6f;&#x6d;">&#x77;&#x61;&#x6e;&#103;&#119;&#x31;&#49;&#49;&#64;&#105;&#x63;&#x6c;&#x6f;&#x75;&#x64;&#x2e;&#99;&#x6f;&#x6d;</a></strong></p>]]></content>
    
    
    <categories>
      
      <category>Operating System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º</title>
    <link href="/2023/02/19/Matrix002/"/>
    <url>/2023/02/19/Matrix002/</url>
    
    <content type="html"><![CDATA[<h2 id="çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º"><a href="#çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º" class="headerlink" title="çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º"></a>çŸ©é˜µä¹˜æ³•è®¡ç®—æ‹†åˆ†å±•ç¤º</h2><h3 id="é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ"><a href="#é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ" class="headerlink" title="é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ"></a>é€šç”¨çŸ©é˜µä¹˜æ¦‚å¿µ</h3><p><img src="/2023/02/19/Matrix002/image-20230219171156738.png" alt="image-20230219171156738"></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µå„è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µiè¡Œjåˆ—</span><br>        c[i][j] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>; p &lt; k; p++)&#123;<span class="hljs-comment">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class="hljs-comment">//è®¡ç®—åŒºåŸŸ</span><br>           C[i][j] += A[i][p] * B[p][j];<span class="hljs-comment">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="è®¡ç®—æ‹†åˆ†å±•ç¤º"><a href="#è®¡ç®—æ‹†åˆ†å±•ç¤º" class="headerlink" title="è®¡ç®—æ‹†åˆ†å±•ç¤º"></a>è®¡ç®—æ‹†åˆ†å±•ç¤º</h3><p>å›¾å››å°†è¾“å‡ºè®¡ç®—æ‹†åˆ†ä¸º <strong>1 Ã— 4</strong> çš„å°å—ï¼Œå³å°† <strong>N</strong> ç»´åº¦æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚è®¡ç®—è¯¥å—è¾“å‡ºæ—¶ï¼Œéœ€è¦ä½¿ç”¨ <strong>A</strong> çŸ©é˜µçš„1è¡Œï¼Œå’Œ <strong>B</strong> çŸ©é˜µçš„4åˆ— ã€‚</p><p><img src="/2023/02/19/Matrix002/image-20230219171904249.png" alt="image-20230219171904249"></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µå„è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j +=<span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µj-j+3åˆ—</span><br>        c[i][j + <span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>        c[i][j + <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>        c[i][j + <span class="hljs-number">2</span>] = <span class="hljs-number">0</span>;<br>        c[i][j + <span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>; p &lt; k; p++)&#123;<span class="hljs-comment">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class="hljs-comment">//è®¡ç®—åŒºåŸŸ</span><br>            <span class="hljs-comment">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>           C[i][j + <span class="hljs-number">0</span>] += A[i][p] * B[p][j + <span class="hljs-number">0</span>];    <br>           C[i][j + <span class="hljs-number">1</span>] += A[i][p] * B[p][j + <span class="hljs-number">1</span>];<br>           C[i][j + <span class="hljs-number">2</span>] += A[i][p] * B[p][j + <span class="hljs-number">2</span>];<br>           C[i][j + <span class="hljs-number">3</span>] += A[i][p] * B[p][j + <span class="hljs-number">3</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ€å†…ä¾§è®¡ç®—ä½¿ç”¨çš„çŸ©é˜µ<strong>A</strong>çš„å…ƒç´ æ˜¯ä¸€è‡´çš„ã€‚å› æ­¤å¯ä»¥å°†**A[i][p]**è¯»å–åˆ°å¯„å­˜å™¨ä¸­ï¼Œä»è€Œå®ç°4æ¬¡æ•°æ®å¤ç”¨ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">register</span> <span class="hljs-keyword">double</span> temp = A[i][p];<br></code></pre></div></td></tr></table></figure><p>ä¸€èˆ¬å°†æœ€å†…ä¾§å¾ªç¯ç§°ä½œè®¡ç®—æ ¸(micro kernel)</p><p>ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ‹†åˆ†è¾“å‡º<strong>M</strong>ç»´åº¦ï¼Œä»è€Œåœ¨å†…æµ‹å¾ªç¯ä¸­è®¡ç®— <strong>4 Ã— 4</strong> è¾“å‡ºï¼Œå¦‚å›¾äº”ã€‚</p><p><img src="/2023/02/19/Matrix002/image-20230219174355047.png" alt="image-20230219174355047"></p><p>åŒæ ·çš„ï¼Œå°†è®¡ç®—æ ¸å¿ƒå±•å¼€ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä¼ªä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°† <strong>1 Ã— 4</strong> ä¸­å±•ç¤ºè¿‡çš„Nç»´åº¦çš„è®¡ç®—ç®€åŒ–è¡¨ç¤ºã€‚è¿™ç§æ‹†åˆ†å¯çœ‹æˆæ˜¯<strong>4 Ã— 1 Ã— 4</strong>ï¼Œè¿™æ ·Aå’ŒBçš„è®¿å­˜å‡å¯å¤ç”¨å››æ¬¡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i+=<span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µi-i+3è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j +=<span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µç¬¬j-j+3åˆ—</span><br>        c[i + <span class="hljs-number">0</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        c[i + <span class="hljs-number">1</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        c[i + <span class="hljs-number">2</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        c[i + <span class="hljs-number">3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>; p &lt; k; p++)&#123;<span class="hljs-comment">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class="hljs-comment">//è®¡ç®—åŒºåŸŸ</span><br>            <span class="hljs-comment">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>           C[i + <span class="hljs-number">0</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">0</span>][p] * B[p][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];    <br>           C[i + <span class="hljs-number">1</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">1</span>][p] * B[p][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];<br>           C[i + <span class="hljs-number">2</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">2</span>][p] * B[p][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];<br>           C[i + <span class="hljs-number">3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">3</span>][p] * B[p][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åˆ°ç›®å‰ä¸ºæ­¢ã€‚æˆ‘ä»¬éƒ½æ˜¯åœ¨è¾“å‡ºçš„ä¸¤ä¸ªç»´åº¦ä¸Šå±•å¼€ï¼Œè€Œæ•´ä¸ªè®¡ç®—è¿˜åŒ…å«ä¸€ä¸ªè§„çº¦(Reduction)ç»´åº¦Kã€‚å›¾å…­å±•ç¤ºäº†åœ¨è®¡ç®—<strong>4 Ã— 4</strong>è¾“å‡ºæ—¶ï¼Œå°†ç»´åº¦Kæ‹†åˆ†ï¼Œä»è€Œæ¯æ¬¡æœ€å†…ä¾§å¾ªç¯è®¡ç®—å‡ºè¾“å‡ºçŸ©é˜µCçš„<strong>4&#x2F;K</strong>çš„éƒ¨åˆ†å’Œã€‚</p><p><img src="/2023/02/19/Matrix002/image-20230219180147184.png" alt="image-20230219180147184"></p><p>ä¸‹é¢å±•ç¤ºçš„æ˜¯è¿™éƒ¨åˆ†è®¡ç®—çš„å±•å¼€ä¼ªä»£ç ï¼Œå…¶ä¸­ç»´åº¦Må’ŒNå·²ç»è¢«ç®€å†™ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i+=<span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µi-i+3è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j +=<span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µç¬¬j-j+3åˆ—</span><br>        c[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        c[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        c[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        c[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>; p &lt; k; p+=<span class="hljs-number">4</span>)&#123;<span class="hljs-comment">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class="hljs-comment">//è®¡ç®—åŒºåŸŸ</span><br>           C[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][p + <span class="hljs-number">0</span>] * B[p + <span class="hljs-number">0</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];    <br>           C[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][p + <span class="hljs-number">1</span>] * B[p + <span class="hljs-number">1</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];<br>           C[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][p + <span class="hljs-number">2</span>] * B[p + <span class="hljs-number">2</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];<br>           C[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>] += A[i + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>][p + <span class="hljs-number">3</span>] * B[p + <span class="hljs-number">3</span>][j + <span class="hljs-number">0.</span><span class="hljs-number">.3</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨å¯¹Må’ŒNå±•å¼€å¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å¤ç”¨Bå’ŒAçš„æ•°æ®ï¼›åœ¨å¯¹Kå±•å¼€æ—¶ï¼Œå…¶å±€éƒ¨ä½¿ç”¨çš„Cçš„å†…å­˜æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆKè¿­ä»£æ—¶å¯ä»¥å°†éƒ¨åˆ†å’Œç´¯åŠ åœ¨å¯„å­˜å™¨ä¸­â€”â€”æœ€å†…å±‚å¾ªç¯æ•´ä¸ªè¿­ä»£ä¸€æ¬¡å†™åˆ°Cçš„å†…å­˜ä¸­ã€‚</p><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://zhenhuaw.me/blog/2019/gemm-optimization.html">é€šç”¨çŸ©é˜µä¹˜ï¼ˆGEMMï¼‰ä¼˜åŒ–ç®—æ³• | é»æ˜ç°çƒ¬ åšå®¢ (zhenhuaw.me)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Matrix</tag>
      
      <tag>GEMM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>11. ç››æœ€å¤šæ°´çš„å®¹å™¨</title>
    <link href="/2023/02/18/leetcode11/"/>
    <url>/2023/02/18/leetcode11/</url>
    
    <content type="html"><![CDATA[<h2 id="11-ç››æœ€å¤šæ°´çš„å®¹å™¨"><a href="#11-ç››æœ€å¤šæ°´çš„å®¹å™¨" class="headerlink" title="11.ç››æœ€å¤šæ°´çš„å®¹å™¨"></a>11.ç››æœ€å¤šæ°´çš„å®¹å™¨</h2><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><h4 id="11-ç››æœ€å¤šæ°´çš„å®¹å™¨-1"><a href="#11-ç››æœ€å¤šæ°´çš„å®¹å™¨-1" class="headerlink" title="11. ç››æœ€å¤šæ°´çš„å®¹å™¨"></a><a href="https://leetcode.cn/problems/container-with-most-water/">11. ç››æœ€å¤šæ°´çš„å®¹å™¨</a></h4><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">maxArea</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt;&amp; height)</span> </span>&#123;<br>        <span class="hljs-comment">//åŒæŒ‡é’ˆï¼›</span><br>        <span class="hljs-keyword">int</span> ans =<span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">int</span> left=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> right=height.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">while</span>(left&lt;right)&#123;<br>            <span class="hljs-keyword">int</span> temp=<span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span>(height[left]&lt;=height[right])&#123;<br>                temp = height[left]*(right-left);<br>                ans = std::<span class="hljs-built_in">max</span>(ans,temp);<br>                left++;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                temp = height[right]*(right-left);<br>                ans = std::<span class="hljs-built_in">max</span>(ans,temp);<br>                right--;<br>            &#125;<br>            <br>        &#125;<br>        <span class="hljs-keyword">return</span> ans;<br>        <br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://leetcode.cn/problems/container-with-most-water/solution/sheng-zui-duo-shui-de-rong-qi-by-leetcode-solution/">ç››æœ€å¤šæ°´çš„å®¹å™¨ - ç››æœ€å¤šæ°´çš„å®¹å™¨ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>146.LRU cache</title>
    <link href="/2023/02/17/leetcode001/"/>
    <url>/2023/02/17/leetcode001/</url>
    
    <content type="html"><![CDATA[<h2 id="146-LRU-cache"><a href="#146-LRU-cache" class="headerlink" title="146.LRU cache"></a>146.LRU cache</h2><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://leetcode.cn/problems/lru-cache/">146. LRU ç¼“å­˜ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LRUCache</span> &#123;</span><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">int</span> cap=<span class="hljs-number">0</span>;<br>    list&lt;pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;&gt; lru;   <span class="hljs-comment">//çœŸæ­£çš„cache</span><br>    unordered_map&lt;<span class="hljs-keyword">int</span>,list&lt;pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;&gt;::iterator&gt; mp;   <span class="hljs-comment">//ä¸»è¦ç”¨å¤„å°±æ˜¯æŸ¥æ‰¾</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">LRUCache</span>(<span class="hljs-keyword">int</span> capacity) &#123;<br>        cap = capacity;<span class="hljs-comment">//å®¹é‡</span><br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>&#123;<span class="hljs-comment">//ä½œä¸ºå°±æ˜¯æŠŠæœ€è¿‘è®¿é—®çš„æ”¾åœ¨è¡¨å¤´</span><br>        <span class="hljs-keyword">if</span>(mp.<span class="hljs-built_in">find</span>(key)!=mp.<span class="hljs-built_in">end</span>())&#123;<span class="hljs-comment">//æœ‰è¿™ä¸ªå…ƒç´ </span><br>            lru.<span class="hljs-built_in">splice</span>(lru.<span class="hljs-built_in">begin</span>(),lru,mp[key]);<span class="hljs-comment">//å°†ä¸€ä¸ª list å®¹å™¨ä¸­çš„å…ƒç´ æ’å…¥åˆ°å¦ä¸€ä¸ªå®¹å™¨çš„æŒ‡å®šä½ç½®</span><br>            <span class="hljs-keyword">return</span> lru.<span class="hljs-built_in">begin</span>()-&gt;second;<span class="hljs-comment">//è¿”å›å…ƒç´ </span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<span class="hljs-comment">//æ²¡æœ‰è¿™ä¸ªå…ƒç´ </span><br>        &#125;<br>    &#125;<br><br>    <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">put</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key, <span class="hljs-keyword">int</span> value)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">get</span>(key)!=<span class="hljs-number">-1</span>)&#123;<span class="hljs-comment">//cacheä¸­æœ‰keyï¼Œè°ƒç”¨getåè‡ªåŠ¨æ’å…¥åˆ°è¡¨å¤´ã€keyå­˜åœ¨ã€‘</span><br>            lru.<span class="hljs-built_in">begin</span>()-&gt;second = value;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-comment">//ã€keyä¸å­˜åœ¨ã€‘</span><br>            <span class="hljs-keyword">if</span>(lru.<span class="hljs-built_in">size</span>()==cap)&#123;<span class="hljs-comment">//å¦‚æœå®¹é‡æ»¡äº†</span><br>                <span class="hljs-keyword">int</span> delkey = lru.<span class="hljs-built_in">back</span>().first; <span class="hljs-comment">//è®°å½•æœ€ä¹…æœªè®¿é—®çš„key</span><br>                lru.<span class="hljs-built_in">pop_back</span>(); <span class="hljs-comment">//popæ‰ï¼Œç½®æ¢</span><br>                mp.<span class="hljs-built_in">erase</span>(delkey); <span class="hljs-comment">//æŸ¥æ‰¾è¡¨ä¸­ä¹Ÿåˆ é™¤</span><br>            &#125;<br>            lru.<span class="hljs-built_in">emplace_front</span>(key,value);<span class="hljs-comment">//å¤´éƒ¨ç”Ÿæˆä¸€ä¸ªå…ƒç´ </span><br>            mp[key]=lru.<span class="hljs-built_in">begin</span>();<span class="hljs-comment">//åŠ å…¥æŸ¥æ‰¾è¡¨</span><br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Your LRUCache object will be instantiated and called as such:</span><br><span class="hljs-comment"> * LRUCache* obj = new LRUCache(capacity);</span><br><span class="hljs-comment"> * int param_1 = obj-&gt;get(key);</span><br><span class="hljs-comment"> * obj-&gt;put(key,value);</span><br><span class="hljs-comment"> */</span><br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.jianshu.com/p/bbea4b2410e6">C++å®ç°LRUç¼“å­˜â€”â€”LeetCode146 - ç®€ä¹¦ (jianshu.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>LeetCode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BLISlabä¸­CçŸ©é˜µåˆå§‹åŒ–é€Ÿåº¦æµ‹è¯•</title>
    <link href="/2023/02/15/blislab003/"/>
    <url>/2023/02/15/blislab003/</url>
    
    <content type="html"><![CDATA[<h2 id="BLISlabä¸­CçŸ©é˜µåˆå§‹åŒ–é€Ÿåº¦æµ‹è¯•"><a href="#BLISlabä¸­CçŸ©é˜µåˆå§‹åŒ–é€Ÿåº¦æµ‹è¯•" class="headerlink" title="BLISlabä¸­CçŸ©é˜µåˆå§‹åŒ–é€Ÿåº¦æµ‹è¯•"></a>BLISlabä¸­CçŸ©é˜µåˆå§‹åŒ–é€Ÿåº¦æµ‹è¯•</h2><p><strong>å‡è®¾æˆ‘ä»¬æƒ³æŠŠCä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è®¾ä¸º0ã€‚</strong></p><p><strong>ç»Ÿä¸€ç¼–è¯‘å‘½ä»¤ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">g++  xxx.cpp -O0 -std=c++11 -o xxx<br></code></pre></div></td></tr></table></figure><h3 id="ç‰ˆæœ¬ä¸€ï¼š"><a href="#ç‰ˆæœ¬ä¸€ï¼š" class="headerlink" title="ç‰ˆæœ¬ä¸€ï¼š"></a>ç‰ˆæœ¬ä¸€ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> C( i, j )     C[ (j)*ldc + (i) ]</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> i,j,m,n;<br>m=<span class="hljs-number">20000</span>;<br>n=<span class="hljs-number">20000</span>;<br><span class="hljs-keyword">int</span> ldc=m;<br><span class="hljs-keyword">double</span>*C =(<span class="hljs-keyword">double</span>*)_mm_malloc(m*n*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>),<span class="hljs-number">32</span>);<br>std::chrono::high_resolution_clock::time_point tp1 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br><span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>    <span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123; <br>        <span class="hljs-built_in">C</span>(i,j) = <span class="hljs-number">0.0</span>;<br>    &#125;<br>&#125;<br>std::chrono::high_resolution_clock::time_point tp2 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br>std::chrono::duration&lt;<span class="hljs-keyword">size_t</span>, std::nano&gt; dur = tp2 - tp1;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;1 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; çº³ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;2 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; å¾®å¦™&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;3 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; æ¯«ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;4 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::seconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; ç§’é’Ÿ&quot;</span> &lt;&lt; std::endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></div></td></tr></table></figure><h3 id="å®æµ‹ç»“æœï¼š"><a href="#å®æµ‹ç»“æœï¼š" class="headerlink" title="å®æµ‹ç»“æœï¼š"></a>å®æµ‹ç»“æœï¼š</h3><figure class="highlight basic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">10776901341</span> çº³ç§’<br><span class="hljs-symbol">2 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">10776901</span> å¾®å¦™<br><span class="hljs-symbol">3 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">10776</span> æ¯«ç§’<br><span class="hljs-symbol">4 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">10</span> ç§’é’Ÿ<br></code></pre></div></td></tr></table></figure><h3 id="ç‰ˆæœ¬äºŒï¼š"><a href="#ç‰ˆæœ¬äºŒï¼š" class="headerlink" title="ç‰ˆæœ¬äºŒï¼š"></a>ç‰ˆæœ¬äºŒï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> C( i, j )     C[ (j)*ldc + (i) ]</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> i,j,m,n;<br>m=<span class="hljs-number">20000</span>;<br>n=<span class="hljs-number">20000</span>;<br><span class="hljs-keyword">int</span> ldc=m;<br><span class="hljs-keyword">double</span>*C =(<span class="hljs-keyword">double</span>*)_mm_malloc(m*n*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>),<span class="hljs-number">32</span>);<br><span class="hljs-keyword">double</span> *cp;<br>std::chrono::high_resolution_clock::time_point tp1 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br><span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>    cp = &amp;C[ j*ldc ];<span class="hljs-comment">//point cp to top of ith column</span><br>    <span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        *cp++ = <span class="hljs-number">0.0</span>;<span class="hljs-comment">//set element that cp points to to zero and</span><br>    &#125;<span class="hljs-comment">//advance the pointer</span><br>&#125;<br>std::chrono::high_resolution_clock::time_point tp2 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br>std::chrono::duration&lt;<span class="hljs-keyword">size_t</span>, std::nano&gt; dur = tp2 - tp1;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;1 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; çº³ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;2 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; å¾®å¦™&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;3 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; æ¯«ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;4 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::seconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; ç§’é’Ÿ&quot;</span> &lt;&lt; std::endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></div></td></tr></table></figure><h3 id="å®æµ‹ç»“æœï¼š-1"><a href="#å®æµ‹ç»“æœï¼š-1" class="headerlink" title="å®æµ‹ç»“æœï¼š"></a>å®æµ‹ç»“æœï¼š</h3><figure class="highlight basic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">3455968000</span> çº³ç§’<br><span class="hljs-symbol">2 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">3455968</span> å¾®å¦™<br><span class="hljs-symbol">3 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">3455</span> æ¯«ç§’<br><span class="hljs-symbol">4 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">3</span> ç§’é’Ÿ<br></code></pre></div></td></tr></table></figure><h3 id="ç‰ˆæœ¬ä¸‰ï¼š"><a href="#ç‰ˆæœ¬ä¸‰ï¼š" class="headerlink" title="ç‰ˆæœ¬ä¸‰ï¼š"></a>ç‰ˆæœ¬ä¸‰ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> C( i, j )     C[ (j)*ldc + (i) ]</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> i,j,m,n;<br>m=<span class="hljs-number">20000</span>;<br>n=<span class="hljs-number">20000</span>;<br><span class="hljs-keyword">int</span> ldc=m;<br><span class="hljs-keyword">double</span>*C =(<span class="hljs-keyword">double</span>*)_mm_malloc(m*n*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>),<span class="hljs-number">32</span>);<br><span class="hljs-keyword">double</span> *cp;<br>std::chrono::high_resolution_clock::time_point tp1 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br><span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>    cp = &amp;C[ j * ldc ];<br>    <span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i+=<span class="hljs-number">4</span>)&#123;<br>       *(cp+<span class="hljs-number">0</span>) = <span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">1</span>) = <span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">2</span>) = <span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">3</span>) = <span class="hljs-number">0.0</span>;<br>        cp+=<span class="hljs-number">4</span>;<br>   &#125;<br>&#125;<br>std::chrono::high_resolution_clock::time_point tp2 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br>std::chrono::duration&lt;<span class="hljs-keyword">size_t</span>, std::nano&gt; dur = tp2 - tp1;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;1 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; çº³ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;2 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; å¾®å¦™&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;3 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; æ¯«ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;4 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::seconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; ç§’é’Ÿ&quot;</span> &lt;&lt; std::endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></div></td></tr></table></figure><h3 id="å®æµ‹ç»“æœï¼š-2"><a href="#å®æµ‹ç»“æœï¼š-2" class="headerlink" title="å®æµ‹ç»“æœï¼š"></a>å®æµ‹ç»“æœï¼š</h3><figure class="highlight basic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2581347801</span> çº³ç§’<br><span class="hljs-symbol">2 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2581347</span> å¾®å¦™<br><span class="hljs-symbol">3 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2581</span> æ¯«ç§’<br><span class="hljs-symbol">4 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2</span> ç§’é’Ÿ<br></code></pre></div></td></tr></table></figure><h3 id="ç‰ˆæœ¬å››ï¼š"><a href="#ç‰ˆæœ¬å››ï¼š" class="headerlink" title="ç‰ˆæœ¬å››ï¼š"></a>ç‰ˆæœ¬å››ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> C( i, j )     C[ (j)*ldc + (i) ]</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> i,j,m,n;<br>m=<span class="hljs-number">20000</span>;<br>n=<span class="hljs-number">20000</span>;<br><span class="hljs-keyword">int</span> ldc=m;<br><span class="hljs-keyword">double</span>*C =(<span class="hljs-keyword">double</span>*)_mm_malloc(m*n*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>),<span class="hljs-number">32</span>);<br><span class="hljs-keyword">double</span> *cp;<br>std::chrono::high_resolution_clock::time_point tp1 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br>    <span class="hljs-keyword">register</span> <span class="hljs-keyword">double</span> c0 =<span class="hljs-number">0.0</span>,c1=<span class="hljs-number">0.0</span>,c2=<span class="hljs-number">0.0</span>,c3=<span class="hljs-number">0.0</span>;<br><span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>    cp = &amp;C[ j * ldc ];<br>    <span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i+=<span class="hljs-number">4</span>)&#123;<br>        *(cp+<span class="hljs-number">0</span>) = c0;<br>        *(cp+<span class="hljs-number">1</span>) = c1;<br>        *(cp+<span class="hljs-number">2</span>) = c2;<br>        *(cp+<span class="hljs-number">3</span>) = c3;<br>        cp+=<span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br>std::chrono::high_resolution_clock::time_point tp2 = std::chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();<br>std::chrono::duration&lt;<span class="hljs-keyword">size_t</span>, std::nano&gt; dur = tp2 - tp1;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;1 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; çº³ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;2 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; å¾®å¦™&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;3 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; æ¯«ç§’&quot;</span> &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;4 è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š&quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::seconds&gt;(dur).<span class="hljs-built_in">count</span>() &lt;&lt; <span class="hljs-string">&quot; ç§’é’Ÿ&quot;</span> &lt;&lt; std::endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®æµ‹ç»“æœï¼š-3"><a href="#å®æµ‹ç»“æœï¼š-3" class="headerlink" title="å®æµ‹ç»“æœï¼š"></a>å®æµ‹ç»“æœï¼š</h3><figure class="highlight basic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2269606428</span> çº³ç§’<br><span class="hljs-symbol">2 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2269606</span> å¾®å¦™<br><span class="hljs-symbol">3 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2269</span> æ¯«ç§’<br><span class="hljs-symbol">4 </span>è¢«è®¡æ—¶ä»£ç è€—æ—¶ï¼š<span class="hljs-number">2</span> ç§’é’Ÿ<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://gukaifeng.cn/posts/c-11-chrono-gao-jing-du-ji-shi-fang-fa/">C++11 chrono é«˜ç²¾åº¦è®¡æ—¶æ–¹æ³• | GuKaifengâ€™s Blog</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>dgemm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BLISlab tutorilé˜…è¯»</title>
    <link href="/2023/02/12/blislib002/"/>
    <url>/2023/02/12/blislib002/</url>
    
    <content type="html"><![CDATA[<h1 id="BLISlab-tutorilé˜…è¯»"><a href="#BLISlab-tutorilé˜…è¯»" class="headerlink" title="BLISlab tutorilé˜…è¯»"></a>BLISlab tutorilé˜…è¯»</h1><h2 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h2><p><strong>Gitåœ°å€ï¼š</strong><a href="https://github.com/flame/blislab">https://github.com/flame/blislab</a> ã€ä»£ç åŒ…åŒ…å«tutoril.pdfã€‘</p><h2 id="BLISlab-A-Sandbox-for-Optimizing-GEMM"><a href="#BLISlab-A-Sandbox-for-Optimizing-GEMM" class="headerlink" title="BLISlab: A Sandbox for Optimizing GEMM"></a>BLISlab: A Sandbox for Optimizing GEMM</h2><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>çŸ©é˜µ-çŸ©é˜µä¹˜æ³•æ˜¯ç§‘å­¦è®¡ç®—ä¸­éå¸¸é‡è¦çš„åŸºæœ¬è¿ç®—ï¼Œæœºå™¨å­¦ä¹ ä¹Ÿè¶Šæ¥è¶Šé‡è¦ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¦‚å¿µï¼Œå¯ä»¥åœ¨å…¸å‹çš„é«˜ä¸­ä»£æ•°è¯¾ç¨‹ä¸­å¼•å…¥ï¼Œä½†åœ¨å®è·µä¸­åˆéå¸¸é‡è¦ï¼Œå®ƒåœ¨è®¡ç®—æœºä¸Šçš„å®ç°ä»ç„¶æ˜¯ä¸€ä¸ªæ´»è·ƒçš„ç ”ç©¶ä¸»é¢˜ã€‚æœ¬ç¬”è®°æè¿°äº†ä¸€ç»„ä½¿ç”¨è¯¥æ“ä½œçš„ç»ƒä¹ ï¼Œå¦‚ä½•åœ¨å…·æœ‰åˆ†å±‚å†…å­˜(å¤šä¸ªç¼“å­˜)çš„ç°ä»£cpuä¸Šè·å¾—é«˜æ€§èƒ½ã€‚å®ƒæ˜¯åŸºäºblasç±»åº“å®ä¾‹åŒ–è½¯ä»¶(BLIS)æ¡†æ¶ä¸‹çš„è§è§£ï¼Œé€šè¿‡å…¬å¼€ä¸€ä¸ªæ¨¡ä»¿BLISå®ç°çš„ç®€åŒ–â€œæ²™ç›’â€æ¥å®ç°çš„ã€‚å› æ­¤ï¼Œå®ƒä¹Ÿæˆä¸ºBLISä¼˜åŒ–çš„â€œä¼—åŒ…â€å·¥å…·ã€‚</p><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1.Introduction"></a>1.Introduction</h2><p>çŸ©é˜µ-çŸ©é˜µä¹˜æ³•(Gemm)ç»å¸¸è¢«ç”¨ä½œä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä»¥æé«˜å¦‚ä½•åœ¨ç°ä»£å¤„ç†å™¨ä¸Šä¼˜åŒ–ä»£ç çš„æ„è¯†ã€‚åŸå› æ˜¯è¯¥æ“ä½œæè¿°ç®€å•ï¼Œå¾ˆéš¾å®Œå…¨ä¼˜åŒ–ï¼Œè€Œä¸”å…·æœ‰å®é™…æ„ä¹‰ã€‚åœ¨æœ¬æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬å°†å¸¦é¢†è¯»è€…äº†è§£ç›®å‰CPUæ¶æ„ä¸­æœ€å¿«å®ç°çš„æŠ€æœ¯ã€‚</p><h3 id="1-1-Basic-Linear-Algebra-Subprograms-BLAS"><a href="#1-1-Basic-Linear-Algebra-Subprograms-BLAS" class="headerlink" title="1.1 Basic Linear Algebra Subprograms (BLAS)"></a>1.1 Basic Linear Algebra Subprograms (BLAS)</h3><p>åŸºæœ¬çº¿æ€§ä»£æ•°å­ç¨‹åº(BLAS)[10,5,4,14]ä¸ºä¸€ç»„çº¿æ€§ä»£æ•°æ“ä½œå½¢æˆäº†ä¸€ä¸ªæ¥å£ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºäº†æ›´é«˜çº§åˆ«çš„çº¿æ€§ä»£æ•°åº“ï¼Œå¦‚LAPACK[2]å’Œlibflame[19]ã€‚å…¶æ€æƒ³æ˜¯ï¼Œå¦‚æœæœ‰äººé’ˆå¯¹ç»™å®šçš„ä½“ç³»ç»“æ„ä¼˜åŒ–BLASï¼Œé‚£ä¹ˆæ‰€æœ‰ä»¥è°ƒç”¨BLASçš„æ–¹å¼ç¼–å†™çš„åº”ç”¨ç¨‹åºå’Œåº“éƒ½å°†å—ç›Šäºè¿™ç§ä¼˜åŒ–ã€‚</p><p>BLASè¢«åˆ†ä¸ºä¸‰ç»„:ä¸€çº§BLAS(çŸ¢é‡-çŸ¢é‡æ“ä½œ)ã€äºŒçº§BLAS(çŸ©é˜µ-çŸ¢é‡æ“ä½œ)å’Œä¸‰çº§BLAS(çŸ©é˜µ-çŸ©é˜µæ“ä½œ)ã€‚æœ€åä¸€ç»„å¾—ç›Šäºè¿™æ ·ä¸€ä¸ªäº‹å®:å¦‚æœæ‰€æœ‰çŸ©é˜µæ“ä½œæ•°çš„å¤§å°éƒ½æ˜¯n Ã— nï¼Œåˆ™O(n3)æµ®ç‚¹è¿ç®—å¯¹O(n)ä¸ªæ•°æ®æ‰§è¡Œï¼Œå› æ­¤åœ¨å†…å­˜å±‚(ä¸»å­˜ã€ç¼“å­˜å’Œå¯„å­˜å™¨)ä¹‹é—´ç§»åŠ¨æ•°æ®çš„æˆæœ¬å¯ä»¥åœ¨å¾ˆå¤šæ¬¡è®¡ç®—ä¸­å¹³æ‘Šã€‚å› æ­¤ï¼Œå¦‚æœä»”ç»†æ‰§è¡Œè¿™äº›æ“ä½œï¼ŒåŸåˆ™ä¸Šå¯ä»¥å®ç°é«˜æ€§èƒ½ã€‚</p><h3 id="1-2-Matrix-matrix-multiplication"><a href="#1-2-Matrix-matrix-multiplication" class="headerlink" title="1.2 Matrix-matrix multiplication"></a>1.2 Matrix-matrix multiplication</h3><p>ç‰¹åˆ«åœ°ï¼ŒBLASé€šè¿‡(Fortran)è°ƒç”¨æ”¯æŒå…·æœ‰åŒç²¾åº¦æµ®ç‚¹æ•°çš„Gemm:</p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">dgemm( transa, transb, m, n, k alpha, A,lda, B, ldb, beta, C, ldc)<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡é€‚å½“åœ°é€‰æ‹©è½¬ç½®aå’Œè½¬ç½®bæ¥è®¡ç®—:</p><p><img src="/2023/02/12/blislib002/image-20230212215656711.png" alt="image-20230212215656711"></p><p>è¿™é‡ŒCæ˜¯m Ã— n, kæ˜¯â€œç¬¬ä¸‰ç»´â€ã€‚å‚æ•°dla, dlbå’Œdlcå°†åœ¨æœ¬æ–‡æ¡£åé¢è¿›è¡Œè§£é‡Šã€‚</p><p>åœ¨æˆ‘ä»¬çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘Gemmçš„ç®€åŒ–ç‰ˆæœ¬:</p><p><img src="/2023/02/12/blislib002/image-20230212215836596.png" alt="image-20230212215836596"></p><p>å…¶ä¸­Cæ˜¯m Ã— n, Aæ˜¯m Ã— k, Bæ˜¯k Ã— nã€‚å¦‚æœäº†è§£å¦‚ä½•ä¼˜åŒ–dgemmçš„è¿™ç§ç‰¹æ®Šæƒ…å†µï¼Œé‚£ä¹ˆå¯ä»¥å¾ˆå®¹æ˜“åœ°å°†æ­¤çŸ¥è¯†æ‰©å±•åˆ°æ‰€æœ‰3çº§BLASåŠŸèƒ½ã€‚</p><h3 id="1-3-High-performance-implementation"><a href="#1-3-High-performance-implementation" class="headerlink" title="1.3 High-performance implementation"></a>1.3 High-performance implementation</h3><p>é«˜æ€§èƒ½å®ç°çš„å¤æ‚æ€§ä½¿å¾—BLAS(å°¤å…¶æ˜¯Gemm)çš„å®ç°é€šå¸¸éƒ½æ˜¯ç”±é»˜é»˜æ— é—»çš„ä¸“å®¶æ¥å®Œæˆçš„ï¼Œè¿™äº›ä¸“å®¶ä¸ºç¡¬ä»¶ä¾›åº”å•†å¼€å‘æ•°å­—åº“ï¼Œä¾‹å¦‚IBMçš„ESSLã€Intelçš„MKLã€Crayçš„LibSciå’ŒAMDçš„ACMLåº“ã€‚è¿™äº›åº“é€šå¸¸æ˜¯ç”¨æ±‡ç¼–ä»£ç ç¼–å†™çš„(è‡³å°‘æ˜¯éƒ¨åˆ†)ï¼Œå¹¶ä¸”é’ˆå¯¹ç‰¹å®šçš„å¤„ç†å™¨é«˜åº¦ä¸“é—¨åŒ–ã€‚</p><p>ä¸€ç¯‡å…³é”®è®ºæ–‡[1]å±•ç¤ºäº†â€œç®—æ³•å’Œä½“ç³»ç»“æ„â€æ–¹æ³•å¦‚ä½•æºæ‰‹è®¾è®¡arä½“ç³»ç»“æ„ã€ç¼–è¯‘å™¨å’Œç®—æ³•ï¼Œä½¿BLASèƒ½å¤Ÿç”¨é«˜çº§è¯­è¨€(Fortan)ä¸ºIBM Powerä½“ç³»ç»“æ„ç¼–å†™ï¼Œå¹¶è§£é‡Šäº†åœ¨è¿™äº›å¤„ç†å™¨ä¸Šå®ç°é«˜æ€§èƒ½çš„å¤æ‚æ€§ã€‚ä¾¿æºå¼é«˜æ€§èƒ½ANSI C (PHiPAC)[3]é¡¹ç›®éšåæä¾›äº†ç”¨Cç¼–å†™é«˜æ€§èƒ½ä»£ç çš„æŒ‡å—ï¼Œå¹¶å»ºè®®å¦‚ä½•è‡ªåŠ¨ç”Ÿæˆå’Œä¼˜åŒ–ä»¥è¿™ç§æ–¹å¼ç¼–å†™çš„Gemmã€‚Au tomatatically tuning Linear Algebra Software (ATLAS)[17,18]å»ºç«‹åœ¨è¿™äº›è§è§£çš„åŸºç¡€ä¸Šï¼Œä½¿BLASåº“çš„è‡ªåŠ¨è°ƒä¼˜å’Œè‡ªåŠ¨ç”Ÿæˆæˆä¸ºä¸»æµã€‚</p><p>åœ¨æœ¬æ–‡æ¡£çš„ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æœ‰å…³è¯¥ä¸»é¢˜çš„æœ€æ–°è®ºæ–‡ï¼ŒåŒ…æ‹¬å¼•å…¥äº†å®æ–½Gemm[6]çš„Gotoæ–¹æ³•å’Œè¯¥æ–¹æ³•[16]çš„BLISé‡æ„çš„è®ºæ–‡ï¼Œä»¥åŠå…¶ä»–æ›´ç›´æ¥ç›¸å…³çš„è®ºæ–‡ã€‚</p><h3 id="1-4-Other-similar-exercises"><a href="#1-4-Other-similar-exercises" class="headerlink" title="1.4 Other similar exercises"></a>1.4 Other similar exercises</h3><p>è¿˜æœ‰ä¸€äº›äººåŸºäºGemmç»„åˆäº†ç»ƒä¹ ã€‚ä¸æœ¬æ–‡ç›¸å…³çš„æœ€æ–°æˆæœæœ‰:ä¹Œå°”å§†å¤§å­¦Michael Lehnæ‰€ä½œçš„â€œä¼˜åŒ–å¾®å†…æ ¸:ä»çº¯Cåˆ°SSEâ€ï¼Œä»¥åŠæˆ‘ä»¬è‡ªå·±æ•´ç†çš„å…³äºâ€œä¼˜åŒ–å¾®å†…æ ¸â€çš„ç»´åŸºã€‚</p><h3 id="1-5-We-need-you"><a href="#1-5-We-need-you" class="headerlink" title="1.5 We need you!"></a>1.5 We need you!</h3><p>æœ¬æ–‡çš„ç›®çš„æ˜¯æŒ‡å¯¼æ‚¨å®ç°Gemmçš„é«˜æ€§èƒ½å®ç°ã€‚æˆ‘ä»¬çš„åˆ«æœ‰ç”¨å¿ƒæ˜¯ï¼Œç”¨äºå®ç°BLASçš„BLISæ¡†æ¶éœ€è¦é’ˆå¯¹å„ç§cpué«˜åº¦ä¼˜åŒ–çš„æ‰€è°“å¾®å†…æ ¸ã€‚åœ¨æ•™ä½ åŸºæœ¬æŠ€å·§çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°â€œé‚£ä¸ªäººâ€å°†è´¡çŒ®æœ€å¥½çš„å¾®å†…æ ¸ã€‚å°±æŠŠå®ƒå½“åšæˆ‘ä»¬ç‰ˆçš„é«˜æ€§èƒ½è®¡ç®—æœºè¾¾äººç§€å§ã€‚è™½ç„¶æˆ‘ä»¬åœ¨æè¿°ä¸­å…³æ³¨çš„æ˜¯Intel Haswellæ¶æ„çš„ä¼˜åŒ–ï¼Œä½†æ˜¯è®¾ç½®å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¿®æ”¹ï¼Œä»è€Œå¸®åŠ©æ‚¨(å’Œæˆ‘ä»¬)ä¼˜åŒ–å…¶ä»–cpuã€‚äº‹å®ä¸Šï¼ŒBLISæœ¬èº«æ”¯æŒçš„ä½“ç³»ç»“æ„åŒ…æ‹¬AMDå’ŒIntelçš„x86å¤„ç†å™¨ï¼ŒIBMçš„Powerå¤„ç†å™¨ï¼ŒARMå¤„ç†å™¨å’Œå¾·å·ä»ªå™¨çš„DSPå¤„ç†å™¨[15,12,8]ã€‚</p><h2 id="2-Step-1-The-Basics"><a href="#2-Step-1-The-Basics" class="headerlink" title="2 Step 1: The Basics"></a>2 Step 1: The Basics</h2><h3 id="2-1-Simple-matrix-matrix-multiplication"><a href="#2-1-Simple-matrix-matrix-multiplication" class="headerlink" title="2.1 Simple matrix-matrix multiplication"></a>2.1 Simple matrix-matrix multiplication</h3><p>åœ¨æˆ‘ä»¬çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å°†è€ƒè™‘è®¡ç®—ï¼š</p><p><img src="/2023/02/12/blislib002/image-20230213165803939.png" alt="image-20230213165803939"></p><p><img src="/2023/02/12/blislib002/image-20230213165826084.png" alt="image-20230213165826084"></p><p>å…¶ä¸­ï¼ŒAã€Bã€Cåˆ†åˆ«ä¸ºm Ã— kã€k Ã— nã€m Ã— nçŸ©é˜µã€‚</p><p><img src="/2023/02/12/blislib002/image-20230213165920897.png" alt="image-20230213165920897"></p><p>å¦‚æœAã€Bå’ŒCå­˜å‚¨åœ¨äºŒç»´æ•°ç»„Aã€Bå’ŒCä¸­ï¼Œä¸‹é¢çš„ä¼ªä»£ç è®¡ç®—C:&#x3D;<br>AB + C:</p><p><img src="/2023/02/12/blislib002/image-20230213170125083.png" alt="image-20230213170125083"></p><p>åˆ†åˆ«è®¡ç®—ä¹˜æ³•å’ŒåŠ æ³•ï¼Œè®¡ç®—éœ€è¦2mnkä¸ªæµ®ç‚¹è¿ç®—(flop)ã€‚</p><h3 id="2-2-Setup"><a href="#2-2-Setup" class="headerlink" title="2.2 Setup"></a>2.2 Setup</h3><p>ä¸ºäº†è®©æ‚¨é«˜æ•ˆåœ°å­¦ä¹ å¦‚ä½•é«˜æ•ˆåœ°è¿›è¡Œè®¡ç®—ï¼Œæ‚¨å¯ä»¥åœ¨å¯åŠ¨é¡¹ç›®æ—¶å‡†å¤‡å¥½å¤§éƒ¨åˆ†åŸºç¡€è®¾æ–½ã€‚æˆ‘ä»¬å·²ç»æ„é€ äº†å­ç›®å½•step1ï¼Œæœ‰ç‚¹åƒå®ç°çœŸæ­£åº“mightçš„é¡¹ç›®ã€‚å¯¹äºæˆ‘ä»¬çš„ç›®çš„æ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯å¤šä½™çš„ï¼Œä½†æ˜¯å¦‚ä½•æ„å»ºè½¯ä»¶é¡¹ç›®æ˜¯ä¸€é¡¹å€¼å¾—å­¦ä¹ çš„æœ‰ç”¨æŠ€èƒ½ã€‚</p><p><img src="/2023/02/12/blislib002/image-20230214173819349.png" alt="image-20230214173819349"></p><p>è€ƒè™‘å›¾4ï¼Œå®ƒæ¼”ç¤ºäº†å­ç›®å½•step1çš„ç›®å½•ç»“æ„:</p><p><strong>README</strong>æ˜¯ä¸€ä¸ªæè¿°ç›®å½•å†…å®¹ä»¥åŠå¦‚ä½•ç¼–è¯‘å’Œæ‰§è¡Œä»£ç çš„æ–‡ä»¶ã€‚</p><p><strong>source .sh</strong>é…ç½®ç¯å¢ƒå˜é‡çš„æ–‡ä»¶ã€‚åœ¨é‚£ä¸ªæ–‡ä»¶ä¸­</p><p><strong>BLISLAB USE INTEL</strong>è®¾ç½®æ˜¯å¦ä½¿ç”¨INTELç¼–è¯‘å™¨(true)æˆ–GNUç¼–è¯‘å™¨(false)ã€‚</p><p><strong>BLISLAB USE BLAS</strong>æŒ‡ç¤ºæ‚¨çš„å‚è€ƒdgemmæ˜¯å¦ä½¿ç”¨å¤–éƒ¨BLASåº“å®ç°(å¦‚æœæ‚¨çš„æœºå™¨ä¸Šå®‰è£…äº†è¿™æ ·çš„BLASåº“ï¼Œåˆ™ä¸ºtrue)ï¼Œè¿˜æ˜¯ç®€å•çš„ä¸‰é‡å¾ªç¯å®ç°(false)ã€‚</p><p><strong>COMPILER OPT LEVEL</strong>è®¾ç½®GNUæˆ–Intelç¼–è¯‘å™¨çš„ä¼˜åŒ–çº§åˆ«(O0, O1, O2, O3)ã€‚<br>(è¯·æ³¨æ„ï¼Œä¾‹å¦‚ï¼ŒO3ç”±å¤§å†™å­—æ¯â€œOâ€å’Œæ•°å­—â€œ3â€ç»„æˆã€‚)</p><p><strong>OMP NUM THREADS</strong> and <strong>BLISLAB IC NT</strong>è®¾ç½®ç”¨äºå¹¶è¡Œç‰ˆæœ¬çš„çº¿ç¨‹æ•°<br>ä»£ç ã€‚å¯¹äºç¬¬1æ­¥ï¼Œå°†å®ƒä»¬éƒ½è®¾ç½®ä¸º1ã€‚</p><p><strong>dgemm</strong>æ˜¯å®ç°dgemmçš„ä¾‹ç¨‹å­˜åœ¨çš„å­ç›®å½•ã€‚åœ¨å…¶ä¸­</p><p><strong>bl_dgemm_ref.c</strong>åŒ…å«ä¾‹ç¨‹<strong>dgemm ref</strong>ï¼Œå®ƒæ˜¯dgemmçš„ä¸€ä¸ªç®€å•å®ç°ï¼Œå¦‚æœ<strong>BLISLAB_use_BLAS &#x3D; false</strong>ï¼Œæ‚¨å°†ä½¿ç”¨å®ƒæ¥æ£€æŸ¥å®ç°çš„æ­£ç¡®æ€§ã€‚</p><p><strong>my_dgemm.c</strong>åŒ…å«ä¾‹ç¨‹<strong>dgemm</strong>ï¼Œå®ƒæœ€åˆæ˜¯dgemmçš„ä¸€ä¸ªç®€å•å®ç°ï¼Œæ‚¨å°†ä¼˜åŒ–å®ƒä½œä¸ºæŒæ¡å¦‚ä½•ä¼˜åŒ–gemmçš„ç¬¬ä¸€æ­¥çš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>Bl_dgemm_util.c</strong>åŒ…å«ç¨åä¼šæ´¾ä¸Šç”¨åœºçš„å®ç”¨ç¨‹åºä¾‹ç¨‹</p><p><strong>include</strong>è¿™ä¸ªç›®å½•åŒ…å«åŒ…å«å„ç§å®å®šä¹‰å’Œå…¶ä»–å¤´ä¿¡æ¯çš„æ–‡ä»¶ã€‚</p><p><strong>lib</strong>æ­¤ç›®å½•å°†ä¿å­˜ç”±æ‚¨å®ç°çš„æºæ–‡ä»¶(libblislab. lib)ç”Ÿæˆçš„åº“ã€‚libblislab.a)æ‚¨è¿˜å¯ä»¥åœ¨æ­¤ç›®å½•ä¸­å®‰è£…å‚è€ƒåº“(ä¾‹å¦‚OpenBLAS)ä»¥æ¯”è¾ƒæ€§èƒ½ã€‚</p><p><strong>test</strong> è¿™ä¸ªç›®å½•åŒ…å«â€œæµ‹è¯•é©±åŠ¨ç¨‹åºâ€å’Œå„ç§å®ç°çš„æ­£ç¡®æ€§&#x2F;æ€§èƒ½æ£€æŸ¥è„šæœ¬ã€‚</p><p><strong>test_bl_demm .c</strong>åŒ…å«æµ‹è¯•ä¾‹ç¨‹bl_demmçš„â€œæµ‹è¯•é©±åŠ¨ç¨‹åºâ€ã€‚</p><p><strong>test_bl_dgemm.x</strong>æ˜¯<strong>test_bl_dgemm.c</strong>çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p><strong>Run_bl_dgemm.sh</strong>åŒ…å«ä¸€ä¸ªbashè„šæœ¬ï¼Œç”¨äºæ”¶é›†æ€§èƒ½ç»“æœã€‚</p><p><strong>tacc_run_bl_dgemm.sh</strong> contains a <strong>SLURM</strong> script for you to (optionally) submit the job to the Texas Advanced Computing Center (TACC) machines if you have an account there.</p><h3 id="2-3-Getting-started"><a href="#2-3-Getting-started" class="headerlink" title="2.3 Getting started"></a>2.3 Getting started</h3><p>æˆ‘ä»¬å¸Œæœ›æ‚¨ä»my_dgemm.cä¸­çš„å®ç°å¼€å§‹ï¼Œå¹¶é€šè¿‡åº”ç”¨å„ç§æ ‡å‡†ä¼˜åŒ–æŠ€æœ¯å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚è¯¥æ–‡ä»¶ä¸­çš„åˆå§‹å®ç°æ˜¯å…·æœ‰å›¾2ä¸­ç»™å‡ºçš„ä¸‰ä¸ªå¾ªç¯çš„ç®€å•å®ç°ã€‚é¦–å…ˆè¦æ³¨æ„çš„æ˜¯äºŒç»´æ•°ç»„å¦‚ä½•ä»¥æ‰€è°“çš„åˆ—-ä¸»åºæ˜ å°„åˆ°å†…å­˜ã€‚è¿™ç§é€‰æ‹©çš„åŸå› æ˜¯æœ€åˆçš„BLASå‡å®šæ•°ç»„çš„åˆ—ä¸»å­˜å‚¨ï¼Œå› ä¸ºè¯¥æ¥å£é¦–å…ˆæ˜¯ä¸ºFortranç”¨æˆ·æä¾›çš„ã€‚æ£€æŸ¥</p><p><img src="/2023/02/12/blislib002/image-20230214185803699.png" alt="image-20230214185803699"></p><p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ¯ä¸ªæ“ä½œæ•°éƒ½æ˜¯ä¸€ä¸ªå®ã€‚è€ƒè™‘æ–‡ä»¶çš„æ—©æœŸ</p><p><img src="/2023/02/12/blislib002/image-20230214185849594.png" alt="image-20230214185849594"></p><p>åœ°å€Cå¤„çš„çº¿æ€§æ•°ç»„ç”¨äºå­˜å‚¨å…ƒç´ Ci,jï¼Œå› æ­¤i,jå…ƒç´ è¢«æ˜ å°„åˆ°ä½ç½®j * ldc + iã€‚æŸ¥çœ‹å®ƒçš„æ–¹æ³•æ˜¯Cçš„æ¯ä¸€åˆ—éƒ½æ˜¯è¿ç»­å­˜å‚¨çš„ã€‚ä½†æ˜¯ï¼Œå¯ä»¥æŠŠçŸ©é˜µCçœ‹ä½œæ˜¯åµŒå…¥åœ¨ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ä¸­ï¼Œè¯¥æ•°ç»„æœ‰ldcè¡Œï¼Œå› æ­¤è®¿é—®ä¸€è¡Œå°±æ„å‘³ç€è·¨ldcéå†æ•°ç»„Cã€‚äºŒç»´æ•°ç»„Cçš„å‰ç»´æ•°é€šå¸¸æ˜¯æŒ‡è¿™ä¸ªè¾ƒå¤§æ•°ç»„çš„è¡Œç»´æ•°ï¼Œå› æ­¤å˜é‡ldc (Cçš„å‰ç»´æ•°)ã€‚ä¸‹å›¾è¯´æ˜äº†è¿™ä¸‰ä¸ªçŸ©é˜µ:</p><p><img src="/2023/02/12/blislib002/image-20230214190409172.png" alt="image-20230214190409172"></p><p>å…¶ä¸­ç®­å¤´è¡¨ç¤ºåˆ—æ˜¯è¿ç»­å­˜å‚¨çš„ã€‚</p><h4 id="2-3-1-Configure-the-default-implementation"><a href="#2-3-1-Configure-the-default-implementation" class="headerlink" title="2.3.1 Configure the default implementation"></a>2.3.1 Configure the default implementation</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç»ƒä¹ ç¼–è¯‘å¹¶é“¾æ¥åˆ°Intelçš„iccç¼–è¯‘å™¨ï¼Œè¯¥ç¼–è¯‘å™¨å°†å¯¹ä»£ç åº”ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–(O3çº§)ã€‚æ‚¨éœ€è¦é€šè¿‡ä»¥ä¸‹å‘½ä»¤è®¾ç½®ç¯å¢ƒå˜é‡:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">source sourceme.sh<br></code></pre></div></td></tr></table></figure><p>åœ¨ç»ˆç«¯ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°è¾“å‡º:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLISLAB_USE_INTEL = TRUE<br>COMPILER_OPT_LEVEL = O3<br></code></pre></div></td></tr></table></figure><h4 id="2-3-2-Compile-execute-and-collect-results"><a href="#2-3-2-Compile-execute-and-collect-results" class="headerlink" title="2.3.2 Compile, execute and collect results"></a>2.3.2 Compile, execute and collect results</h4><p>å¦‚æœæ‚¨æ— æ³•è®¿é—®Intelçš„ç¼–è¯‘å™¨(icc)ï¼Œè¯·é˜…è¯»ç¬¬2.3.2å°èŠ‚å’Œ2.3.3å°èŠ‚ï¼Œå¹¶ç»§ç»­é˜…è¯»ç¬¬2.3.5å°èŠ‚ã€‚</p><p>æ‚¨å¯ä»¥ç¼–è¯‘ã€æ‰§è¡Œä»£ç å¹¶é€šè¿‡æ‰§è¡Œæ”¶é›†æ€§èƒ½ç»“æœ</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">make clean<br>make<br>cd test<br>./run_bl_dgemm.sh<br></code></pre></div></td></tr></table></figure><p>åœ¨å­ç›®å½•step1ä¸­ã€‚æ‚¨å°†çœ‹åˆ°æ€§èƒ½ç»“æœè¾“å‡º:</p><p><img src="/2023/02/12/blislib002/image-20230214231134260.png" alt="image-20230214231134260"></p><p><img src="/2023/02/12/blislib002/image-20230214231142311.png" alt="image-20230214231142311"></p><p>æ‚¨å¯ä»¥åœ¨run_bl_dgemm.shä¸­æ›´æ”¹é‡‡æ ·å—å¤§å°ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœä»£ç ä¸­æœ‰é”™è¯¯ï¼Œè¿™äº›é”™è¯¯å°†è¢«æŠ¥å‘Šä¸ºï¼Œä¾‹å¦‚ï¼Œ</p><p><img src="/2023/02/12/blislib002/image-20230214231406465.png" alt="image-20230214231406465"></p><h4 id="2-3-3-Draw-the-performance-graph"><a href="#2-3-3-Draw-the-performance-graph" class="headerlink" title="2.3.3 Draw the performance graph"></a>2.3.3 Draw the performance graph</h4><p>æœ€åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<strong>MATLAB</strong>ç”¨æˆ‘ä»¬çš„è„šæœ¬ç»˜åˆ¶æ€§èƒ½å›¾ã€‚åœ¨<strong>test</strong>å­ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">./collect_result_step1<br></code></pre></div></td></tr></table></figure><p>ä½ ä¼šå¾—åˆ°ä¸€ä¸ªMATLABæ–‡ä»¶â€œstep1_result.mâ€ï¼Œå…·æœ‰æ€§èƒ½ç»“æœã€‚ç„¶åä½ å¯ä»¥æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">bl_dgemm_plot.m<br></code></pre></div></td></tr></table></figure><p>åœ¨MATLABä¸­ï¼Œç„¶åç”Ÿæˆæ€§èƒ½å›¾ã€‚</p><h4 id="2-3-4-Change-to-the-GNU-compiler"><a href="#2-3-4-Change-to-the-GNU-compiler" class="headerlink" title="2.3.4 Change to the GNU compiler"></a>2.3.4 Change to the GNU compiler</h4><p>ç”±äºæˆ‘ä»¬å¸Œæœ›æ‚¨æ˜ç¡®åœ°äº†è§£ä»€ä¹ˆæ ·çš„æŠ€å·§å¯ä»¥å¸¦æ¥é«˜æ€§èƒ½ï¼Œå¹¶ä¸”ç”±äºæœ‰äº›äººå¯èƒ½æ— æ³•è®¿é—®Intelç¼–è¯‘å™¨ï¼Œå› æ­¤æ¥ä¸‹æ¥åº”è¯¥æ”¹ä¸ºä½¿ç”¨GNU Cç¼–è¯‘å™¨ã€‚ä¸ºæ­¤ï¼Œä½ å¿…é¡»ç¼–è¾‘<strong>sourceme.sh</strong>:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLISLAB_USE_INTEL=false<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œç±»ä¼¼äºé»˜è®¤è®¾ç½®ï¼Œæ‚¨éœ€è¦é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è®¾ç½®ç¯å¢ƒå˜é‡:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">source sourceme.sh<br></code></pre></div></td></tr></table></figure><p>åœ¨ç»ˆç«¯ï¼Œä½ ä¼šè§‚å¯Ÿåˆ°:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLISLAB_USE_INTEL = false<br>COMILER_OPT_LEVEL = O3<br></code></pre></div></td></tr></table></figure><h4 id="2-3-5-Turn-off-optimization"><a href="#2-3-5-Turn-off-optimization" class="headerlink" title="2.3.5 Turn off optimization"></a>2.3.5 Turn off optimization</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¸Œæœ›æ‚¨å…³é—­ç¼–è¯‘å™¨æ‰§è¡Œçš„ä¼˜åŒ–ã€‚è¿™æœ‰ä¸‰ä¸ªç›®çš„:é¦–å…ˆï¼Œè¿™æ„å‘³ç€æ‚¨å°†å¿…é¡»æ˜¾å¼åœ°æ‰§è¡Œä¼˜åŒ–ï¼Œè¿™å°†å…è®¸æ‚¨äº†è§£æ¶æ„å’Œç®—æ³•å¦‚ä½•äº¤äº’ã€‚å…¶æ¬¡ï¼Œä¼˜åŒ–ç¼–è¯‘å™¨å¾ˆå¯èƒ½ä¼šè¯•å›¾â€œæ’¤é”€â€æ‚¨æ˜¾å¼è¯•å›¾å®Œæˆçš„ä»»åŠ¡ã€‚ç¬¬ä¸‰ï¼Œåœ¨ä»£ç ä¸­æ„å»ºçš„æŠ€å·§è¶Šå¤šï¼Œç¼–è¯‘å™¨å°±è¶Šéš¾æ‰¾å‡ºä¼˜åŒ–çš„æ–¹æ³•ã€‚</p><p>ä½ éœ€è¦å…ˆç¼–è¾‘<strong>sourceme.sh:</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">COMILER_OPT_LEVEL = O0<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œç±»ä¼¼äºé»˜è®¤è®¾ç½®ï¼Œæ‚¨éœ€è¦é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è®¾ç½®ç¯å¢ƒå˜é‡:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">source sourceme.sh<br></code></pre></div></td></tr></table></figure><p>åœ¨ç»ˆç«¯ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°è¾“å‡º:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLISLAB_USE_INTEL = false<br>COMILER_OPT_LEVEL =O0<br></code></pre></div></td></tr></table></figure><h4 id="2-3-6-Optional-Use-optimized-BLAS-library-as-reference-implementation"><a href="#2-3-6-Optional-Use-optimized-BLAS-library-as-reference-implementation" class="headerlink" title="2.3.6 (Optional) Use optimized BLAS library as reference implementation"></a>2.3.6 (Optional) Use optimized BLAS library as reference implementation</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨çš„å‚è€ƒGemmå®ç°æ˜¯ä¸€ä¸ªéå¸¸ç¼“æ…¢çš„ä¸‰å¾ªç¯å®ç°ã€‚å¦‚æœä½ åœ¨æµ‹è¯•æœºå™¨ä¸Šå®‰è£…äº†BLASåº“ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½®è¯¥åº“ä¸­çš„dgemmä½œä¸ºä½ çš„å‚è€ƒå®ç°:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLISLAB_USE_BLAS=true<br></code></pre></div></td></tr></table></figure><p>åœ¨sourceme.shã€‚å¦‚æœä½¿ç”¨Intelç¼–è¯‘å™¨ï¼Œåˆ™ä¸éœ€è¦æ˜¾å¼æŒ‡å®šMKLçš„è·¯å¾„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨GNUç¼–è¯‘å™¨ï¼Œåˆ™éœ€è¦æŒ‡å®šBLASåº“çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä»<a href="https://github.com/flame/blis%E5%AE%89%E8%A3%85%E6%88%91%E4%BB%AC%E7%9A%84BLIS%E5%BA%93%E5%88%B0/home/lib/blis%E7%9B%AE%E5%BD%95%E5%90%8C%E6%97%B6%E5%9C%A8sourceme">https://github.com/flame/bliså®‰è£…æˆ‘ä»¬çš„BLISåº“åˆ°/home/lib/blisç›®å½•åŒæ—¶åœ¨sourceme</a> .shä¸­è®¾ç½®</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLAS_DIR=/home/lib/blis<br></code></pre></div></td></tr></table></figure><p>æ‰§è¡Œ**$ source sourceme .sh**åï¼Œä½ ä¼šçœ‹åˆ°:</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">BLISLAB_USE_BLAS = true<br>BLAS_DIR = /home/lib/blis<br></code></pre></div></td></tr></table></figure><p>ç°åœ¨ï¼Œæ‚¨çš„å®ç°çš„æ€§èƒ½å’Œå‡†ç¡®æ€§å°†ä¸è¿™ä¸ªä¼˜åŒ–çš„åº“ä¾‹ç¨‹è¿›è¡Œæ¯”è¾ƒã€‚</p><h3 id="2-4-Basic-techniques"><a href="#2-4-Basic-techniques" class="headerlink" title="2.4 Basic techniques"></a>2.4 Basic techniques</h3><p>åœ¨æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›åŸºæœ¬çš„äº¤æ˜“æŠ€å·§ã€‚</p><h4 id="2-4-1-Using-pointers"><a href="#2-4-1-Using-pointers" class="headerlink" title="2.4.1 Using pointers"></a>2.4.1 Using pointers</h4><p>æ—¢ç„¶ä¼˜åŒ–è¢«å…³é—­äº†ï¼Œé‚£ä¹ˆçŸ©é˜µå…ƒç´ æ‰€åœ¨åœ°å€çš„è®¡ç®—å°†æ˜¾å¼åœ°å…¬å¼€ã€‚(ä¼˜åŒ–ç¼–è¯‘å™¨å¯ä»¥æ¶ˆé™¤è¿™ç§å¼€é”€ã€‚)æ‚¨è¦åšçš„æ˜¯æ›´æ”¹my_gemm.cä¸­çš„å®ç°ï¼Œä»¥ä¾¿å®ƒä½¿ç”¨æŒ‡é’ˆã€‚åœ¨è¿™æ ·åšä¹‹å‰ï¼Œæ‚¨å¯èƒ½éœ€è¦å¤‡ä»½åŸå§‹çš„my_gemm.cï¼Œä»¥é˜²éœ€è¦ä»å¤´å¼€å§‹é‡æ–°å¯åŠ¨ã€‚å®é™…ä¸Šï¼Œåœ¨æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œæ‚¨å¯èƒ½éƒ½å¸Œæœ›åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­å¤‡ä»½å‰é¢çš„å®ç°</p><p>è¿™æ˜¯åŸºæœ¬çš„æƒ³æ³•ã€‚å‡è®¾æˆ‘ä»¬æƒ³æŠŠCä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è®¾ä¸º0ã€‚ä¸€ä¸ªåŸºæœ¬çš„å¾ªç¯ï¼ŒæŒ‰ç…§åœ¨my_gemm.cä¸­æ‰¾åˆ°çš„å†…å®¹æ¥è®¾è®¡</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>    <span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>        <span class="hljs-built_in">C</span>(i,j) =<span class="hljs-number">0.0</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>Using pointers, we might implement this as</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span> *cp;<br><span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>    cp = &amp;C[ j*ldc ];<span class="hljs-comment">//point cp to top of ith column</span><br>    <span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        *cp++ = <span class="hljs-number">0.0</span>;<span class="hljs-comment">//set element that cp points to to zero and</span><br>    &#125;<span class="hljs-comment">//advance the pointer</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼Œæˆ‘ä»¬æœ‰æ„åœ°äº¤æ¢äº†å¾ªç¯çš„é¡ºåºï¼Œä»¥ä¾¿å‘å‰ç§»åŠ¨æŒ‡é’ˆå°†æˆ‘ä»¬å¸¦åˆ°Cçš„åˆ—ä¸­ã€‚</p><h4 id="2-4-2-Loop-unrolling"><a href="#2-4-2-Loop-unrolling" class="headerlink" title="2.4.2 Loop unrolling"></a>2.4.2 Loop unrolling</h4><p>æ¯æ¬¡é€šè¿‡å†…éƒ¨å¾ªç¯æ›´æ–°å¾ªç¯ç´¢å¼•iå’ŒæŒ‡é’ˆcpéƒ½ä¼šäº§ç”Ÿç›¸å½“å¤§çš„å¼€é”€ã€‚</p><p>å› æ­¤ï¼Œç¼–è¯‘å™¨å°†æ‰§è¡Œå¾ªç¯å±•å¼€ã€‚ä½¿ç”¨å±•å¼€å› å­4ï¼Œæˆ‘ä»¬å°†Cè®¾ç½®ä¸º0çš„ç®€å•å¾ªç¯å˜æˆ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span> *cp;<br><br><span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>    cp = &amp;C[ j * ldc ];<br>    <span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i+=<span class="hljs-number">4</span>)&#123;<br>        *(cp+<span class="hljs-number">0</span>) = <span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">1</span>) = <span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">2</span>) = <span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">3</span>) = <span class="hljs-number">0.0</span>;<br>        cp+=<span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é‡è¦çš„</p><ul><li>iå’Œcpç°åœ¨æ¯å››æ¬¡è¿­ä»£æ‰æ›´æ–°ä¸€æ¬¡ã€‚</li><li><em>(cp+0)ä½¿ç”¨ç§°ä¸ºé—´æ¥å¯»å€çš„æœºå™¨æŒ‡ä»¤ï¼Œè¿™æ¯”ä½¿ç”¨</em>(cp+k)è®¡ç®—æ›´æœ‰æ•ˆï¼Œå…¶ä¸­kæ˜¯å˜é‡ã€‚</li><li>å½“å®ƒä»å†…å­˜ä¸­è¾“å…¥æ•°æ®åˆ°ç¼“å­˜ä¸­æ—¶ï¼Œæ¯æ¬¡è¾“å…¥ä¸€æ¡64å­—èŠ‚çš„ç¼“å­˜çº¿ã€‚è¿™æ„å‘³ç€ä»¥64å­—èŠ‚çš„å—è®¿é—®è¿ç»­æ•°æ®å¯ä»¥å‡å°‘å†…å­˜å±‚ä¹‹é—´çš„å†…å­˜ç§»åŠ¨æˆæœ¬ã€‚</li></ul><p>è¯·æ³¨æ„ï¼Œåœ¨å±•å¼€æ—¶ï¼Œå¦‚æœmä¸æ˜¯4çš„å€æ•°ï¼Œåˆ™å¯èƒ½å¿…é¡»å¤„ç†â€œè¾¹ç¼˜â€ã€‚</p><p>ä¸ºäº†è¿™ä¸ªç»ƒä¹ ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒè¿™ä¸ªè¾¹ç¼˜ï¼Œåªè¦ä½ æ˜æ™ºåœ°é€‰æ‹©ä½ çš„é‡‡æ ·å—å¤§å°ï¼Œå°±åƒç¬¬2.5èŠ‚é‡ç”³çš„é‚£æ ·ã€‚</p><h4 id="2-4-3-Register-variables"><a href="#2-4-3-Register-variables" class="headerlink" title="2.4.3 Register variables"></a>2.4.3 Register variables</h4><p>æ³¨æ„ï¼Œåªæœ‰å½“æ•°æ®å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­æ—¶ï¼Œè®¡ç®—æ‰ä¼šå‘ç”Ÿã€‚ç¼–è¯‘å™¨å°†è‡ªåŠ¨è½¬æ¢ä»£ç ï¼Œä»¥ä¾¿æ’å…¥å°†æŸäº›æ•°æ®æ”¾å…¥å¯„å­˜å™¨çš„ä¸­é—´æ­¥éª¤ã€‚å¯ä»¥ç»™ç¼–è¯‘å™¨ä¸€ä¸ªæç¤ºï¼Œå°†æŸäº›æ•°æ®ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­æ˜¯å¾ˆå¥½çš„ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤º:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span> *cp;<br><br><span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>    cp = &amp;C[ j * ldc ];<br>    <span class="hljs-keyword">for</span>( i = <span class="hljs-number">0</span>; i &lt; m; i+=<span class="hljs-number">4</span>)&#123;<br>        <span class="hljs-keyword">register</span> <span class="hljs-keyword">double</span> c0 =<span class="hljs-number">0.0</span>,c1=<span class="hljs-number">0.0</span>,c2=<span class="hljs-number">0.0</span>,c3=<span class="hljs-number">0.0</span>;<br>        *(cp+<span class="hljs-number">0</span>) = c0;<br>        *(cp+<span class="hljs-number">1</span>) = c1;<br>        *(cp+<span class="hljs-number">2</span>) = c2;<br>        *(cp+<span class="hljs-number">3</span>) = c3;<br>        cp+=<span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="2-5-A-modest-first-goal"><a href="#2-5-A-modest-first-goal" class="headerlink" title="2.5 A modest first goal"></a>2.5 A modest first goal</h4><p>ç°åœ¨æˆ‘ä»¬è¦æ±‚æ‚¨ä½¿ç”¨ä¸Šé¢è®¨è®ºçš„æŠ€æœ¯æ¥ä¼˜åŒ–my_dgemm.cã€‚ç°åœ¨ï¼Œåªéœ€è¦è€ƒè™‘å¦‚ä½•ä¸ºè¾ƒå°çš„çŸ©é˜µè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œè¯·çœ‹ä¸‹é¢è¿™å¼ å›¾:</p><p><img src="/2023/02/12/blislib002/image-20230215110352304.png" alt="image-20230215110352304"></p><p>æˆ‘ä»¬æƒ³è®©ä½ åšçš„æ˜¯ç¼–å†™ä½ çš„ä»£ç ï¼Œä½¿Cçš„mR Ã— nRå—ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­ã€‚ä½ å¯ä»¥é€‰æ‹©mRå’ŒnRï¼Œä½†æ˜¯ä½ éœ€è¦ç”¨è¿™äº›é€‰é¡¹æ›´æ–°æ–‡ä»¶<strong>include&#x2F;bl_config.h</strong>ã€‚è¿™ç¡®ä¿äº†æµ‹è¯•é©±åŠ¨ç¨‹åºåªå°è¯•è¿™äº›å—å¤§å°çš„å€æ•°çš„é—®é¢˜å¤§å°ï¼Œæ‰€ä»¥æ‚¨ä¸å¿…æ‹…å¿ƒâ€œè¾¹ç¼˜â€ã€‚</p><p>æ‚¨å°†æ³¨æ„åˆ°ï¼Œå³ä½¿å¯¹äºå¯ä»¥æ”¾å…¥æŸä¸ªç¼“å­˜å†…å­˜ä¸­çš„è¾ƒå°çš„çŸ©é˜µï¼Œæ‚¨çš„å®ç°(æ¯”æ‚¨å¯èƒ½å·²å®‰è£…çš„MKLæˆ–å…¶ä»–ä¼˜åŒ–çš„BLASåº“çš„å®ç°å·®å¾—å¤š)ã€‚åŸå› æ˜¯ç¼–è¯‘å™¨æ²¡æœ‰ä¸ºæµ®ç‚¹è¿ç®—ä½¿ç”¨æœ€å¿«çš„æŒ‡ä»¤ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨å‘é‡intrinsic funtionså‡½æ•°(å…è®¸æ‚¨ä»Cæ˜¾å¼åœ°åˆ©ç”¨å®ƒä»¬)æˆ–é€šè¿‡åœ¨æ±‡ç¼–ä»£ç ä¸­ç¼–ç æ¥è®¿é—®è¿™äº›å‡½æ•°ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¿˜æ²¡åˆ°é‚£ä¸€æ­¥ã€‚æˆ‘ä»¬å°†<br>åœ¨æ­¥éª¤3ä¸­è®¨è®ºæ›´å¤šã€‚</p><h2 id="3-Step-2-Blocking"><a href="#3-Step-2-Blocking" class="headerlink" title="3 Step 2: Blocking"></a>3 Step 2: Blocking</h2><h3 id="3-1-Poormanâ€™s-BLAS"><a href="#3-1-Poormanâ€™s-BLAS" class="headerlink" title="3.1 Poormanâ€™s BLAS"></a>3.1 Poormanâ€™s BLAS</h3><p>æœ¬ç»ƒä¹ çš„ç¬¬1æ­¥ä½¿æ‚¨è®¤è¯†åˆ°ï¼Œéšç€åŸºäºç¼“å­˜çš„ä½“ç³»ç»“æ„çš„å‡ºç°ï¼ŒGemmçš„é«˜æ€§èƒ½å®ç°éœ€è¦ä»”ç»†æ³¨æ„æ•°æ®åœ¨å†…å­˜å±‚ä¹‹é—´ç§»åŠ¨çš„æˆæœ¬å’Œå¯¹è¯¥æ•°æ®çš„è®¡ç®—çš„æ‘Šè–„ã€‚ä¸ºäº†ä¿æŒè¿™ç§å¯ç®¡ç†æ€§ï¼Œè®¤è¯†åˆ°åªæœ‰ä½¿ç”¨ç›¸å¯¹è¾ƒå°çš„çŸ©é˜µæ‰§è¡ŒçŸ©é˜µ-çŸ©é˜µä¹˜æ³•çš„â€œå†…æ ¸â€éœ€è¦é«˜åº¦ä¼˜åŒ–ï¼Œè¿™æ˜¯æœ‰å¸®åŠ©çš„ï¼Œå› ä¸ºä½¿ç”¨è¾ƒå¤§çš„çŸ©é˜µçš„è®¡ç®—å¯ä»¥è¢«åˆ†å—ï¼Œç„¶åä½¿ç”¨è¿™æ ·çš„å†…æ ¸è€Œä¸ä¼šå¯¹æ•´ä½“æ€§èƒ½äº§ç”Ÿä¸åˆ©å½±å“ã€‚è¿™ä¸€è§è§£åœ¨[9]ä¸­å¾—åˆ°äº†æ˜ç¡®çš„æå€¡ã€‚</p><p>è¿™æœ‰æ—¶è¢«ç§°ä¸ºâ€œç©·äººçš„BLASâ€ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªäººåªèƒ½è´Ÿæ‹…å¾—èµ·ä¼˜åŒ–çŸ©é˜µ-çŸ©é˜µä¹˜æ³•(ä½¿ç”¨å­çŸ©é˜µ)ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„å»ºGemmï¼Œä»¥åŠå…¶ä»–é‡è¦çš„çŸ©é˜µ-çŸ©é˜µè¿ç®—ï¼Œå³ä¸‰çº§BLASã€‚æˆ‘ä»¬ç¨åå°†çœ‹åˆ°çš„æ˜¯ï¼Œä»æ¨¡å—åŒ–å’Œæ€§èƒ½çš„è§’åº¦æ¥çœ‹ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæ‚¨å·²ç»çœ‹åˆ°äº†åˆ†å—çš„ç¤ºä¾‹ã€‚</p><h3 id="3-2-Blocked-matrix-matrix-multiplication"><a href="#3-2-Blocked-matrix-matrix-multiplication" class="headerlink" title="3.2 Blocked matrix-matrix multiplication"></a>3.2 Blocked matrix-matrix multiplication</h3><p>åˆ†å—Gemmä»¥åˆ©ç”¨å¤„ç†å™¨çš„åˆ†å±‚å†…å­˜çš„å…³é”®æ˜¯ç†è§£å½“è¿™äº›çŸ©é˜µè¢«åˆ†å—æ—¶å¦‚ä½•è®¡ç®—C:&#x3D; AB + Cã€‚åˆ†å—</p><p><img src="/2023/02/12/blislib002/image-20230216130352894.png" alt="image-20230216130352894"></p><h3 id="3-3-Your-mission-if-you-choose-to-accept-it"><a href="#3-3-Your-mission-if-you-choose-to-accept-it" class="headerlink" title="3.3 Your mission, if you choose to accept it"></a>3.3 Your mission, if you choose to accept it</h3><p>æˆ‘ä»¬ç°åœ¨è¦æ±‚æ‚¨åœ¨my_dgemmä¸­å®ç°åˆ†å—çŸ©é˜µ-çŸ©é˜µä¹˜æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºå°çŸ©é˜µï¼Œæ‚¨å¯ä»¥è·å¾—æ¯”å¤§çŸ©é˜µæ›´å¥½çš„æ€§èƒ½ï¼Œå› ä¸ºå°çŸ©é˜µé€‚åˆç¼“å­˜ã€‚å°†çŸ©é˜µåˆ’åˆ†ä¸ºèƒ½å¤Ÿè·å¾—æ›´é«˜æ€§èƒ½çš„å­çŸ©é˜µï¼Œæ‚¨å°†çœ‹åˆ°ï¼Œå³ä½¿å¯¹äºæ›´å¤§çš„çŸ©é˜µï¼Œæ‰€å¾—åˆ°çš„å®ç°ä¹Ÿèƒ½ä¿æŒæ›´å¥½çš„æ€§èƒ½</p><h2 id="4-Step-3-Blocking-for-Multiple-Levels-of-Cache"><a href="#4-Step-3-Blocking-for-Multiple-Levels-of-Cache" class="headerlink" title="4 Step 3: Blocking for Multiple Levels of Cache"></a>4 Step 3: Blocking for Multiple Levels of Cache</h2><h3 id="4-1-The-Goto-Approach-to-Implementing-gemm"><a href="#4-1-The-Goto-Approach-to-Implementing-gemm" class="headerlink" title="4.1 The Goto Approach to Implementing gemm"></a>4.1 The Goto Approach to Implementing gemm</h3><p>2000å¹´å·¦å³ï¼ŒKazushige Gotoç”¨ä»–çš„æŠ€æœ¯å½»åº•æ”¹å˜äº†Gemmåœ¨å½“å‰cpuä¸Šçš„å®ç°æ–¹å¼ï¼Œè¯¥æŠ€æœ¯é¦–æ¬¡å‘è¡¨åœ¨è®ºæ–‡[6]ä¸Šã€‚</p><p>æœ€è¿‘åœ¨[16]ä¸­æè¿°äº†è¿™ç§æ–¹æ³•çš„è¿›ä¸€æ­¥â€œé‡æ„â€ã€‚</p><p>BLISæ¡†æ¶çš„ä¼˜ç‚¹æ˜¯å®ƒå°†å¿…é¡»é«˜åº¦ä¼˜åŒ–çš„å†…æ ¸(å¯èƒ½ä½¿ç”¨å‘é‡intrinsicæˆ–åœ¨æ±‡ç¼–ä»£ç ä¸­)å‡å°‘ä¸ºå¾®å†…æ ¸ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦æè¿°è¯¥æ–¹æ³•çš„é‡ç‚¹ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®è¯»è€…ç†Ÿæ‚‰ä»¥ä¸Šä¸¤ç¯‡è®ºæ–‡æœ¬èº«ã€‚</p><p>å›¾3(å·¦)è¯´æ˜äº†Gotoæ–¹æ³•ä¸ºä¸‰å±‚ç¼“å­˜(L1ã€L2å’ŒL3)æ„å»ºåˆ†å—çš„æ–¹å¼ã€‚åœ¨BLISæ¡†æ¶ä¸­ï¼Œå®ç°å°±æ˜¯è¿™æ ·ç»“æ„çš„ï¼Œå› æ­¤åªæœ‰åº•å±‚çš„å¾®å†…æ ¸éœ€è¦é’ˆå¯¹ç»™å®šçš„ä½“ç³»ç»“æ„è¿›è¡Œé«˜åº¦ä¼˜åŒ–å’Œå®šåˆ¶ã€‚åœ¨æœ€åˆçš„GotoBLASå®ç°(ç°åœ¨ç»´æŠ¤ä¸ºOpenBLAS[11])ä¸­ï¼Œä»å›´ç»•å¾®å†…æ ¸çš„ç¬¬äºŒä¸ªå¾ªç¯å¼€å§‹çš„æ“ä½œæ˜¯å®šåˆ¶çš„ã€‚ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæ‰€æœ‰æ•°æ®éƒ½æ˜¯è¿ç»­è®¿é—®çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨åˆ°è¾¾å¾®å†…æ ¸ä¹‹å‰çš„æŸä¸ªæ—¶åˆ»ï¼Œæ•°æ®æ˜¯æŒ‰ç…§ç®­å¤´æ‰€ç¤ºçš„é¡ºåºæ‰“åŒ…çš„:</p><p><img src="/2023/02/12/blislib002/image-20230216131649371.png" alt="image-20230216131649371"></p><p>ç°åœ¨ï¼Œæ³¨æ„ä¸Šå›¾ä¸­Aå—çš„æ¯ä¸€åˆ—éƒ½ä¹˜ä»¥Bå—å¯¹åº”è¡Œä¸­çš„æ¯ä¸ªå…ƒç´ (æˆ‘ä»¬ç§°è¿™äº›Aå—å’ŒBå—ä¸ºå¾®é¢æ¿)ã€‚è¿™æ„å‘³ç€L2ç¼“å­˜çš„å»¶è¿Ÿ(ä»ç¼“å­˜ä¸­å¼•å…¥Aå¾®é¢æ¿å…ƒç´ æ‰€éœ€çš„æ—¶é—´)å¯ä»¥å¹³æ‘Šåˆ°2nR flopä¸Šã€‚</p><p><img src="/2023/02/12/blislib002/image-20230216131916807.png" alt="image-20230216131916807"></p><p>å‡ºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬å¯ä»¥ç»„ç»‡è®¡ç®—ï¼Œä½¿Açš„å¾®é¢æ¿é€šå¸¸é©»ç•™åœ¨L2ç¼“å­˜ä¸­ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½:å½“Aå’ŒBçš„å¾®é¢æ¿çš„ä¸€åˆ—å‘ç”Ÿæ’å1çš„æ›´æ–°æ—¶ï¼ŒAçš„å¾®é¢æ¿çš„ä¸‹ä¸€åˆ—å¯ä»¥è¢«å¸¦å…¥å¯„å­˜å™¨ï¼Œè¿™æ ·è®¡ç®—å°±å¯ä»¥æ©ç›–æ•°æ®ç§»åŠ¨çš„æˆæœ¬ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›å°†Bçš„å¾®é¢æ¿ä¿ç•™åœ¨L1ç¼“å­˜ä¸­(å› ä¸ºå®ƒå°†è¢«Açš„è®¸å¤šå¾®é¢æ¿é‡ç”¨)ï¼Œè¿™é™åˆ¶äº†åˆ†å—å‚æ•°kCã€‚</p><p><img src="/2023/02/12/blislib002/image-20230216132839380.png" alt="image-20230216132839380"></p><p>æœ‰äººå¯èƒ½ä¼šé—®ï¼Œä¸Šè¿°æ–¹æ¡ˆæ˜¯å¦æ˜¯æœ€ä¼˜æ–¹æ¡ˆã€‚åœ¨[7]ä¸­ç»™å‡ºäº†ä¸€ä¸ªç†è®ºï¼Œè¡¨æ˜åœ¨ä¸€ä¸ªç†æƒ³åŒ–çš„æ¨¡å‹ä¸‹ï¼Œä¸Šè¿°æ˜¯å±€éƒ¨æœ€ä¼˜çš„(åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œå‡è®¾æ•°æ®åœ¨å±‚æ¬¡ç»“æ„ä¸­çš„æŸä¸ªå†…å­˜å±‚ä¸­ï¼Œåœ¨è¯¥çº§åˆ«ä¸Šæå‡ºçš„é˜»å¡æœ€ä¼˜åœ°ä¸ä¸‹ä¸€ä¸ªå†…å­˜å±‚å¹³æ‘Šæ•°æ®ç§»åŠ¨çš„æˆæœ¬)ã€‚[13]ç»™å‡ºäº†æŒ‡å¯¼å„ç§åˆ†å—å‚æ•°é€‰æ‹©çš„ç†è®ºã€‚</p><p><img src="/2023/02/12/blislib002/image-20230216133142749.png" alt="image-20230216133142749"></p><h3 id="4-2-Setup"><a href="#4-2-Setup" class="headerlink" title="4.2 Setup"></a>4.2 Setup</h3><p>å›¾4è¯´æ˜äº†å­ç›®å½•step3çš„ç›®å½•ç»“æ„ã€‚ä¸æ­¥éª¤1ç›¸æ¯”ï¼Œæˆ‘ä»¬å¯¹ä»¥ä¸‹ç›®å½•&#x2F;æ–‡ä»¶è¿›è¡Œäº†ä¿®æ”¹&#x2F;æ·»åŠ :</p><p><strong>kernels</strong> è¿™ä¸ªç›®å½•åŒ…å«å„ç§æ¶æ„çš„å¾®å†…æ ¸å®ç°</p><p><strong>bd_gemm_ukr.c</strong>ç»™å‡ºäº†ä¸€ä¸ªåŸç”Ÿçš„Cå®ç°</p><p><strong>bl_dgemm_int_kernel.c</strong> gives an <strong>AVX&#x2F;AVX2</strong> intrinsics micro-kernel implementation for Haswell architecture.</p><p><strong>bl_dgemm_asm_kernel.c</strong> gives an <strong>AVX&#x2F;AVX2</strong> assembly micro-kernel implementation for Haswell architecture.</p><h3 id="4-3-Advanced-techniques"><a href="#4-3-Advanced-techniques" class="headerlink" title="4.3 Advanced techniques"></a>4.3 Advanced techniques</h3><p>You can find the vector instructions online:</p><p><strong>Intel Intrinsics Guide</strong></p><p><strong>Intel ISA Extensions</strong></p><h4 id="4-3-1-An-introduction-example-for-â€œaxpyâ€"><a href="#4-3-1-An-introduction-example-for-â€œaxpyâ€" class="headerlink" title="4.3.1 An introduction example for â€œaxpyâ€"></a>4.3.1 An introduction example for â€œaxpyâ€</h4><p>æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®ç°â€œaxpyâ€çš„ç¤ºä¾‹ï¼Œä»¥æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨Intel AVX intrinsicå’ŒAssembly(åœ¨misc&#x2F;exampleså­ç›®å½•ä¸­)ã€‚</p><p><img src="/2023/02/12/blislib002/image-20230216134020439.png" alt="image-20230216134020439"></p><p>è¿™ä¸ªä¾‹å­å¯ä»¥ä½œä¸ºå­¦ä¹ åŸºæœ¬broacast&#x2F;fma&#x2F;load&#x2F;storeæŒ‡ä»¤çš„ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚æ­¤å¤–ï¼Œè¿™ä¸ªç¤ºä¾‹å®é™…ä¸Šæ˜¯4Ã—4 rank-1æ›´æ–°çš„â€œbroadcastâ€å®ç°çš„åŸè¯­ã€‚</p><h4 id="4-3-2-4Ã—4-rank-1-update"><a href="#4-3-2-4Ã—4-rank-1-update" class="headerlink" title="4.3.2 4Ã—4 rank-1 update"></a>4.3.2 4Ã—4 rank-1 update</h4><p>å¾®å†…æ ¸å®ç°å¯ä»¥å½’ç»“ä¸º4Ã—4çº§åˆ«1çš„æ›´æ–°ã€‚æœ‰ä¸¤ç§å¯èƒ½çš„å®ç°:ä¸€ç§åŸºäºå¹¿æ’­(å›¾5)ï¼Œå¦ä¸€ç§æ˜¯è´è¶æ’åˆ—(å›¾6)ã€‚æ‚¨è¿˜å¯ä»¥å°è¯•å…¶ä»–å¯èƒ½çš„å®ç°ã€‚</p><h3 id="4-4-Your-mission-if-you-choose-to-accept-it"><a href="#4-4-Your-mission-if-you-choose-to-accept-it" class="headerlink" title="4.4 Your mission, if you choose to accept it"></a>4.4 Your mission, if you choose to accept it</h3><p>æˆ‘ä»¬åœ¨my_dgemmä¸­ä¸ºæ‚¨æä¾›äº†ç®€åŒ–BLISæ¡†æ¶çš„å‚è€ƒå®ç°ã€‚ä»£ç çš„ç»„ç»‡æ–¹å¼ä¸å›¾3æ‰€ç¤ºç›¸åŒã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªå¾ªç¯ä¸­çš„æ­¥é•¿å¹¶æ²¡æœ‰å¾ˆå¥½åœ°é€‰æ‹©ï¼Œå¹¶ä¸”å¾®å†…æ ¸å®ç°æ˜¯ä¸€ä¸ªç®€å•çš„Cç‰ˆæœ¬ã€‚å› æ­¤ã€‚æ‚¨ä¸ä¼šæœŸæœ›ä»£ç å…·æœ‰é«˜æ€§èƒ½ã€‚æˆ‘ä»¬è¦ä½ åšçš„å°±æ˜¯:</p><ul><li>åœ¨include&#x2F;bl_config.hæ–‡ä»¶ä¸­æŒ‡å®šåˆ†å—å‚æ•°mC, nC, kCå’Œå¾®å†…æ ¸å¤§å°å‚æ•°mR, nR;</li><li>ä½¿ç”¨çŸ¢é‡intrinsicæˆ–æ±‡ç¼–ä»£ç å®ç°é«˜æ•ˆçš„å¾®å†…æ ¸ã€‚å°†ä»£ç æ”¾åœ¨kernels&#x2F;bl_dgemm_int_kernel.c(ç”¨äºå‘é‡intrinsic)æˆ–kernels&#x2F;bl_dgemm_asm_kernel.c(ç”¨äºasæ±‡ç¼–)ä¸­ã€‚éœ€è¦åœ¨â€œinclude&#x2F; BL_config.hâ€ä¸­ä¿®æ”¹â€œBL_MICRO_KERNELâ€ï¼ŒæŒ‡å®šå¾®å†…æ ¸çš„å‡½æ•°åã€‚</li></ul><p><img src="/2023/02/12/blislib002/image-20230216140558800.png" alt="image-20230216140558800"></p><h2 id="5-Step-4-Parallelizing-with-OpenMP"><a href="#5-Step-4-Parallelizing-with-OpenMP" class="headerlink" title="5 Step 4: Parallelizing with OpenMP"></a>5 Step 4: Parallelizing with OpenMP</h2><p>BLISæ„é€ GotoBLASæ–¹æ³•å®ç°Gemmçš„å¥½å¤„æ˜¯ï¼Œå®ƒåœ¨tt Cä¸­å…¬å¼€äº†5ä¸ªå¾ªç¯ï¼Œè¿™äº›å¾ªç¯å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸OpenMPæŒ‡ä»¤å¹¶è¡Œã€‚</p><h3 id="5-1-To-parallelize-or-not-to-parallelize-thatâ€™s-the-question"><a href="#5-1-To-parallelize-or-not-to-parallelize-thatâ€™s-the-question" class="headerlink" title="5.1 To parallelize or not to parallelize, thatâ€™s the question"></a>5.1 To parallelize or not to parallelize, thatâ€™s the question</h3><p>æœ€åŸºæœ¬çš„é—®é¢˜æ˜¯è¦å¹¶è¡ŒåŒ–å“ªä¸ªå¾ªç¯ã€‚åœ¨[12]ä¸­è¯¦ç»†è®¨è®ºäº†æ¯ä¸ªå¾ªç¯çš„å¹¶è¡ŒåŒ–çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚å¯¹äºå¤šæ ¸ä½“ç³»ç»“æ„(å…·æœ‰ç›¸å¯¹è¾ƒå°‘æ ¸çš„å¤šçº¿ç¨‹ä½“ç³»ç»“æ„)ï¼Œå¯ä»¥åœ¨æ—©æœŸçš„è®ºæ–‡[15]ä¸­æ‰¾åˆ°ç»“æœã€‚</p><h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6 Conclusion"></a>6 Conclusion</h2><p>æˆ‘ä»¬ä½¿ç”¨GEMMä½œä¸ºæ¡ˆä¾‹ç ”ç©¶æ¥å±•ç¤ºå¦‚ä½•ä¸ºæ€§èƒ½è¿›è¡Œç¼–ç¨‹</p><p><img src="/2023/02/12/blislib002/image-20230216141029854.png" alt="image-20230216141029854"></p><p><img src="/2023/02/12/blislib002/image-20230216141041389.png" alt="image-20230216141041389"></p><p><img src="/2023/02/12/blislib002/image-20230216141057850.png" alt="image-20230216141057850"></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>dgemm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JZ6 ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</title>
    <link href="/2023/02/07/niuke003/"/>
    <url>/2023/02/07/niuke003/</url>
    
    <content type="html"><![CDATA[<h2 id="JZ6-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"><a href="#JZ6-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨" class="headerlink" title="JZ6 ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"></a><strong>JZ6</strong> <strong>ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</strong></h2><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://www.nowcoder.com/practice/d0267f7f55b3412ba93bd35cfa8e8035?tpId=265&tqId=39210&rp=1&ru=/exam/oj/ta&qru=/exam/oj/ta&sourceUrl=/exam/oj/ta?page=1&tpId=13&type=265&difficulty=undefined&judgeStatus=undefined&tags=&title=">ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘ (nowcoder.com)</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment">*  struct ListNode &#123;</span><br><span class="hljs-comment">*        int val;</span><br><span class="hljs-comment">*        struct ListNode *next;</span><br><span class="hljs-comment">*        ListNode(int x) :</span><br><span class="hljs-comment">*              val(x), next(NULL) &#123;</span><br><span class="hljs-comment">*        &#125;</span><br><span class="hljs-comment">*  &#125;;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">printListFromTailToHead</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>        vector&lt;<span class="hljs-keyword">int</span>&gt; s;<br>        <span class="hljs-keyword">while</span> (head!=<span class="hljs-literal">NULL</span>) &#123;<br>            s.<span class="hljs-built_in">insert</span>(s.<span class="hljs-built_in">begin</span>(),head-&gt;val);<span class="hljs-comment">//åˆ©ç”¨è¿­ä»£å™¨å¤´æ’</span><br>            head=head-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> s;<br>    &#125;<br>&#125;;<br><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç‰›å®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JZ5 æ›¿æ¢ç©ºæ ¼</title>
    <link href="/2023/02/07/niuke002/"/>
    <url>/2023/02/07/niuke002/</url>
    
    <content type="html"><![CDATA[<h2 id="JZ5-æ›¿æ¢ç©ºæ ¼"><a href="#JZ5-æ›¿æ¢ç©ºæ ¼" class="headerlink" title="JZ5 æ›¿æ¢ç©ºæ ¼"></a><strong>JZ5</strong> <strong>æ›¿æ¢ç©ºæ ¼</strong></h2><h2 id="é¢˜ç›®é“¾æ¥"><a href="#é¢˜ç›®é“¾æ¥" class="headerlink" title="é¢˜ç›®é“¾æ¥"></a>é¢˜ç›®é“¾æ¥</h2><p><a href="https://www.nowcoder.com/practice/0e26e5551f2b489b9f58bc83aa4b6c68?tpId=265&tqId=39209&rp=1&ru=/exam/oj/ta&qru=/exam/oj/ta&sourceUrl=/exam/oj/ta?tpId=13&difficulty=undefined&judgeStatus=undefined&tags=&title=">æ›¿æ¢ç©ºæ ¼_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘ (nowcoder.com)</a></p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * @param s stringå­—ç¬¦ä¸² </span><br><span class="hljs-comment">     * @return stringå­—ç¬¦ä¸²</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">string <span class="hljs-title">replaceSpace</span><span class="hljs-params">(string s)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>        string str2 =<span class="hljs-string">&quot;%20&quot;</span>;<br>        string str3;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-keyword">if</span>(s[i]!=<span class="hljs-string">&#x27; &#x27;</span>)<span class="hljs-comment">//ä¸æ˜¯ç©ºæ ¼å°±æ’å…¥åˆ°str3</span><br>                str3.<span class="hljs-built_in">push_back</span>(s[i]);<br>            <span class="hljs-keyword">else</span><br>                str3.<span class="hljs-built_in">append</span>(str2);<span class="hljs-comment">//å¦‚æœæ˜¯ç©ºæ ¼å°±æŠŠstr2æ’å…¥åˆ°str3</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> str3;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç‰›å®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JZ3 æ•°ç»„ä¸­é‡å¤çš„æ•°å­—</title>
    <link href="/2023/02/07/niuke001/"/>
    <url>/2023/02/07/niuke001/</url>
    
    <content type="html"><![CDATA[<h2 id="JZ3-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—"><a href="#JZ3-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—" class="headerlink" title="JZ3 æ•°ç»„ä¸­é‡å¤çš„æ•°å­—"></a>JZ3 æ•°ç»„ä¸­é‡å¤çš„æ•°å­—</h2><h2 id="é¢˜ç›®é“¾æ¥ï¼š"><a href="#é¢˜ç›®é“¾æ¥ï¼š" class="headerlink" title="é¢˜ç›®é“¾æ¥ï¼š"></a>é¢˜ç›®é“¾æ¥ï¼š</h2><p><a href="https://www.nowcoder.com/practice/6fe361ede7e54db1b84adc81d09d8524?tpId=265&tqId=39207&rp=1&ru=/exam/oj/ta&qru=/exam/oj/ta&sourceUrl=/exam/oj/ta?tpId=13&difficulty=undefined&judgeStatus=undefined&tags=&title=">æ•°ç»„ä¸­é‡å¤çš„æ•°å­—_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘ (nowcoder.com)</a></p><h2 id="å®Œæ•´è§£ç­”ï¼š"><a href="#å®Œæ•´è§£ç­”ï¼š" class="headerlink" title="å®Œæ•´è§£ç­”ï¼š"></a>å®Œæ•´è§£ç­”ï¼š</h2><p>set::count()æ˜¯C++ STLä¸­çš„å†…ç½®å‡½æ•°ï¼Œå®ƒè¿”å›å…ƒç´ åœ¨é›†åˆä¸­å‡ºç°çš„æ¬¡æ•°ã€‚ç”±äºsetå®¹å™¨ä»…åŒ…å«å”¯ä¸€å…ƒç´ ï¼Œå› æ­¤åªèƒ½è¿”å›1æˆ–0ã€‚</p><ul><li>ç”¨æ³•ï¼šset_name.count(element)</li><li>å‚æ•°ï¼šè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå¼ºåˆ¶æ€§å‚æ•°elementï¼Œè¯¥å…ƒç´ æŒ‡å®šè¦è¿”å›å…¶è®¡æ•°çš„å…ƒç´ ã€‚</li><li>è¿”å›å€¼ï¼šè¯¥å‡½æ•°è¿”å›1æˆ–0ï¼Œå› ä¸ºè¯¥é›†åˆä»…åŒ…å«å”¯ä¸€å…ƒç´ ã€‚å¦‚æœè®¾ç½®çš„å®¹å™¨ä¸­å­˜åœ¨è¯¥å€¼ï¼Œåˆ™è¿”å›1ã€‚å¦‚æœå®¹å™¨ä¸­ä¸å­˜åœ¨å®ƒï¼Œåˆ™è¿”å›0ã€‚</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä»£ç ä¸­çš„ç±»åã€æ–¹æ³•åã€å‚æ•°åå·²ç»æŒ‡å®šï¼Œè¯·å‹¿ä¿®æ”¹ï¼Œç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * @param numbers intæ•´å‹vector </span><br><span class="hljs-comment">     * @return intæ•´å‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">duplicate</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt;&amp; numbers)</span> </span>&#123;<br>        <span class="hljs-comment">// write code here</span><br>        set&lt;<span class="hljs-keyword">int</span>&gt; s;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;numbers.<span class="hljs-built_in">size</span>();i++)&#123;<br>            <span class="hljs-keyword">if</span>(s.<span class="hljs-built_in">count</span>(numbers[i])&gt;<span class="hljs-number">0</span>) <span class="hljs-comment">//æ­¤å…ƒç´ é‡å¤ï¼Œåˆ™è¿”å›</span><br>                <span class="hljs-keyword">return</span> numbers[i];<br>            <span class="hljs-keyword">else</span><br>                s.<span class="hljs-built_in">insert</span>(numbers[i]);<span class="hljs-comment">//ä¸é‡å¤åˆ™åŠ å…¥é›†åˆ</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h2><p><a href="https://blog.csdn.net/cmehppc/article/details/121712019">(64æ¡æ¶ˆæ¯) ã€c++ã€‘set.count()ç”¨æ³•_æ³æ³æåˆ°æœˆäº®äº†å—çš„åšå®¢-CSDNåšå®¢_c++set count</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>ç‰›å®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çŸ©é˜µä¹˜æ³•æœ€åŸºç¡€ç‰ˆæœ¬</title>
    <link href="/2023/02/06/matrix001/"/>
    <url>/2023/02/06/matrix001/</url>
    
    <content type="html"><![CDATA[<h2 id="çŸ©é˜µä¹˜æ³•æœ€åŸºç¡€ç‰ˆæœ¬"><a href="#çŸ©é˜µä¹˜æ³•æœ€åŸºç¡€ç‰ˆæœ¬" class="headerlink" title="çŸ©é˜µä¹˜æ³•æœ€åŸºç¡€ç‰ˆæœ¬"></a>çŸ©é˜µä¹˜æ³•æœ€åŸºç¡€ç‰ˆæœ¬</h2><h3 id="æ•°å­¦åŸç†ç¤ºä¾‹"><a href="#æ•°å­¦åŸç†ç¤ºä¾‹" class="headerlink" title="æ•°å­¦åŸç†ç¤ºä¾‹"></a>æ•°å­¦åŸç†ç¤ºä¾‹</h3><p><img src="/2023/02/06/matrix001/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25pYW5uaWFueGk=,size_16,color_FFFFFF,t_70.png" alt="img"></p><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><p>ç”¨Açš„ç¬¬iè¡Œåˆ†åˆ«å’ŒBçš„ç¬¬jåˆ—çš„å„ä¸ªå…ƒç´ ç›¸ä¹˜æ±‚å’Œï¼Œæ±‚å¾—Cçš„ç¬¬iè¡Œjåˆ—çš„å…ƒç´ ï¼Œè¿™ç§ç®—æ³•ä¸­ï¼ŒBçš„è®¿é—®æ˜¯æŒ‰åˆ—è¿›è¡Œè®¿é—®çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//mæ˜¯AçŸ©é˜µçš„è¡Œ,kæ˜¯AçŸ©é˜µçš„åˆ—,næ˜¯BçŸ©é˜µçš„åˆ—</span><br><span class="hljs-keyword">double</span> temp=<span class="hljs-number">0.0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µå„è¡Œï¼Œå…¶è¡Œæ•°ä¸Açš„è¡Œæ•°ç›¸ç­‰ </span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<span class="hljs-comment">//éå†CçŸ©é˜µiè¡Œjåˆ—</span><br>        temp = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>; p &lt; k; p++)&#123;<span class="hljs-comment">//ç”¨på¾ªç¯ç´¯åŠ å’Œè®¡ç®—C[i][j] </span><br>            <span class="hljs-comment">//è®¡ç®—åŒºåŸŸ</span><br>            temp += A[i][p] * B[p][j];<span class="hljs-comment">//éå†AçŸ©é˜µå„è¡Œä¸BçŸ©é˜µå„åˆ—</span><br>        &#125;<br>        C[i][j] = temp;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//ç»“æœCçŸ©é˜µmè¡Œnåˆ—</span><br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://blog.csdn.net/niannianxi/article/details/104028215">(64æ¡æ¶ˆæ¯) Cè¯­è¨€å®ç°çŸ©é˜µçš„ä¹˜æ³•_ê§å¹´å¹´æ›¦ê§‚çš„åšå®¢-CSDNåšå®¢_cè¯­è¨€çŸ©é˜µä¹˜æ³•</a></p><p><a href="https://www.jb51.net/article/75750.htm">Cè¯­è¨€ç§‘å­¦è®¡ç®—å…¥é—¨ä¹‹çŸ©é˜µä¹˜æ³•çš„ç›¸å…³è®¡ç®—_C è¯­è¨€_è„šæœ¬ä¹‹å®¶ (jb51.net)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Matrix</tag>
      
      <tag>GEMM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>registerå…³é”®å­—</title>
    <link href="/2023/02/02/register/"/>
    <url>/2023/02/02/register/</url>
    
    <content type="html"><![CDATA[<h2 id="registerå…³é”®å­—"><a href="#registerå…³é”®å­—" class="headerlink" title="registerå…³é”®å­—"></a>registerå…³é”®å­—</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> val = <span class="hljs-number">100</span>;<br><span class="hljs-comment">//å¯„å­˜å™¨å˜é‡æ²¡æœ‰åœ°å€ï¼Œä¸èƒ½å–åœ°å€</span><br>val = <span class="hljs-number">200</span>; <span class="hljs-comment">//å¯ä»¥è¢«å†™å…¥</span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, val);<br><span class="hljs-comment">// åœ¨gccç¼–è¯‘å™¨ä¸‹ ä¹Ÿä¸å…è®¸å–åœ°å€</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//ç”±äºä½¿ç”¨registerå…³é”®å­—ï¼Œç›´æ¥å°†valå­˜åœ¨å¯„å­˜å™¨å†…ï¼Œå› æ­¤valæ²¡æœ‰å†…å­˜åœ°å€ï¼Œå› æ­¤ä¸èƒ½è¿›è¡Œå–åœ°å€æ“ä½œã€‚</span><br></code></pre></div></td></tr></table></figure><ol><li>æˆ‘ä»¬é€šå¸¸é‡‡ç”¨å±€éƒ¨å˜é‡é‡‡ç”¨ register çš„ï¼Œå…¨å±€å˜é‡ä¼šå¯¼è‡´ CPU å½“ä¸­çš„å¯„å­˜å™¨è¢«é•¿æ—¶é—´å ç”¨ã€‚</li><li>ä¸€ä¸ªå˜é‡è¢«å­˜æ”¾åˆ°å¯„å­˜å™¨å½“ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡çš„æ•ˆç‡å°±ä¼šå¤§å¤§çš„æé«˜,å› ä¸ºä¸ç”¨è®¿å­˜è¯»å–</li><li>registerå…³é”®å­—å¯ä»¥ä¸æŒ‡é’ˆå˜é‡ä¸€èµ·ä½¿ç”¨ã€‚</li><li>å¯„å­˜å™¨æ˜¯ä¸€ä¸ªå­˜å‚¨ç±»ï¼Œå¹¶ä¸”Cä¸å…è®¸å˜é‡ä½¿ç”¨å¤šä¸ªå­˜å‚¨ç±»è¯´æ˜ç¬¦ã€‚å› æ­¤ï¼Œregisterä¸èƒ½ä¸staticä¸€èµ·ä½¿ç”¨ã€‚</li><li>å¯„å­˜å™¨åªèƒ½åœ¨ä¸€ä¸ªå—å†…ä½¿ç”¨ï¼ˆå±€éƒ¨ï¼‰ï¼Œè€Œä¸èƒ½åœ¨å…¨å±€èŒƒå›´å†…ï¼ˆåœ¨ä¸»å¤–éƒ¨ï¼‰ä½¿ç”¨</li><li>å¯„å­˜å™¨æ•°é‡æœ‰é™</li></ol><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://xie.infoq.cn/article/f6093f4eebd3664c0a1514e26">ã€Cè¯­è¨€ã€‘register å…³é”®å­—_11æœˆæœˆæ›´_è¬“æ³½_InfoQå†™ä½œç¤¾åŒº</a></p><p><a href="https://zhuanlan.zhihu.com/p/263575137">ä¸€æ­¥å¸¦æ‚¨äº†è§£Cè¯­è¨€ä¸­çš„â€œregisterâ€å…³é”®å­— - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://www.ab62.cn/article/5406.html">Cè¯­è¨€å…³é”®å­—ä¹‹auto registerè¯¦è§£_C è¯­è¨€_ABæ•™ç¨‹ç½‘ (ab62.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C/C++</tag>
      
      <tag>register</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BLISlab dgemmä¼˜åŒ–</title>
    <link href="/2023/02/02/blislab/"/>
    <url>/2023/02/02/blislab/</url>
    
    <content type="html"><![CDATA[<h1 id="BLISlab-dgemmä¼˜åŒ–"><a href="#BLISlab-dgemmä¼˜åŒ–" class="headerlink" title="BLISlab dgemmä¼˜åŒ–"></a>BLISlab dgemmä¼˜åŒ–</h1><h2 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h2><p><strong>Gitåœ°å€ï¼š</strong><a href="https://github.com/flame/blislab">https://github.com/flame/blislab</a></p><p><strong>è§†é¢‘æ•™ç¨‹ï¼š</strong><a href="https://www.bilibili.com/video/BV1c94y117Uw?vd_source=3ae32e36058f58c5b85935fca9b77797%E3%80%90%E6%BE%8E%E5%B3%B0%E7%A7%91%E6%8A%80-%E5%BC%A0%E5%85%88%E8%BD%B6%E8%80%81%E5%B8%88%E3%80%91">https://www.bilibili.com/video/BV1c94y117Uw?vd_source=3ae32e36058f58c5b85935fca9b77797ã€æ¾å³°ç§‘æŠ€-å¼ å…ˆè½¶è€å¸ˆã€‘</a></p><p><strong>é˜…è¯»</strong>ï¼štutorial.pdfã€ä½äºä»£ç åŒ…ä¸­ã€‘</p><h2 id="Step0"><a href="#Step0" class="headerlink" title="Step0"></a>Step0</h2><h3 id="1-å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°"><a href="#1-å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°" class="headerlink" title="1.å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°"></a>1.å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">git clone https://github.com/flame/blislab.git<br></code></pre></div></td></tr></table></figure><h3 id="2-ä»£ç ç»“æ„"><a href="#2-ä»£ç ç»“æ„" class="headerlink" title="2.ä»£ç ç»“æ„"></a>2.ä»£ç ç»“æ„</h3><p><img src="/2023/02/02/blislab/image-20230202155728203.png" alt="image-20230202155728203"></p><h3 id="3-ç¼–è¯‘ç¯å¢ƒ"><a href="#3-ç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="3.ç¼–è¯‘ç¯å¢ƒ"></a>3.ç¼–è¯‘ç¯å¢ƒ</h3><p><img src="/2023/02/02/blislab/image-20230202155820411.png" alt="image-20230202155820411"></p><h3 id="4-è¿è¡Œç¯å¢ƒé…ç½®è„šæœ¬"><a href="#4-è¿è¡Œç¯å¢ƒé…ç½®è„šæœ¬" class="headerlink" title="4.è¿è¡Œç¯å¢ƒé…ç½®è„šæœ¬"></a>4.è¿è¡Œç¯å¢ƒé…ç½®è„šæœ¬</h3><p><img src="/2023/02/02/blislab/image-20230202160027957.png" alt="image-20230202160027957"></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@hadoop1 step0]# source ./sourceme.sh <br>BLISLAB_DIR = .<br>BLISLAB_USE_INTEL = false<br>BLISLAB_USE_BLAS = false<br>COMPILER_OPT_LEVEL = O3<br>BLAS_DIR = /u/jianyu/lib/openblas<br></code></pre></div></td></tr></table></figure><h3 id="5-Makefile"><a href="#5-Makefile" class="headerlink" title="5.Makefile"></a>5.Makefile</h3><p><img src="/2023/02/02/blislab/image-20230202160244490.png" alt="image-20230202160244490"></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@hadoop1 step0]# make<br>gcc -O3 -march=core-avx2 -fPIC -c dgemm/my_dgemm.c -o dgemm/my_dgemm.o -I./include -I./kernels -I/u/jianyu/lib/openblas/include<br>gcc -O3 -march=core-avx2 -fPIC -c dgemm/bl_dgemm_ref.c -o dgemm/bl_dgemm_ref.o -I./include -I./kernels -I/u/jianyu/lib/openblas/include<br>gcc -O3 -march=core-avx2 -fPIC -c dgemm/bl_dgemm_util.c -o dgemm/bl_dgemm_util.o -I./include -I./kernels -I/u/jianyu/lib/openblas/include<br>ar cr lib/libblislab.a dgemm/my_dgemm.o dgemm/bl_dgemm_ref.o dgemm/bl_dgemm_util.o    <br>ranlib lib/libblislab.a<br>gcc -O3 -march=core-avx2 -fPIC -shared -o lib/libblislab.so dgemm/my_dgemm.o dgemm/bl_dgemm_ref.o dgemm/bl_dgemm_util.o     ./lib/libblislab.a -lpthread -lm -lrt<br>cd ./test &amp;&amp; make &amp;&amp; cd . -I./include -I./kernels -I/u/jianyu/lib/openblas/include<br>make[1]: è¿›å…¥ç›®å½•â€œ/root/blislab/step0/testâ€<br>gcc -O3 -march=core-avx2 -fPIC test_bl_dgemm.c -o test_bl_dgemm.x -I../include -I../kernels -I/u/jianyu/lib/openblas/include ../lib/libblislab.a -lpthread -lm -lrt<br>make[1]: ç¦»å¼€ç›®å½•â€œ/root/blislab/step0/testâ€<br></code></pre></div></td></tr></table></figure><h3 id="6-make-gnu-inc"><a href="#6-make-gnu-inc" class="headerlink" title="6.make.gnu.inc"></a>6.make.gnu.inc</h3><p><img src="/2023/02/02/blislab/image-20230202160608401.png" alt="image-20230202160608401"></p><h3 id="7-refå‚è€ƒå®ç°æ˜¯å¦è°ƒç”¨BLAS"><a href="#7-refå‚è€ƒå®ç°æ˜¯å¦è°ƒç”¨BLAS" class="headerlink" title="7.refå‚è€ƒå®ç°æ˜¯å¦è°ƒç”¨BLAS"></a>7.refå‚è€ƒå®ç°æ˜¯å¦è°ƒç”¨BLAS</h3><p><img src="/2023/02/02/blislab/image-20230202160904158.png" alt="image-20230202160904158"></p><h3 id="8-my-dgemm-c"><a href="#8-my-dgemm-c" class="headerlink" title="8.my_dgemm.c"></a>8.my_dgemm.c</h3><p><img src="/2023/02/02/blislab/image-20230202160939940.png" alt="image-20230202160939940"></p><h3 id="9-ç›¸å…³æ•°æ®å˜é‡å«ä¹‰"><a href="#9-ç›¸å…³æ•°æ®å˜é‡å«ä¹‰" class="headerlink" title="9.ç›¸å…³æ•°æ®å˜é‡å«ä¹‰"></a>9.ç›¸å…³æ•°æ®å˜é‡å«ä¹‰</h3><p><img src="/2023/02/02/blislab/image-20230202161055971.png" alt="image-20230202161055971"></p><h3 id="10-ä»£ç é‡‡ç”¨åˆ—ä¸»å…ƒ"><a href="#10-ä»£ç é‡‡ç”¨åˆ—ä¸»å…ƒ" class="headerlink" title="10.ä»£ç é‡‡ç”¨åˆ—ä¸»å…ƒ"></a>10.ä»£ç é‡‡ç”¨åˆ—ä¸»å…ƒ</h3><p><img src="/2023/02/02/blislab/image-20230202161219553.png" alt="image-20230202161219553"></p><h3 id="11-dgemmä½¿ç”¨è„šæœ¬æµ‹è¯•"><a href="#11-dgemmä½¿ç”¨è„šæœ¬æµ‹è¯•" class="headerlink" title="11.dgemmä½¿ç”¨è„šæœ¬æµ‹è¯•"></a>11.dgemmä½¿ç”¨è„šæœ¬æµ‹è¯•</h3><p>Testç›®å½•ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@hadoop1 test]# ./run_bl_dgemm.sh <br>result=[<br><span class="hljs-meta">%</span><span class="bash">m%n%k%MY_GFLOPS%REF_GFLOPS</span><br>   16    16    16  7.35  1.93<br>   32    32    32  7.88  1.29<br>   48    48    48  9.81  1.17<br>   64    64    64  8.98  1.20<br>   80    80    80  9.59  1.11<br>   96    96    96  7.74  1.08<br>  112   112   112  8.32  0.95<br>  128   128   128  7.74  1.04<br>  144   144   144  7.39  0.99<br>  160   160   160  7.13  1.06<br>  176   176   176  7.58  1.06<br>  192   192   192  7.73  0.98<br>  208   208   208  7.29  1.01<br>  224   224   224  7.90  0.97<br>  240   240   240  7.61  1.00<br>  256   256   256  6.72  0.96<br>  272   272   272  7.51  0.99<br>  288   288   288  7.39  0.99<br>  304   304   304  7.84  0.99<br>  320   320   320  7.61  0.97<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//run_bl_dgemm.sh</span><br>#!/bin/bash<br><br>#For Mac OS only<br><span class="hljs-keyword">export</span> DYLD_LIBRARY_PATH=/opt/intel/lib:/opt/intel/mkl/lib<br><br>#Single Thread<br><span class="hljs-keyword">export</span> KMP_AFFINITY=compact  #Rule to bind core to thread <span class="hljs-keyword">for</span> OMP thread with Intel compiler <span class="hljs-keyword">for</span> parallel version<br><span class="hljs-keyword">export</span> OMP_NUM_THREADS=<span class="hljs-number">1</span>     #Set OMP number of threads <span class="hljs-keyword">for</span> parallel version<br><span class="hljs-keyword">export</span> BLISLAB_IC_NT=<span class="hljs-number">1</span>       #Set BLISLAB number of threads <span class="hljs-keyword">for</span> parallel version<br>k_start=<span class="hljs-number">16</span><span class="hljs-comment">//èµ·å§‹å¤§å°</span><br>k_end=<span class="hljs-number">1024</span><span class="hljs-comment">//ç»“æŸå¤§å°</span><br>k_blocksize=<span class="hljs-number">16</span><span class="hljs-comment">//æ­¥é•¿</span><br>echo <span class="hljs-string">&quot;result=[&quot;</span><br>echo -e <span class="hljs-string">&quot;%m\t%n\t%k\t%MY_GFLOPS\t%REF_GFLOPS&quot;</span><br><span class="hljs-keyword">for</span> (( k=k_start; k&lt;=k_end; k+=k_blocksize ))<br><span class="hljs-keyword">do</span><br>    ./test_bl_dgemm.x     $k $k $k <br>done<br>echo <span class="hljs-string">&quot;];&quot;</span><br></code></pre></div></td></tr></table></figure><h3 id="12-dgemmæ‰‹åŠ¨æŒ‡å®šå‚æ•°æµ‹è¯•"><a href="#12-dgemmæ‰‹åŠ¨æŒ‡å®šå‚æ•°æµ‹è¯•" class="headerlink" title="12.dgemmæ‰‹åŠ¨æŒ‡å®šå‚æ•°æµ‹è¯•"></a>12.dgemmæ‰‹åŠ¨æŒ‡å®šå‚æ•°æµ‹è¯•</h3><p>Testç›®å½•ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">[root@hadoop1 test]# ./test_bl_dgemm.x <span class="hljs-number">256</span> <span class="hljs-number">256</span> <span class="hljs-number">256</span> <br>  <span class="hljs-number">256</span>   <span class="hljs-number">256</span>   <span class="hljs-number">256</span>  <span class="hljs-number">5.00</span>  <span class="hljs-number">0.84</span><br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">[root@hadoop1 test]# ./test_bl_dgemm.x <span class="hljs-number">16</span> <span class="hljs-number">32</span> <span class="hljs-number">128</span><br>   <span class="hljs-number">16</span>    <span class="hljs-number">32</span>   <span class="hljs-number">128</span>  <span class="hljs-number">8.77</span>  <span class="hljs-number">1.02</span><br></code></pre></div></td></tr></table></figure><p><strong>è¿™é‡Œè¦æ³¨æ„å“ªä¸ªä»£è¡¨m,n,k?</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">( <span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[] )</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span>    m, n, k; <br><br>    <span class="hljs-keyword">if</span> ( argc != <span class="hljs-number">4</span> ) &#123;<br>        <span class="hljs-built_in">printf</span>( <span class="hljs-string">&quot;Error: require 3 arguments, but only %d provided.\n&quot;</span>, argc - <span class="hljs-number">1</span> );<br>        <span class="hljs-built_in">exit</span>( <span class="hljs-number">0</span> );<br>    &#125;<br><br>    <span class="hljs-built_in">sscanf</span>( argv[ <span class="hljs-number">1</span> ], <span class="hljs-string">&quot;%d&quot;</span>, &amp;m );<br>    <span class="hljs-built_in">sscanf</span>( argv[ <span class="hljs-number">2</span> ], <span class="hljs-string">&quot;%d&quot;</span>, &amp;n );<br>    <span class="hljs-built_in">sscanf</span>( argv[ <span class="hljs-number">3</span> ], <span class="hljs-string">&quot;%d&quot;</span>, &amp;k );<br><br>    <span class="hljs-built_in">test_bl_dgemm</span>( m, n, k );<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="13-è®¡æ—¶åŒºåŸŸ"><a href="#13-è®¡æ—¶åŒºåŸŸ" class="headerlink" title="13.è®¡æ—¶åŒºåŸŸ"></a><strong>13.è®¡æ—¶åŒºåŸŸ</strong></h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; nrepeats; i ++ ) &#123;<br>        ref_beg = <span class="hljs-built_in">bl_clock</span>();<span class="hljs-comment">//blislibæä¾›çš„å°è£…</span><br>        &#123;<br>            <span class="hljs-built_in">bl_dgemm_ref</span>(<br>                    m,<br>                    n,<br>                    k,<br>                    A,<br>                    lda,<br>                    B,<br>                    ldb,<br>                    C_ref,<br>                    ldc_ref<br>                    );<br>        &#125;<br>        ref_time = <span class="hljs-built_in">bl_clock</span>() - ref_beg;<br><br>        <span class="hljs-keyword">if</span> ( i == <span class="hljs-number">0</span> ) &#123;<br>            ref_rectime = ref_time;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            ref_rectime = ref_time &lt; ref_rectime ? ref_time : ref_rectime;<span class="hljs-comment">//å¤šæ¬¡è®¡æ—¶å–æœ€ä¼˜</span><br>        &#125;<br>    &#125;<br></code></pre></div></td></tr></table></figure><h3 id="14-æ­£ç¡®æ€§æ£€éªŒ"><a href="#14-æ­£ç¡®æ€§æ£€éªŒ" class="headerlink" title="14.æ­£ç¡®æ€§æ£€éªŒ"></a>14.æ­£ç¡®æ€§æ£€éªŒ</h3><p>Testç›®å½•ä¸‹Test_bl_gemm.c</p><p>ç»“æœæ¯”è¾ƒï¼šé€šè¿‡æ¯”è¾ƒä½ çš„ä¼˜åŒ–è®¡ç®—ç»“æœå’Œå‚è€ƒè®¡ç®—ç»“æœå¯¹æ¯”</p><p>Gflopsçš„è®¡ç®—</p><ul><li>æœ‰æ•ˆæµ®ç‚¹æ¬¡æ•° &#x3D; 2*m*n*k</li><li>Gflops &#x3D; æœ‰æ•ˆæµ®ç‚¹æ¬¡æ•° &#x2F; æ—¶é—´</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">computeError</span>(<br>        ldc,<br>        ldc_ref,<br>        m,<br>        n,<br>        C,<br>        C_ref<br>        );<br><br><span class="hljs-comment">// Compute overall floating point operations.</span><br>flops = ( m * n / ( <span class="hljs-number">1000.0</span> * <span class="hljs-number">1000.0</span> * <span class="hljs-number">1000.0</span> ) ) * ( <span class="hljs-number">2</span> * k );<br><br><span class="hljs-built_in">printf</span>( <span class="hljs-string">&quot;%5d\t %5d\t %5d\t %5.2lf\t %5.2lf\n&quot;</span>, <br>        m, n, k, flops / bl_dgemm_rectime, flops / ref_rectime );<br></code></pre></div></td></tr></table></figure><h3 id="15-è¯¾åä½œä¸š"><a href="#15-è¯¾åä½œä¸š" class="headerlink" title="15.è¯¾åä½œä¸š"></a>15.è¯¾åä½œä¸š</h3><p><strong>perfå·¥å…·çš„ç”¨æ³•</strong>ï¼š</p><p><a href="https://xingyuanjie.top/2022/01/19/tool003/">perf-ç³»ç»Ÿçº§æ€§èƒ½åˆ†æå·¥å…· - Amicoyuan (xingyuanjie.top)</a></p><p><strong>åˆ†æä¸åŒçš„j,p,iå¾ªç¯é¡ºåºçš„æ€§èƒ½ï¼š</strong></p><p>åŸå› cache missé€ æˆçš„å·®å¼‚</p><h2 id="Step1"><a href="#Step1" class="headerlink" title="Step1"></a>Step1</h2><h3 id="1-ä¸Step0æ¯”è¾ƒ"><a href="#1-ä¸Step0æ¯”è¾ƒ" class="headerlink" title="1.ä¸Step0æ¯”è¾ƒ"></a>1.ä¸Step0æ¯”è¾ƒ</h3><p><strong>å·¦è¾¹æ˜¯Step1å³è¾¹æ˜¯Step0</strong></p><p><img src="/2023/02/02/blislab/image-20230202165659964.png" alt="image-20230202165659964"></p><h3 id="2-åŸºæœ¬åˆ†å—"><a href="#2-åŸºæœ¬åˆ†å—" class="headerlink" title="2.åŸºæœ¬åˆ†å—"></a>2.åŸºæœ¬åˆ†å—</h3><p><img src="/2023/02/02/blislab/image-20230202170723811.png" alt="image-20230202170723811"></p><h3 id="3-åæ±‡ç¼–"><a href="#3-åæ±‡ç¼–" class="headerlink" title="3.åæ±‡ç¼–"></a>3.åæ±‡ç¼–</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@hadoop1 dgemm]# objdump -d ./my_dgemm.o &gt; my_dgemm.S<br></code></pre></div></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs assembly">./my_dgemm.oï¼š     æ–‡ä»¶æ ¼å¼ elf64-x86-64<br><br><br>Disassembly of section .text:<br><br>0000000000000000 &lt;AddDot&gt;:<br>   0:85 ff                test   %edi,%edi<br>   2:7e 2e                jle    32 &lt;AddDot+0x32&gt;<br>   4:48 63 d2             movslq %edx,%rdx<br>   7:c4 c1 7b 10 01       vmovsd (%r9),%xmm0<br>   c:31 c0                xor    %eax,%eax<br>   e:48 c1 e2 03          shl    $0x3,%rdx<br>  12:66 0f 1f 44 00 00    nopw   0x0(%rax,%rax,1)<br>  18:c5 fb 10 0e          vmovsd (%rsi),%xmm1<br>  1c:48 01 d6             add    %rdx,%rsi<br>  1f:c4 e2 f1 b9 04 c1    vfmadd231sd (%rcx,%rax,8),%xmm1,%xmm0<br>  25:48 83 c0 01          add    $0x1,%rax<br>  29:c4 c1 7b 11 01       vmovsd %xmm0,(%r9)<br>  2e:39 c7                cmp    %eax,%edi<br>  30:7f e6                jg     18 &lt;AddDot+0x18&gt;<br>  32:f3 c3                repz retq <br>  34:66 90                xchg   %ax,%ax<br>  36:66 2e 0f 1f 84 00 00 nopw   %cs:0x0(%rax,%rax,1)<br>  3d:00 00 00 <br><br>0000000000000040 &lt;AddDot_MRxNR&gt;:<br>  40:e9 00 00 00 00       jmpq   45 &lt;AddDot_MRxNR+0x5&gt;<br>  45:90                   nop<br>  46:66 2e 0f 1f 84 00 00 nopw   %cs:0x0(%rax,%rax,1)<br>  4d:00 00 00 <br></code></pre></div></td></tr></table></figure><h3 id="4-åæ±‡ç¼–ï¼ˆ-fPICå¼•å…¥çš„å·®å¼‚ï¼‰"><a href="#4-åæ±‡ç¼–ï¼ˆ-fPICå¼•å…¥çš„å·®å¼‚ï¼‰" class="headerlink" title="4.åæ±‡ç¼–ï¼ˆ-fPICå¼•å…¥çš„å·®å¼‚ï¼‰"></a>4.åæ±‡ç¼–ï¼ˆ-fPICå¼•å…¥çš„å·®å¼‚ï¼‰</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@hadoop1 test]# objdump -d ./test_bl_dgemm.x  &gt; test.S<br></code></pre></div></td></tr></table></figure><p><img src="/2023/02/02/blislab/image-20230202171234007.png" alt="image-20230202171234007"></p><h3 id="5-Gccç”Ÿæˆæ±‡ç¼–"><a href="#5-Gccç”Ÿæˆæ±‡ç¼–" class="headerlink" title="5.Gccç”Ÿæˆæ±‡ç¼–"></a>5.Gccç”Ÿæˆæ±‡ç¼–</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[root@hadoop1 step1]# gcc -O3 -march=core-avx2 -fPIC -S dgemm/my_dgemm.c -o dgemm/my_dgemm1.S -I./include -I./kernels -I/u/jianyu/lib/openblas/include<br></code></pre></div></td></tr></table></figure><p><img src="/2023/02/02/blislab/image-20230202171758087.png" alt="image-20230202171758087"></p><h3 id="6-Step0ä¸Step1æ¯”è¾ƒ"><a href="#6-Step0ä¸Step1æ¯”è¾ƒ" class="headerlink" title="6.Step0ä¸Step1æ¯”è¾ƒ"></a>6.Step0ä¸Step1æ¯”è¾ƒ</h3><p><img src="/2023/02/02/blislab/image-20230202172816584.png" alt="image-20230202172816584"></p><h3 id="7-åˆ†å—ï¼Œä¿®æ”¹MRï¼Œ-NRä¸º4Ã—4"><a href="#7-åˆ†å—ï¼Œä¿®æ”¹MRï¼Œ-NRä¸º4Ã—4" class="headerlink" title="7.åˆ†å—ï¼Œä¿®æ”¹MRï¼Œ NRä¸º4Ã—4"></a>7.åˆ†å—ï¼Œä¿®æ”¹MRï¼Œ NRä¸º4Ã—4</h3><p><img src="/2023/02/02/blislab/image-20230202173132817.png" alt="image-20230202173132817"></p><h3 id="8-åˆ†å—ï¼ˆ2Ã—2ï¼‰"><a href="#8-åˆ†å—ï¼ˆ2Ã—2ï¼‰" class="headerlink" title="8.åˆ†å—ï¼ˆ2Ã—2ï¼‰"></a>8.åˆ†å—ï¼ˆ2Ã—2ï¼‰</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">void</span> AddDot_2Ã—<span class="hljs-number">2</span>( <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">double</span> *A, <span class="hljs-keyword">int</span> lda, <span class="hljs-keyword">double</span> *B, <span class="hljs-keyword">int</span> ldb, <span class="hljs-keyword">double</span> *C,<span class="hljs-keyword">int</span> ldc ) &#123;<br><span class="hljs-keyword">register</span> <span class="hljs-keyword">double</span> C00, C01, C10, C11;<br>    <span class="hljs-keyword">int</span> p;<br>    C00=<span class="hljs-number">0.0</span>;<br>    C01=<span class="hljs-number">0.0</span>;<br>    C10=<span class="hljs-number">0.0</span>;<br>    C11=<span class="hljs-number">0.0</span>;<br>    <br>    <span class="hljs-keyword">for</span>( p=<span class="hljs-number">0</span> ;p &lt; k; p++)<br>    &#123;<br>        C00 += <span class="hljs-built_in">A</span>( <span class="hljs-number">0</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">0</span>);<br>        C01 += <span class="hljs-built_in">A</span>( <span class="hljs-number">0</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">1</span>);<br>        C10 += <span class="hljs-built_in">A</span>( <span class="hljs-number">1</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">0</span>);<br>        C11 += <span class="hljs-built_in">A</span>( <span class="hljs-number">1</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>) +=C00;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) +=C01;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>) +=C10;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>) +=C11;<br>    <br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="/2023/02/02/blislab/image-20230202173645399.png" alt="image-20230202173645399"></p><h3 id="9-AddDot-2x2æ±‡ç¼–ä»£ç "><a href="#9-AddDot-2x2æ±‡ç¼–ä»£ç " class="headerlink" title="9.AddDot_2x2æ±‡ç¼–ä»£ç "></a>9.AddDot_2x2æ±‡ç¼–ä»£ç </h3><p><img src="/2023/02/02/blislab/image-20230202191728644.png" alt="image-20230202191728644"></p><h3 id="10-AddDot-2x2æœ€å†…å±‚å¾ªç¯å±•å¼€"><a href="#10-AddDot-2x2æœ€å†…å±‚å¾ªç¯å±•å¼€" class="headerlink" title="10.AddDot_2x2æœ€å†…å±‚å¾ªç¯å±•å¼€"></a>10.AddDot_2x2æœ€å†…å±‚å¾ªç¯å±•å¼€</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">void</span> AddDot_2Ã—<span class="hljs-number">2</span>( <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">double</span> *A, <span class="hljs-keyword">int</span> lda, <span class="hljs-keyword">double</span> *B, <span class="hljs-keyword">int</span> ldb, <span class="hljs-keyword">double</span> *C,<span class="hljs-keyword">int</span> ldc ) &#123;<br><span class="hljs-keyword">register</span> <span class="hljs-keyword">double</span> C00, C01, C10, C11;<br>    <span class="hljs-keyword">int</span> p;<br>    C00=<span class="hljs-number">0.0</span>;<br>    C01=<span class="hljs-number">0.0</span>;<br>    C10=<span class="hljs-number">0.0</span>;<br>    C11=<span class="hljs-number">0.0</span>;<br>    <br>    <span class="hljs-keyword">for</span>( p=<span class="hljs-number">0</span> ;p &lt; k; p+=<span class="hljs-number">2</span>)<br>    &#123;<br>        C00 += <span class="hljs-built_in">A</span>( <span class="hljs-number">0</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">0</span>) + <span class="hljs-built_in">A</span>( <span class="hljs-number">0</span>, p+<span class="hljs-number">1</span>) * <span class="hljs-built_in">B</span>( p+<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br>        C01 += <span class="hljs-built_in">A</span>( <span class="hljs-number">0</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">1</span>) + <span class="hljs-built_in">A</span>( <span class="hljs-number">0</span>, p+<span class="hljs-number">1</span>) * <span class="hljs-built_in">B</span>( p+<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br>        C10 += <span class="hljs-built_in">A</span>( <span class="hljs-number">1</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">0</span>) + <span class="hljs-built_in">A</span>( <span class="hljs-number">1</span>, p+<span class="hljs-number">1</span>) * <span class="hljs-built_in">B</span>( p+<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br>        C11 += <span class="hljs-built_in">A</span>( <span class="hljs-number">1</span>, p) * <span class="hljs-built_in">B</span>( p, <span class="hljs-number">1</span>) + <span class="hljs-built_in">A</span>( <span class="hljs-number">1</span>, p+<span class="hljs-number">1</span>) * <span class="hljs-built_in">B</span>( p+<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>) +=C00;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) +=C01;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>) +=C10;<br>    <span class="hljs-built_in">C</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>) +=C11;<br>    <br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="/2023/02/02/blislab/image-20230202192033816.png" alt="image-20230202192033816"></p><h3 id="11-AddDot-2x2æ±‡ç¼–ä»£ç ã€æœ€å†…å±‚å¾ªç¯å±•å¼€ã€‘"><a href="#11-AddDot-2x2æ±‡ç¼–ä»£ç ã€æœ€å†…å±‚å¾ªç¯å±•å¼€ã€‘" class="headerlink" title="11.AddDot_2x2æ±‡ç¼–ä»£ç ã€æœ€å†…å±‚å¾ªç¯å±•å¼€ã€‘"></a>11.AddDot_2x2æ±‡ç¼–ä»£ç ã€æœ€å†…å±‚å¾ªç¯å±•å¼€ã€‘</h3><p><img src="/2023/02/02/blislab/image-20230202192319993.png" alt="image-20230202192319993"></p><h2 id="Step2"><a href="#Step2" class="headerlink" title="Step2"></a>Step2</h2><h3 id="1-ä¸Step1çš„æ€§èƒ½æ¯”è¾ƒ"><a href="#1-ä¸Step1çš„æ€§èƒ½æ¯”è¾ƒ" class="headerlink" title="1.ä¸Step1çš„æ€§èƒ½æ¯”è¾ƒ"></a>1.ä¸Step1çš„æ€§èƒ½æ¯”è¾ƒ</h3><p><img src="/2023/02/02/blislab/image-20230206163219051.png" alt="image-20230206163219051"></p><h3 id="2-ä¼˜åŒ–kernel-x2F-bl-dgemm-ukr-c"><a href="#2-ä¼˜åŒ–kernel-x2F-bl-dgemm-ukr-c" class="headerlink" title="2.ä¼˜åŒ–kernel&#x2F;bl_dgemm_ukr.c"></a>2.ä¼˜åŒ–kernel&#x2F;bl_dgemm_ukr.c</h3><p><img src="/2023/02/02/blislab/image-20230206163713966.png" alt="image-20230206163713966"></p><p><img src="/2023/02/02/blislab/image-20230206163803615.png" alt="image-20230206163803615"></p><h3 id="3-ä¼˜åŒ–åæ€§èƒ½å¯¹æ¯”"><a href="#3-ä¼˜åŒ–åæ€§èƒ½å¯¹æ¯”" class="headerlink" title="3.ä¼˜åŒ–åæ€§èƒ½å¯¹æ¯”"></a>3.ä¼˜åŒ–åæ€§èƒ½å¯¹æ¯”</h3><p><img src="/2023/02/02/blislab/image-20230206163833950.png" alt="image-20230206163833950"></p><h3 id="4-ä¸‹é™åŸå› åˆ†æ"><a href="#4-ä¸‹é™åŸå› åˆ†æ" class="headerlink" title="4.ä¸‹é™åŸå› åˆ†æ"></a>4.ä¸‹é™åŸå› åˆ†æ</h3><p><img src="/2023/02/02/blislab/image-20230206164335213.png" alt="image-20230206164335213"></p><p><img src="/2023/02/02/blislab/image-20230206164734050.png" alt="image-20230206164734050"></p><h3 id="5-å¦‚ä½•è¿›è¡Œåˆ†å—"><a href="#5-å¦‚ä½•è¿›è¡Œåˆ†å—" class="headerlink" title="5.å¦‚ä½•è¿›è¡Œåˆ†å—"></a>5.å¦‚ä½•è¿›è¡Œåˆ†å—</h3><p><img src="/2023/02/02/blislab/image-20230206165017812.png" alt="image-20230206165017812"></p><p><img src="/2023/02/02/blislab/image-20230206165103417.png" alt="image-20230206165103417"></p><p><img src="/2023/02/02/blislab/image-20230206170050450.png" alt="image-20230206170050450"></p><p><img src="/2023/02/02/blislab/image-20230206170105998.png" alt="image-20230206170105998"></p><p><img src="/2023/02/02/blislab/image-20230206170126588.png" alt="image-20230206170126588"></p><p><img src="/2023/02/02/blislab/image-20230206170153251.png" alt="image-20230206170153251"></p><p><img src="/2023/02/02/blislab/image-20230206170226248.png" alt="image-20230206170226248"></p><p><img src="/2023/02/02/blislab/image-20230206170242872.png" alt="image-20230206170242872"></p><p><img src="/2023/02/02/blislab/image-20230206170320842.png" alt="image-20230206170320842"></p><p><img src="/2023/02/02/blislab/image-20230206170334857.png" alt="image-20230206170334857"></p><h3 id="6-Dgemmä»£ç "><a href="#6-Dgemmä»£ç " class="headerlink" title="6.Dgemmä»£ç "></a>6.Dgemmä»£ç </h3><p><img src="/2023/02/02/blislab/image-20230206171538013.png" alt="image-20230206171538013"></p><p><img src="/2023/02/02/blislab/image-20230206171556767.png" alt="image-20230206171556767"></p><p><img src="/2023/02/02/blislab/image-20230206171622104.png" alt="image-20230206171622104"></p><p><img src="/2023/02/02/blislab/image-20230206171639209.png" alt="image-20230206171639209"></p><h3 id="7-Dgemm-macro-kenrelä»£ç "><a href="#7-Dgemm-macro-kenrelä»£ç " class="headerlink" title="7.Dgemm macro kenrelä»£ç "></a>7.Dgemm macro kenrelä»£ç </h3><p><img src="/2023/02/02/blislab/image-20230206171903844.png" alt="image-20230206171903844"></p><p><img src="/2023/02/02/blislab/image-20230206171940282.png" alt="image-20230206171940282"></p><h3 id="8-Gemmæ±‡æ€»"><a href="#8-Gemmæ±‡æ€»" class="headerlink" title="8.Gemmæ±‡æ€»"></a>8.Gemmæ±‡æ€»</h3><p><img src="/2023/02/02/blislab/image-20230206172351890.png" alt="image-20230206172351890"></p><h3 id="9-æ‹“å±•"><a href="#9-æ‹“å±•" class="headerlink" title="9.æ‹“å±•"></a>9.æ‹“å±•</h3><p><img src="/2023/02/02/blislab/image-20230206172425329.png" alt="image-20230206172425329"></p><h3 id="10-åŒç¼“å†²ä¼˜åŒ–"><a href="#10-åŒç¼“å†²ä¼˜åŒ–" class="headerlink" title="10.åŒç¼“å†²ä¼˜åŒ–"></a>10.åŒç¼“å†²ä¼˜åŒ–</h3><p><img src="/2023/02/02/blislab/image-20230206172846408.png" alt="image-20230206172846408"></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>dgemm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAçº¿ç¨‹ç®¡ç†</title>
    <link href="/2023/01/28/cuda006/"/>
    <url>/2023/01/28/cuda006/</url>
    
    <content type="html"><![CDATA[<h3 id="1-çº¿ç¨‹ç®¡ç†"><a href="#1-çº¿ç¨‹ç®¡ç†" class="headerlink" title="1.çº¿ç¨‹ç®¡ç†"></a>1.çº¿ç¨‹ç®¡ç†</h3><p>å½“æ ¸å‡½æ•°åœ¨ä¸»æœºç«¯å¯åŠ¨æ—¶ï¼Œå®ƒçš„æ‰§è¡Œä¼šç§»åŠ¨åˆ°è®¾å¤‡ä¸Šï¼Œæ­¤æ—¶è®¾å¤‡ä¸­ä¼šäº§ç”Ÿå¤§é‡çš„çº¿ç¨‹å¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œç”±æ ¸å‡½æ•°æŒ‡å®šçš„è¯­å¥ã€‚äº†è§£å¦‚ä½•ç»„ç»‡çº¿ç¨‹æ˜¯CUDAç¼–ç¨‹çš„ä¸€ä¸ªå…³é”®éƒ¨åˆ†ã€‚CUDAæ˜ç¡®äº†çº¿ç¨‹å±‚æ¬¡æŠ½è±¡çš„æ¦‚å¿µä»¥ä¾¿äºä½ ç»„ç»‡çº¿ç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªä¸¤å±‚çš„çº¿ç¨‹å±‚æ¬¡ç»“æ„ï¼Œç”±çº¿ç¨‹å—å’Œçº¿ç¨‹å—ç½‘æ ¼æ„æˆï¼Œå¦‚å›¾2-5æ‰€ç¤ºã€‚</p><p><img src="/2023/01/28/cuda006/image-20230128160011560.png" alt="image-20230128160011560"></p><p>ç”±ä¸€ä¸ªå†…æ ¸å¯åŠ¨æ‰€äº§ç”Ÿçš„æ‰€æœ‰çº¿ç¨‹ç»Ÿç§°ä¸ºä¸€ä¸ªç½‘æ ¼ã€‚åŒä¸€ç½‘æ ¼ä¸­çš„æ‰€æœ‰çº¿ç¨‹å…±äº«ç›¸åŒçš„å…¨å±€å†…å­˜ç©ºé—´ã€‚ä¸€ä¸ªç½‘æ ¼ç”±å¤šä¸ªçº¿ç¨‹å—æ„æˆï¼Œä¸€ä¸ªçº¿ç¨‹å—åŒ…å«ä¸€ç»„çº¿ç¨‹ï¼ŒåŒä¸€çº¿ç¨‹å—å†…çš„çº¿ç¨‹åä½œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥å®ç°ã€‚</p><p>â€‹-åŒæ­¥</p><p>â€‹-å…±äº«å†…å­˜</p><p>ä¸åŒå—å†…çš„çº¿ç¨‹ä¸èƒ½åä½œã€‚</p><p>çº¿ç¨‹ä¾é ä»¥ä¸‹ä¸¤ä¸ªåæ ‡å˜é‡æ¥åŒºåˆ†å½¼æ­¤ã€‚</p><p>â€‹-blockIdx(çº¿ç¨‹å—åœ¨çº¿ç¨‹æ ¼å†…çš„ç´¢å¼•)</p><p>â€‹-threadIdx(å—å†…çš„çº¿ç¨‹ç´¢å¼•)</p><p>è¿™äº›å˜é‡æ˜¯æ ¸å‡½æ•°ä¸­éœ€è¦é¢„åˆå§‹åŒ–çš„å†…ç½®å˜é‡ã€‚å½“æ‰§è¡Œä¸€ä¸ªæ ¸å‡½æ•°æ—¶ï¼ŒCUDAè¿è¡Œæ—¶ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…åæ ‡å˜é‡blockIdxå’ŒthreadIdxã€‚åŸºäºè¿™äº›åæ ‡ï¼Œä½ å¯ä»¥å°†éƒ¨åˆ†æ•°æ®åˆ†é…ç»™ä¸åŒçš„çº¿ç¨‹ã€‚</p><p>è¯¥åæ ‡å˜é‡æ˜¯åŸºäºuint3å®šä¹‰çš„CUDAå†…ç½®çš„å‘é‡ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªåŒ…å«3ä¸ªæ— ç¬¦å·æ•´æ•°çš„ç»“æ„ï¼Œå¯ä»¥é€šè¿‡x,y,zä¸‰ä¸ªå­—æ®µæ¥æŒ‡å®šã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">blockIdx.x<br>blockIdx.y<br>blockIdx.z<br>threadIdx.x<br>threadIdx.y<br>threadIdx.z<br></code></pre></div></td></tr></table></figure><p>CUDAå¯ä»¥ç»„ç»‡ä¸‰ç»´çš„ç½‘æ ¼å’Œå—ã€‚å›¾2-5å±•ç¤ºäº†ä¸€ä¸ªçº¿ç¨‹å±‚æ¬¡ç»“æ„çš„ç¤ºä¾‹ï¼Œå…¶ç»“æ„æ˜¯ä¸€ä¸ªåŒ…å«äºŒç»´å—çš„äºŒç»´ç½‘æ ¼ã€‚ç½‘æ ¼å’Œå—çš„ç»´åº¦ç”±ä¸‹åˆ—ä¸¤ä¸ªå†…ç½®å˜é‡æŒ‡å®šã€‚</p><p>â€‹-blockDim(çº¿ç¨‹å—çš„ç»´åº¦ï¼Œç”¨æ¯ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æ•°æ¥è¡¨ç¤º)</p><p>â€‹-gridDim(çº¿ç¨‹æ ¼çš„ç»´åº¦ï¼Œç”¨æ¯ä¸ªçº¿ç¨‹æ ¼ä¸­çš„çº¿ç¨‹æ•°æ¥è¡¨ç¤º)</p><p>å®ƒä»¬æ˜¯dim3ç±»å‹çš„å˜é‡ï¼Œæ˜¯åŸºäºuint3å®šä¹‰çš„æ•´æ•°å‹å‘é‡ï¼Œç”¨æ¥è¡¨ç¤ºç»´åº¦ã€‚å½“å®šä¹‰ä¸€ä¸ªdim3ç±»å‹çš„å˜é‡æ—¶ï¼Œæ‰€æœ‰æœªæŒ‡å®šçš„å…ƒç´ éƒ½è¢«åˆå§‹åŒ–ä¸º1ã€‚dim3ç±»å‹å˜é‡ä¸­çš„æ¯ä¸ªç»„ä»¶å¯ä»¥é€šè¿‡å®ƒçš„x,y,zå­—æ®µè·å¾—ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">blockDim.x<br>blockDim.y<br>blockDim.z<br></code></pre></div></td></tr></table></figure><h3 id="2-ç½‘æ ¼å’Œçº¿ç¨‹å—çš„ç»´åº¦"><a href="#2-ç½‘æ ¼å’Œçº¿ç¨‹å—çš„ç»´åº¦" class="headerlink" title="2.ç½‘æ ¼å’Œçº¿ç¨‹å—çš„ç»´åº¦"></a>2.ç½‘æ ¼å’Œçº¿ç¨‹å—çš„ç»´åº¦</h3><p>é€šå¸¸ï¼Œä¸€ä¸ªçº¿ç¨‹æ ¼ä¼šè¢«ç»„ç»‡æˆçº¿ç¨‹å—çš„äºŒç»´æ•°ç»„å½¢å¼ï¼Œä¸€ä¸ªçº¿ç¨‹å—ä¼šè¢«ç»„ç»‡æˆçº¿ç¨‹çš„ä¸‰ç»´æ•°ç»„å½¢å¼ã€‚</p><p>çº¿ç¨‹æ ¼å’Œçº¿ç¨‹å—å‡ä½¿ç”¨3ä¸ªdim3ç±»å‹çš„æ— ç¬¦å·æ•´å‹å­—æ®µï¼Œè€Œæœªä½¿ç”¨çš„å­—æ®µå°†è¢«åˆå§‹åŒ–ä¸º1ä¸”å¿½ç•¥ä¸è®¡ã€‚</p><p>åœ¨CUDAç¨‹åºä¸­æœ‰ä¸¤ç»„ä¸åŒçš„ç½‘æ ¼å’Œå—å˜é‡ï¼šæ‰‹åŠ¨å®šä¹‰çš„dim3æ•°æ®ç±»å‹å’Œé¢„å®šä¹‰çš„uint3æ•°æ®ç±»å‹ã€‚åœ¨ä¸»æœºç«¯ï¼Œä½œä¸ºå†…æ ¸è°ƒç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä½ å¯ä»¥ä½¿ç”¨dim3æ•°æ®ç±»å‹å®šä¹‰ä¸€ä¸ªç½‘æ ¼å’Œå—çš„ç»´åº¦ã€‚å½“æ‰§è¡Œæ ¸å‡½æ•°æ—¶ï¼ŒCUDAè¿è¡Œæ—¶ä¼šç”Ÿæˆç›¸åº”çš„å†…ç½®é¢„åˆå§‹åŒ–çš„ç½‘æ ¼ï¼Œå—å’Œçº¿ç¨‹å˜é‡ï¼Œå®ƒä»¬åœ¨æ ¸å‡½æ•°å†…å‡å¯è¢«è®¿é—®åˆ°ä¸”ä¸ºunit3ç±»å‹ã€‚æ‰‹åŠ¨å®šä¹‰çš„dim3ç±»å‹çš„ç½‘ç»œå’Œå—å˜é‡ä»…åœ¨ä¸»æœºç«¯å¯è§ï¼Œè€Œunit3ç±»å‹çš„å†…ç½®é¢„åˆå§‹åŒ–çš„ç½‘æ ¼å’Œå—å˜é‡ä»…åœ¨è®¾å¤‡ç«¯å¯è§ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡ä»£ç æ¸…å•2-2æ¥éªŒè¯è¿™äº›å˜é‡å¦‚ä½•ä½¿ç”¨ã€‚é¦–å…ˆï¼Œå®šä¹‰ç¨‹åºæ‰€ç”¨çš„æ•°æ®å¤§å°ï¼Œä¸ºäº†å¯¹æ­¤è¿›è¡Œè¯´æ˜ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¾ƒå°çš„æ•°æ®ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> nElem = <span class="hljs-number">6</span>;<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œå®šä¹‰å—çš„å°ºå¯¸å¹¶åŸºäºå—å’Œæ•°æ®çš„å¤§å°è®¡ç®—ç½‘æ ¼å°ºå¯¸ã€‚åœ¨ä¸‹é¢ä¾‹å­ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªåŒ…å«3ä¸ªçº¿ç¨‹çš„ä¸€ç»´çº¿ç¨‹å—ï¼Œä»¥åŠä¸€ä¸ªåŸºäºå—å’Œæ•°æ®å¤§å°å®šä¹‰çš„ä¸€å®šæ•°é‡çº¿ç¨‹å—çš„ä¸€ç»´çº¿ç¨‹ç½‘æ ¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;<br><span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">((nElem+block.x<span class="hljs-number">-1</span>)/block.x)</span></span>;<br></code></pre></div></td></tr></table></figure><p>ä½ ä¼šå‘ç°ç½‘æ ¼å¤§å°æ˜¯å—å¤§å°çš„å€æ•°ã€‚ä»¥ä¸‹ä¸»æœºç«¯ä¸Šçš„ç¨‹åºæ®µç”¨æ¥æ£€æŸ¥ç½‘æ ¼å’Œå—ç»´åº¦ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;grid.x %d grid.y %d grid.z %d\n&quot;</span>,grid.x,grid.y,grid.z);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;block.x %d block.y %d block.z %d\n&quot;</span>,block.x,block.y,block.z);<br></code></pre></div></td></tr></table></figure><p>åœ¨æ ¸å‡½æ•°ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½è¾“å‡ºè‡ªå·±çš„çº¿ç¨‹ç´¢å¼•ï¼Œå—ç´¢å¼•ï¼Œå—ç»´åº¦å’Œç½‘æ ¼ç»´åº¦ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;threadIdx:(%d, %d, %d) blockIdx:(%d, %d, %d) blockDim:(%d, %d, %d) &quot;</span> <span class="hljs-string">&quot;gridDim:(%d, %d, %d)\n&quot;</span>, threadIdx.x, threadIdx,y, threadIdz.z,blockIdx.x, blockIdx.y, blockIdx.z, blockDim.x, blockDim.y, blockDim.z, gridDim.x,gridDim.y,gridDim.z);<br></code></pre></div></td></tr></table></figure><p>æŠŠä»£ç åˆå¹¶ä¿å­˜æˆåä¸ºcheckDimension.cuçš„æ–‡ä»¶ï¼Œå¦‚ä»£ç æ¸…å•2-2æ‰€ç¤ºã€‚</p><p><strong>ä»£ç æ¸…å•2-2     æ£€æŸ¥ç½‘ç»œå’Œå—çš„ç´¢å¼•å’Œç»´åº¦ï¼ˆcheckDimension.cuï¼‰</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cuda_runtime.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">checkIndex</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;threadIdx:(%d, %d, %d) blockIdx:(%d, %d, %d) blockDim:(%d, %d, %d) &quot;</span> <span class="hljs-string">&quot;gridDim:(%d, %d, %d)\n&quot;</span>, threadIdx.x, threadIdx,y, threadIdz.z, blockIdx.x, blockIdx.y, blockIdx.z, blockDim.x, blockDim.y, blockDim.z, gridDim.x,gridDim.y,gridDim.z);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-comment">//define total data element</span><br>    <span class="hljs-keyword">int</span> nElem = <span class="hljs-number">6</span>;<br>    <span class="hljs-comment">//define grid and block structure</span><br>    <span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span></span>;<br><span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">((nElem+block.x<span class="hljs-number">-1</span>)/block.x)</span></span>;<br>    <br>    <span class="hljs-comment">//check grid and block dimension from host side</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;grid.x %d grid.y %d grid.z %d\n&quot;</span>,grid.x,grid.y,grid.z);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;block.x %d block.y %d block.z %d\n&quot;</span>,block.x,block.y,block.z);<br><br>    <span class="hljs-comment">//check grid and block dimension from device side</span><br>    checkIndex&lt;&lt;&lt;grid, block&gt;&gt;&gt;();<br>    <br>    <span class="hljs-comment">//reset device before you leave</span><br>    <span class="hljs-built_in">cudaDeviceReset</span>();<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç°åœ¨å¼€å§‹ç¼–è¯‘å’Œè¿è¡Œè¿™æ®µç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc -arch=sm_20 checkDimension.cu -o check<br>./check<br></code></pre></div></td></tr></table></figure><p>å› ä¸ºprintfå‡½æ•°åªæ”¯æŒFermiåŠä»¥ä¸Šç‰ˆæœ¬çš„GPUæ¶æ„ï¼Œæ‰€ä»¥å¿…é¡»æ·»åŠ -arch&#x3D;sm_20ç¼–è¯‘å™¨é€‰é¡¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œnvccä¼šäº§ç”Ÿæ”¯æŒæœ€ä½ç‰ˆæœ¬GPUæ¶æ„çš„ä»£ç ã€‚è¿™ä¸ªåº”ç”¨ç¨‹åºçš„è¿è¡Œç»“æœå¦‚ä¸‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„åæ ‡ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½æœ‰ç›¸åŒçš„å—ç»´åº¦å’Œç½‘æ ¼ç»´åº¦ã€‚</p><p><img src="/2023/01/28/cuda006/image-20230129172501750.png" alt="image-20230129172501750"></p><h3 id="3-ä»ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯è®¿é—®ç½‘æ ¼-x2F-å—å˜é‡"><a href="#3-ä»ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯è®¿é—®ç½‘æ ¼-x2F-å—å˜é‡" class="headerlink" title="3.ä»ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯è®¿é—®ç½‘æ ¼&#x2F;å—å˜é‡"></a>3.ä»ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯è®¿é—®ç½‘æ ¼&#x2F;å—å˜é‡</h3><p>åŒºåˆ«ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯çš„ç½‘æ ¼å’Œå—å˜é‡çš„è®¿é—®æ˜¯å¾ˆé‡è¦çš„ã€‚ä¾‹å¦‚ï¼Œå£°æ˜ä¸€ä¸ªä¸»æœºç«¯çš„å—å˜é‡ï¼Œä½ æŒ‰å¦‚ä¸‹å®šä¹‰å®ƒçš„åæ ‡å¹¶å¯¹å…¶è¿›è¡Œè®¿é—®ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">block.x,block.y,block.z<br></code></pre></div></td></tr></table></figure><p>åœ¨è®¾å¤‡ç«¯ï¼Œä½ å·²ç»é¢„å®šä¹‰äº†å†…ç½®å—å˜é‡çš„å¤§å°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">blockDim.x,blockDim.y,blockDim.z<br></code></pre></div></td></tr></table></figure><p>æ€»ä¹‹ï¼Œåœ¨å¯åŠ¨å†…æ ¸ä¹‹å‰å°±å®šä¹‰äº†ä¸»æœºç«¯çš„ç½‘æ ¼å’Œå—å˜é‡ï¼Œå¹¶ä»ä¸»æœºç«¯é€šè¿‡ç”±x,y,zä¸‰ä¸ªå­—æ®µå†³å®šçš„çŸ¢é‡ç»“æ„æ¥è®¿é—®å®ƒä»¬ã€‚å½“å†…æ ¸å¯åŠ¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å†…æ ¸ä¸­é¢„åˆå§‹åŒ–çš„å†…ç½®å˜é‡ã€‚</p><p>å¯¹äºä¸€ä¸ªç»™å®šçš„æ•°æ®å¤§å°ï¼Œç¡®å®šç½‘æ ¼å’Œå—å°ºå¯¸çš„ä¸€èˆ¬æ­¥éª¤ä¸ºï¼š</p><p>â€‹-ç¡®å®šå—çš„å¤§å°</p><p>â€‹-åœ¨å·²çŸ¥æ•°æ®å¤§å°å’Œå—å¤§å°çš„åŸºç¡€ä¸Šè®¡ç®—ç½‘æ ¼ç»´åº¦</p><p>è¦ç¡®å®šå—å°ºå¯¸ï¼Œé€šå¸¸éœ€è¦è€ƒè™‘ï¼š</p><p>â€‹-å†…æ ¸çš„æ€§èƒ½ç‰¹æ€§</p><p>â€‹-GPUèµ„æºçš„é™åˆ¶</p><p>ä»£ç æ¸…å•2-3ä½¿ç”¨äº†ä¸€ä¸ªä¸€ç»´ç½‘æ ¼å’Œä¸€ä¸ªä¸€ç»´å—æ¥è¯´æ˜å½“å—çš„å¤§å°æ”¹å˜æ—¶ï¼Œç½‘æ ¼çš„å°ºå¯¸ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚</p><p><strong>ä»£ç æ¸…å•2-3 åœ¨ä¸»æœºä¸Šå®šä¹‰ç½‘æ ¼å’Œå—çš„å¤§å°ï¼ˆdefineGridBlock.cuï¼‰</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cuda_runtime.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-comment">//define total data element</span><br>    <span class="hljs-keyword">int</span> nElem = <span class="hljs-number">1024</span>;<br>    <br>    <span class="hljs-comment">//define grid and block structure</span><br>    <span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(<span class="hljs-number">1024</span>)</span></span>;<br>    <span class="hljs-function">dim3 <span class="hljs-title">grid</span> <span class="hljs-params">((nElem+block.x<span class="hljs-number">-1</span>)/block.x)</span></span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;grid.x %d block.x %d \n&quot;</span>,grid.x, block.x);<br>    <br>    <span class="hljs-comment">//reset block</span><br>    block.x = <span class="hljs-number">512</span>;<br>    grid.x = (nElem+block.x<span class="hljs-number">-1</span>)/block.x;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;grid.x %d block.x %d \n&quot;</span>,grid.x, block.x);<br>    <br>    <span class="hljs-comment">//reset block</span><br>    block.x = <span class="hljs-number">256</span>;<br>    grid.x = (nElem+block.x<span class="hljs-number">-1</span>)/block.x;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;grid.x %d block.x %d \n&quot;</span>,grid.x, block.x);<br>    <br>    <span class="hljs-comment">//reset block</span><br>    block.x = <span class="hljs-number">128</span>;<br>    grid.x = (nElem+block.x<span class="hljs-number">-1</span>)/block.x;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;grid.x %d block.x %d \n&quot;</span>,grid.x, block.x);<br>    <br>    <span class="hljs-comment">//reset device before you leave</span><br>    <span class="hljs-built_in">cudaDeviceReset</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç”¨ä¸‹åˆ—å‘½ä»¤ç¼–è¯‘å’Œè¿è¡Œè¿™æ®µç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc defineGridBlock.cu-o block<br>./block<br></code></pre></div></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¾“å‡ºç¤ºä¾‹ã€‚ç”±äºåº”ç”¨ç¨‹åºä¸­çš„æ•°æ®å¤§å°æ˜¯å›ºå®šçš„ï¼Œå› æ­¤å½“å—çš„å¤§å°å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç›¸åº”çš„ç½‘æ ¼å°ºå¯¸ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ã€‚</p><p><img src="/2023/01/28/cuda006/image-20230129174300533.png" alt="image-20230129174300533"></p><h3 id="4-çº¿ç¨‹å±‚æ¬¡ç»“æ„"><a href="#4-çº¿ç¨‹å±‚æ¬¡ç»“æ„" class="headerlink" title="4.çº¿ç¨‹å±‚æ¬¡ç»“æ„"></a>4.çº¿ç¨‹å±‚æ¬¡ç»“æ„</h3><p>CUDAçš„ç‰¹ç‚¹ä¹‹ä¸€å°±æ˜¯é€šè¿‡ç¼–ç¨‹æ¨¡å‹æ­ç¤ºäº†ä¸€ä¸ªä¸¤å±‚çš„çº¿ç¨‹å±‚æ¬¡ç»“æ„ã€‚ç”±äºä¸€ä¸ªå†…æ ¸å¯åŠ¨çš„ç½‘æ ¼å’Œå—çš„ç»´æ•°ä¼šå½±å“æ€§èƒ½ï¼Œè¿™ä¸€ç»“æ„ä¸ºç¨‹åºå‘˜ä¼˜åŒ–ç¨‹åºæä¾›äº†ä¸€ä¸ªé¢å¤–çš„é€”å¾„ã€‚</p><p>ç½‘æ ¼å’Œå—çš„ç»´åº¦å­˜åœ¨å‡ ä¸ªé™åˆ¶å› ç´ ï¼Œå¯¹äºå—å¤§å°çš„ä¸€ä¸ªä¸»è¦é™åˆ¶å› ç´ å°±æ˜¯å¯åˆ©ç”¨çš„è®¡ç®—èµ„æºï¼Œå¦‚å¯„å­˜å™¨ï¼Œå…±äº«å†…å­˜ç­‰ã€‚æŸäº›é™åˆ¶å¯ä»¥é€šè¿‡æŸ¥è¯¢GPUè®¾å¤‡æ’¤å›ã€‚</p><p>ç½‘æ ¼å’Œå—ä»é€»è¾‘ä¸Šä»£è¡¨äº†ä¸€ä¸ªæ ¸å‡½æ•°çš„çº¿ç¨‹å±‚æ¬¡ç»“æ„ã€‚</p><h3 id="5-å‚è€ƒèµ„æ–™"><a href="#5-å‚è€ƒèµ„æ–™" class="headerlink" title="5.å‚è€ƒèµ„æ–™"></a>5.å‚è€ƒèµ„æ–™</h3><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAå†…å­˜ç®¡ç†</title>
    <link href="/2023/01/17/cuda005/"/>
    <url>/2023/01/17/cuda005/</url>
    
    <content type="html"><![CDATA[<h3 id="1-å†…å­˜ç®¡ç†"><a href="#1-å†…å­˜ç®¡ç†" class="headerlink" title="1.å†…å­˜ç®¡ç†"></a>1.å†…å­˜ç®¡ç†</h3><p>CUDAç¼–ç¨‹æ¨¡å‹å‡è®¾ç³»ç»Ÿæ˜¯ç”±ä¸€ä¸ªä¸»æœºå’Œä¸€ä¸ªè®¾å¤‡ç»„æˆçš„ï¼Œè€Œä¸”å„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ã€‚æ ¸å‡½æ•°æ˜¯åœ¨è®¾å¤‡ä¸Šè¿è¡Œçš„ã€‚ä¸ºä½¿ä½ æ‹¥æœ‰å……åˆ†çš„æ§åˆ¶æƒå¹¶ä½¿ç³»ç»Ÿè¾¾åˆ°æœ€ä½³æ€§èƒ½ï¼ŒCUDAè¿è¡Œæ—¶è´Ÿè´£åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜ï¼Œå¹¶ä¸”åœ¨ä¸»æœºå†…å­˜å’Œè®¾å¤‡å†…å­˜ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚è¡¨2-1åˆ—å‡ºäº†æ ‡å‡†çš„Cå‡½æ•°ä»¥åŠç›¸åº”åœ°é’ˆå¯¹å†…å­˜æ“ä½œçš„CUDA Cå‡½æ•°ã€‚</p><p>ç”¨äºæ‰§è¡ŒGPUå†…å­˜åˆ†é…çš„æ˜¯cudaMallocå‡½æ•°ï¼Œå…¶å‡½æ•°åŸå‹ä¸ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">cudaError_t <span class="hljs-title">cudaMalloc</span><span class="hljs-params">(<span class="hljs-keyword">void</span>** devPtr, <span class="hljs-keyword">size_t</span> size)</span></span><br></code></pre></div></td></tr></table></figure><p><img src="/2023/01/17/cuda005/image-20230117223254853.png" alt="image-20230117223254853"></p><p>è¯¥å‡½æ•°è´Ÿè´£å‘è®¾å¤‡åˆ†é…ä¸€å®šå­—èŠ‚çš„çº¿æ€§å†…å­˜ï¼Œå¹¶ä»¥devPtrçš„å½¢å¼è¿”å›æŒ‡å‘æ‰€åˆ†é…å†…å­˜çš„æŒ‡é’ˆã€‚cudaMallocä¸æ ‡å‡†Cè¯­è¨€ä¸­çš„mallocå‡½æ•°å‡ ä¹ä¸€æ ·ï¼Œåªæ˜¯æ­¤å‡½æ•°åœ¨GPUçš„å†…å­˜é‡Œåˆ†é…å†…å­˜ã€‚é€šè¿‡å……åˆ†ä¿æŒä¸æ ‡å‡†Cè¯­è¨€è¿è¡Œåº“ä¸­çš„æ¥å£ä¸€è‡´æ€§ï¼Œå¯ä»¥å®ç°CUDAåº”ç”¨ç¨‹åºçš„è½»æ¾æ¥å…¥ã€‚</p><p>cudaMemcpyå‡½æ•°è´Ÿè´£ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œå…¶å‡½æ•°åŸå‹ä¸ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">cudaError_t <span class="hljs-title">cudaMencpy</span><span class="hljs-params">( <span class="hljs-keyword">void</span>* dst, <span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span>* src, <span class="hljs-keyword">size_t</span> count, cudaMemcpyKind kind)</span></span><br></code></pre></div></td></tr></table></figure><p>æ­¤å‡½æ•°ä»srcæŒ‡å‘çš„æºå­˜å‚¨åŒºå¤åˆ¶ä¸€å®šæ•°é‡çš„å­—èŠ‚åˆ°dstæŒ‡å‘çš„ç›®æ ‡å­˜å‚¨åŒºã€‚å¤åˆ¶æ–¹å‘ç”±kindæŒ‡å®šï¼Œå…¶ä¸­çš„kindæœ‰ä»¥ä¸‹å‡ ç§ã€‚</p><ol><li>cudaMemcpyHostToHost</li><li>cudaMemcpyHostToDevice</li><li>cudaMemcpyDeviceToHost</li><li>cudaMemcpyDeviceToDevice</li></ol><p>è¿™ä¸ªå‡½æ•°ä»¥åŒæ­¥æ–¹å¼æ‰§è¡Œï¼Œå› ä¸ºåœ¨cudaMemcpyå‡½æ•°è¿”å›ä»¥åŠä¼ è¾“æ“ä½œå®Œæˆä¹‹å‰ä¸»æœºåº”ç”¨ç¨‹åºæ˜¯é˜»å¡çš„ã€‚é™¤äº†å†…æ ¸å¯åŠ¨ä¹‹å¤–çš„CUDAè°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯çš„æšä¸¾ç±»å‹cudaError_tã€‚å¦‚æœGPUå†…å­˜åˆ†é…æˆåŠŸï¼Œå‡½æ•°è¿”å›ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">cudaSuccess<br></code></pre></div></td></tr></table></figure><p>å¦åˆ™è¿”å›ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">cudaErrorMemoryAllocation<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹CUDAè¿è¡Œæ—¶å‡½æ•°å°†é”™è¯¯ä»£ç è½¬åŒ–ä¸ºå¯è¯»çš„é”™è¯¯æ¶ˆæ¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">cudaGetErroeString</span><span class="hljs-params">(cudaError_t error)</span></span><br></code></pre></div></td></tr></table></figure><p>cudaGetErrorStringå‡½æ•°å’ŒCè¯­è¨€ä¸­çš„strerrorå‡½æ•°ç±»ä¼¼ã€‚</p><p>CUDAç¼–ç¨‹æ¨¡å‹ä»GPUæ¶æ„ä¸­æŠ½è±¡å‡ºä¸€ä¸ªå†…å­˜å±‚æ¬¡ç»“æ„ï¼Œå›¾2-3æ‰€ç¤ºçš„æ˜¯ä¸€ä¸ªç®€åŒ–çš„GPUå†…å­˜ç»“æ„ï¼Œå®ƒä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼šå…¨å±€å†…å­˜å’Œå…±äº«å†…å­˜ã€‚</p><h3 id="2-å†…å­˜å±‚æ¬¡ç»“æ„"><a href="#2-å†…å­˜å±‚æ¬¡ç»“æ„" class="headerlink" title="2.å†…å­˜å±‚æ¬¡ç»“æ„"></a>2.å†…å­˜å±‚æ¬¡ç»“æ„</h3><p>CUDAç¼–ç¨‹æ¨¡å‹æœ€æ˜¾è‘—çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯æ­ç¤ºäº†å†…å­˜å±‚æ¬¡ç»“æ„ã€‚æ¯ä¸€ä¸ªGPUè®¾å¤‡éƒ½æœ‰ç”¨äºä¸åŒç”¨é€”çš„å­˜å‚¨ç±»å‹ã€‚</p><p>åœ¨GPUå†…å­˜å±‚æ¬¡ç»“æ„ä¸­ï¼Œæœ€ä¸»è¦çš„ä¸¤ç§å†…å­˜æ˜¯å…¨å±€å†…å­˜å’Œå…±äº«å†…å­˜ã€‚å…¨å±€ç±»ä¼¼äºCPUçš„ç³»ç»Ÿå†…å­˜ï¼Œè€Œå…±äº«å†…å­˜ç±»ä¼¼äºCPUçš„ç¼“å­˜ã€‚ç„¶è€ŒGPUçš„å…±äº«å†…å­˜å¯ä»¥ç”±CUDA Cçš„å†…æ ¸ç›´æ¥æ§åˆ¶ã€‚</p><p><img src="/2023/01/17/cuda005/image-20230128140743600.png" alt="image-20230128140743600"></p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¸¤ä¸ªæ•°ç»„ç›¸åŠ çš„ä¾‹å­æ¥å­¦ä¹ å¦‚ä½•åœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨CUDA Cç¼–ç¨‹ã€‚å¦‚å›¾2-4æ‰€ç¤ºï¼Œæ•°ç»„açš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ•°ç»„bçš„ç¬¬ä¸€ä¸ªå…ƒç´ ç›¸åŠ ï¼Œå¾—åˆ°çš„ç»“æœä½œä¸ºæ•°ç»„cçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¿›è¡Œäº†ä¸€æ¬¡è¿ç®—ã€‚â€˜</p><p><img src="/2023/01/17/cuda005/image-20230128141008674.png" alt="image-20230128141008674"></p><p>é¦–å…ˆï¼Œæ‰§è¡Œä¸»æœºç«¯ä»£ç ä½¿ä¸¤ä¸ªæ•°ç»„ç›¸åŠ ï¼ˆå¦‚ä»£ç æ¸…å•2-1æ‰€ç¤ºï¼‰ã€‚</p><h4 id="ä»£ç æ¸…å•2-1-sumArraysOnHost-c"><a href="#ä»£ç æ¸…å•2-1-sumArraysOnHost-c" class="headerlink" title="ä»£ç æ¸…å•2-1 sumArraysOnHost.c"></a>ä»£ç æ¸…å•2-1 sumArraysOnHost.c</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;time.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sumArraysOnHost</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *A, <span class="hljs-keyword">float</span> *B, <span class="hljs-keyword">float</span> *C, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> idx=<span class="hljs-number">0</span>;idx&lt;n;idx++)<br>        C[idx]=A[idx]+B[idx];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initialData</span><span class="hljs-params">(<span class="hljs-keyword">float</span> *ip,<span class="hljs-keyword">int</span> size)</span></span>&#123;<br>    <span class="hljs-comment">//generate different seed for random number time_t t;</span><br>    <span class="hljs-built_in">srand</span>((<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>) <span class="hljs-built_in">time</span> (&amp;t));<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;size;i++)&#123;<br>        ip[i]=(<span class="hljs-keyword">float</span>)(<span class="hljs-built_in">rand</span>() &amp; OxFF)/<span class="hljs-number">10.0f</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> nElem =<span class="hljs-number">1024</span>;<br>    <span class="hljs-keyword">size_t</span> nBytes = nElem *<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">float</span>);<br>    <br>    <span class="hljs-keyword">float</span> *h_A, *h_B, *h_C;<br>    h_A = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    h_B = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    h_C = (<span class="hljs-keyword">float</span> *)<span class="hljs-built_in">malloc</span>(nBytes);<br>    <br>    <span class="hljs-built_in">initialData</span>(h_A, nElem);<br>    <span class="hljs-built_in">initialData</span>(h_B, nElem);<br>    <br>    <span class="hljs-built_in">sumArraysOnHost</span>(h_A, h_B, h_C, nElem);<br>    <br>    <span class="hljs-built_in">free</span>(h_A);<br>    <span class="hljs-built_in">free</span>(h_B);<br>    <span class="hljs-built_in">free</span>(h_C);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªçº¯Cè¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä½ å¯ä»¥ç”¨Cè¯­è¨€ç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥åƒä¸‹é¢è¿™æ ·ç”¨nvccè¿›è¡Œç¼–è¯‘ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc -Xcompiler -std=c99 sumArraysOnHost.c -o sum<br>./sum<br></code></pre></div></td></tr></table></figure><p>nvccå°è£…äº†å‡ ç§å†…éƒ¨ç¼–è¯‘å·¥å…·ï¼ŒCUDAç¼–è¯‘å™¨å…è®¸é€šè¿‡å‘½ä»¤è¡Œé€‰é¡¹åœ¨ä¸åŒé˜¶æ®µå¯åŠ¨ä¸åŒçš„å·¥å…·å®Œæˆç¼–è¯‘å·¥ä½œã€‚-Xcompilerç”¨äºæŒ‡å®šå‘½ä»¤è¡Œé€‰é¡¹æ˜¯æŒ‡å‘Cç¼–è¯‘å™¨è¿˜æ˜¯é¢„å¤„ç†å™¨ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œå°†-std&#x3D;c99ä¼ é€’ç»™ç¼–è¯‘å™¨ï¼Œå› ä¸ºè¿™é‡Œçš„Cç¨‹åºæ˜¯æŒ‰ç…§C99æ ‡å‡†ç¼–å†™çš„ã€‚</p><p>ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨GPUä¸Šä¿®æ”¹ä»£ç æ¥è¿›è¡Œæ•°ç»„åŠ æ³•è¿ç®—ï¼Œç”¨cudaMallocåœ¨GPUä¸Šç”³è¯·å†…å­˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">float</span> *h_A, *h_B, *h_C;<br><span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_A, nBytes);<br><span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_B, nBytes);<br><span class="hljs-built_in">cudaMalloc</span>((<span class="hljs-keyword">float</span>**)&amp;d_C, nBytes);<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨cudaMemcpyå‡½æ•°æŠŠæ•°æ®ä»ä¸»æœºå†…å­˜æ‹·è´åˆ°GPUçš„å…¨å±€å†…å­˜ä¸­ï¼Œå‚è€ƒcudaMemcpyHostToDeviceæŒ‡å®šæ•°æ®æ‹·è´æ–¹å‘ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">cudaMemcpy</span>(d_A, h_A, nBytes, cudaMemcpyHostToDevice);<br><span class="hljs-built_in">cudaMemcpy</span>(d_B, h_B, nBytes, cudaMemcpyHostToDevice);<br></code></pre></div></td></tr></table></figure><p>å½“æ•°æ®è¢«è½¬ç§»åˆ°GPUçš„å…¨å±€å†…å­˜åï¼Œä¸»æœºç«¯è°ƒç”¨æ ¸å‡½æ•°åœ¨GPUä¸Šè¿›è¡Œæ•°ç»„æ±‚å’Œã€‚ä¸€æ—¦å†…æ ¸è¢«è°ƒç”¨ï¼Œæ§åˆ¶æƒç«‹åˆ»è¢«ä¼ å›ä¸»æœºï¼Œè¿™æ ·çš„è¯ï¼Œå½“æ ¸å‡½æ•°åœ¨GPUä¸Šè¿è¡Œæ—¶ï¼Œä¸»æœºå¯ä»¥æ‰§è¡Œå…¶ä»–å‡½æ•°ã€‚å› æ­¤ï¼Œå†…æ ¸ä¸ä¸»æœºæ˜¯å¼‚æ­¥çš„ã€‚</p><p>å½“å†…æ ¸åœ¨GPUä¸Šå®Œæˆäº†å¯¹æ‰€æœ‰æ•°ç»„å…ƒç´ çš„å¤„ç†åï¼Œå…¶ç»“æœå°†ä»¥æ•°ç»„d_Cçš„å½¢å¼å­˜å‚¨åœ¨GPUçš„å…¨å±€å†…å­˜ä¸­ï¼Œç„¶åç”¨cudaMemcpyå‡½æ•°æŠŠç»“æœä»GPUå¤åˆ¶å›åˆ°ä¸»æœºçš„æ•°ç»„gpuRefä¸­ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">cudaMemcpy</span>(gpuRef, d_C, nBytes, cudaMemcpyDeviceToHost);<br></code></pre></div></td></tr></table></figure><p>cudaMemcpyçš„è°ƒç”¨ä¼šå¯¼è‡´ä¸»æœºè¿è¡Œé˜»å¡ã€‚cudaMemcpyDeviceToHostçš„ä½œç”¨å°±æ˜¯å°†å­˜å‚¨åœ¨GPUä¸Šçš„æ•°ç»„d_Cä¸­çš„ç»“æœå¤åˆ¶åˆ°gpuRefä¸­ã€‚æœ€åï¼Œè°ƒç”¨cudaFreeé‡Šæ”¾GPUçš„å†…å­˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">cudaFree</span>(d_A);<br><span class="hljs-built_in">cudaFree</span>(d_B);<br><span class="hljs-built_in">cudaFree</span>(d_C);<br></code></pre></div></td></tr></table></figure><h3 id="3-ä¸åŒçš„å­˜å‚¨ç©ºé—´"><a href="#3-ä¸åŒçš„å­˜å‚¨ç©ºé—´" class="headerlink" title="3.ä¸åŒçš„å­˜å‚¨ç©ºé—´"></a>3.ä¸åŒçš„å­˜å‚¨ç©ºé—´</h3><p>ä½¿ç”¨CUDA Cè¿›è¡Œç¼–ç¨‹çš„äººæœ€å¸¸çŠ¯çš„é”™è¯¯å°±æ˜¯å¯¹ä¸åŒå†…å­˜ç©ºé—´çš„ä¸æ°å½“å¼•ç”¨ã€‚å¯¹äºåœ¨GPUä¸Šè¢«åˆ†é…çš„å†…å­˜æ¥è¯´ï¼Œè®¾å¤‡æŒ‡é’ˆåœ¨ä¸»æœºä»£ç ä¸­å¯èƒ½å¹¶æ²¡æœ‰è¢«å¼•ç”¨ã€‚å¦‚æœä½ æ‰§è¡Œäº†é”™è¯¯çš„å†…å­˜åˆ†é…ï¼Œå¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">gpuRef = d_C<br></code></pre></div></td></tr></table></figure><p>è€Œä¸æ˜¯ç”¨ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">cudaMemcpy</span>(gpuRef, d_C, nBytes, cudaMemcpyDeviceToHost);<br></code></pre></div></td></tr></table></figure><p>åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶å°†ä¼šå´©æºƒã€‚</p><p>ä¸ºäº†é¿å…è¿™ç±»é”™è¯¯ï¼ŒCUDA6.0æå‡ºäº†ç»Ÿä¸€å¯»å€ï¼Œä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæ¥è®¿é—®CPUå’ŒGPUçš„å†…å­˜</p><h3 id="4-å‚è€ƒèµ„æ–™"><a href="#4-å‚è€ƒèµ„æ–™" class="headerlink" title="4.å‚è€ƒèµ„æ–™"></a>4.å‚è€ƒèµ„æ–™</h3><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç¼–ç¨‹ç»“æ„</title>
    <link href="/2023/01/17/cuda004/"/>
    <url>/2023/01/17/cuda004/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAç¼–ç¨‹ç»“æ„"><a href="#CUDAç¼–ç¨‹ç»“æ„" class="headerlink" title="CUDAç¼–ç¨‹ç»“æ„"></a>CUDAç¼–ç¨‹ç»“æ„</h2><p>CUDAç¼–ç¨‹æ¨¡å‹ä½¿ç”¨ç”±Cè¯­è¨€æ‰©å±•ç”Ÿæˆçš„æ³¨é‡Šä»£ç åœ¨å¼‚æ„è®¡ç®—ç³»ç»Ÿä¸­æ‰§è¡Œåº”ç”¨ç¨‹åºã€‚</p><p>åœ¨ä¸€ä¸ªå¼‚æ„ç¯å¢ƒä¸­åŒ…å«å¤šä¸ªCPUå’ŒGPUï¼Œæ¯ä¸ªGPUå’ŒCPUçš„å†…å­˜éƒ½ç”±ä¸€æ¡PCI-Expressæ€»çº¿åˆ†éš”å¼€ã€‚å› æ­¤ï¼Œéœ€è¦æ³¨æ„åŒºåˆ«ä»¥ä¸‹å†…å®¹ã€‚</p><ol><li>ä¸»æœºï¼šCPUåŠå…¶å†…å­˜ï¼ˆä¸»æœºå†…å­˜ï¼‰</li><li>è®¾å¤‡ï¼šGPUåŠå…¶å†…å­˜ï¼ˆè®¾å¤‡å†…å­˜ï¼‰</li></ol><p>ä¸ºäº†æ¸…æ¥šåœ°æŒ‡æ˜ä¸åŒçš„å†…å­˜ç©ºé—´ï¼Œåœ¨æœ¬ä¹¦çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œä¸»æœºå†…å­˜ä¸­çš„å˜é‡åä»¥h__ä¸ºå‰ç¼€ï¼Œè®¾å¤‡å†…å­˜ä¸­çš„å˜é‡åä»¥d__ä¸ºå‰ç¼€ã€‚</p><p>ä»CUDA6.0å¼€å§‹ï¼ŒNVDIAæå‡ºäº†åä¸ºâ€œç»Ÿä¸€å¯»å€â€ï¼ˆUnified Memoryï¼‰çš„ç¼–ç¨‹æ¨¡å‹çš„æ”¹è¿›ï¼Œå®ƒè¿æ¥äº†ä¸»æœºå†…å­˜å’Œè®¾å¤‡å†…å­˜ç©ºé—´ï¼Œå¯ä½¿ç”¨å•ä¸ªæŒ‡é’ˆè®¿é—®CPUå’ŒGPUå†…å­˜ï¼Œæ— é¡»å½¼æ­¤ä¹‹é—´æ‰‹åŠ¨æ‹·è´æ•°æ®ã€‚ç°åœ¨ï¼Œé‡è¦çš„æ˜¯åº”å­¦ä¼šå¦‚ä½•ä¸ºä¸»æœºå’Œè®¾å¤‡åˆ†é…å†…å­˜ç©ºé—´ä»¥åŠå¦‚ä½•åœ¨CPUå’ŒGPUä¹‹é—´æ‹·è´å…±äº«æ•°æ®ã€‚è¿™ç§ç¨‹åºå‘˜ç®¡ç†æ¨¡å¼æ§åˆ¶ä¸‹çš„å†…å­˜å’Œæ•°æ®å¯ä»¥ä¼˜åŒ–åº”ç”¨ç¨‹åºå¹¶å®ç°ç¡¬ä»¶ç³»ç»Ÿåˆ©ç”¨ç‡çš„æœ€å¤§åŒ–ã€‚</p><p>å†…æ ¸ï¼ˆkernelï¼‰æ˜¯CUDAç¼–ç¨‹æ¨¡å‹çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå…¶ä»£ç åœ¨GPUä¸Šè¿è¡Œã€‚ä½œä¸ºä¸€ä¸ªå¼€å‘äººå‘˜ï¼Œä½ å¯ä»¥ä¸²è¡Œçš„æ‰§è¡Œæ ¸å‡½æ•°ã€‚åœ¨æ­¤èƒŒæ™¯ä¸‹ï¼ŒCUDAçš„è°ƒåº¦ç®¡ç†ç¨‹åºå‘˜åœ¨GPUçº¿ç¨‹ä¸Šç¼–å†™æ ¸å‡½æ•°ã€‚åœ¨ä¸»æœºä¸Šï¼ŒåŸºäºåº”ç”¨ç¨‹åºæ•°æ®ä»¥åŠGPUçš„æ€§èƒ½å®šä¹‰å¦‚ä½•è®©è®¾å¤‡å®ç°ç®—æ³•åŠŸèƒ½ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä½¿ä½ ä¸“æ³¨äºç®—æ³•çš„é€»è¾‘ï¼ˆé€šè¿‡ç¼–å†™ä¸²è¡Œä»£ç ï¼‰ï¼Œä¸”åœ¨åˆ›å»ºå’Œç®¡ç†å¤§é‡çš„GPUçº¿ç¨‹æ—¶ä¸å¿…æ‹˜æ³¥äºç»†èŠ‚ã€‚</p><p>å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸»æœºå¯ä»¥ç‹¬ç«‹åœ°å¯¹è®¾å¤‡è¿›è¡Œæ“ä½œã€‚å†…æ ¸ä¸€æ—¦è¢«å¯åŠ¨ï¼Œç«¯ç²’æƒç«‹åˆ»è¿”å›ç»™ä¸»æœºï¼Œé‡Šæ”¾CPUæ¥æ‰§è¡Œç”±è®¾å¤‡ä¸Šè¿è¡Œçš„å¹¶è¡Œä»£ç å®ç°çš„é¢å¤–çš„ä»»åŠ¡ã€‚CUDAç¼–ç¨‹æ¨¡å‹ä¸»è¦æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤åœ¨GPUä¸Šè¿›è¡Œçš„è¿ç®—å¯ä»¥ä¸ä¸»æœº-è®¾å¤‡é€šä¿¡é‡å ã€‚ä¸€ä¸ªå…¸å‹çš„CUDAç¨‹åºåŒ…æ‹¬ç”±å¹¶è¡Œä»£ç äº’è¡¥çš„ä¸²è¡Œä»£ç ã€‚å¦‚å›¾2-2æ‰€ç¤ºï¼Œä¸²è¡Œä»£ç ï¼ˆåŠä»»åŠ¡å¹¶è¡Œä»£ç ï¼‰åœ¨ä¸»æœºCPUä¸Šæ‰§è¡Œï¼Œè€Œå¹¶è¡Œä»£ç åœ¨GPUä¸Šæ‰§è¡Œã€‚ä¸»æœºä»£ç æŒ‰ç…§ANSI Cæ ‡å‡†è¿›è¡Œç¼–å†™ï¼Œè€Œè®¾å¤‡ä»£ç ä½¿ç”¨CUDA Cè¿›è¡Œç¼–å†™ã€‚ä½ å¯ä»¥å°†æ‰€æœ‰çš„ä»£ç ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªæºæ–‡ä»¶æ¥æ„å»ºåº”ç”¨ç¨‹åºå’Œåº“ã€‚NVIDIAçš„Cç¼–è¯‘å™¨(nvcc)ä¸ºä¸»æœºå’Œè®¾å¤‡ç”Ÿæˆå¯æ‰§è¡Œä»£ç ã€‚</p><p>ä¸€ä¸ªå…¸å‹çš„CUDAç¨‹åºå®ç°æµç¨‹éµå¾ªä»¥ä¸‹æ¨¡å¼</p><ol><li>æŠŠæ•°æ®ä»CPUå†…å­˜æ‹·è´åˆ°GPUå†…å­˜</li><li>è°ƒç”¨æ ¸å‡½æ•°å¯¹å­˜å‚¨åœ¨GPUå†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œæ“ä½œ</li><li>å°†æ•°æ®ä»GPUå†…å­˜ä¼ é€å›åˆ°CPUå†…å­˜</li></ol><p>é¦–å…ˆï¼Œä½ è¦å­¦ä¹ çš„æ˜¯å†…å­˜ç®¡ç†åŠä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚</p><p><img src="/2023/01/17/cuda004/image-20230117220146068.png" alt="image-20230117220146068"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç¼–ç¨‹æ¨¡å‹æ¦‚è¿°</title>
    <link href="/2023/01/17/cuda003/"/>
    <url>/2023/01/17/cuda003/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDAç¼–ç¨‹æ¨¡å‹æ¦‚è¿°"><a href="#CUDAç¼–ç¨‹æ¨¡å‹æ¦‚è¿°" class="headerlink" title="CUDAç¼–ç¨‹æ¨¡å‹æ¦‚è¿°"></a>CUDAç¼–ç¨‹æ¨¡å‹æ¦‚è¿°</h2><p>CUDAç¼–ç¨‹æ¨¡å‹æä¾›äº†ä¸€ä¸ªè®¡ç®—æœºæ¶æ„æŠ½è±¡ä½œä¸ºåº”ç”¨ç¨‹åºå’Œå…¶å¯ç”¨ç¡¬ä»¶ä¹‹é—´çš„æ¡¥æ¢ã€‚å›¾2-1è¯´æ˜äº†ç¨‹åºå’Œç¼–ç¨‹æ¨¡å‹å®ç°ä¹‹é—´çš„æŠ½è±¡ç»“æ„çš„é‡è¦ã€‚é€šä¿¡æŠ½è±¡æ˜¯ç¨‹åºä¸ç¼–ç¨‹æ¨¡å‹å®ç°ä¹‹é—´çš„åˆ†ç•Œçº¿ï¼Œå®ƒé€šè¿‡ä¸“ä¸šçš„ç¡¬ä»¶åŸè¯­å’Œæ“ä½œç³»ç»Ÿçš„ç¼–è¯‘å™¨æˆ–åº“æ¥å®ç°ã€‚åˆ©ç”¨ç¼–ç¨‹æ¨¡å‹æ‰€ç¼–å†™çš„ç¨‹åºæŒ‡å®šäº†ç¨‹åºçš„å„ç»„æˆéƒ¨åˆ†æ˜¯å¦‚ä½•å…±äº«ä¿¡æ¯åŠç›¸äº’åä½œçš„ã€‚ç¼–ç¨‹æ¨¡å‹ä»é€»è¾‘ä¸Šæä¾›äº†ä¸€ä¸ªç‰¹å®šçš„è®¡ç®—æœºæ¶æ„ï¼Œé€šå¸¸å®ƒä½“ç°åœ¨ç¼–ç¨‹è¯­è¨€æˆ–ç¼–ç¨‹ç¯å¢ƒä¸­ã€‚</p><p><img src="/2023/01/17/cuda003/image-20230117203406633.png" alt="image-20230117203406633"></p><p>é™¤äº†ä¸å…¶ä»–å¹¶è¡Œç¼–ç¨‹æ¨¡å‹å…±æœ‰çš„æŠ½è±¡å¤–ï¼ŒCUDAç¼–ç¨‹æ¨¡å‹è¿˜åˆ©ç”¨GPUæ¶æ„çš„è®¡ç®—èƒ½åŠ›æä¾›äº†ä»¥ä¸‹å‡ ä¸ªç‰¹æœ‰åŠŸèƒ½ã€‚</p><ol><li>ä¸€ç§é€šè¿‡å±‚æ¬¡ç»“æ„åœ¨GPUä¸­ç»„ç»‡çº¿ç¨‹çš„æ–¹æ³•</li><li>ä¸€ç§é€šè¿‡å±‚æ¬¡ç»“æ„åœ¨GPUä¸­è®¿é—®å†…å­˜çš„æ–¹æ³•</li></ol><p>ä»¥ç¨‹åºå‘˜çš„è§’åº¦å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªä¸åŒçš„å±‚é¢æ¥çœ‹å¾…å¹¶è¡Œè®¡ç®—ã€‚</p><ol><li>é¢†åŸŸå±‚</li><li>é€»è¾‘å±‚</li><li>ç¡¬ä»¶å±‚</li></ol><p>åœ¨ç¼–ç¨‹ä¸ç®—æ³•è®¾è®¡çš„è¿‡ç¨‹ä¸­ï¼Œä½ æœ€å…³å¿ƒçš„åº”æ˜¯åœ¨é¢†åŸŸå±‚å¦‚ä½•è§£ææ•°æ®å’Œå‡½æ•°ï¼Œä»¥ä¾¿åœ¨å¹¶è¡Œç¯å¢ƒä¸­èƒ½æ­£ç¡®ï¼Œé«˜æ•ˆåœ°è§£å†³é—®é¢˜ã€‚å½“è¿›å…¥ç¼–ç¨‹é˜¶æ®µï¼Œä½ çš„å…³æ³¨ç‚¹åº”è½¬å‘å¦‚ä½•ç»„ç»‡å¹¶å‘çº¿ç¨‹ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä½ éœ€è¦ä»é€»è¾‘å±‚é¢æ¥æ€è€ƒï¼Œä»¥ç¡®ä¿ä½ çš„çº¿ç¨‹å’Œè®¡ç®—èƒ½æ­£ç¡®åœ°è§£å†³é—®é¢˜ã€‚åœ¨Cè¯­è¨€å¹¶è¡Œç¼–ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨pthreadsæˆ–OpenMPæŠ€æœ¯æ¥æ˜¾å¼åœ°ç®¡ç†çº¿ç¨‹ã€‚CUDAæå‡ºäº†ä¸€ä¸ªçº¿ç¨‹å±‚æ¬¡ç»“æ„æŠ½è±¡çš„æ¦‚å¿µï¼Œä»¥å…è®¸æ§åˆ¶çº¿ç¨‹è¡Œä¸ºã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDA:ä¸€ç§å¼‚æ„è®¡ç®—å¹³å°</title>
    <link href="/2023/01/16/cuda002/"/>
    <url>/2023/01/16/cuda002/</url>
    
    <content type="html"><![CDATA[<h2 id="CUDA-ä¸€ç§å¼‚æ„è®¡ç®—å¹³å°"><a href="#CUDA-ä¸€ç§å¼‚æ„è®¡ç®—å¹³å°" class="headerlink" title="CUDA:ä¸€ç§å¼‚æ„è®¡ç®—å¹³å°"></a>CUDA:ä¸€ç§å¼‚æ„è®¡ç®—å¹³å°</h2><h3 id="1-CUDAçš„ç®€å•ä»‹ç»"><a href="#1-CUDAçš„ç®€å•ä»‹ç»" class="headerlink" title="1.CUDAçš„ç®€å•ä»‹ç»"></a>1.CUDAçš„ç®€å•ä»‹ç»</h3><p>CUDAæ˜¯ä¸€ç§é€šç”¨çš„å¹¶è¡Œè®¡ç®—å¹³å°å’Œç¼–ç¨‹æ¨¡å‹ï¼Œå®ƒåˆ©ç”¨NVIDIA GPUä¸­çš„å¹¶è¡Œè®¡ç®—å¼•æ“èƒ½å¤Ÿæœ‰æ•ˆåœ°è§£å†³å¤æ‚çš„è®¡ç®—é—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨CUDAï¼Œä½ å¯ä»¥åƒåœ¨CPUä¸Šï¼Œé€šè¿‡GPUæ¥è¿›è¡Œè®¡ç®—ã€‚</p><p>CUDAå¹³å°å¯ä»¥é€šè¿‡CUDAåŠ é€Ÿåº“ï¼Œç¼–è¯‘å™¨æŒ‡ä»¤ï¼Œåº”ç”¨ç¼–ç¨‹æ¥å£ä»¥åŠè¡Œä¸šæ ‡å‡†ç¨‹åºè¯­è¨€çš„æ‰©å±•ï¼ˆåŒ…æ‹¬C,C++,Fortranï¼ŒPythonï¼Œå¦‚å›¾1-12æ‰€ç¤ºï¼‰æ¥ä½¿ç”¨ã€‚</p><p>CUDA Cæ˜¯æ ‡å‡†ANSI Cè¯­è¨€çš„ä¸€ä¸ªæ‰©å±•ï¼Œå®ƒå¸¦æœ‰çš„å°‘æ•°è¯­è¨€æ‰©å±•åŠŸèƒ½ä½¿å¼‚æ„ç¼–ç¨‹æˆä¸ºå¯èƒ½ï¼ŒåŒæ—¶ä¹Ÿèƒ½é€šè¿‡APIæ¥ç®¡ç†è®¾å¤‡ï¼Œå†…å­˜å’Œå…¶ä»–ä»»åŠ¡ã€‚CUDAè¿˜æ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå®ƒä½¿ç¨‹åºèƒ½å¯¹æœ‰ä¸åŒæ•°é‡æ ¸çš„GPUæ˜æ˜¾åœ°æ‰©å±•å…¶å¹¶è¡Œæ€§ï¼ŒåŒæ—¶å¯¹ç†Ÿæ‚‰Cç¼–ç¨‹è¯­è¨€çš„ç¨‹åºå‘˜æ¥è¯´ä¹Ÿæ¯”è¾ƒå®¹æ˜“ä¸Šæ‰‹ã€‚</p><p><img src="/2023/01/16/cuda002/image-20230116175503342.png" alt="image-20230116175503342"></p><p>CUDAæä¾›äº†ä¸¤å±‚APIæ¥ç®¡ç†GPUè®¾å¤‡å’Œç»„ç»‡çº¿ç¨‹ï¼Œå¦‚å›¾1-13æ‰€ç¤ºã€‚</p><p><img src="/2023/01/16/cuda002/image-20230116175610403.png" alt="image-20230116175610403"></p><p>-CUDAé©±åŠ¨API</p><p>-CUDAè¿è¡Œæ—¶API</p><p>é©±åŠ¨APIæ˜¯ä¸€ç§ä½çº§APIï¼Œå®ƒç›¸å¯¹æ¥è¯´è¾ƒéš¾ç¼–ç¨‹ï¼Œä½†æ˜¯å®ƒå¯¹äºåœ¨GPUè®¾å¤‡ä½¿ç”¨ä¸Šæä¾›äº†æ›´å¤šçš„æ§åˆ¶ã€‚è¿è¡Œæ—¶APIæ˜¯ä¸€ä¸ªé«˜çº§APIï¼Œä»–åœ¨é©±åŠ¨APIçš„ä¸Šå±‚å®ç°ã€‚æ¯ä¸ªè¿è¡Œæ—¶APIå‡½æ•°éƒ½è¢«åˆ†è§£ä¸ºæ›´å¤šä¼ ç»™é©±åŠ¨APIçš„åŸºæœ¬è¿ç®—ã€‚</p><h3 id="2-è¿è¡Œæ—¶APIä¸é©±åŠ¨API"><a href="#2-è¿è¡Œæ—¶APIä¸é©±åŠ¨API" class="headerlink" title="2.è¿è¡Œæ—¶APIä¸é©±åŠ¨API"></a>2.è¿è¡Œæ—¶APIä¸é©±åŠ¨API</h3><p>è¿è¡Œæ—¶APIå’Œé©±åŠ¨APIä¹‹é—´æ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½å·®å¼‚ã€‚åœ¨è®¾å¤‡ç«¯ï¼Œå†…æ ¸æ˜¯å¦‚ä½•ä½¿ç”¨å†…å­˜ä»¥åŠä½ æ˜¯å¦‚ä½•ç»„ç»‡çº¿ç¨‹çš„ï¼Œå¯¹æ€§èƒ½æœ‰æ›´æ˜¾è‘—çš„å½±å“ã€‚</p><p>è¿™ä¸¤ç§APIæ˜¯ç›¸äº’æ’æ–¥çš„ï¼Œä½ å¿…é¡»ä½¿ç”¨ä¸¤è€…ä¹‹ä¸€ï¼Œä»ä¸¤è€…ä¸­æ··åˆå‡½æ•°è°ƒç”¨æ˜¯ä¸å¯èƒ½çš„ã€‚æœ¬ä¹¦ä¸­æ‰€æœ‰ä¾‹å­éƒ½ä½¿ç”¨è¿è¡Œæ—¶APIã€‚</p><p>ä¸€ä¸ªCUDAç¨‹åºåŒ…å«äº†ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†çš„æ··åˆã€‚</p><p>-åœ¨CPUä¸Šè¿è¡Œçš„ä¸»æœºä»£ç </p><p>-åœ¨GPUä¸Šè¿è¡Œçš„è®¾å¤‡ä»£ç </p><p>NVIDIAçš„CUDA nvccç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å°†è®¾å¤‡ä»£ç ä»ä¸»æœºä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ã€‚å¦‚å›¾1-14æ‰€ç¤ºï¼Œä¸»æœºä»£ç æ˜¯æ ‡å‡†çš„Cä»£ç ï¼Œä½¿ç”¨Cç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ã€‚è®¾å¤‡ä»£ç ï¼Œä¹Ÿå°±æ˜¯æ ¸å‡½æ•°ï¼Œæ˜¯ç”¨æ‰©å±•çš„å¸¦æœ‰æ ‡è®°æ•°æ®å¹¶è¡Œå‡½æ•°å…³é”®å­—çš„CUDA Cè¯­è¨€ç¼–å†™çš„ã€‚è®¾å¤‡ä»£ç é€šè¿‡nvccè¿›è¡Œç¼–è¯‘ã€‚åœ¨é“¾æ¥é˜¶æ®µï¼Œåœ¨å†…æ ¸ç¨‹åºè°ƒç”¨å’Œæ˜¾ç¤ºGPUè®¾å¤‡æ“ä½œä¸­æ·»åŠ CUDAè¿è¡Œæ—¶åº“ã€‚</p><p><img src="/2023/01/16/cuda002/image-20230116180725596.png" alt="image-20230116180725596"></p><p>CUDA nvccç¼–è¯‘å™¨æ˜¯ä»¥å¹¿æ³›ä½¿ç”¨LLVMå¼€æºç¼–è¯‘ç³»ç»Ÿä¸ºåŸºç¡€çš„ã€‚åœ¨GPUåŠ é€Ÿå™¨çš„æ”¯æŒä¸‹ï¼Œé€šè¿‡ä½¿ç”¨CUDAç¼–è¯‘å™¨SDKï¼Œä½ å¯ä»¥åˆ›å»ºæˆ–æ‰©å±•ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚å›¾1-15æ‰€ç¤ºã€‚</p><p>CUDAå¹³å°ä¹Ÿæ˜¯æ”¯æŒå¤šæ ·åŒ–å¹¶è¡Œè®¡ç®—ç”Ÿæ€ç³»ç»Ÿçš„åŸºç¡€ï¼Œå¦‚å›¾1-26æ‰€ç¤ºã€‚ç°åœ¨ï¼Œéšç€è¶Šæ¥è¶Šå¤šçš„å…¬å¸å¯ä»¥æä¾›å…¨çƒæ€§çš„å·¥å…·ï¼ŒæœåŠ¡å’Œè§£å†³æ–¹æ¡ˆï¼ŒCUDAç”Ÿæ€ç³»ç»Ÿè¿…é€Ÿæˆé•¿ã€‚å¦‚æœä½ æƒ³åœ¨GPUä¸Šå»ºç«‹ä½ çš„åº”ç”¨ç¨‹åºï¼Œå¼ºåŒ–GPUæ€§èƒ½æœ€ç®€å•æ–¹å¼æ˜¯ä½¿ç”¨CUDAå·¥å…·åŒ…ï¼ˆcuda-toolkitï¼‰ï¼Œå®ƒä¸ºCå’ŒC++å¼€å‘äººå‘˜æä¾›äº†ä¸€ä¸ªç»¼åˆçš„å¼€å‘ç¯å¢ƒã€‚CUDAå·¥å…·åŒ…åŒ…æ‹¬ç¼–è¯‘å™¨ï¼Œæ•°å­¦åº“ï¼Œä»¥åŠè°ƒå¼å’Œä¼˜åŒ–åº”ç”¨ç¨‹åºæ€§èƒ½çš„å·¥å…·ã€‚åŒæ—¶æä¾›äº†ä»£ç æ ·ä¾‹ï¼Œç¼–ç¨‹æŒ‡å—ï¼Œç”¨æˆ·æ‰‹å†Œï¼ŒAPIå‚è€ƒæ–‡æ¡£å’Œå…¶ä»–å¸®åŠ©ä½ å…¥é—¨çš„æ–‡æ¡£ã€‚</p><p><img src="/2023/01/16/cuda002/image-20230116181439404.png" alt="image-20230116181439404"></p><p><img src="/2023/01/16/cuda002/image-20230116181447616.png" alt="image-20230116181447616"></p><h3 id="3-å‚è€ƒèµ„æ–™"><a href="#3-å‚è€ƒèµ„æ–™" class="headerlink" title="3.å‚è€ƒèµ„æ–™"></a>3.å‚è€ƒèµ„æ–™</h3><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAç”¨GPUè¾“å‡ºHello World</title>
    <link href="/2023/01/16/cuda001/"/>
    <url>/2023/01/16/cuda001/</url>
    
    <content type="html"><![CDATA[<h2 id="ç”¨GPUè¾“å‡ºHello-World"><a href="#ç”¨GPUè¾“å‡ºHello-World" class="headerlink" title="ç”¨GPUè¾“å‡ºHello World"></a>ç”¨GPUè¾“å‡ºHello World</h2><h3 id="1-æ£€æŸ¥ç¯å¢ƒ"><a href="#1-æ£€æŸ¥ç¯å¢ƒ" class="headerlink" title="1.æ£€æŸ¥ç¯å¢ƒ"></a>1.æ£€æŸ¥ç¯å¢ƒ</h3><p>å­¦ä¹ ä¸€ä¸ªæ–°ç¼–ç¨‹è¯­è¨€çš„æœ€å¥½æ–¹å¼å°±æ˜¯ä½¿ç”¨è¿™ç§è¯­è¨€æ¥ç¼–å†™ç¨‹åºã€‚åœ¨æœ¬èŠ‚ï¼Œä½ å°†å¼€å§‹ç¼–å†™åœ¨GPUä¸Šè¿è¡Œçš„ç¬¬ä¸€ä¸ªå†…æ ¸ä»£ç ã€‚åƒå…¶ä»–ä»»ä½•ç¼–ç¨‹è¯­è¨€ä¸€æ ·ç¼–å†™GPUä¸Šçš„ç¬¬ä¸€ä¸ªç¨‹åºæ˜¯è¾“å‡ºå­—ç¬¦ä¸²â€œHello Worldâ€ã€‚</p><p>å¦‚æœè¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨CUDA,åœ¨Linuxç³»ç»Ÿä¸­ï¼Œä½ å¯ä»¥æƒ³ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥CUDAç¼–è¯‘å™¨æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">which nvcc<br></code></pre></div></td></tr></table></figure><p>é€šå¸¸çš„ç»“æœå¯èƒ½æ˜¯</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">/usr/local/cuda/bin/nvcc<br></code></pre></div></td></tr></table></figure><p>ä½ è¿˜éœ€è¦æ£€æŸ¥ä½ çš„æœºå™¨ä¸Šæ˜¯å¦å®‰è£…äº†GPUåŠ é€Ÿå¡ã€‚å¯¹åƒä½ å¯ä»¥åœ¨Linuxç³»ç»Ÿä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">ls -l /dev/nv*<br></code></pre></div></td></tr></table></figure><p>é€šå¸¸çš„ç»“æœæ˜¯ï¼š</p><p><img src="/2023/01/16/cuda001/image-20230116170920773.png" alt="image-20230116170920773"></p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å‘ç°äº†ä¸¤ä¸ªGPUå¡ï¼ˆä¸åŒçš„ç”¨æˆ·é…ç½®å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œå› æ­¤æ˜¾ç¤ºç»“æœä¼šæœ‰æ‰€å·®å¼‚ï¼‰ã€‚</p><h3 id="2-ç¬¬ä¸€ä¸ªCUDA-Cç¨‹åº"><a href="#2-ç¬¬ä¸€ä¸ªCUDA-Cç¨‹åº" class="headerlink" title="2.ç¬¬ä¸€ä¸ªCUDA Cç¨‹åº"></a>2.ç¬¬ä¸€ä¸ªCUDA Cç¨‹åº</h3><p>ç°åœ¨ä½ è¦å‡†å¤‡å¥½å†™ä½ çš„ç¬¬ä¸€ä¸ªCUDA Cç¨‹åºã€‚å†™ä¸€ä¸ªCUDA Cç¨‹åºï¼Œä½ éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç”¨ä¸“ç”¨æ‰©å±•å.cuæ¥åˆ›å»ºä¸€ä¸ªæºæ–‡ä»¶ã€‚</li><li>ä½¿ç”¨CUDA nvccç¼–è¯‘å™¨æ¥ç¼–è¯‘ç¨‹åºã€‚</li><li>ä»å‘½ä»¤è¡Œè¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æœ‰å¯åœ¨GPUä¸Šè¿è¡Œçš„å†…æ ¸ä»£ç ã€‚</li></ol><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªCè¯­è¨€ç¨‹åºæ¥è¾“å‡ºâ€œHello Worldâ€,å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World from CPU!\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æŠŠä»£ç ä¿å­˜åˆ°hello.cuä¸­ï¼Œç„¶åä½¿ç”¨nvccç¼–è¯‘å™¨æ¥ç¼–è¯‘ã€‚CUDA nvccç¼–è¯‘å™¨å’Œgccç¼–è¯‘å™¨åŠå…¶ä»–ç¼–è¯‘å™¨æœ‰ç›¸ä¼¼çš„è¯­ä¹‰</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc hello.cu -o hello<br></code></pre></div></td></tr></table></figure><p>å¦‚æœä½ è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶helloï¼Œå°†ä¼šè¾“å‡ºï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs angelscript">Hello World <span class="hljs-keyword">from</span> CPU!<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œç¼–å†™ä¸€ä¸ªå†…æ ¸å‡½æ•°ï¼Œå‘½åä¸ºhelloFromGPUï¼Œç”¨å®ƒæ¥è¾“å‡ºå­—ç¬¦ä¸²â€œHello World from GPU!â€ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">helloFromGPU</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World from GPU!\n&quot;</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¿®é¥°ç¬¦__global__å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå‡½æ•°å°†ä¼šä»CPUä¸­è°ƒç”¨ï¼Œç„¶ååœ¨GPUä¸Šæ‰§è¡Œã€‚ç”¨ä¸‹é¢ä»£ç å¯ç”¨å†…æ ¸å‡½æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">helloFromGPU&lt;&lt;&lt;<span class="hljs-number">1</span>,<span class="hljs-number">10</span>&gt;&gt;&gt;();<br></code></pre></div></td></tr></table></figure><p>ä¸‰é‡å°–æ‹¬å·æ„å‘³ç€ä»ä¸»çº¿ç¨‹åˆ°è®¾å¤‡ç«¯ä»£ç çš„è°ƒç”¨ã€‚ä¸€ä¸ªå†…æ ¸å‡½æ•°é€šè¿‡ä¸€ç»„çº¿ç¨‹æ¥æ‰§è¡Œï¼Œæ‰€æœ‰çº¿ç¨‹æ‰§è¡Œç›¸åŒçš„ä»£ç ã€‚ä¸‰é‡å°–æ‹¬å·é‡Œé¢çš„å‚æ•°æ˜¯æ‰§è¡Œé…ç½®ï¼Œç”¨æ¥è¯´æ˜ä½¿ç”¨å¤šå°‘çº¿ç¨‹æ¥æ‰§è¡Œå†…æ ¸å‡½æ•°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰10ä¸ªGPUçº¿ç¨‹è¢«è°ƒç”¨ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œå¾—åˆ°ä»£ç æ¸…å•1-1æ‰€ç¤ºçš„ç¨‹åºã€‚</p><h3 id="3-ä»£ç æ¸…å•1-1Hello-World-from-GPU-hello-cu"><a href="#3-ä»£ç æ¸…å•1-1Hello-World-from-GPU-hello-cu" class="headerlink" title="3.ä»£ç æ¸…å•1-1Hello World from GPU! (hello.cu)"></a>3.ä»£ç æ¸…å•1-1Hello World from GPU! (hello.cu)</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">helloFromGPU</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World from GPU!\n&quot;</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//hello from cpu</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World from CPU!\n&quot;</span>);<br>    <br>    <br>    helloFromGPU&lt;&lt;&lt;<span class="hljs-number">1</span>,<span class="hljs-number">10</span>&gt;&gt;&gt;();<br>    <span class="hljs-built_in">cudaDeviceReset</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å‡½æ•°cudaDeviceRestï¼ˆï¼‰ç”¨æ¥æ˜¾å¼åœ°é‡Šæ”¾å’Œæ¸…ç©ºå½“å‰è¿›ç¨‹ä¸­ä¸å½“å‰è®¾åˆ«æœ‰å…³çš„æ‰€æœ‰èµ„æºã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œåœ¨nvccå‘½ä»¤è¡Œä¸­ä½¿ç”¨-arch sm_20è¿›è¡Œç¼–è¯‘ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">nvcc -arch sm_20 hello.cu -o hello<br></code></pre></div></td></tr></table></figure><p>å¼€å…³è¯­å¥-arch sm_20ä½¿ç¼–è¯‘å™¨ä¸ºFermiæ¶æ„ç”Ÿæˆè®¾å¤‡ä»£ç ã€‚è¿è¡Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®ƒå°†è¾“å‡º10æ¡å­—ç¬¦ä¸²â€œHello World from CPU!â€ï¼Œæ¯ä¸ªçº¿ç¨‹è¾“å‡ºä¸€æ¡ã€‚</p><p><img src="/2023/01/16/cuda001/image-20230116173446169.png" alt="image-20230116173446169"></p><h3 id="4-ä¸€ä¸ªå…¸å‹çš„CUDAç¼–ç¨‹ç»“æ„åŒ…æ‹¬5ä¸ªä¸»è¦æ­¥éª¤"><a href="#4-ä¸€ä¸ªå…¸å‹çš„CUDAç¼–ç¨‹ç»“æ„åŒ…æ‹¬5ä¸ªä¸»è¦æ­¥éª¤" class="headerlink" title="4.ä¸€ä¸ªå…¸å‹çš„CUDAç¼–ç¨‹ç»“æ„åŒ…æ‹¬5ä¸ªä¸»è¦æ­¥éª¤"></a>4.ä¸€ä¸ªå…¸å‹çš„CUDAç¼–ç¨‹ç»“æ„åŒ…æ‹¬5ä¸ªä¸»è¦æ­¥éª¤</h3><ol><li>åˆ†é…GPUå†…å­˜</li><li>ä»CPUå†…å­˜ä¸­æ‹·è´æ•°æ®åˆ°GPUå†…å­˜</li><li>è°ƒç”¨CUDAå†…æ ¸å‡½æ•°æ¥å®Œæˆç¨‹åºæŒ‡å®šçš„è¿ç®—</li><li>å°†æ•°æ®ä»GPUæ‹·å›CPUå†…å­˜</li><li>é‡Šæ”¾GPUå†…å­˜ç©ºé—´</li></ol><p>åœ¨hello.cuä¸­ï¼Œä½ åªçœ‹åˆ°äº†ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨å†…æ ¸ã€‚</p><h3 id="5-å‚è€ƒèµ„æ–™"><a href="#5-å‚è€ƒèµ„æ–™" class="headerlink" title="5.å‚è€ƒèµ„æ–™"></a>5.å‚è€ƒèµ„æ–™</h3><p>CUDA Cç¼–ç¨‹æƒå¨æŒ‡å— ç¨‹æ¶¦ä¼Ÿï¼ŒMax Grossman(ç¾)ï¼ŒTy Mckercher </p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMPç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜(æœªå®Œç»“)</title>
    <link href="/2023/01/14/openmp006/"/>
    <url>/2023/01/14/openmp006/</url>
    
    <content type="html"><![CDATA[<h2 id="OpenMPç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜"><a href="#OpenMPç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜" class="headerlink" title="OpenMPç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜"></a>OpenMPç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</h2><p><strong>æœ¬èŠ‚å°†è®¨è®ºä¸€ä¸ªä¸é€‚åˆç”¨parallel foræŒ‡ä»¤æˆ–è€…foræŒ‡ä»¤æ¥å¹¶è¡ŒåŒ–çš„é—®é¢˜ã€‚</strong></p><h3 id="1-é˜Ÿåˆ—"><a href="#1-é˜Ÿåˆ—" class="headerlink" title="1.é˜Ÿåˆ—"></a>1.é˜Ÿåˆ—</h3><p>é˜Ÿåˆ—æ˜¯ä¸€ç§æŠ½è±¡çš„æ•°æ®ç»“æ„ï¼Œæ’å…¥å…ƒç´ æ—¶å°†å…ƒç´ æ’å…¥åˆ°é˜Ÿåˆ—â€œå°¾éƒ¨â€ï¼Œè€Œè¯»å–å…ƒç´ æ—¶ï¼Œé˜Ÿåˆ—â€œå¤´éƒ¨â€çš„å…ƒç´ è¢«è¿”å›å¹¶ä»é˜Ÿåˆ—ä¸­è¢«ç§»é™¤ã€‚é˜Ÿåˆ—å¯ä»¥çœ‹åšæ˜¯åœ¨è¶…å¸‚ä¸­ç­‰å¾…ä»˜æ¬¾çš„æ¶ˆè´¹è€…çš„æŠ½è±¡ï¼Œé˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯æ¶ˆè´¹è€…ã€‚æ–°çš„æ¶ˆè´¹è€…åˆ°è¾¾æ—¶æ’åœ¨ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œä¸‹ä¸€ä¸ªä»˜æ¬¾ç¦»å¼€ç­‰å¾…é˜Ÿåˆ—çš„æ˜¯æ’åœ¨é˜Ÿåˆ—å¤´éƒ¨çš„æ¶ˆè´¹è€…ã€‚</p><p>å½“ä¸€ä¸ªæ–°çš„å…ƒç´ æ’å…¥åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨æ—¶ï¼Œé€šå¸¸ç§°è¿™ä¸ªæ–°çš„å…ƒç´ â€œå…¥é˜Ÿâ€äº†ï¼›å½“ä¸€ä¸ªå…ƒç´ ä»é˜Ÿåˆ—çš„å¤´éƒ¨è¢«ç§»é™¤æ—¶ï¼Œé€šå¸¸ç§°è¿™ä¸ªå…ƒç´ â€œå‡ºé˜Ÿâ€äº†ã€‚</p><p>é˜Ÿåˆ—åœ¨è®¡ç®—æœºç§‘å­¦ä¸­éšå¤„å¯è§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰å¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½è¯•å›¾å‘ç¡¬ç›˜å†™å…¥æ•°æ®ï¼Œä¸ºäº†ç¡®ä¿æ¯æ¬¡åªæœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨å†™ç¡¬ç›˜ï¼Œä¸€ç§è‡ªç„¶è€Œç„¶çš„æ–¹æ³•æ˜¯å°†è¿›ç¨‹ç»„ç»‡ä¸ºé˜Ÿåˆ—ã€‚æ¢å¥è¯è¯´ï¼Œæ’åœ¨é˜Ÿåˆ—ç¬¬ä¸€ä¸ªçš„è¿›ç¨‹åœ¨å½“å‰è¿›ç¨‹ç»“æŸå¯¹ç¡¬ç›˜çš„ä½¿ç”¨åï¼Œç¬¬ä¸€ä¸ªè·å¾—ç¡¬ç›˜çš„è®¿é—®æƒé™ï¼›æ’åœ¨é˜Ÿåˆ—ç¬¬äºŒä¸ªçš„è¿›ç¨‹åœ¨æ’åœ¨é˜Ÿåˆ—ç¬¬ä¸€ä¸ªçš„è¿›ç¨‹ä½¿ç”¨å®Œç¡¬ç›˜åè·å¾—ç¡¬ç›˜çš„è®¿é—®æƒé™ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p>é˜Ÿåˆ—ä¹Ÿæ˜¯åœ¨å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„æ•°æ®ç»“æ„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰å‡ ä¸ªâ€œç”Ÿäº§è€…â€çº¿ç¨‹å’Œå‡ ä¸ªâ€œæ¶ˆè´¹è€…â€çº¿ç¨‹ã€‚ç”Ÿäº§è€…çº¿ç¨‹â€œäº§ç”Ÿâ€å¯¹æœåŠ¡å™¨æ•°æ®çš„è¯·æ±‚â€”â€”â€”ä¾‹å¦‚å½“å‰è‚¡ç¥¨çš„ä»·æ ¼ï¼Œè€Œæ¶ˆè´¹è€…çº¿ç¨‹é€šè¿‡å‘ç°å’Œç”Ÿæˆæ•°æ®ï¼ˆä¾‹å¦‚ï¼Œå½“å‰è‚¡ç¥¨çš„ä»·æ ¼ï¼‰æ¥â€œæ¶ˆè´¹â€è¯·æ±‚ã€‚ç”Ÿäº§è€…çº¿ç¨‹å°†è¯·æ±‚å…¥é˜Ÿï¼Œè€Œæ¶ˆè´¹è€…çº¿ç¨‹å°†è¯·æ±‚ä»é˜Ÿåˆ—ä¸­ç§»é™¤ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªæœ‰å½“æ¶ˆè´¹è€…çº¿ç¨‹å°†è¯·æ±‚çš„æ•°æ®å‘é€ç»™ç”Ÿäº§è€…çº¿ç¨‹æ—¶ï¼Œè¿›ç¨‹æ‰ä¼šç»“æŸã€‚</p><h3 id="2-æ¶ˆæ¯ä¼ é€’"><a href="#2-æ¶ˆæ¯ä¼ é€’" class="headerlink" title="2.æ¶ˆæ¯ä¼ é€’"></a>2.æ¶ˆæ¯ä¼ é€’</h3><p>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜æ¨¡å‹çš„å¦å¤–ä¸€ä¸ªåº”ç”¨æ˜¯åœ¨å…±äº«å†…å­˜ç³»ç»Ÿä¸Šå®ç°æ¶ˆæ¯ä¼ é€’ã€‚æ¯ä¸€ä¸ªçº¿ç¨‹æœ‰ä¸€ä¸ªæ¶ˆæ¯å…±äº«é˜Ÿåˆ—ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¦å‘å¦ä¸€ä¸ªçº¿ç¨‹â€œå‘é€æ¶ˆæ¯â€œæ—¶ï¼Œä»–å°†æ¶ˆæ¯æ”¾å…¥ç›®æ ‡çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚ä¸€ä¸ªçº¿ç¨‹æ¥å—æ¶ˆæ¯æ—¶åªéœ€ä»å®ƒçš„æ¶ˆæ¯é˜Ÿåˆ—çš„å¤´éƒ¨å–å‡ºæ¶ˆæ¯ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªç®€å•çš„æ¶ˆæ¯ä¼ é€’ç¨‹åºï¼Œåœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éšæœºäº§ç”Ÿæ•´æ•°â€æ¶ˆæ¯â€œå’Œæ¶ˆæ¯çš„æ—¥å¿—ç›®æ ‡çº¿ç¨‹ã€‚å½“åˆ›å»ºä¸€æ¡æ¶ˆæ¯åï¼Œçº¿ç¨‹å°†æ¶ˆæ¯åŠ å…¥åˆ°åˆé€‚çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚å½“å‘é€æ¶ˆæ¯ä¹‹åï¼Œè¯¥çº¿ç¨‹æŸ¥çœ‹å®ƒè‡ªå·±çš„æ¶ˆæ¯é˜Ÿåˆ—ä»¥è·çŸ¥å®ƒæ˜¯å¦æ”¶åˆ°äº†æ¶ˆæ¯ï¼Œå¦‚æœå®ƒæ”¶åˆ°äº†æ¶ˆæ¯ï¼Œå®ƒå°†ä»é˜Ÿé¦–çš„æ¶ˆæ¯å‡ºé˜Ÿå¹¶æ‰“å°è¯¥æ¶ˆæ¯ã€‚æ¯ä¸ªçº¿ç¨‹äº¤æ›¿å‘é€å’Œæ¥å—æ¶ˆæ¯ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šæ¯ä¸ªçº¿ç¨‹å‘é€æ¶ˆæ¯çš„æ•°ç›®ã€‚å½“ä¸€ä¸ªçº¿ç¨‹å‘é€å®Œæ‰€æœ‰æ¶ˆæ¯åï¼Œè¯¥çº¿ç¨‹ä¸æ–­æ¥å—æ¶ˆæ¯ç›´åˆ°æ‰€æœ‰çš„çº¿ç¨‹éƒ½å·²å®Œæˆï¼Œæ­¤æ—¶æ‰€æœ‰çš„çº¿ç¨‹éƒ½ç»“æŸäº†ã€‚æ¯ä¸ªçº¿ç¨‹çš„ä¼ªä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(send_msgs = <span class="hljs-number">0</span>; sent_msgs &lt; send_max ;sent_msgs++)&#123;<br>    <span class="hljs-built_in">Send_msg</span>();<br>    <span class="hljs-built_in">Try_receive</span>();<br>&#125;<br><br><span class="hljs-keyword">while</span>(!<span class="hljs-built_in">Done</span>())<br>    <span class="hljs-built_in">Try_receive</span>();<br></code></pre></div></td></tr></table></figure><h3 id="3-å‘é€æ¶ˆæ¯"><a href="#3-å‘é€æ¶ˆæ¯" class="headerlink" title="3.å‘é€æ¶ˆæ¯"></a>3.å‘é€æ¶ˆæ¯</h3><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè®¿é—®æ¶ˆæ¯é˜Ÿåˆ—å¹¶å°†æ¶ˆæ¯å…¥é˜Ÿï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªä¸´ç•ŒåŒºã€‚å°½ç®¡æˆ‘ä»¬è¿˜æ²¡æœ‰æ·±å…¥åœ°ç ”ç©¶å¦‚ä½•å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†æˆ‘ä»¬å¾ˆæœ‰å¯èƒ½éœ€è¦ç”¨ä¸€ä¸ªå˜é‡æ¥è·Ÿè¸ªé˜Ÿåˆ—çš„å°¾éƒ¨ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€ä¸ªå•é“¾è¡¨æ¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé“¾è¡¨çš„å°¾éƒ¨å¯¹åº”ç€é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚ç„¶åï¼Œä¸ºäº†æœ‰æ•ˆåœ°è¿›è¡Œå…¥é˜Ÿæ“ä½œï¼Œéœ€è¦å­˜å‚¨æŒ‡å‘é“¾è¡¨å°¾éƒ¨çš„æŒ‡é’ˆï¼Œå½“ä¸€æ¡æ–°æ¶ˆæ¯å…¥é˜Ÿæ—¶ï¼Œéœ€è¦æ£€æŸ¥å’Œæ›´æ–°è¿™ä¸ªé˜Ÿå°¾æŒ‡é’ˆã€‚å¦‚æœä¸¤ä¸ªçº¿ç¨‹è¯•å›¾åŒæ—¶è¿›è¡Œè¿™äº›æ“ä½œï¼Œé‚£ä¹ˆå¯èƒ½ä¼šä¸¢å¤±ä¸€æ¡å·²ç»ç”±å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹å…¥é˜Ÿçš„æ¶ˆæ¯.ï¼ˆç”»å¼ å›¾èƒ½å¤Ÿæœ‰åŠ©äºç†è§£è¿™ç§æƒ…å†µï¼ï¼‰ä¸¤ä¸ªæ“ä½œçš„ç»“æœä¼šå‘ç”Ÿå†²çªï¼Œå› æ­¤å…¥é˜Ÿæ“ä½œå½¢æˆäº†ä¸´ç•ŒåŒºã€‚</p><p>Send_msg()å‡½æ•°çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">mesg = <span class="hljs-built_in">random</span>();<br>dest = <span class="hljs-built_in">random</span>() % thread_count;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp critical</span><br><span class="hljs-built_in">Enqueue</span>(queue,dest,my_rank.mesg);<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„åœ¨ä¸Šé¢çš„å®ç°ä¸­ï¼Œå…è®¸çº¿ç¨‹å‘å®ƒè‡ªå·±å‘é€æ¶ˆæ¯ã€‚</p><h3 id="4-æ¥å—æ¶ˆæ¯"><a href="#4-æ¥å—æ¶ˆæ¯" class="headerlink" title="4.æ¥å—æ¶ˆæ¯"></a>4.æ¥å—æ¶ˆæ¯</h3><p>æ¥å—æ¶ˆæ¯çš„åŒæ­¥é—®é¢˜ä¸å‘é€æ¶ˆæ¯æœ‰äº›ä¸åŒã€‚åªæœ‰æ¶ˆæ¯é˜Ÿåˆ—çš„æ‹¥æœ‰è€…ï¼ˆå³ç›®æ ‡çº¿ç¨‹ï¼‰å¯ä»¥ä»ç»™å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸¤æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆåªè¦æ¯æ¬¡åªå‡ºé˜Ÿä¸€æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆå‡ºé˜Ÿæ“ä½œå’Œå…¥é˜Ÿæ“ä½œå°±ä¸å¯èƒ½å†²çªã€‚å› æ­¤å¦‚æœé˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸¤æ¡æ¶ˆæ¯ï¼Œé€šè¿‡è·Ÿè¸ªé˜Ÿåˆ—çš„å¤§å°å°±å¯ä»¥é¿å…ä»»ä½•åŒæ­¥ï¼ˆä¾‹å¦‚criticalæŒ‡ä»¤ï¼‰</p><p>ç°åœ¨çš„é—®é¢˜æ˜¯å¦‚ä½•å­˜å‚¨é˜Ÿåˆ—å¤§å°ã€‚å¦‚æœåªä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨é˜Ÿåˆ—çš„å¤§å°ï¼Œé‚£ä¹ˆå¯¹è¯¥å˜é‡çš„æ“ä½œä¼šå½¢æˆä¸´ç•ŒåŒºã€‚ç„¶è€Œå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå˜é‡ï¼šenqueuedå’Œdequeuedï¼Œé‚£ä¹ˆé˜Ÿåˆ—ä¸­æ¶ˆæ¯çš„ä¸ªæ•°ï¼ˆé˜Ÿåˆ—çš„å¤§å°ï¼‰å°±ä¸º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">queue_size = enqueued - dequeued<br></code></pre></div></td></tr></table></figure><p>å¹¶ä¸”ï¼Œå”¯ä¸€èƒ½å¤Ÿæ›´æ–°dequeuedçš„çº¿ç¨‹æ˜¯æ¶ˆæ¯é˜Ÿåˆ—çš„æ‹¥æœ‰è€…ã€‚å¯ä»¥çœ‹åˆ°åœ¨ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨enqueuedè®¡ç®—é˜Ÿåˆ—å¤§å°queue_sizeçš„åŒæ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ›´æ–°enqueuedã€‚ä¸ºäº†è§£é‡Šè¿™ç§æƒ…å†µï¼Œå‡å¦‚è¿›ç¨‹qæ­£åœ¨è®¡ç®—queue_sizeï¼Œé‚£ä¹ˆå®ƒå°†å¯èƒ½å¾—åˆ°enqueuedæ–°çš„æˆ–è€…æ—§çš„å€¼ã€‚å½“queue_sizeå®é™…å€¼æ˜¯1æˆ–è€…2æ—¶ï¼Œçº¿ç¨‹qå¯èƒ½ä¼šå¾—åˆ°queue_sizeæ˜¯0æˆ–è€…1ã€‚ä½†è¿™åªä¼šå¼•èµ·ç¨‹åºä¸€å®šçš„å»¶è¿Ÿï¼Œè€Œä¸ä¼šå¼•èµ·ç¨‹åºé”™è¯¯ã€‚å¦‚æœqueue_sizeæœ¬åº”è¯¥æ˜¯1ï¼Œå´è¯¯è®¡ç®—ä¸º0ï¼Œé‚£ä¹ˆçº¿ç¨‹qå»¶è¿Ÿä¸€æ®µæ—¶é—´åä¼šè¯•å›¾é‡æ–°è®¡ç®—é˜Ÿåˆ—çš„å¤§å°ï¼›å¦‚æœqueue_sizeæœ¬åº”è¯¥æ˜¯2ï¼Œå´è¯¯è®¡ç®—ä¸º1ï¼Œé‚£ä¹ˆçº¿ç¨‹qå°†æ‰§è¡Œä¸´ç•ŒåŒºæŒ‡ä»¤ï¼Œè™½ç„¶è¿™æœ¬æ¥æ˜¯ä¸å¿…è¦çš„ã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼å®ç°Try_receive:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">queue_size = enqueued - dequeued;<br><span class="hljs-keyword">if</span>(queue_size == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(queue_size == <span class="hljs-number">1</span>)<br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp critical</span><br>    <span class="hljs-built_in">Dequeue</span>(queue,&amp;src,&amp;mesg);<br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">Dequeue</span>(queue,&amp;src,&amp;mesg);<br><span class="hljs-built_in">Print_message</span>(src,mesg);<br></code></pre></div></td></tr></table></figure><h3 id="5-ç»ˆæ­¢æ£€æµ‹"><a href="#5-ç»ˆæ­¢æ£€æµ‹" class="headerlink" title="5.ç»ˆæ­¢æ£€æµ‹"></a>5.ç»ˆæ­¢æ£€æµ‹</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¢è®¨å¦‚ä½•å®ç°Doneå‡½æ•°ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªâ€ç›´æ¥â€œçš„å®ç°ï¼Œä½†è¿™ä¸ªå®ç°éšè—ç€é—®é¢˜ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">queue_size = enqueued - dequeued;<br><span class="hljs-keyword">if</span>(queue_size == <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> True;<br><span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">return</span> False;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœçº¿ç¨‹uæ‰§è¡Œè¿™æ®µä»£ç ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½æœ‰äº›çº¿ç¨‹ï¼Œå¦‚çº¿ç¨‹vï¼Œåœ¨çº¿ç¨‹uè®¡ç®—å‡ºqueue_size &#x3D; 0åå‘çº¿ç¨‹uå‘é€ä¸€æ¡æ¶ˆæ¯ã€‚å½“ç„¶ï¼Œçº¿ç¨‹uåœ¨å¾—å‡ºqueue_size &#x3D; 0åå°†ç»ˆæ­¢ï¼Œé‚£ä¹ˆçº¿ç¨‹vå‘é€ç»™å®ƒçš„æ¶ˆæ¯å°±æ°¸è¿œä¸ä¼šè¢«æ¥å—åˆ°ã€‚</p><p>ç„¶è€Œï¼Œåœ¨æˆ‘ä»¬ç¨‹åºä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå®Œforå¾ªç¯åå°†ä¸å†å‘é€ä»»ä½•æ¶ˆæ¯ã€‚å› æ­¤å¯ä»¥å¢åŠ ä¸€ä¸ªè®¡æ•°å™¨done_sendingï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨forå¾ªç¯ç»“æŸåå°†è¯¥è®¡æ•°å™¨åŠ 1ï¼ŒDoneçš„å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">queue_size = enqueued - dequeued;<br><span class="hljs-keyword">if</span>(queue_size == <span class="hljs-number">0</span> &amp;&amp; done_sending == thread_count)<br>    <span class="hljs-keyword">return</span> TRUE;<br><span class="hljs-keyword">else</span><br>    rerun FALSE;<br></code></pre></div></td></tr></table></figure><h3 id="6-å¯åŠ¨"><a href="#6-å¯åŠ¨" class="headerlink" title="6.å¯åŠ¨"></a>6.å¯åŠ¨</h3><p>å½“ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ï¼Œä¸»çº¿ç¨‹å°†å¾—åˆ°å‘½ä»¤è¡Œå‚æ•°å¹¶ä¸”åˆ†é…ä¸€ä¸ªæ•°ç»„ç©ºé—´ç»™æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹åº”ç€ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ã€‚ç”±äºæ¯ä¸ªçº¿ç¨‹å¯ä»¥å‘å…¶ä»–ä»»æ„çš„ä¸‹æ¬¡çº¿ç¨‹å‘é€æ¶ˆæ¯ï¼Œæ‰€ä»¥è¿™ä¸ªæ•°ç»„åº”è¯¥è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œè€Œä¸”æ¯ä¸ªçº¿ç¨‹å¯ä»¥å‘ä»»ä½•ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æ’å…¥ä¸€æ¡æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆè‡³å°‘ï¼‰å¯ä»¥å­˜å‚¨ï¼š</p><ol><li>æ¶ˆæ¯åˆ—è¡¨</li><li>é˜Ÿå°¾æŒ‡é’ˆæˆ–ç´¢å¼•</li><li>é˜Ÿé¦–æŒ‡é’ˆæˆ–ç´¢å¼•</li><li>å…¥é˜Ÿæ¶ˆæ¯çš„æ•°ç›®</li><li>å‡ºé˜Ÿæ¶ˆæ¯çš„æ•°ç›®</li></ol><p>æœ€å¥½å°†é˜Ÿåˆ—å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—çš„ç»“æ„ä½“ä¸­ï¼Œä¸ºäº†å‡å°‘å‚æ•°ä¼ é€’æ—¶å¤åˆ¶çš„å¼€é”€ï¼Œæœ€å¥½ç”¨æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆæ•°ç»„æ¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€‚å› æ­¤ï¼Œä¸€æ—¦ä¸»çº¿ç¨‹åˆ†é…äº†é˜Ÿåˆ—æ•°ç»„ï¼Œå°±å¯ä»¥ä½¿ç”¨parallelæŒ‡ä»¤å¼€å§‹æ‰§è¡Œçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯ä»¥ä¸ºè‡ªå·±çš„é˜Ÿåˆ—åˆ†é…å­˜å‚¨ç©ºé—´ã€‚</p><p>è¿™é‡Œä¸€ä¸ªé‡è¦çš„é—®é¢˜æ˜¯ï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹å¯èƒ½åœ¨å…¶ä»–çº¿ç¨‹ä¹‹å‰å®Œæˆå®ƒçš„é˜Ÿåˆ—åˆ†é…ã€‚å¦‚æœè¿™ç§æƒ…å†µå‡ºç°äº†ï¼Œé‚£ä¹ˆå®Œæˆåˆ†é…çš„çº¿ç¨‹å¯èƒ½ä¼šè¯•å›¾å¼€å§‹å‘é‚£äº›è¿˜æ²¡æœ‰å®Œæˆé˜Ÿåˆ—åˆ†é…çš„çº¿ç¨‹å‘é€æ¶ˆæ¯ï¼Œè¿™å°†å¯¼è‡´ç¨‹åºå´©æºƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ä»»ä½•ä¸€ä¸ªçº¿ç¨‹éƒ½å¿…é¡»åœ¨æ‰€æœ‰çš„çº¿ç¨‹éƒ½å®Œæˆäº†é˜Ÿåˆ—åˆ†é…åæ‰å¼€å§‹å‘é€æ¶ˆæ¯ã€‚å›æƒ³ä¸€ä¸‹ï¼Œä¹‹å‰æˆ‘ä»¬è§è¿‡ä¸€äº›OpenMPæŒ‡ä»¤åœ¨ç»“æŸæ—¶æä¾›éšå¼è·¯éšœï¼Œå³ä»»ä½•ä¸€ä¸ªçº¿ç¨‹éƒ½å¿…é¡»ç­‰åˆ°ç»„ä¸­æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆäº†æŸä¸ªç¨‹åºå—åæ‰å¯ä»¥æ¥ç€æ‰§è¡Œåç»­ä»£ç ã€‚ç„¶è€Œï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¤„äºparallelå—çš„ä¸­é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä¾èµ–äºOpenMPæä¾›çš„éšå¼è·¯éšœâ€”â€”æˆ‘ä»¬åº”å½“ä½¿ç”¨æ˜¾å¼è·¯éšœã€‚å¹¸è¿çš„æ˜¯ï¼ŒOpenMPæä¾›äº†ç›¸åº”çš„æŒ‡ä»¤ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp barrier</span><br></code></pre></div></td></tr></table></figure><p>å½“çº¿ç¨‹é‡åˆ°è·¯éšœæ—¶ï¼Œå®ƒå°†è¢«é˜»å¡ï¼Œç›´åˆ°ç»„ä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½åˆ°è¾¾äº†è¿™ä¸ªè·¯éšœã€‚å½“ç»„ä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½åˆ°è¾¾äº†è¿™ä¸ªè·¯éšœæ—¶ï¼Œè¿™äº›çº¿ç¨‹å°±å¯ä»¥æ¥ç€å¾€ä¸‹æ‰§è¡Œã€‚</p><h3 id="7-atomicæŒ‡ä»¤"><a href="#7-atomicæŒ‡ä»¤" class="headerlink" title="7.atomicæŒ‡ä»¤"></a>7.atomicæŒ‡ä»¤</h3><p>å‘é€å®Œæ‰€æœ‰çš„æ¶ˆæ¯åï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œæœ€åçš„å¾ªç¯ä»¥ä¾¿æ¥å—æ¶ˆæ¯ä¹‹å‰ï¼Œéœ€è¦å¯¹done_sendingåŠ 1.æ˜¾ç„¶ï¼Œå¯¹done_sendingçš„å¢é‡æ“ä½œæ˜¯ä¸´ç•ŒåŒºï¼Œå¯ä»¥é€šè¿‡criticalæŒ‡ä»¤æ¥ä¿æŠ¤å®ƒã€‚ç„¶åï¼ŒOpenMPæä¾›äº†å¦å¤–ä¸€ç§å¯èƒ½æ›´åŠ é«˜æ•ˆçš„æŒ‡ä»¤ï¼šatomicæŒ‡ä»¤ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp atomic</span><br></code></pre></div></td></tr></table></figure><p>ä¸criticalæŒ‡ä»¤ä¸åŒï¼Œå®ƒåªèƒ½ä¿æŠ¤ç”±ä¸€æ¡Cè¯­è¨€èµ‹å€¼è¯­å¥æ‰€å½¢æˆçš„ä¸´ç•ŒåŒºã€‚æ­¤å¤–ï¼Œè¯­å¥å¿…é¡»æ˜¯ä¸€ä¸‹å‡ ç§å½¢å¼ä¹‹ä¸€ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">x &lt;op&gt; = &lt;expression&gt;<br>x++;<br>++x;<br>x--;<br>--x;<br></code></pre></div></td></tr></table></figure><p><op>å¯ä»¥æ˜¯ä»¥ä¸‹ä»»æ„çš„äºŒå…ƒæ“ä½œç¬¦ï¼š</op></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">+,*,-,/,&amp;,|,^,&lt;&lt;,<span class="hljs-keyword">or</span> &gt;&gt;<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œè¦è®°ä½ï¼Œ<expression>ä¸èƒ½å¼•ç”¨xã€‚</expression></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰xçš„è£…è½½å’Œå­˜å‚¨å¯ä»¥ç¡®ä¿æ˜¯å—ä¿æŠ¤çš„ï¼Œä¾‹å¦‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp atomic</span><br>x += y++;<br></code></pre></div></td></tr></table></figure><p>å…¶ä»–çº¿ç¨‹å¯¹xçš„æ›´æ–°å¿…é¡»ç­‰åˆ°è¯¥çº¿ç¨‹å¯¹xçš„æ›´æ–°ç»“æŸä¹‹åã€‚ä½†æ˜¯å¯¹yçš„æ›´æ–°ä¸å—ä¿æŠ¤ï¼Œå› æ­¤ç¨‹åºçš„ç»“æœæ˜¯ä¸å¯é¢„æµ‹çš„ã€‚</p><p>atomicæŒ‡ä»¤çš„æ€æƒ³æ˜¯è®¸å¤šå¤„ç†å™¨æä¾›ä¸“é—¨çš„è£…è½½-ä¿®æ”¹-å­˜å‚¨(load-modify-store)æŒ‡ä»¤ã€‚ä½¿ç”¨è¿™ç§ä¸“é—¨çš„æŒ‡ä»¤è€Œä¸ä½¿ç”¨ä¿æŠ¤ä¸´ç•ŒåŒºçš„é€šç”¨ç»“æ„ï¼Œå¯ä»¥æ›´é«˜æ•ˆåœ°ä¿æŠ¤ä¸´ç•ŒåŒºã€‚</p><h3 id="8-ä¸´ç•ŒåŒºå’Œé”"><a href="#8-ä¸´ç•ŒåŒºå’Œé”" class="headerlink" title="8.ä¸´ç•ŒåŒºå’Œé”"></a>8.ä¸´ç•ŒåŒºå’Œé”</h3><p>ä¸ºäº†å®Œæˆå¯¹æ¶ˆæ¯ä¼ é€’ç¨‹åºçš„è®¨è®ºï¼Œæˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥ä»”ç»†ç ”ç©¶OpenMP criticalæŒ‡ä»¤çš„è§„èŒƒã€‚åœ¨æ›´æ—©çš„ä¾‹å­ä¸­ï¼Œç¨‹åºæœ€å¤šåªæœ‰ä¸€ä¸ªä¸´ç•ŒåŒºï¼ŒcriticalæŒ‡ä»¤å¼ºåˆ¶æ‰€æœ‰çš„çº¿ç¨‹å¯¹è¯¥åŒºåŸŸè¿›è¡Œäº’æ–¥è®¿é—®ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œä¸´ç•ŒåŒºçš„ä½¿ç”¨å°†æ›´åŠ å¤æ‚ã€‚æˆ‘ä»¬å°†åœ¨æºä»£ç ä¸­çœ‹åˆ°3ä¸ªåœ¨criticalæˆ–atomicæŒ‡ä»¤åé¢çš„ä»£ç å—ï¼š</p><ol><li>done_sending++</li><li>Enqueue(q_p,my_rank,mesg);</li><li>Dequeue(q_p,&amp;src,&amp;mesg);</li></ol><p>ç„¶è€Œï¼Œæˆ‘ä»¬ä¸éœ€è¦å¼ºåˆ¶å¯¹3ä¸ªä»£ç å—éƒ½è¿›è¡Œäº’æ–¥è®¿é—®ï¼Œç”šè‡³ä¸éœ€è¦å¼ºåˆ¶å¯¹ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªä»£ç å—è¿›è¡Œå®Œå…¨çš„äº’æ–¥è®¿é—®ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹0åœ¨å‘çº¿ç¨‹1çš„æ¶ˆæ¯é˜Ÿåˆ—å†™æ¶ˆæ¯çš„åŒæ—¶ï¼Œçº¿ç¨‹1å¯ä»¥å‘çº¿ç¨‹2çš„æ¶ˆæ¯é˜Ÿåˆ—å†™æ¶ˆæ¯ã€‚ä½†æ˜¯OpenMPçš„è§„å®šç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªä»£ç å—æ˜¯è¢«criticalæŒ‡ä»¤ä¿æŠ¤çš„ä»£ç å—ã€‚åœ¨OpenMPçœ‹æ¥ï¼Œæˆ‘ä»¬çš„ç¨‹åºæœ‰ä¸¤ä¸ªä¸åŒçš„ä¸´ç•ŒåŒºï¼›è¢«atomicæŒ‡ä»¤ä¿æŠ¤çš„done_sending++å’Œâ€œå¤åˆâ€ä¸´ç•ŒåŒºã€‚åœ¨â€œå¤åˆâ€ä¸´ç•ŒåŒºä¸­ï¼Œç¨‹åºè¯»å–å’Œå‘é€æ¶ˆæ¯ã€‚</p><p>å¼ºåˆ¶çº¿ç¨‹é—´çš„äº’æ–¥ä¼šä½¿ç¨‹åºçš„æ‰§è¡Œä¸²è¡ŒåŒ–ã€‚OpenMPé»˜è®¤çš„åšæ³•æ˜¯å°†æ‰€æœ‰çš„ä¸´ç•ŒåŒºä»£ç å—ä½œä¸ºå¤åˆä¸´ç•ŒåŒºçš„ä¸€éƒ¨åˆ†ï¼Œè¿™å¯èƒ½éå¸¸ä¸åˆ©äºç¨‹åºçš„æ€§èƒ½ã€‚OpenMPæä¾›äº†å‘criticalæŒ‡ä»¤æ·»åŠ åå­—çš„é€‰é¡¹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp critical(name)</span><br></code></pre></div></td></tr></table></figure><p>é‡‡å–è¿™ç§æ–¹å¼ï¼Œä¸¤ä¸ªç”¨ä¸åŒåå­—çš„criticalæŒ‡ä»¤ä¿æŠ¤çš„ä»£ç å—å°±å¯ä»¥åŒæ—¶æ‰§è¡Œã€‚æˆ‘ä»¬æƒ³ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸´ç•ŒåŒºæä¾›ä¸åŒçš„åå­—ï¼Œä½†æ˜¯ä¸´ç•ŒåŒºçš„åå­—æ˜¯åœ¨ç¨‹åºç¼–è¯‘è¿‡ç¨‹ä¸­è®¾ç½®çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­è®¾ç½®ä¸´ç•ŒåŒºçš„åå­—ã€‚ä½†æ˜¯æŒ‰ç…§ä¸ºæˆ‘ä»¬çš„è®¾ç½®ï¼Œå½“æˆ‘ä»¬æƒ³è®©è®¿é—®ä¸åŒé˜Ÿåˆ—çš„çº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ç›¸åŒçš„ä»£ç å—æ—¶ï¼Œè¢«å‘½åçš„criticalæŒ‡ä»¤å°±ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚äº†ã€‚</p><p>è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨é”ï¼ˆlockï¼‰ã€‚é”ç”±ä¸€ä¸ªæ•°æ®ç»“æ„å’Œå®šä¹‰åœ¨è¿™ä¸ªæ•°æ®ç»“æ„ä¸Šçš„å‡½æ•°ç»„æˆï¼Œè¿™äº›å‡½æ•°ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥æ˜¾å¼åœ°å¼ºåˆ¶å¯¹ä¸´ç•ŒåŒºè¿›è¡Œäº’æ–¥è®¿é—®ã€‚é”çš„ä½¿ç”¨å¯ä»¥å¤§æ¦‚ç”¨ä¸‹é¢çš„ä¼ªä»£ç æè¿°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">/*Executed by one thread*/</span><br>initialize the lock data structure;<br>...<br><span class="hljs-comment">/*Executed by multiple threads*/</span><br>Attempt to lock <span class="hljs-keyword">or</span> set the lock data structure;<br>Critical section;<br>Unlock <span class="hljs-keyword">or</span> unset the lock data structure;<br>...<br><span class="hljs-comment">/*Executed by one thread*/</span><br>Destory the lock data structure;<br></code></pre></div></td></tr></table></figure><p>é”çš„æ•°æ®ç»“æ„è¢«æ‰§è¡Œä¸´ç•ŒåŒºçš„çº¿ç¨‹æ‰€å…±äº«ï¼Œè¿™äº›çº¿ç¨‹ä¸­çš„æŸä¸ªçº¿ç¨‹ï¼ˆå¦‚ä¸»çº¿ç¨‹ï¼‰ä¼šåˆå§‹åŒ–é”ã€‚è€Œå½“æ‰€æœ‰çš„çº¿ç¨‹éƒ½ä½¿ç”¨å®Œé”åï¼ŒæŸä¸ªçº¿ç¨‹åº”å½“è´Ÿè´£é”€æ¯é”ã€‚</p><p>åœ¨ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºå‰ï¼Œå®ƒå°è¯•é€šè¿‡è°ƒç”¨é”å‡½æ•°æ¥ä¸Šé”ï¼ˆsetï¼‰ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–çš„çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—é”å¹¶è¿›å…¥ä¸´ç•ŒåŒºã€‚å½“è¯¥çº¿ç¨‹æ‰§è¡Œå®Œä¸´ç•ŒåŒºä»£ç åï¼Œå®ƒè°ƒç”¨è§£é”å‡½æ•°é‡Šæ”¾ï¼ˆrelinquishæˆ–è€…unsetï¼‰é”ï¼Œä»¥ä¾¿å…¶ä»–çº¿ç¨‹å¯ä»¥è·å¾—é”ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰é”æ—¶ï¼Œå…¶ä»–çº¿ç¨‹éƒ½ä¸èƒ½è¿›å…¥è¯¥ä¸´ç•ŒåŒºã€‚å…¶ä»–çº¿ç¨‹å°è¯•é€šè¿‡è°ƒç”¨é”å‡½æ•°è¿›å…¥è¯¥ä¸´ç•ŒåŒºæ—¶ä¼šé˜»å¡ã€‚å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹è¢«é”å‡½æ•°é˜»å¡ï¼Œåˆ™å½“ä¸´ç•ŒåŒºçš„çº¿ç¨‹é‡Šæ”¾é”æ—¶ï¼Œè¿™äº›çº¿ç¨‹ä¸­çš„æŸä¸ªçº¿ç¨‹ä¼šè·å¾—é”ï¼Œè€Œå…¶ä»–çº¿ç¨‹ä»è¢«é˜»å¡ã€‚</p><p>OpenMPæœ‰ä¸¤ç§é”ï¼šç®€å•ï¼ˆsimpleï¼‰é”å’ŒåµŒå¥—ï¼ˆnestedï¼‰é”ã€‚ç®€å•é”åœ¨è¢«é‡Šæ”¾å‰åªèƒ½è·å¾—ä¸€æ¬¡ï¼Œè€Œä¸€ä¸ªåµŒå¥—é”åœ¨è¢«é‡Šæ”¾å‰å¯ä»¥è¢«åŒä¸€ä¸ªçº¿ç¨‹è·å¾—å¤šæ¬¡ã€‚OpenMPç®€å•é”çš„ç±»å‹æ˜¯omp_lock_tï¼Œå®šä¹‰ç®€å•é”çš„å‡½æ•°åŒ…æ‹¬ï¼š</p><p><img src="/2023/01/14/openmp006/image-20230116165204803.png" alt="image-20230116165204803"></p><p>ç›¸å…³çš„ç±»å‹å’Œå‡½æ•°åœ¨å¤´æ–‡ä»¶omp.hä¸­å£°æ˜ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°çš„ä½œä¸ºæ˜¯åˆå§‹åŒ–é”ï¼Œæ‰€ä»¥æ­¤æ—¶é”å¤„äºè§£é”çŠ¶æ€ï¼Œæ¢å¥è¯è¯´ï¼Œæ­¤æ—¶æ²¡æœ‰çº¿ç¨‹æ‹¥æœ‰è¿™ä¸ªé”ã€‚ç¬¬äºŒä¸ªå‡½æ•°å°è¯•è·å¾—é”ï¼Œå¦‚æœæˆåŠŸï¼Œè°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œï¼›å¦‚æœå¤±è´¥ï¼Œè°ƒç”¨è¯¥å‡½æ•°çš„çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°é”è¢«å…¶ä»–çº¿ç¨‹é‡Šæ”¾ã€‚ç¬¬ä¸‰ä¸ªå‡½æ•°é‡Šæ”¾é”ï¼Œä»¥ä¾¿å…¶ä»–çº¿ç¨‹å¯ä»¥è·å¾—è¯¥é”ã€‚ç¬¬å››ä¸ªå‡½æ•°é”€æ¯é”ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMPå¾ªç¯è°ƒåº¦</title>
    <link href="/2023/01/14/openmp005/"/>
    <url>/2023/01/14/openmp005/</url>
    
    <content type="html"><![CDATA[<h2 id="OpenMPå¾ªç¯è°ƒåº¦"><a href="#OpenMPå¾ªç¯è°ƒåº¦" class="headerlink" title="OpenMPå¾ªç¯è°ƒåº¦"></a>OpenMPå¾ªç¯è°ƒåº¦</h2><h3 id="1-å¾ªç¯è°ƒåº¦"><a href="#1-å¾ªç¯è°ƒåº¦" class="headerlink" title="1.å¾ªç¯è°ƒåº¦"></a>1.å¾ªç¯è°ƒåº¦</h3><p>å½“ç¬¬ä¸€æ¬¡é‡åˆ°parallel foræŒ‡ä»¤æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°å°†å„æ¬¡å¾ªç¯åˆ†é…ç»™çº¿ç¨‹çš„æ“ä½œæ˜¯ç”±ç³»ç»Ÿå®Œæˆçš„ã€‚ç„¶è€Œï¼Œå¤§éƒ¨åˆ†OpenMPå®ç°åªæ˜¯ç²—ç•¥åœ°ä½¿ç”¨å—åˆ†å‰²ï¼šå¦‚æœåœ¨ä¸²è¡Œå¾ªç¯ä¸­æœ‰næ¬¡è¿­ä»£ï¼Œé‚£ä¹ˆåœ¨å¹¶è¡Œå¾ªç¯ä¸­ï¼Œå‰n&#x2F;thread_countä¸ªè¿­ä»£åˆ†é…ç»™çº¿ç¨‹0ï¼Œæ¥ä¸‹æ¥çš„n&#x2F;thread_countä¸ªè¿­ä»£åˆ†é…ç»™çº¿ç¨‹1ï¼Œä¾æ­¤ç±»æ¨ã€‚ä¸éš¾æƒ³åˆ°ï¼Œè¿™ç§åˆ†é…æ–¹å¼è‚¯å®šä¸æ˜¯æœ€ä¼˜çš„ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬æƒ³è¦å¹¶è¡ŒåŒ–å¾ªç¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">sum = <span class="hljs-number">0.0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=n;i++)<br>    sum+=<span class="hljs-built_in">f</span>(i);<br></code></pre></div></td></tr></table></figure><p>åŒæ—¶ï¼Œå‡è®¾å¯¹få‡½æ•°è°ƒç”¨æ‰€éœ€è¦çš„æ—¶é—´ä¸å‚æ•°içš„å¤§å°æˆæ­£æ¯”ï¼Œé‚£ä¹ˆä¸åˆ†é…ç»™çº¿ç¨‹0çš„å·¥ä½œç›¸æ¯”ï¼Œåˆ†é…ç»™çº¿ç¨‹thread_count-1çš„å·¥ä½œé‡ç›¸å¯¹è¾ƒå¤§ã€‚ä¸€ä¸ªæ›´å¥½çš„åˆ†é…æ–¹æ¡ˆæ˜¯è½®æµåˆ†é…çº¿ç¨‹çš„å·¥ä½œï¼ˆå¾ªç¯åˆ’åˆ†ï¼‰ã€‚åœ¨å¾ªç¯åˆ’åˆ†ä¸­ï¼Œå„æ¬¡è¿­ä»£è¢«â€œè½®æµâ€åœ°ä¸€æ¬¡ä¸€ä¸ªåœ°åˆ†é…ç»™çº¿ç¨‹ã€‚å‡å¦‚ t&#x3D;thread_countã€‚é‚£ä¹ˆä¸€ä¸ªå¾ªç¯åˆ’åˆ†å°†å¦‚ä¸‹åˆ†é…å„æ¬¡è¿­ä»£ï¼š</p><p><img src="/2023/01/14/openmp005/image-20230114132246596.png" alt="image-20230114132246596"></p><p>ä¸ºäº†äº†è§£è¿™æ ·åˆ†é…æ˜¯å¦‚ä½•å½±å“æ€§èƒ½çš„ï¼Œæˆ‘ä»¬ç¼–å†™äº†å¦‚ä¸‹ç¨‹åºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> j,start=i*(i+<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>,finish=start+i;<br>    <span class="hljs-keyword">double</span> return_val = <span class="hljs-number">0.0</span>;<br>    <br>    <span class="hljs-keyword">for</span>(j = start; j&lt;=finish; j++)&#123;<br>        return_val += <span class="hljs-built_in">sin</span>(j);<br>    &#125;<br>    <span class="hljs-keyword">return</span> return_val;<br>    <span class="hljs-comment">/* f */</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ¯å½“å‡½æ•°fï¼ˆiï¼‰è°ƒç”¨iæ¬¡sinå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œæ‰§è¡Œfï¼ˆ2iï¼‰çš„æ—¶é—´å‡ ä¹æ˜¯æ‰§è¡Œfï¼ˆiï¼‰çš„æ—¶é—´çš„ä¸¤å€ã€‚</p><p>å½“n&#x3D;10000å¹¶ä¸”åªç”¨ä¸€ä¸ªçº¿ç¨‹è¿è¡Œç¨‹åºæ—¶ï¼Œè¿è¡Œæ—¶é—´æ˜¯3.67ç§’ã€‚å½“ç”¨ä¸¤ä¸ªçº¿ç¨‹å’Œç¼ºçœåˆ†é…æ–¹å¼ï¼ˆç¬¬0-5000æ¬¡è¿­ä»£åˆ†é…ç»™çº¿ç¨‹0ï¼Œç¬¬5001-10000æ¬¡è¿­ä»£åˆ†é…ç»™çº¿ç¨‹1ï¼‰ï¼Œè¿è¡Œç¨‹åºæ—¶ï¼Œè¿è¡Œæ—¶é—´ä¸º2.76ç§’ã€‚åŠ é€Ÿæ¯”ä»…ä¸º1.33.ç„¶è€Œï¼Œå½“è¿è¡Œä¸¤ä¸ªçº¿ç¨‹å¹¶é‡‡ç”¨å¾ªç¯åˆ’åˆ†æ—¶ï¼Œè¿è¡Œæ—¶é—´å‡å°‘åˆ°1.84ç§’ã€‚ä¸å•çº¿ç¨‹è¿è¡Œç›¸æ¯”ï¼ŒåŠ é€Ÿæ¯”ä¸º1.99ï¼›ä¸åŒçº¿ç¨‹ï¼Œå—åˆ†å‰²ç›¸æ¯”ï¼ŒåŠ é€Ÿæ¯”ä¸º1.5ï¼</p><p>æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå¥½çš„è¿­ä»£åˆ†é…èƒ½å¤Ÿå¯¹æ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ã€‚å†OpenMPä¸­ï¼Œå°†å¾ªç¯åˆ†é…ç»™çº¿ç¨‹ç§°ä¸ºè°ƒåº¦ï¼Œscheduleå­å¥ç”¨äºåœ¨parallel foræˆ–è€…foræŒ‡ä»¤ä¸­è¿›è¡Œè¿­ä»£åˆ†é…ã€‚</p><h3 id="2-scheduleå­å¥"><a href="#2-scheduleå­å¥" class="headerlink" title="2.scheduleå­å¥"></a>2.scheduleå­å¥</h3><p>åœ¨ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ä¹è·å–ç¼ºçœè°ƒåº¦ï¼šåªéœ€è¦æ·»åŠ parallel foræŒ‡ä»¤å’Œreductionå­å¥ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">sum=<span class="hljs-number">0.0</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) reduction(+:sum)</span><br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=n;i++)&#123;<br>    sum+=<span class="hljs-built_in">f</span>(i);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸ºäº†å¯¹çº¿ç¨‹è¿›è¡Œè°ƒåº¦ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªscheduleå­å¥åˆ°parallel foræŒ‡ä»¤ä¸­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">sum=<span class="hljs-number">0.0</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) reduction(+:sum)schedule(static,1)</span><br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=n;i++)&#123;<br>    sum+=<span class="hljs-built_in">f</span>(i);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸€èˆ¬è€Œè¨€ï¼Œscheduleå­å¥æœ‰å¦‚ä¸‹å½¢å¼ï¼š</p><p>scheduleï¼ˆ<type>[.<chunksize>]ï¼‰</chunksize></type></p><p>typeå¯ä»¥æ˜¯ä¸‹åˆ—ä»»æ„ä¸€ä¸ªï¼š</p><ol><li>staticï¼šè¿­ä»£èƒ½å¤Ÿåœ¨å¾ªç¯æ‰§è¡Œå‰åˆ†é…ç»™çº¿ç¨‹</li><li>dynamicæˆ–guidedï¼šè¿­ä»£åœ¨å¾ªç¯æ‰§è¡Œæ—¶è¢«åˆ†é…ç»™çº¿ç¨‹ï¼Œå› æ­¤åœ¨ä¸€ä¸ªçº¿ç¨‹å®Œæˆäº†å®ƒçš„å½“å‰è¿­ä»£é›†åˆåï¼Œå®ƒèƒ½ä»è¿è¡Œæ—¶ç³»ç»Ÿä¸­è¯·æ±‚æ›´å¤š</li><li>autoï¼šç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ç³»ç»Ÿå†³å®šè°ƒåº¦æ–¹å¼</li><li>runtimeï¼šè°ƒåº¦åœ¨è¿è¡Œæ—¶å†³å®š</li></ol><p>chunksizeæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚åœ¨OpenMPä¸­ï¼Œè¿­ä»£å—æ˜¯åœ¨é¡ºåºå¾ªç¯ä¸­è¿ç»­æ‰§è¡Œçš„ä¸€å—è¿­ä»£è¯­å¥ï¼Œå—ä¸­çš„è¿­ä»£æ¬¡æ•°æ˜¯chunksizeã€‚åªæœ‰staticï¼Œdynamicå’Œguidedè°ƒåº¦æœ‰chunksizeã€‚è¿™è™½ç„¶å†³å®šäº†è°ƒåº¦çš„ç»†èŠ‚ï¼Œä½†å‡†ç¡®çš„è§£é‡Šè¿˜æ˜¯ä¾èµ–äºtypeã€‚</p><h3 id="3-stasticè°ƒåº¦ç±»å‹"><a href="#3-stasticè°ƒåº¦ç±»å‹" class="headerlink" title="3.stasticè°ƒåº¦ç±»å‹"></a>3.stasticè°ƒåº¦ç±»å‹</h3><p>å¯¹äºstaticè°ƒåº¦ï¼Œç³»ç»Ÿä»¥è½®è½¬çš„æ–¹å¼åˆ†é…chunksizeå—ä¸ªè¿­ä»£ç»™æ¯ä¸ªçº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚æœ‰12ä¸ªè¿­ä»£ï¼Œ0ï¼Œ1ï¼Œâ€”ï¼Œ11å’Œ3ä¸ªçº¿ç¨‹ï¼Œå¦‚æœåœ¨parallel foræˆ–foræŒ‡ä»¤ä¸­ä½¿ç”¨scheduleï¼ˆstaticï¼Œ1ï¼‰è¿­ä»£å°†å¦‚ä¸‹åˆ†é…ï¼š</p><p><img src="/2023/01/14/openmp005/image-20230114141741424.png" alt="image-20230114141741424"></p><p>å¦‚æœä½¿ç”¨scheduleï¼ˆstaticï¼Œ2ï¼‰ï¼Œè¿­ä»£å°†å¦‚ä¸‹è¿›è¡Œåˆ†é…ï¼š</p><p><img src="/2023/01/14/openmp005/image-20230114141830866.png" alt="image-20230114141830866"></p><p>å¦‚æœä½¿ç”¨scheduleï¼ˆstaticï¼Œ4ï¼‰ï¼Œè¿­ä»£å°†å¦‚ä¸‹åˆ†é…ï¼š</p><p><img src="/2023/01/14/openmp005/image-20230114141909092.png" alt="image-20230114141909092"></p><p>å› æ­¤ï¼Œå­å¥scheduleï¼ˆstatic,total_iterations&#x2F;thread_countï¼‰å°±ç›¸å½“äºè¢«å¤§éƒ¨åˆ†OpenMPå®ç°æ‰€ä½¿ç”¨çš„ç¼ºçœè°ƒåº¦ã€‚</p><p>è¿™é‡Œï¼Œchunksizeå¯ä»¥è¢«å¿½ç•¥ã€‚å¦‚æœä»–è¢«å¿½ç•¥äº†ï¼Œchunksizeå°±è¿‘ä¼¼ç­‰äºtotal_iterations&#x2F;thread_countã€‚</p><h3 id="4-dynamicå’Œguidedè°ƒåº¦ç±»å‹"><a href="#4-dynamicå’Œguidedè°ƒåº¦ç±»å‹" class="headerlink" title="4.dynamicå’Œguidedè°ƒåº¦ç±»å‹"></a>4.dynamicå’Œguidedè°ƒåº¦ç±»å‹</h3><p>åœ¨dynamicè°ƒåº¦ä¸­ï¼Œè¿­ä»£ä¹Ÿè¢«åˆ†æˆchunksizeä¸ªè¿ç»­è¿­ä»£çš„å—ã€‚æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€å—ï¼Œå¹¶ä¸”å½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆä¸€å—æ—¶ï¼Œå®ƒå°†ä»è¿è¡Œæ—¶ç³»ç»Ÿè¯·æ±‚å¦ä¸€å—ï¼Œç›´åˆ°æ‰€æœ‰çš„è¿­ä»£å®Œæˆã€‚chunksizeå¯ä»¥è¢«å¿½ç•¥ã€‚å½“å®ƒè¢«å¿½ç•¥æ—¶ï¼Œchunksizeä¸º1ã€‚</p><p>åœ¨guidedè°ƒåº¦ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹ä¹Ÿæ‰§è¡Œä¸€å—ï¼Œå¹¶ä¸”å½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆä¸€å—æ—¶ï¼Œå°†è¯·æ±‚å¦ä¸€å—ã€‚ç„¶è€Œï¼Œåœ¨guidedè°ƒåº¦ä¸­ï¼Œå½“å—å®Œæˆåï¼Œæ–°å—çš„å¤§å°ä¼šå˜å°ã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœç”¨parallel foræŒ‡ä»¤å’Œscheduleï¼ˆguidedï¼‰å­å¥æ¥è¿è¡Œæ¢¯å½¢ç§¯åˆ†æ³•ç¨‹åºï¼Œé‚£ä¹ˆå½“n&#x3D;10000å¹¶ä¸”thread_count&#x3D;2æ—¶ã€‚è¿­ä»£å°†å¦‚è¡¨5-3é‚£æ ·åˆ†é…ã€‚å—çš„å¤§å°è¿‘ä¼¼ç­‰äºå‰©ä¸‹çš„è¿­ä»£æ•°é™¤ä»¥çº¿ç¨‹æ•°ã€‚ç¬¬ä¸€ä¸ªå—çš„å¤§å°9999&#x2F;2â‰ˆ5000ï¼Œå› ä¸ºæœ‰9999ä¸ªè¿­ä»£æœªè¢«åˆ†é…çš„è¿­ä»£ã€‚ç¬¬äºŒä¸ªå—çš„å¤§å°ä¸º4999&#x2F;2â‰ˆ2500ï¼Œä¸€æ¬¡ç±»æ¨ã€‚</p><p><img src="/2023/01/14/openmp005/image-20230114143233692.png" alt="image-20230114143233692"></p><p>åœ¨guidedè°ƒåº¦ä¸­ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šchunksizeï¼Œé‚£ä¹ˆå—çš„å¤§å°ä¸º1ï¼›å¦‚æœæŒ‡å®šäº†chunksizeï¼Œé‚£ä¹ˆå—çš„å¤§å°å°±æ˜¯chunksizeï¼Œé™¤äº†æœ€åä¸€å—çš„å¤§å°å¯ä»¥æ¯”chunksizeå°ã€‚</p><h3 id="5-runtimeè°ƒåº¦ç±»å‹"><a href="#5-runtimeè°ƒåº¦ç±»å‹" class="headerlink" title="5.runtimeè°ƒåº¦ç±»å‹"></a>5.runtimeè°ƒåº¦ç±»å‹</h3><p>ä¸ºäº†ç†è§£scheduleï¼ˆruntimeï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ç¦»é¢˜ä¸€ä¼šå„¿ï¼Œè®¨è®ºä¸€ä¸‹ç¯å¢ƒå˜é‡ã€‚æ­£å¦‚åå­—æ‰€æš—ç¤ºçš„ï¼Œç¯å¢ƒå˜é‡æ˜¯èƒ½å¤Ÿè¢«è¿è¡Œæ—¶ç³»ç»Ÿæ‰€è®¿é—®çš„å‘½åå€¼ï¼Œå³å®ƒä»¬åœ¨ç¨‹åºçš„ç¯å¢ƒä¸­æ˜¯å¯å¾—çš„ã€‚ä¸€äº›ç»å¸¸è¢«ä½¿ç”¨çš„ç¯å¢ƒå˜é‡æ˜¯PATH,HOMEå’ŒSHELLã€‚PATHå˜é‡æ˜ç¡®äº†å½“å¯»æ‰¾ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æ—¶shellåº”è¯¥æœç´¢å“ªäº›ç›®å½•ã€‚å®ƒé€šå¸¸åœ¨UNIXå’ŒWindowsç³»ç»Ÿä¸­å®šä¹‰ã€‚HOMEå˜é‡æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•çš„ä½ç½®ï¼Œè€ŒSHELLå˜é‡æŒ‡å®šç”¨æˆ·shellçš„å¯æ‰§è¡Œä½ç½®ã€‚è¿™æ ·é€šå¸¸åœ¨UNIXç³»ç»Ÿä¸­ã€‚åœ¨ç±»UNIXç³»ç»Ÿï¼ˆä¾‹å¦‚Linuxå’ŒMac OS Xï¼‰å’ŒWindowsï¼Œç¯å¢ƒå˜é‡èƒ½å¤Ÿåœ¨å‘½ä»¤è¡Œä¸­æ£€æŸ¥å’ŒæŒ‡å®šã€‚åœ¨ç±»UNIXç³»ç»Ÿä¸­ï¼Œèƒ½ä½¿ç”¨shellå‘½ä»¤è¡Œï¼›åœ¨windowsä¸­ï¼Œèƒ½ä½¿ç”¨é›†æˆå¼€å‘ç¯å¢ƒçš„å‘½ä»¤è¡Œã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ­£ä½¿ç”¨bash shellï¼Œè¦æ£€æŸ¥ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼åªéœ€è¦è¾“å…¥</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span></span><br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨exportå‘½ä»¤æ¥è®¾ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"><span class="hljs-built_in">export</span> TEST_VAR = <span class="hljs-string">&quot;hello&quot;</span></span><br></code></pre></div></td></tr></table></figure><p>å¦‚ä½•æ£€æŸ¥å’Œè®¾ç½®ç‰¹å®šç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œè¯·å’¨è¯¢æœ¬åœ°ç³»ç»Ÿçš„ä¸“å®¶ã€‚</p><p>å½“scheduleï¼ˆruntimeï¼‰æŒ‡å®šæ—¶ï¼Œç³»ç»Ÿä½¿ç”¨ç¯å¢ƒå˜é‡OMP_SCHEDULEåœ¨è¿è¡Œæ—¶æ¥å†³å®šå¦‚ä½•è°ƒåº¦å¾ªç¯ã€‚OMP_SCHEDULEç¯å¢ƒå˜é‡ä¼šå‘ˆç°ä»»ä½•èƒ½å¤Ÿè¢«staticï¼Œdynamicæˆ–guidedè°ƒåº¦æ‰€ä½¿ç”¨çš„å€¼ã€‚ä¾‹å¦‚ï¼Œå‡è®¾åœ¨ç¨‹åºä¸­æœ‰ä¸€æ¡parallel foræŒ‡ä»¤ï¼Œå¹¶ä¸”å®ƒå·²ç»è¢«scheduleï¼ˆruntimeï¼‰ä¿®æ”¹äº†ã€‚é‚£ä¹ˆå¦‚æœä½¿ç”¨bash shellï¼Œå°±èƒ½é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†ä¸€ä¸ªå¾ªç¯åˆ†é…æ‰€å¾—åˆ°çš„è¿­ä»£åˆ†é…ç»™çº¿ç¨‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"><span class="hljs-built_in">export</span> OMP_SCHEDULE=<span class="hljs-string">&quot;static,1&quot;</span></span><br></code></pre></div></td></tr></table></figure><p>ç°åœ¨ï¼Œå½“å¼€å§‹æ‰§è¡Œç¨‹åºæ—¶ï¼Œç³»ç»Ÿå°†è°ƒåº¦forå¾ªç¯çš„è¿­ä»£ï¼Œå°±å¦‚åŒä½¿ç”¨å­å¥scheduleï¼ˆstaticï¼Œ1ï¼‰ä¿®æ”¹äº†parallel foræŒ‡ä»¤é‚£æ ·ã€‚</p><h3 id="6-è°ƒåº¦é€‰æ‹©"><a href="#6-è°ƒåº¦é€‰æ‹©" class="headerlink" title="6.è°ƒåº¦é€‰æ‹©"></a>6.è°ƒåº¦é€‰æ‹©</h3><p>å¦‚æœéœ€è¦å¹¶è¡ŒåŒ–ä¸€ä¸ªforå¾ªç¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å†³å®šä½¿ç”¨å“ªä¸€ç§ç”µé•€å’Œchuncksizeçš„å¤§å°ï¼Ÿå®é™…ä¸Šï¼Œæ¯ä¸€ä¸­scheduleå­å¥æœ‰ä¸åŒçš„ç³»ç»Ÿå¼€é”€ã€‚dynamicè°ƒåº¦çš„ç³»ç»Ÿå¼€é”€è¦å¤§äºstaticè°ƒåº¦ï¼Œè€Œguidedè°ƒåº¦çš„ç³»ç»Ÿå¼€é”€æ˜¯ä¸‰ç§æ–¹å¼ä¸­æœ€å¤§çš„ã€‚å› æ­¤ï¼Œå¦‚æœä¸ä½¿ç”¨scheduleå­å¥å°±å·²ç»è¾¾åˆ°äº†ä»¤äººæ»¡æ„çš„æ€§èƒ½ï¼Œå°±ä¸éœ€è¦è¿›è¡Œå¤šä½™çš„å·¥ä½œã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ€€ç–‘è°ƒåº¦çš„æ€§èƒ½å¯ä»¥æå‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¯¹å„ç§è°ƒåº¦è¿›è¡Œè¯•éªŒã€‚</p><p>åœ¨æœ¬èŠ‚å¼€å§‹æä¾›çš„ä¾‹å­ä¸­ï¼Œåœ¨ç¨‹åºä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨scheduleï¼ˆstaticï¼Œ1ï¼‰ä»£æ›¿é»˜è®¤è°ƒåº¦æ—¶ï¼ŒåŠ é€Ÿæ¯”ä»1.33æå‡åˆ°1.99ã€‚å› ä¸ºåœ¨ä¸¤ä¸ªçº¿ç¨‹çš„æ¡ä»¶ä¸‹ï¼ŒåŠ é€Ÿæ¯”å‡ ä¹ä¸å¯èƒ½æ¯”1.99æ›´å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç”¨å†å°è¯•å…¶ä»–çš„è°ƒåº¦æ–¹å¼ï¼Œè‡³å°‘åœ¨åªç”¨ä¸¤ä¸ªçº¿ç¨‹å¹¶ä¸”è¿­ä»£æ•°ä¸º10000çš„æƒ…å†µä¸‹æ˜¯è¿™æ ·ã€‚å¦‚æœåšæ›´å¤šçš„è¯•éªŒï¼Œæ”¹å˜çº¿ç¨‹çš„ä¸ªæ•°å’Œè¿­ä»£çš„æ¬¡æ•°ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ï¼šæœ€ä¼˜çš„è°ƒåº¦æ–¹å¼æ˜¯ç”±çº¿ç¨‹çš„ä¸ªæ•°å’Œè¿­ä»£çš„æ¬¡æ•°å…±åŒå†³å®šçš„ã€‚</p><p>å¦‚æœæˆ‘ä»¬æ–­å®šé»˜è®¤çš„è°ƒåº¦æ–¹å¼æ€§èƒ½ä½ä¸‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šåšå¤§é‡çš„å®éªŒæ¥å¯»æ‰¾æœ€ä¼˜çš„è°ƒåº¦æ–¹å¼å’Œè¿­ä»£æ¬¡æ•°ã€‚åœ¨è¿›è¡Œäº†å¤§é‡çš„å·¥ä½œä»¥åï¼Œæˆ‘ä»¬å¯èƒ½å‘ç°ï¼Œè¿™äº›å¾ªç¯æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„å¹¶è¡ŒåŒ–ï¼Œæ²¡æœ‰å“ªä¸€ç§è°ƒåº¦å¯ä»¥å¸¦æ¥æ¯”è¾ƒæ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚ç¼–ç¨‹ä½œä¸š5.4å°±æ˜¯è¿™æ ·ä¸€ä¸ªä¾‹å­ã€‚</p><p>ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘æœ‰äº›è°ƒåº¦ï¼š</p><ol><li>å¦‚æœå¾ªç¯çš„æ¯æ¬¡è¿­ä»£éœ€è¦å‡ ä¹ç›¸åŒçš„è®¡ç®—é‡ï¼Œé‚£ä¹ˆå¯èƒ½é»˜è®¤çš„è°ƒåº¦æ–¹å¼èƒ½æä¾›æœ€å¥½çš„æ€§èƒ½</li><li>å¦‚æœéšç€å¾ªç¯çš„è¿›è¡Œï¼Œè¿­ä»£çš„è®¡ç®—é‡çº¿æ€§çŒ›å¢ï¼ˆæˆ–é€’å‡ï¼‰ï¼Œé‚£ä¹ˆé‡‡ç”¨æ¯”è¾ƒå°çš„chuncksizeçš„staticè°ƒåº¦å¯èƒ½ä¼šæä¾›æœ€å¥½çš„æ€§èƒ½</li><li>å¦‚æœæ¯æ¬¡è¿­ä»£çš„å¼€é”€äº‹å…ˆä¸èƒ½ç¡®å®šï¼Œé‚£ä¹ˆå°±å¯èƒ½éœ€è¦å°è¯•ä½¿ç”¨å¤šç§ä¸åŒçš„è°ƒåº¦ç­–ç•¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”å½“ä½¿ç”¨scheduleï¼ˆruntimeï¼‰å­å¥ï¼Œé€šè¿‡å¯Œè£•ç¯å¢ƒå˜é‡OMP_SCHEDULEä¸åŒçš„å€¼æ¥æ¯”è¾ƒä¸åŒè°ƒåº¦ç­–ç•¥ä¸‹ç¨‹åºçš„æ€§èƒ½</li></ol><h3 id="7-æ€»ç»“"><a href="#7-æ€»ç»“" class="headerlink" title="7.æ€»ç»“"></a>7.æ€»ç»“</h3><ol><li>è°ƒåº¦æ–¹å¼å¯¹åŠ é€Ÿæ•ˆæœçš„é‡è¦æ€§</li><li>åˆç†åˆ†æä»»åŠ¡ç‰¹æ€§ï¼Œé€‰æ‹©æœ€é€‚åˆçš„è°ƒåº¦æ–¹å¼</li></ol><h3 id="8-å‚è€ƒèµ„æ–™"><a href="#8-å‚è€ƒèµ„æ–™" class="headerlink" title="8.å‚è€ƒèµ„æ–™"></a>8.å‚è€ƒèµ„æ–™</h3><p>å¹¶è¡Œç¨‹åºå¯¼è®º ï¼ˆç¾ï¼‰Peter S.Pacheco</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMPæ’åº</title>
    <link href="/2023/01/13/openmp004/"/>
    <url>/2023/01/13/openmp004/</url>
    
    <content type="html"><![CDATA[<h2 id="OpenMPæ’åº"><a href="#OpenMPæ’åº" class="headerlink" title="OpenMPæ’åº"></a>OpenMPæ’åº</h2><h3 id="1-å†’æ³¡æ’åº"><a href="#1-å†’æ³¡æ’åº" class="headerlink" title="1.å†’æ³¡æ’åº"></a>1.å†’æ³¡æ’åº</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(list_length = n; list.length &gt;= <span class="hljs-number">2</span>; list_length--)<span class="hljs-comment">//å‡åºæ’åˆ—</span><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>;i &lt; list_length<span class="hljs-number">-1</span>; i++)<br>        <span class="hljs-keyword">if</span>(a[i] &gt; a[i+<span class="hljs-number">1</span>])&#123;<br>            tmp = a[i];<br>            a[i] = a[i+<span class="hljs-number">1</span>];<br>            a[i+<span class="hljs-number">1</span>] = tmp;<br>        &#125;<br></code></pre></div></td></tr></table></figure><p>â€‹æ˜¾ç„¶ï¼Œåœ¨å¤–éƒ¨å¾ªç¯ä¸­æœ‰ä¸€ä¸ªå¾ªç¯ä¾èµ–ï¼Œåœ¨å¤–éƒ¨å¾ªç¯çš„ä»»ä½•ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œå½“å‰åˆ—è¡¨çš„å†…å®¹ä¾èµ–äºå¤–éƒ¨å¾ªç¯çš„å‰ä¸€æ¬¡è¿­ä»£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ç®—æ³•å¼€å§‹æ—¶ï¼Œa&#x3D;3,4,1,2ï¼Œé‚£ä¹ˆå¤–éƒ¨å¾ªç¯çš„ç¬¬äºŒæ¬¡è¿­ä»£å°†å¯¹åˆ—è¡¨3ï¼Œ1ï¼Œ2è¿›è¡Œæ“ä½œï¼Œå› ä¸º4åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­åº”è¯¥å·²ç»è¢«ç§»åŠ¨åˆ°åˆ—è¡¨çš„æœ€åäº†ã€‚ä½†å¦‚æœå‰ä¸¤æ¬¡è¿­ä»£åŒæ—¶æ‰§è¡Œï¼Œåˆ™å¯èƒ½ç¬¬äºŒæ¬¡è¿­ä»£çš„æœ‰æ•ˆåˆ—è¡¨åŒ…å«4ã€‚</p><p>â€‹å†…éƒ¨å¾ªç¯çš„å¾ªç¯ä¾èµ–ä¹Ÿå¾ˆå®¹æ˜“å‘ç°ã€‚åœ¨ç¬¬iæ¬¡è¿­ä»£ä¸­ï¼Œè¢«æ¯”è¾ƒçš„å…ƒç´ ä¾èµ–äºç¬¬i-1æ¬¡è¿­ä»£ã€‚å¦‚æœåœ¨ç¬¬i-1æ¬¡è¿­ä»£ä¸­a[i-1]å’Œa[i]æ²¡æœ‰äº¤æ¢ï¼Œé‚£ä¹ˆç¬¬iæ¬¡è¿­ä»£å°†æ¯”è¾ƒa[i]å’Œa[i+1]ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœç¬¬i-1æ¬¡è¿­ä»£äº¤æ¢äº†a[i-1]å’Œa[i]ï¼Œé‚£ä¹ˆç¬¬iæ¬¡è¿­ä»£å°†æ¯”è¾ƒåŸå§‹çš„a[i-1] (ç°åœ¨æ˜¯a[i]å’Œa[i+1])ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚å½“å‰åˆ—è¡¨æ˜¯{3ï¼Œ1ï¼Œ2}ã€‚é‚£ä¹ˆå½“i&#x3D;1æ—¶ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒ3å’Œ2ï¼Œä½†å¦‚æœi&#x3D;0å’Œi&#x3D;1æ¬¡è¿­ä»£åŒæ—¶å‘ç”Ÿï¼Œåˆ™å®Œå…¨æœ‰å¯èƒ½i&#x3D;1æ¬¡è¿­ä»£å›æ¯”è¾ƒ1å’Œ2ã€‚</p><p>â€‹æˆ‘ä»¬å®Œå…¨ä¸æ¸…æ¥šæ€æ ·åœ¨ä¸å®Œå…¨é‡å†™ç®—æ³•çš„æƒ…å†µä¸‹ä¸€å¤„ä»»ä½•ä¸€ä¸ªå¾ªç¯ä¾èµ–ã€‚è®°ä½ã€‚å³ä½¿æˆ‘ä»¬æ€»èƒ½æ‰¾åˆ°å¾ªç¯ä¾èµ–ï¼Œä½†å¯èƒ½å¾ˆéš¾ç”šè‡³ä¸å¯èƒ½ç§»é™¤å®ƒã€‚å¯¹äºå¹¶è¡ŒåŒ–forå¾ªç¯è€Œè¨€ï¼Œparallel foræŒ‡ä»¤ä¸æ˜¯ä¸€ä¸ªé€šç”¨çš„è§£å†³æ–¹æ³•ã€‚</p><h3 id="2-å¥‡å¶äº¤æ¢æ’åº"><a href="#2-å¥‡å¶äº¤æ¢æ’åº" class="headerlink" title="2.å¥‡å¶äº¤æ¢æ’åº"></a>2.å¥‡å¶äº¤æ¢æ’åº</h3><p>â€‹å¥‡å¶äº¤æ¢æ’åºæ˜¯ä¸€ä¸ªä¸å†’æ³¡æ’åºç›¸ä¼¼çš„ç®—æ³•ï¼Œä½†å®ƒç›¸å¯¹æ¥è¯´æ›´å®¹æ˜“å¹¶è¡ŒåŒ–ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(phase = <span class="hljs-number">0</span>;phase &lt; n ; phase++)<br>    <span class="hljs-keyword">if</span>(phase % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span>(i = <span class="hljs-number">1</span>; i &lt; n ;i += <span class="hljs-number">2</span>)<br>            <span class="hljs-keyword">if</span>(a[i<span class="hljs-number">-1</span>] &gt; a[i]) <span class="hljs-built_in">swap</span>(a[i<span class="hljs-number">-1</span>],a[i]);<br><span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">for</span>(i = <span class="hljs-number">1</span>;i &lt; n<span class="hljs-number">-1</span> ;i += <span class="hljs-number">2</span>)<br>            <span class="hljs-keyword">if</span>(a[i] &gt; a[i+<span class="hljs-number">1</span>]) <span class="hljs-built_in">swap</span>(a[i],a[i+<span class="hljs-number">1</span>]);<br></code></pre></div></td></tr></table></figure><p>åˆ—è¡¨aå­˜å‚¨nä¸ªæ•´æ•°ï¼Œç®—æ³•å¯¹ä»–ä»¬è¿›è¡Œå‡åºæ’åˆ—ã€‚åœ¨ä¸€ä¸ªâ€œå¶é˜¶æ®µâ€ï¼ˆphase %2 &#x3D;&#x3D;0 ï¼‰é‡Œï¼Œæ¯ä¸ªå¶ä¸‹æ ‡å…ƒç´ a[i]ä¸å®ƒå·¦è¾¹çš„å…ƒç´ a[i-1]ç›¸æ¯”è¾ƒã€‚å¦‚æœä»–ä»¬æ˜¯æ²¡æœ‰æ’å¥½åºçš„ï¼Œå°±äº¤æ¢å®ƒä»¬ã€‚åœ¨ä¸€ä¸ªâ€œå¥‡é˜¶æ®µâ€é‡Œï¼Œæ¯ä¸ªå¥‡ä¸‹æ ‡å…ƒç´ ä¸å®ƒå³è¾¹çš„å…ƒç´ ç›¸æ¯”è¾ƒã€‚å¦‚æœä»–ä»¬æ˜¯æ²¡æœ‰æ’å¥½åºçš„ï¼Œåˆ™äº¤æ¢ä»–ä»¬ã€‚æœ‰å®šç†è¯æ˜ï¼šåœ¨nä¸ªé˜¶æ®µåï¼Œåˆ—è¡¨å¯ä»¥å®Œæˆæ’åºã€‚</p><p>â€‹ä½œä¸ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡è®¾a&#x3D;{9,7,8,6}ã€‚è¡¨5-1æ˜¾ç¤ºäº†å„ä¸ªé˜¶æ®µçš„æƒ…å†µã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ€åçš„é˜¶æ®µä¸æ˜¯å¿…è¦çš„ï¼Œä½†ç®—æ³•å¹¶ä¸åœ¨æ‰§è¡Œæ¯ä¸ªé˜¶æ®µå‰æ£€æŸ¥åˆ—è¡¨æ˜¯å¦å·²ç»æœ‰åºã€‚</p><p><img src="/2023/01/13/openmp004/image-20230113174202896.png" alt="image-20230113174202896"></p><p>â€‹ä¸éš¾çœ‹åˆ°å¤–éƒ¨å¾ªç¯æœ‰ä¸€ä¸ªå¾ªç¯ä¾èµ–ã€‚ä¾‹å¦‚åœ¨a &#x3D; {9ï¼Œ7ï¼Œ8ï¼Œ6}ä¹‹å‰ã€‚åœ¨é˜¶æ®µ0ä¸­ï¼Œå†…éƒ¨å¾ªç¯å°†æ¯”è¾ƒï¼ˆ9ï¼Œ7ï¼‰å’Œï¼ˆ8ï¼Œ6ï¼‰è¿™ä¸¤å¯¹ä¸­çš„å…ƒç´ ï¼Œè¿™ä¸¤å¯¹éƒ½ä¼šè¢«äº¤æ¢ã€‚å› æ­¤å¯¹äºé˜¶æ®µ1ï¼Œåˆ—è¡¨å°†æ˜¯{7ï¼Œ9ï¼Œ6ï¼Œ8}ï¼Œå¹¶åœ¨é˜¶æ®µ1ä¸­ï¼ˆ9ï¼Œ6ï¼‰ä¸­çš„å…ƒç´ è¢«æ¯”è¾ƒå¹¶äº¤æ¢ã€‚ç„¶è€Œï¼Œå¦‚æœé˜¶æ®µ0å’Œé˜¶æ®µ1åŒæ—¶æ‰§è¡Œï¼Œåˆ™åœ¨é˜¶æ®µ1ä¸­è¢«æ£€æŸ¥å¯èƒ½æ˜¯ï¼ˆ7ï¼Œ8ï¼‰ï¼Œæ˜¯æœ‰åºçš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°šä¸æ¸…æ¥šå¦‚ä½•æ¶ˆé™¤è¿™ä¸ªå¾ªç¯ä¾èµ–ï¼Œå› æ­¤å¹¶è¡ŒåŒ–å¤–éƒ¨forå¾ªç¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚</p><p>â€‹ä½†æ˜¯ï¼Œå†…éƒ¨forå¾ªç¯å¹¶æ²¡æœ‰ä»»ä½•å¾ªç¯ä¾èµ–ã€‚ä¾‹å¦‚ï¼Œåœ¨å¶é˜¶æ®µå¾ªç¯ä¸­ï¼Œå˜é‡iæ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥å¯¹äºä¸¤ä¸ªä¸åŒçš„iå€¼ï¼Œä¾‹å¦‚ï¼Œi&#x3D;jå’Œi&#x3D;kï¼Œ{j-1,j}å’Œ{k-1,k}å°†æ˜¯ä¸åŒçš„ã€‚ï¼ˆa[j-1],a[j]ï¼‰å’Œï¼ˆa[k-1],a[k]ï¼‰æ‰€äº§ç”Ÿçš„æ¯”è¾ƒå’Œå¯èƒ½çš„äº¤æ¢èƒ½å¤ŸåŒæ—¶è¿›è¡Œã€‚</p><p>â€‹æ‰€ä»¥ï¼Œæˆ‘ä»¬è¯•å›¾ä½¿ç”¨ç¨‹åº5-4çš„ä»£ç å¹¶è¡ŒåŒ–å¥‡å¶å˜åŒ–æ’åºï¼Œä½†è¿˜æ˜¯ä¼šæœ‰ä¸€äº›æ½œåœ¨çš„é—®é¢˜ï¼Œé¦–å…ˆï¼Œå°½ç®¡ä»»ä½•ä¸€ä¸ªå¶é˜¶æ®µè¿­ä»£å¹¶ä¸ä¾èµ–ä»»ä½•è¿™ä¸ªé˜¶æ®µçš„å…¶ä»–è¿­ä»£ï¼Œä½†æ˜¯è¿˜éœ€è¦æ³¨æ„ï¼Œå¯¹pé˜¶æ®µå’Œp+1é˜¶æ®µå´å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚æˆ‘ä»¬éœ€è¦ç¡®å®šåœ¨ä»»ä½•ä¸€ä¸ªçº¿ç¨‹å¼€å§‹p+1é˜¶æ®µä¹‹å‰ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å¿…é¡»å…ˆå®Œæˆpé˜¶æ®µã€‚ç„¶è€Œï¼ŒåƒparallelæŒ‡ä»¤é‚£æ ·ï¼Œparallel foræŒ‡ä»¤åœ¨å¾ªç¯ç»“æŸå¤„æœ‰ä¸€ä¸ªéšå¼çš„è·¯éšœï¼Œå› æ­¤ï¼Œåœ¨æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆå½“å‰é˜¶æ®µï¼ˆå³é˜¶æ®µPä¹‹å‰ï¼‰ï¼Œæ²¡æœ‰çº¿ç¨‹èƒ½å¤Ÿè¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼Œå³p+1é˜¶æ®µã€‚ã€è¿™é‡Œéœ€è¦æ³¨æ„åœ¨MPIä¸­å¹¶æ²¡æœ‰éšå¼çš„è·¯éšœæ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨è®¾ç½®è·¯éšœç‚¹ã€‘</p><p>â€‹å…¶æ¬¡ï¼Œæ˜¯åˆ›å»ºå’Œåˆå¹¶çº¿ç¨‹çš„å¼€é”€ã€‚OpenMPå®ç°å¯èƒ½ä¼šåœ¨æ¯ä¸€éå¤–éƒ¨å¾ªç¯éƒ½åˆ›å»ºå’Œåˆå¹¶thread__countä¸ªçº¿ç¨‹ã€‚è¡¨5-2çš„ç¬¬ä¸€è¡Œæ˜¾ç¤ºäº†å½“è¾“å…¥åˆ—è¡¨åŒ…å«20000ä¸ªå…ƒç´ æ—¶ï¼Œåœ¨æˆ‘ä»¬ç³»ç»Ÿä¸Šè¿è¡Œ1ï¼Œ2ï¼Œ3ï¼Œ4ä¸ªçº¿ç¨‹çš„è¿è¡Œæ—¶é—´ã€‚</p><h3 id="3-ç¨‹åº5-4å¥‡å¶æ’åºçš„ç¬¬ä¸€ä¸ªOpenMPå®ç°"><a href="#3-ç¨‹åº5-4å¥‡å¶æ’åºçš„ç¬¬ä¸€ä¸ªOpenMPå®ç°" class="headerlink" title="3.ç¨‹åº5-4å¥‡å¶æ’åºçš„ç¬¬ä¸€ä¸ªOpenMPå®ç°"></a>3.ç¨‹åº5-4å¥‡å¶æ’åºçš„ç¬¬ä¸€ä¸ªOpenMPå®ç°</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(phase = <span class="hljs-number">0</span>;phase &lt; n; phase++)&#123;<br>    <span class="hljs-keyword">if</span>(phase %<span class="hljs-number">2</span> ==<span class="hljs-number">0</span>)<br>    <span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) default(none) shared(a,n) private(i,tmp)</span><br>        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;n;i+=<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(a[i<span class="hljs-number">-1</span>]&gt;a[i])&#123;<br>                tmp = a[i<span class="hljs-number">-1</span>];<br>                a[i<span class="hljs-number">-1</span>] = a[i];<br>                a[i] =tmp;<br>            &#125;<br>        &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) default(none) shared(a,n) private(i,tmp)</span><br>        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;n<span class="hljs-number">-1</span>;i+=<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(a[i] &gt; a[i+<span class="hljs-number">1</span>])&#123;<br>                tmp = a[i+<span class="hljs-number">1</span>];<br>                a[i+<span class="hljs-number">1</span>] = a[i];<br>                a[i] = tmp;<br>            &#125;<br>        &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="/2023/01/13/openmp004/image-20230113225724364.png" alt="image-20230113225724364"></p><p>â€‹è¿™äº›æ—¶é—´è€—è´¹å¹¶ä¸éå¸¸ç³Ÿç³•ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³çœ‹çœ‹æ˜¯å¦èƒ½åšå¾—æ›´å¥½ã€‚æ¯æ¬¡æ‰§è¡Œå†…éƒ¨å¾ªç¯æ—¶ï¼Œä½¿ç”¨åŒæ ·æ•°é‡çš„çº¿ç¨‹ã€‚å› æ­¤åªåˆ›å»ºä¸€æ¬¡çº¿ç¨‹ï¼Œå¹¶åœ¨æ¯æ¬¡å†…éƒ¨å¾ªç¯çš„æ‰§è¡Œä¸­é‡ç”¨å®ƒä»¬ï¼Œè¿™æ ·åšå¯èƒ½æ›´å¥½ã€‚å¹¸è¿çš„æ˜¯ï¼ŒOpenMPæä¾›äº†å…è®¸è¿™æ ·åšçš„æŒ‡ä»¤ã€‚ç”¨parallelæŒ‡ä»¤åœ¨å¤–éƒ¨å¾ªç¯å‰åˆ›å»ºthread__countä¸ªçº¿ç¨‹çš„é›†åˆã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸åœ¨æ¯æ¬¡å†…éƒ¨å¾ªç¯æ‰§è¡Œæ—¶åˆ›å»ºä¸€ç»„æ–°çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªforæŒ‡ä»¤ï¼Œå‘Šè¯‰OpenMPç”¨å·²æœ‰çš„çº¿ç¨‹ç»„æ¥å¹¶è¡ŒåŒ–forå¾ªç¯ï¼Œå¯¹åŸæœ‰OpenMPå®ç°çš„æ”¹åŠ¨æ˜¾ç¤ºåœ¨ç¨‹åº5-5ä¸­ã€‚</p><h3 id="4-ç¨‹åº5-5å¥‡å¶æ’åºçš„ç¬¬äºŒä¸ªOpenMPå®ç°"><a href="#4-ç¨‹åº5-5å¥‡å¶æ’åºçš„ç¬¬äºŒä¸ªOpenMPå®ç°" class="headerlink" title="4.ç¨‹åº5-5å¥‡å¶æ’åºçš„ç¬¬äºŒä¸ªOpenMPå®ç°"></a>4.ç¨‹åº5-5å¥‡å¶æ’åºçš„ç¬¬äºŒä¸ªOpenMPå®ç°</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) default(none) shared(a,n) private(i,tmp,phase)</span><br><span class="hljs-keyword">for</span>(phase = <span class="hljs-number">0</span>;phase &lt; n; phase++)&#123;<br>    <span class="hljs-keyword">if</span>(phase %<span class="hljs-number">2</span> ==<span class="hljs-number">0</span>)<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp for</span><br>        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;n;i+=<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(a[i<span class="hljs-number">-1</span>]&gt;a[i])&#123;<br>                tmp = a[i<span class="hljs-number">-1</span>];<br>                a[i<span class="hljs-number">-1</span>] = a[i];<br>                a[i] =tmp;<br>            &#125;<br>        &#125;<br>    <span class="hljs-keyword">else</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp for</span><br>        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;n<span class="hljs-number">-1</span>;i+=<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(a[i] &gt; a[i+<span class="hljs-number">1</span>])&#123;<br>                tmp = a[i+<span class="hljs-number">1</span>];<br>                a[i+<span class="hljs-number">1</span>] = a[i];<br>                a[i] = tmp;<br>            &#125;<br>        &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸parallel foræŒ‡ä»¤ä¸åŒçš„æ˜¯ï¼ŒforæŒ‡ä»¤å¹¶ä¸åˆ›å»ºä»»ä½•çº¿ç¨‹ã€‚å®ƒä½¿ç”¨å·²ç»åœ¨parallelå—ä¸­åˆ›å»ºçš„çº¿ç¨‹ã€‚åœ¨å¾ªç¯çš„æœ«å°¾æœ‰ä¸€ä¸ªéšå¼çš„è·¯éšœã€‚ä»£ç çš„ç»“æœï¼ˆæœ€ç»ˆåˆ—è¡¨ï¼‰å°†å› æ­¤ä¸åŸæœ‰çš„å¹¶è¡ŒåŒ–ä»£ç æ‰€å–å¾—åˆ°çš„ç»“æœä¸€æ ·ã€‚</p><p>â€‹å¥‡å¶æ’åºçš„ç¬¬äºŒä¸ªç‰ˆæœ¬çš„è¿è¡Œæ—¶é—´æ˜¾ç¤ºåœ¨è¡¨5-2çš„ç¬¬äºŒè¡Œã€‚å½“ä½¿ç”¨ä¸¤ä¸ªæˆ–æ›´å¤šçº¿ç¨‹æ—¶ï¼Œä½¿ç”¨ä¸¤æ¡foræŒ‡ä»¤çš„ç‰ˆæœ¬è¦æ¯”ä½¿ç”¨ä¸¤æ¡parallel foræŒ‡ä»¤çš„ç‰ˆæœ¬å¿«17%ã€‚å› æ­¤å¯¹äºè¿™ä¸ªç³»ç»Ÿè€Œè¨€ï¼Œä¸ºè¿™ç‚¹æ”¹å˜æ‰€åšçš„å°å°åŠªåŠ›æ˜¯å€¼å¾—çš„ã€‚</p><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h3><ol><li>å¾ªç¯ä¾èµ–æ€»ä¼šå‡ºç°ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾ˆéš¾å»è§£å†³å®ƒç”šè‡³æ ¹æœ¬æ— æ³•è§£å†³ã€‚</li><li>åœ¨æ„é€ å¹¶è¡ŒåŒºæ—¶è¦å°½é‡å‡å°‘åˆ›å»ºå’Œåˆå¹¶çº¿ç¨‹çš„å¼€é”€</li></ol><h3 id="6-å‚è€ƒæ–‡çŒ®"><a href="#6-å‚è€ƒæ–‡çŒ®" class="headerlink" title="6.å‚è€ƒæ–‡çŒ®"></a>6.å‚è€ƒæ–‡çŒ®</h3><p>å¹¶è¡Œç¨‹åºå¯¼è®º ï¼ˆç¾ï¼‰Peter S.Pacheco</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMP Ï€å€¼ä¼°è®¡</title>
    <link href="/2023/01/09/openmp003/"/>
    <url>/2023/01/09/openmp003/</url>
    
    <content type="html"><![CDATA[<h2 id="Ï€å€¼ä¼°è®¡"><a href="#Ï€å€¼ä¼°è®¡" class="headerlink" title="Ï€å€¼ä¼°è®¡"></a>Ï€å€¼ä¼°è®¡</h2><h3 id="1-æ•°å­¦èƒŒæ™¯"><a href="#1-æ•°å­¦èƒŒæ™¯" class="headerlink" title="1.æ•°å­¦èƒŒæ™¯"></a>1.æ•°å­¦èƒŒæ™¯</h3><p><img src="/2023/01/09/openmp003/image-20230109150836877.png" alt="image-20230109150836877"></p><p>æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸²è¡Œä»£ç ä¸‹å®è¡Œè¿™ä¸ªå…¬å¼ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span> factor = <span class="hljs-number">1.0</span>;<br><span class="hljs-keyword">double</span> sum = <span class="hljs-number">0.0</span>;<br><span class="hljs-keyword">for</span>(k=<span class="hljs-number">0</span> ; k &lt; n; k++)&#123;<br>    sum += factor /(<span class="hljs-number">2</span>*k+<span class="hljs-number">1</span>);<br>    factor = - factor;<br>&#125;<br>pi_approx = <span class="hljs-number">4.0</span>*sum;<br></code></pre></div></td></tr></table></figure><h3 id="2-OpenMPå¹¶è¡ŒåŒ–"><a href="#2-OpenMPå¹¶è¡ŒåŒ–" class="headerlink" title="2.OpenMPå¹¶è¡ŒåŒ–"></a>2.OpenMPå¹¶è¡ŒåŒ–</h3><p>ä¸ºäº†ä½¿ç”¨OpenMPæ¥å¹¶è¡ŒåŒ–ï¼Œå¯ä»¥é¦–å…ˆå€¾å‘äºè¿™æ ·åšï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">1</span> <span class="hljs-keyword">double</span> factor = <span class="hljs-number">1.0</span>;<br><span class="hljs-number">2</span> <span class="hljs-keyword">double</span> sum = <span class="hljs-number">0.0</span>;<br><span class="hljs-number">3</span> <span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) reduction(+:sum)  <span class="hljs-comment">//å¯¹sumè¿›è¡Œæ±‚å’Œå½’çº¦</span></span><br><span class="hljs-number">4</span> <span class="hljs-keyword">for</span>(k=<span class="hljs-number">0</span> ; k &lt; n; k++)&#123;<br><span class="hljs-number">5</span>     sum += factor /(<span class="hljs-number">2</span>*k+<span class="hljs-number">1</span>);<br><span class="hljs-number">6</span>     factor = - factor;<br><span class="hljs-number">7</span> &#125;<br><span class="hljs-number">8</span> pi_approx = <span class="hljs-number">4.0</span>*sum;<br></code></pre></div></td></tr></table></figure><p>ç„¶è€Œï¼Œç¬¬kæ¬¡è¿­ä»£ä¸­å¯¹ç¬¬6è¡Œçš„factorçš„æ›´æ–°å’Œæ¥ä¸‹æ¥çš„ç¬¬k + 1æ¬¡è¿­ä»£ä¸­å¯¹ç¬¬5è¡Œçš„sumçš„ç´¯åŠ æ˜¯ä¸€ä¸ªå¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰ã€‚å¦‚æœç¬¬kæ¬¡è¿­ä»£è¢«åˆ†é…Â·åˆ°ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œç¬¬k + 1æ¬¡è¿­ä»£è¢«åˆ†é…ç»™å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ™æˆ‘ä»¬ä¸èƒ½ä¿è¯ç¬¬6è¡Œä¸­factorçš„å€¼æ˜¯æ­£ç¡®çš„ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬èƒ½é€šè¿‡æ£€æŸ¥ç³»æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><p><img src="/2023/01/09/openmp003/image-20230109161031989.png" alt="image-20230109161031989"></p><p>å¯ä»¥çœ‹åˆ°ï¼šåœ¨ç¬¬kæ¬¡è¿­ä»£ï¼Œfactorçš„å€¼åº”è¯¥æ˜¯<img src="/2023/01/09/openmp003/image-20230109161206995.png" alt="image-20230109161206995">ã€‚å¦‚æœkæ˜¯å¶æ•°ï¼Œé‚£ä¹ˆå€¼æ˜¯+1ï¼›å¦‚æœkæ˜¯å¥‡æ•°ï¼Œå€¼æ˜¯-1ã€‚</p><h3 id="3-æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰"><a href="#3-æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰" class="headerlink" title="3.æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰"></a>3.æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰</h3><p>å› æ­¤ï¼Œå¦‚æœå°†ä¸‹è¿°ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">sum += factor /(<span class="hljs-number">2</span>*k+<span class="hljs-number">1</span>);<br>factor = - factor;<br></code></pre></div></td></tr></table></figure><p>æ›¿æ¢ä¸ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">if</span>(k % <span class="hljs-number">2</span> ==<span class="hljs-number">0</span>)<span class="hljs-comment">//é€šè¿‡å¥‡å¶æ€§ï¼Œæ¥ç‹¬ç«‹factoræ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰</span><br>    factor = <span class="hljs-number">1.0</span>;<br><span class="hljs-keyword">else</span><br>    factor = <span class="hljs-number">-1.0</span>;<br>sum += factor/(<span class="hljs-number">2</span>*k+<span class="hljs-number">1</span>);<br></code></pre></div></td></tr></table></figure><p>è¿™æ ·å°±æ¶ˆé™¤äº†å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰ã€‚</p><h3 id="4-ä½œç”¨åŸŸ"><a href="#4-ä½œç”¨åŸŸ" class="headerlink" title="4.ä½œç”¨åŸŸ"></a>4.ä½œç”¨åŸŸ</h3><p>â€‹ç„¶è€Œï¼Œäº‹æƒ…ä»ç„¶ä¸æ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚å¦‚æœåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸Šä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹è¿è¡Œç¨‹åºï¼Œå¹¶è®¾n&#x3D;1000ï¼Œé‚£ä¹ˆç»“æœä»ç„¶æ˜¯é”™è¯¯çš„ã€‚ä¾‹å¦‚ï¼Œ</p><p><img src="/2023/01/09/openmp003/image-20230109164120205.png" alt="image-20230109164120205"></p><p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿è¡Œç¨‹åºï¼Œæˆ‘ä»¬æ€»æ˜¯å¾—åˆ°ï¼š</p><p><img src="/2023/01/09/openmp003/image-20230109164204808.png" alt="image-20230109164204808"></p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§é”™è¯¯ã€‚åœ¨ä¸€ä¸ªå·²ç»è¢«parallel foræŒ‡ä»¤å¹¶è¡ŒåŒ–çš„å—ä¸­ï¼Œç¼ºçœæƒ…å†µä¸‹ä»»ä½•åœ¨å¾ªç¯å‰å£°æ˜çš„å˜é‡ï¼ˆå”¯ä¸€çš„ä¾‹å¤–æ˜¯å¾ªç¯å˜é‡ï¼‰åœ¨çº¿ç¨‹é—´éƒ½æ˜¯å…±äº«çš„ã€‚å› æ­¤factorè¢«å…±äº«ï¼ˆè¢«æ‰€æœ‰çº¿ç¨‹æ‰€å…±äº«ï¼‰ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹0å¯èƒ½ä¼šç»™ä»–èµ‹å€¼1ï¼Œä½†åœ¨å®ƒèƒ½ç”¨è¿™ä¸ªå€¼æ›´æ–°sumå‰ï¼Œçº¿ç¨‹1å¯èƒ½åˆç»™ä»–èµ‹å€¼ä¸º-1äº†ã€‚å› æ­¤ï¼Œé™¤äº†æ¶ˆé™¤è®¡ç®—factoræ—¶çš„å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¿è¯æ¯ä¸ªçº¿ç¨‹æœ‰å®ƒè‡ªå·±çš„factorå‰¯æœ¬ï¼Œå°±æ˜¯è¯´ï¼Œä¸ºäº†ä½¿ä»£ç æ­£ç¡®ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯factoræœ‰ç§æœ‰ä½œç”¨åŸŸï¼ˆç®€å•æ¥è¯´å°±æ˜¯ä¿è¯å½“å‰çº¿ç¨‹çš„factorçš„å€¼ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼Œä¹Ÿåªæœ‰å½“å‰çº¿ç¨‹èƒ½æ›´æ–°å’Œä½¿ç”¨factorï¼‰ã€‚é€šè¿‡æ·»åŠ ä¸€ä¸ªprivateå­å¥åˆ°parallelæŒ‡ä»¤ä¸­æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"> <span class="hljs-keyword">double</span> factor = <span class="hljs-number">1.0</span>;<br> <span class="hljs-keyword">double</span> sum = <span class="hljs-number">0.0</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) reduction(+:sum) private(factor)  <span class="hljs-comment">//å¯¹sumè¿›è¡Œæ±‚å’Œå½’çº¦</span></span><br> <span class="hljs-keyword">for</span>(k=<span class="hljs-number">0</span> ; k &lt; n; k++)&#123;<br>     <span class="hljs-keyword">if</span>(k % <span class="hljs-number">2</span> ==<span class="hljs-number">0</span>)<span class="hljs-comment">//é€šè¿‡å¥‡å¶æ€§ï¼Œæ¥ç‹¬ç«‹factoræ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰</span><br>    factor = <span class="hljs-number">1.0</span>;<br><span class="hljs-keyword">else</span><br>    factor = <span class="hljs-number">-1.0</span>;<br>     sum += factor /(<span class="hljs-number">2</span>*k+<span class="hljs-number">1</span>);<br> &#125;<br> pi_approx = <span class="hljs-number">4.0</span>*sum;<br></code></pre></div></td></tr></table></figure><p>åœ¨privateå­å¥å†…åˆ—ä¸¾çš„å˜é‡ï¼Œåœ¨æ¯ä¸ªçº¿ç¨‹ä¸Šéƒ½æœ‰ä¸€ä¸ªç§æœ‰å‰¯æœ¬è¢«åˆ›å»ºã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œthread_countä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸€ä¸ªéƒ½æœ‰å®ƒè‡ªå·±çš„factorå˜é‡çš„å‰¯æœ¬ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹å¯¹factorçš„æ›´æ–°ä¸ä¼šå½±å“å¦ä¸€ä¸ªçº¿ç¨‹çš„factorå€¼ã€‚</p><p>â€‹è¦è®°ä½çš„é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œä¸€ä¸ªæœ‰ç§æœ‰ä½œç”¨åŸŸçš„å˜é‡çš„å€¼åœ¨parallelå—æˆ–è€…parallel forå—çš„å¼€å§‹å¤„æ˜¯æœªæŒ‡å®šçš„ã€‚å®ƒçš„å€¼åœ¨parallelæˆ–parallel forå—å®Œæˆä¹‹åä¹Ÿæ˜¯æœªæŒ‡å®šçš„ã€‚ä¾‹å¦‚ï¼Œä¸‹åˆ—ä»£ç ä¸­çš„ç¬¬ä¸€ä¸ªprintfè¯­å¥çš„è¾“å‡ºæ˜¯éç¡®å®šçš„ï¼Œå› ä¸ºåœ¨å®ƒè¢«ç°å®åˆå§‹åŒ–ä¹‹å‰å°±æ‰“å°äº†ç§æœ‰å˜é‡xã€‚ç±»ä¼¼åœ°ï¼Œæœ€ç»ˆçš„printfè¾“å‡ºä¹Ÿæ˜¯éç¡®å®šçš„ï¼Œå› ä¸ºä»–åœ¨parallelå—å®Œæˆä¹‹åæ‰“å°xã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> x = <span class="hljs-number">5</span>;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel num_threads(thread_count) private(x)</span><br>&#123;<br>    <span class="hljs-keyword">int</span> my_rank = <span class="hljs-built_in">omp_get_thread_num</span>();<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Thread %d &gt; before initialization,x = %d\n&quot;</span>,myrank,x);<br>    x = <span class="hljs-number">2</span>*my_rank + <span class="hljs-number">2</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Thread %d &gt; after initialization,x = %d\n&quot;</span>,my_rank,x);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;After parallel block, x = %d\n&quot;</span>,x);<br></code></pre></div></td></tr></table></figure><h3 id="5-å…³äºä½œç”¨åŸŸçš„æ›´å¤šé—®é¢˜"><a href="#5-å…³äºä½œç”¨åŸŸçš„æ›´å¤šé—®é¢˜" class="headerlink" title="5.å…³äºä½œç”¨åŸŸçš„æ›´å¤šé—®é¢˜"></a>5.å…³äºä½œç”¨åŸŸçš„æ›´å¤šé—®é¢˜</h3><p>â€‹å…³äºå˜é‡factorçš„é—®é¢˜æ˜¯å¸¸è§é—®é¢˜ä¸­çš„ä¸€ä¸ªã€‚æˆ‘ä»¬é€šå¸¸éœ€è¦è€ƒè™‘åœ¨parallelå—æˆ–parallel forå—ä¸­çš„æ¯ä¸ªå˜é‡çš„ä½œç”¨åŸŸã€‚å› æ­¤ï¼Œä¸å…¶è®©OpenMPå†³å®šæ¯ä¸ªå˜é‡çš„ä½œç”¨åŸŸï¼Œè¿˜ä¸å¦‚è®©ç¨‹åºå‘˜æ˜ç¡®å—ä¸­æ¯ä¸ªå˜é‡çš„ä½œç”¨åŸŸã€‚äº‹å®ä¸Šï¼ŒOpenMPæä¾›äº†ä¸€ä¸ªå­å¥defaultï¼Œè¯¥å­å¥æ˜¾ç¤ºåœ°è¦æ±‚æˆ‘ä»¬è¿™æ ·åšã€‚å¦‚æœæˆ‘ä»¬æ·»åŠ å­å¥ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in"><span class="hljs-keyword">default</span></span>(none)<br></code></pre></div></td></tr></table></figure><p>åˆ°parallelæˆ–parallel foræŒ‡ä»¤ä¸­ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†è¦æ±‚æˆ‘ä»¬æ˜ç¡®åœ¨è¿™ä¸ªå—ä¸­ä½¿ç”¨çš„æ¯ä¸ªå˜é‡å’Œå·²ç»åœ¨å—ä¹‹å¤–å£°æ˜çš„å˜é‡çš„ä½œç”¨åŸŸã€‚ï¼ˆåœ¨ä¸€ä¸ªå—ä¸­å£°æ˜çš„å˜é‡éƒ½æ˜¯ç§æœ‰çš„ï¼Œå› ä¸ºå®ƒä»¬ä¼šè¢«åˆ†é…ç»™çº¿ç¨‹çš„æ ˆã€‚ï¼‰</p><p>â€‹ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€ä¸ªdefaultï¼ˆnoneï¼‰å­å¥ï¼Œå¯¹Ï€çš„è®¡ç®—å°†å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel for num_threads(thread_count) default(none) reduction(+:sum) private(k,factor)  <span class="hljs-comment">//å¯¹sumè¿›è¡Œæ±‚å’Œå½’çº¦</span></span><br> <span class="hljs-keyword">for</span>(k=<span class="hljs-number">0</span> ; k &lt; n; k++)&#123;<br>     <span class="hljs-keyword">if</span>(k % <span class="hljs-number">2</span> ==<span class="hljs-number">0</span>)<span class="hljs-comment">//é€šè¿‡å¥‡å¶æ€§ï¼Œæ¥ç‹¬ç«‹factoræ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰</span><br>    factor = <span class="hljs-number">1.0</span>;<br><span class="hljs-keyword">else</span><br>    factor = <span class="hljs-number">-1.0</span>;<br>     sum += factor /(<span class="hljs-number">2</span>*k+<span class="hljs-number">1</span>);<br> &#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨forå¾ªç¯ä¸­ä½¿ç”¨4ä¸ªå˜é‡ã€‚ç”±äºdefaultå­å¥ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®æ¯ä¸ªå˜é‡çš„ä½œç”¨åŸŸã€‚æ­£å¦‚æˆ‘ä»¬å·²ç»æ³¨æ„åˆ°çš„ï¼Œsumæ˜¯ä¸€ä¸ªå½’çº¦å˜é‡ï¼ˆåŒæ—¶æ‹¥æœ‰ç§æœ‰å’Œå…±äº«ä½œç”¨åŸŸçš„å±æ€§ï¼‰ã€‚æˆ‘ä»¬ä¹Ÿå·²ç»æ³¨æ„åˆ°factorå’Œå¾ªç¯å˜é‡ä¸­kåº”è¯¥æœ‰ç§æœ‰ä½œç”¨åŸŸã€‚ä»æœªåœ¨parallelæˆ–parallel forå—ä¸­æ›´æ–°çš„å˜é‡ï¼Œå¦‚è¿™ä¸ªä¾‹å­ä¸­çš„nï¼Œèƒ½å¤Ÿè¢«å®‰å…¨çš„å…±äº«ã€‚ä¸ç§æœ‰å˜é‡ä¸åŒï¼Œå…±äº«å˜é‡åœ¨å—å†…å…·æœ‰åœ¨parallelæˆ–parallel forå—ä¹‹å‰çš„å€¼ï¼Œåœ¨å—ä¹‹åçš„å€¼ä¸å—å†…çš„æœ€åä¸€ä¸ªå€¼ç›¸åŒã€‚å› æ­¤ï¼Œå¦‚æœnåœ¨å—ä¹‹å‰è¢«åˆå§‹åŒ–ä¸º1000ï¼Œåˆ™åœ¨parallel forè¯­å¥ä¸­ä»–å°†ä¿æŒè¿™ä¸ªå€¼ã€‚å› ä¸ºåœ¨forå¾ªç¯ä¸­å€¼æ²¡æœ‰æ”¹å˜ï¼Œæ‰€æœ‰åœ¨å¾ªç¯ç»“æŸåå®ƒå°†ä¿æŒè¿™ä¸ªå€¼ã€‚</p><h3 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h3><ol><li>åˆ†ææ•°å­¦èƒŒæ™¯ï¼Œè§£å†³å¾ªç¯ä¾èµ–ï¼ˆæ•°æ®ä¾èµ–ï¼‰</li><li>åˆ¤æ–­å˜é‡çš„ä½œç”¨åŸŸ</li></ol><h3 id="7-å‚è€ƒèµ„æ–™"><a href="#7-å‚è€ƒèµ„æ–™" class="headerlink" title="7.å‚è€ƒèµ„æ–™"></a>7.å‚è€ƒèµ„æ–™</h3><p>å¹¶è¡Œç¨‹åºå¯¼è®º ï¼ˆç¾ï¼‰Peter S.Pacheco</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMPå¯»æ‰¾å¾ªç¯ä¾èµ–</title>
    <link href="/2023/01/06/openmp002/"/>
    <url>/2023/01/06/openmp002/</url>
    
    <content type="html"><![CDATA[<h3 id="1-OpenMPå¯»æ‰¾å¾ªç¯ä¾èµ–"><a href="#1-OpenMPå¯»æ‰¾å¾ªç¯ä¾èµ–" class="headerlink" title="1.OpenMPå¯»æ‰¾å¾ªç¯ä¾èµ–"></a>1.OpenMPå¯»æ‰¾å¾ªç¯ä¾èµ–</h3><p>â€‹å½“æˆ‘ä»¬è¯•å›¾ä½¿ç”¨ä¸€ä¸ªparallel foræŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆåº”è¯¥æ³¨æ„çš„æ˜¯ï¼šè¦å°å¿ƒå‘ç°å¾ªç¯ä¾èµ–ã€‚æˆ‘ä»¬ä¸éœ€è¦æ‹…å¿ƒä¸€èˆ¬çš„æ•°æ®ä¾èµ–ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢å¾ªç¯ä¸­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>    x[i] = a + i*h;<span class="hljs-comment">//2</span><br>    y[i] = <span class="hljs-built_in">exp</span>(x[i]);<span class="hljs-comment">//3</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œä¹‹é—´æœ‰ä¸€ä¸ªæ•°æ®ä¾èµ–ã€‚ç„¶è€Œï¼Œå¦‚ä¸‹çš„å¹¶è¡ŒåŒ–æ²¡æœ‰é—®é¢˜ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel num_threads(thread_count)</span><br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>    x[i] = a + i*h;<span class="hljs-comment">//3</span><br>    y[i] = <span class="hljs-built_in">exp</span>(x[i]);<span class="hljs-comment">//4</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>å› ä¸ºx[ i ]çš„è®¡ç®—ä¸å®ƒæ¥ä¸‹æ¥çš„ä½¿ç”¨æ€»æ˜¯è¢«åˆ†é…ç»™åŒä¸€ä¸ªè¿›ç¨‹ã€‚</p><p>â€‹æˆ‘ä»¬ä¹Ÿåº”è¯¥è§‚å¯Ÿåˆ°ï¼Œæœ‰ä¾èµ–å…³ç³»çš„è¯­å¥ï¼Œå…¶ä¸­è‡³å°‘ä¸€æ¡è¯­å¥ä¼šæœ‰åºåœ°å†™æˆ–æ›´æ–°å˜é‡ã€‚å› æ­¤ä¸ºäº†æ£€æµ‹å¾ªç¯ä¾èµ–ï¼Œæˆ‘ä»¬åªéœ€è¦é‡ç‚¹è§‚å¯Ÿè¢«å¾ªç¯ä½“æ›´æ–°çš„å˜é‡ï¼Œå³æˆ‘ä»¬åº”è¯¥å¯»æ‰¾åœ¨ä¸€ä¸ªè¿­ä»£ä¸­è¢«è¯»æˆ–è¢«å†™ï¼Œè€Œåœ¨å¦ä¸€ä¸ªè¿­ä»£ä¸­è¢«å†™çš„å˜é‡ã€‚</p><h3 id="2-æ€»ç»“"><a href="#2-æ€»ç»“" class="headerlink" title="2.æ€»ç»“"></a>2.æ€»ç»“</h3><ol><li>æ•°æ®ä¾èµ–åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­éå¸¸å¸¸è§</li><li>å¦‚ä½•è§£å†³æ•°æ®ä¾èµ–å¯¹æå‡å¹¶è¡ŒåŒ–çš„æ•ˆæœå½±å“å¾ˆå¤§</li></ol><h3 id="3-å‚è€ƒèµ„æ–™"><a href="#3-å‚è€ƒèµ„æ–™" class="headerlink" title="3.å‚è€ƒèµ„æ–™"></a>3.å‚è€ƒèµ„æ–™</h3><p>å¹¶è¡Œç¨‹åºå¯¼è®º ï¼ˆç¾ï¼‰Peter S.Pacheco</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenMPæ¢¯åº¦ç§¯åˆ†æ³•</title>
    <link href="/2023/01/03/openmp001/"/>
    <url>/2023/01/03/openmp001/</url>
    
    <content type="html"><![CDATA[<h2 id="OpenMPæ¢¯åº¦ç§¯åˆ†æ³•"><a href="#OpenMPæ¢¯åº¦ç§¯åˆ†æ³•" class="headerlink" title="OpenMPæ¢¯åº¦ç§¯åˆ†æ³•"></a>OpenMPæ¢¯åº¦ç§¯åˆ†æ³•</h2><h3 id="1-æ¢¯åº¦ç§¯åˆ†æ³•"><a href="#1-æ¢¯åº¦ç§¯åˆ†æ³•" class="headerlink" title="1.æ¢¯åº¦ç§¯åˆ†æ³•"></a>1.æ¢¯åº¦ç§¯åˆ†æ³•</h3><p><img src="/2023/01/03/openmp001/image-20230106165434252.png" alt="001"></p><p><img src="/2023/01/03/openmp001/image-20230106165507737.png" alt="image-20230106165507737"></p><h3 id="2-è¯†åˆ«ä¸¤ç±»ä»»åŠ¡"><a href="#2-è¯†åˆ«ä¸¤ç±»ä»»åŠ¡" class="headerlink" title="2.è¯†åˆ«ä¸¤ç±»ä»»åŠ¡"></a>2.è¯†åˆ«ä¸¤ç±»ä»»åŠ¡</h3><p><img src="/2023/01/03/openmp001/image-20230106164847677.png" alt="image-20230106164847677"></p><ol><li>å•ä¸ªæ¢¯å½¢çš„é¢ç§¯è®¡ç®—</li><li>æ¢¯å½¢é¢ç§¯æ±‚å’Œ</li></ol><p>åœ¨2.1çš„ä»»åŠ¡ä¸­ï¼Œæ²¡æœ‰ä»»åŠ¡é—´çš„é€šä¿¡ï¼Œä½†è¿™ä¸€ç»„ä»»åŠ¡ä¸­çš„æ¯ä¸€ç»„ä»»åŠ¡éƒ½ä¸2.2çš„ä»»åŠ¡é€šä¿¡</p><h3 id="3-ç´¯åŠ çº¿ç¨‹ç»“æœ"><a href="#3-ç´¯åŠ çº¿ç¨‹ç»“æœ" class="headerlink" title="3.ç´¯åŠ çº¿ç¨‹ç»“æœ"></a>3.ç´¯åŠ çº¿ç¨‹ç»“æœ</h3><p>â€‹ä½¿ç”¨ä¸€ä¸ªå…±äº«å˜é‡ä½œä¸ºæ‰€æœ‰çº¿ç¨‹çš„å’Œ ï¼Œæ¯ä¸ªçº¿ç¨‹å¯ä»¥å°†å®ƒè®¡ç®—çš„éƒ¨åˆ†ç»“æœç´¯åŠ åˆ°å…±äº«å˜é‡ä¸­ï¼Œè®©æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œç±»ä¼¼ä¸‹é¢çš„è¯­å¥ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp critical</span><br>global_result += myresult;                <span class="hljs-comment">//éœ€è¦äº’æ–¥è®¿é—®</span><br></code></pre></div></td></tr></table></figure><p>ç«äº‰æ¡ä»¶ï¼Œä½¿ç”¨ä¸´ç•ŒåŒºè§£å†³ã€‚ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¿™æ®µç»“æ„æ€§ä»£ç ã€‚</p><h3 id="4-ç¨‹åºå®Œæ•´ä»£ç "><a href="#4-ç¨‹åºå®Œæ•´ä»£ç " class="headerlink" title="4.ç¨‹åºå®Œæ•´ä»£ç "></a>4.ç¨‹åºå®Œæ•´ä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;omp.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Trap</span><span class="hljs-params">(<span class="hljs-keyword">double</span> a,<span class="hljs-keyword">double</span> b,<span class="hljs-keyword">int</span> n,<span class="hljs-keyword">double</span> *global_result_p)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span></span>&#123;<br><span class="hljs-keyword">double</span> global_result = <span class="hljs-number">0.0</span>;<br><span class="hljs-keyword">double</span> a,b;<span class="hljs-comment">//ä¸ºäº†åŒºåˆ†local_a,local_b</span><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> thread_count;<br><br>thread_count = <span class="hljs-number">8</span>;                                      <span class="hljs-comment">//æŒ‡å®šä½ çš„çº¿ç¨‹æ•°</span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter a,b, and n\n&quot;</span>);<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lf %lf %d&quot;</span>,&amp;a,&amp;b,&amp;n);<br>    <br>    <span class="hljs-comment">//å¹¶è¡ŒåŒºå¼€å§‹</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel num_threads(thread_count)<span class="hljs-comment">//æŒ‡å®šTrapå‡½æ•°ç”±thread_countä¸ªçº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="hljs-built_in">Trap</span>(a,b,n,&amp;global_result);<br><span class="hljs-comment">//å¹¶è¡ŒåŒºç»“æŸ</span><br>    <br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;With n = %d trapezoids, our estimate\n&quot;</span>,n);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;of the integral from %f to %f = %.4lf\n&quot;</span>,a,b,global_result);<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Trap</span><span class="hljs-params">(<span class="hljs-keyword">double</span> a,<span class="hljs-keyword">double</span> b,<span class="hljs-keyword">int</span> n,<span class="hljs-keyword">double</span> *global_result_p)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">double</span> h,x,my_result;<br><span class="hljs-keyword">double</span> local_a,local_b;<br><span class="hljs-keyword">int</span> i,local_n;<span class="hljs-comment">//local_nä»£è¡¨æœ¬è¿›ç¨‹è¢«åˆ†é…äº†å¤šå°‘ä¸ªä»»åŠ¡</span><br><span class="hljs-keyword">int</span> my_rank = <span class="hljs-built_in">omp_get_thread_num</span>();<br><span class="hljs-keyword">int</span> thread_count = <span class="hljs-built_in">omp_get_num_threads</span>();<br><br>h = (b-a)/n;<span class="hljs-comment">//æ¢¯å½¢åº•çš„é•¿åº¦</span><br>local_n = n/thread_count;<span class="hljs-comment">//æ¯ä¸ªçº¿ç¨‹åˆ†é…çš„æ¢¯å½¢æ•°ï¼Œä¿è¯èƒ½æ•´é™¤</span><br>local_a = a + my_rank*local_n*h;<span class="hljs-comment">//åŒºé—´çš„å·¦ç«¯ç‚¹</span><br>local_b = local_a + local_n*h;<span class="hljs-comment">//åŒºé—´çš„å³ç«¯ç‚¹</span><br><span class="hljs-comment">//å¯¹global_resultå…±äº«éƒ¨åˆ†å’Œ</span><br>    my_result = (<span class="hljs-built_in">f</span>(local_a) + <span class="hljs-built_in">f</span>(local_b))/<span class="hljs-number">2.0</span>;<span class="hljs-comment">//f(x)æ˜¯ç›®æ ‡å‡½æ•°</span><br><span class="hljs-keyword">for</span>(i = <span class="hljs-number">1</span> ; i&lt;=local_n<span class="hljs-number">-1</span>; i++)&#123;<br>x = local_a + i*h;<br>my_result += <span class="hljs-built_in">f</span>(x);<br>&#125;<br>my_result = my_result*h;<br>    <span class="hljs-comment">//</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp critical<span class="hljs-comment">//ä¸´ç•ŒåŒºï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨OpenMPæä¾›çš„reduction</span></span><br>*global_result_p += my_result;<span class="hljs-comment">//çº¿ç¨‹å°†éƒ¨åˆ†å’Œç»“æœç´¯åŠ åˆ°å…±äº«å˜é‡</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h3><ol><li>æ ¸å¿ƒæ˜¯æ‹†åˆ†ä»»åŠ¡åŒºåŸŸï¼ŒæŠŠå­ä»»åŠ¡åˆ†é…åˆ°ä¸ªä¸ªçº¿ç¨‹</li><li>å…±äº«å˜é‡çš„é€‰å–å†³å®šäº†å¯å¹¶è¡Œåº¦</li><li>é€šè¿‡å…±äº«å˜é‡å®ç°äº†å½’çº¦çš„æ“ä½œ(è¿™é‡Œä½¿ç”¨åˆ°äº†ä¸´ç•ŒåŒº)</li></ol><h3 id="6-å‚è€ƒèµ„æ–™"><a href="#6-å‚è€ƒèµ„æ–™" class="headerlink" title="6.å‚è€ƒèµ„æ–™"></a>6.å‚è€ƒèµ„æ–™</h3><p>å¹¶è¡Œç¨‹åºå¯¼è®º ï¼ˆç¾ï¼‰Peter S.Pacheco</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OpenMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å›½å†…å¸¸ç”¨é•œåƒæº</title>
    <link href="/2022/06/22/mirror001/"/>
    <url>/2022/06/22/mirror001/</url>
    
    <content type="html"><![CDATA[<h2 id="å›½å†…å¸¸ç”¨é•œåƒæº"><a href="#å›½å†…å¸¸ç”¨é•œåƒæº" class="headerlink" title="å›½å†…å¸¸ç”¨é•œåƒæº"></a>å›½å†…å¸¸ç”¨é•œåƒæº</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">æ¸…åå¤§å­¦ï¼š https:<span class="hljs-comment">//pypi.tuna.tsinghua.edu.cn/simple/</span><br>é˜¿é‡Œäº‘ï¼š https:<span class="hljs-comment">//mirrors.aliyun.com/pypi/simple/</span><br>è±†ç“£ï¼š http:<span class="hljs-comment">//pypi.douban.com/simple/</span><br>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ï¼š http:<span class="hljs-comment">//pypi.mirrors.ustc.edu.cn/simple/</span><br>åä¸­ç§‘æŠ€å¤§å­¦ï¼šhttp:<span class="hljs-comment">//pypi.hustunique.com/simple/</span><br>å±±ä¸œç†å·¥å¤§å­¦ï¼šhttp:<span class="hljs-comment">//pypi.sdutlinux.org/simple/</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Mirror</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…å­˜å¯¹é½</title>
    <link href="/2022/06/12/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/"/>
    <url>/2022/06/12/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/</url>
    
    <content type="html"><![CDATA[<h1 id="å†…å­˜å¯¹é½"><a href="#å†…å­˜å¯¹é½" class="headerlink" title="å†…å­˜å¯¹é½"></a>å†…å­˜å¯¹é½</h1><h2 id="CPUè¯»å–å†…å­˜çš„æ–¹å¼"><a href="#CPUè¯»å–å†…å­˜çš„æ–¹å¼" class="headerlink" title="CPUè¯»å–å†…å­˜çš„æ–¹å¼"></a>CPUè¯»å–å†…å­˜çš„æ–¹å¼</h2><p>CPUè¯»å–å†…å­˜çš„æ–¹å¼å…¶å®éå¸¸å¤æ‚ï¼Œä¸ºäº†æ›´è¿›ä¸€æ­¥çš„äº†è§£ç›¸å…³çš„åŸç†ï¼Œéœ€è¦å¯¹è®¡ç®—æœºç»„æˆåŸç†è¿›è¡Œæ·±åº¦å­¦ä¹ ã€‚</p><h3 id="Memory-access-granularity-å†…å­˜è¯»å–ç²’åº¦"><a href="#Memory-access-granularity-å†…å­˜è¯»å–ç²’åº¦" class="headerlink" title="Memory access granularity(å†…å­˜è¯»å–ç²’åº¦)"></a>Memory access granularity(å†…å­˜è¯»å–ç²’åº¦)</h3><p>However, your computerâ€™s processor does not read from and write to memory in byte-sized chunks. Instead, it accesses memory in two-, four-, eight- 16- or even 32-byte chunks. Weâ€™ll call the size in which a processor accesses memory its memory access granularity.</p><p>CPUæŠŠå†…å­˜å½“æˆæ˜¯ä¸€å—ä¸€å—çš„ï¼Œå—çš„å¤§å°å¯ä»¥æ˜¯2ï¼Œ4ï¼Œ8ï¼Œ16å­—èŠ‚å¤§å°ï¼Œå› æ­¤CPUåœ¨è¯»å–å†…å­˜æ—¶æ˜¯ä¸€å—ä¸€å—è¿›è¡Œè¯»å–çš„ã€‚å—å¤§å°æˆä¸º<em>memory access granularityï¼ˆç²’åº¦ï¼‰</em> æœ¬äººæŠŠå®ƒç¿»è¯‘ä¸ºâ€œå†…å­˜è¯»å–ç²’åº¦â€ ã€‚</p><p><a href="https://www.cnblogs.com/feng9exe/p/10059543.html">https://www.cnblogs.com/feng9exe/p/10059543.html</a> â€å†…å­˜å¯¹é½â€œ</p><h2 id="å†…å­˜å¯¹é½ä¸¾ä¾‹"><a href="#å†…å­˜å¯¹é½ä¸¾ä¾‹" class="headerlink" title="å†…å­˜å¯¹é½ä¸¾ä¾‹"></a>å†…å­˜å¯¹é½ä¸¾ä¾‹</h2><p>å‡è®¾æ­¤è®¡ç®—æœºçš„å†…å­˜è¯»å–ç²’åº¦æ˜¯4ã€‚</p><h3 id="å¦‚æœå†…å­˜å¯¹é½æ—¶"><a href="#å¦‚æœå†…å­˜å¯¹é½æ—¶" class="headerlink" title="å¦‚æœå†…å­˜å¯¹é½æ—¶"></a>å¦‚æœå†…å­˜å¯¹é½æ—¶</h3><p>å‰æçŸ¥è¯†ï¼š</p><p>1 Byte &#x3D; 8bit </p><p>1 int8 å ç”¨ 1 Byte</p><p>1 int16 å ç”¨ 2 Byte</p><p>1 int32 å ç”¨ 4 Byte</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//ä¸€ä¸ªç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">S</span></span><br><span class="hljs-class">&#123;</span><br>    int8 a;<br>    int32 b;<br>&#125;<br></code></pre></div></td></tr></table></figure><table><thead><tr><th>0</th><th>1</th><th>2</th><th>3</th><th align="center">4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td>int8 a</td><td></td><td></td><td></td><td align="center">int32 b</td><td>int32 b</td><td>int32 b</td><td>int32 b</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>æˆ‘ä»¬å¯ä»¥å‘ç°int8 aå‚¨å­˜åœ¨0å·å†…å­˜ä¸Šï¼Œå ç”¨1ä¸ªByteï¼Œ1-3å·å†…å­˜ç©ºä¸‹äº†3ä¸ªByteã€‚int32 bå‚¨å­˜åœ¨äº†4-7å·å†…å­˜ï¼Œä¸€å…±4ä¸ªByteã€‚</p><p>ç”±äºæ­¤è®¡ç®—æœºçš„å†…å­˜è¯»å–ç²’åº¦æ—¶æ˜¯4</p><p>å½“éœ€è¦è¯»å–a(0å·å†…å­˜)æ—¶ï¼Œè®¡ç®—æœºä¼šè¯»å–0-3å·ä¸€ç»„å†…å­˜ï¼Œç„¶åå»æ‰1-3å·å†…å­˜ã€‚è®¿é—®æ¬¡æ•°1æ¬¡ã€‚</p><p>å½“éœ€è¦è¯»å–b(4-7å·å†…å­˜æ—¶)ï¼Œè®¡ç®—æœºä¼šè¯»å–4-7å·å†…å­˜ï¼Œè®¿é—®æ¬¡æ•°1æ¬¡ã€‚</p><h3 id="å¦‚æœå†…å­˜æ²¡æœ‰å¯¹é½æ—¶"><a href="#å¦‚æœå†…å­˜æ²¡æœ‰å¯¹é½æ—¶" class="headerlink" title="å¦‚æœå†…å­˜æ²¡æœ‰å¯¹é½æ—¶"></a>å¦‚æœå†…å­˜æ²¡æœ‰å¯¹é½æ—¶</h3><table><thead><tr><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td>int8 a</td><td>int32 b</td><td>int32 b</td><td>int32 b</td><td>int32 b</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>æˆ‘ä»¬å¯ä»¥å‘ç°int8 aå‚¨å­˜åœ¨0å·å†…å­˜ä¸Šï¼Œå ç”¨äº†1ä¸ªByteã€‚int32 bå‚¨å­˜åœ¨1-4å·å†…å­˜ä¸Šï¼Œä¸€å…±4ä¸ªByteã€‚</p><p>ç”±äºæ­¤è®¡ç®—æœºçš„å†…å­˜è¯»å–ç²’åº¦æ—¶æ˜¯4</p><p>å½“éœ€è¦è¯»å–a(0å·å†…å­˜)æ—¶ï¼Œè®¡ç®—æœºä¼šè¯»å–0-3å·ä¸€ç»„å†…å­˜ï¼Œç„¶åå»æ‰1-3å·å†…å­˜ã€‚è®¿é—®æ¬¡æ•°1æ¬¡ã€‚</p><p>å½“éœ€è¦è¯»å–b(1-4å·å†…å­˜)æ—¶ï¼Œè®¡ç®—æœºä¼šå…ˆè¯»å–0-3å·ä¸€ç»„å†…å­˜ï¼Œå»æ‰0å·å†…å­˜ï¼Œå†è¯»å–4-7å·ä¸€ç»„å†…å­˜ï¼Œå»æ‰5-7å·å†…å­˜ï¼Œéšåå†æ‹¼æ¥1-3å·å†…å­˜å’Œ4å·å†…å­˜ç»„æˆå®Œæ•´çš„bã€‚è®¿é—®æ¬¡æ•°2æ¬¡ã€‚</p><h2 id="å†…å­˜å¯¹é½çš„ç›®çš„"><a href="#å†…å­˜å¯¹é½çš„ç›®çš„" class="headerlink" title="å†…å­˜å¯¹é½çš„ç›®çš„"></a>å†…å­˜å¯¹é½çš„ç›®çš„</h2><p>åˆç†çš„å†…å­˜å¯¹é½å¯ä»¥é«˜æ•ˆçš„åˆ©ç”¨ç¡¬ä»¶æ€§èƒ½ï¼Œå‡å°‘å¤„ç†å™¨å†…å­˜è®¿é—®æ¬¡æ•°ã€‚</p><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p><a href="https://www.bilibili.com/video/BV1Vt4y1m7DP?from=search&amp;amp;seid=13964421962700904405&amp;amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1Vt4y1m7DP?from=search&amp;amp;seid=13964421962700904405&amp;amp;spm_id_from=333.337.0.0</a> â€œå†…å­˜å¯¹é½â€</p><p><a href="https://www.bilibili.com/video/BV1v64y1X7YP?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1v64y1X7YP?spm_id_from=333.999.0.0</a> â€œå†…å­˜å¯¹é½å¯¹ç¨‹åºæ€§èƒ½çš„å½±å“â€</p>]]></content>
    
    
    <categories>
      
      <category>Computer Organization</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>MPIå­¦ä¹ (ä¸€)-ç®€å•çš„å‘é€æ¥æ”¶</title>
    <link href="/2022/06/12/MPI%E5%AD%A6%E4%B9%A0(%E4%B8%80)-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6/"/>
    <url>/2022/06/12/MPI%E5%AD%A6%E4%B9%A0(%E4%B8%80)-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="MPI-ç®€å•çš„å‘é€æ¥æ”¶"><a href="#MPI-ç®€å•çš„å‘é€æ¥æ”¶" class="headerlink" title="MPI-ç®€å•çš„å‘é€æ¥æ”¶"></a>MPI-ç®€å•çš„å‘é€æ¥æ”¶</h1><p>æ‰“å°æ¥è‡ªè¿›ç¨‹é—®å€™è¯­å¥çš„MPIç¨‹åº</p><h2 id="æ‰€ä½¿ç”¨çš„MPIåŸè¯­"><a href="#æ‰€ä½¿ç”¨çš„MPIåŸè¯­" class="headerlink" title="æ‰€ä½¿ç”¨çš„MPIåŸè¯­"></a>æ‰€ä½¿ç”¨çš„MPIåŸè¯­</h2><p><img src="/2022/06/12/MPI%E5%AD%A6%E4%B9%A0(%E4%B8%80)-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6/mpi001.png"></p><p><img src="/2022/06/12/MPI%E5%AD%A6%E4%B9%A0(%E4%B8%80)-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6/mpi002.png"></p><h2 id="ç¨‹åºè¿è¡Œå¹³å°"><a href="#ç¨‹åºè¿è¡Œå¹³å°" class="headerlink" title="ç¨‹åºè¿è¡Œå¹³å°"></a>ç¨‹åºè¿è¡Œå¹³å°</h2><p>åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒA3åˆ†åŒº</p><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><p>mpi&#x2F;intel&#x2F;2017.5</p><h2 id="ç¼–è¯‘æŒ‡ä»¤"><a href="#ç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="ç¼–è¯‘æŒ‡ä»¤"></a>ç¼–è¯‘æŒ‡ä»¤</h2><p>mpicc  3.1.cpp -o 3.1</p><h2 id="è¿è¡ŒæŒ‡ä»¤"><a href="#è¿è¡ŒæŒ‡ä»¤" class="headerlink" title="è¿è¡ŒæŒ‡ä»¤"></a>è¿è¡ŒæŒ‡ä»¤</h2><p>mpirun -np 4 .&#x2F;3.1(æœ¬åœ°æäº¤,é‡‡å–4ä¸ªè¿›ç¨‹)</p><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mpi.h&gt;</span>   <span class="hljs-comment">//å¤´æ–‡ä»¶</span></span><br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MAX_STRING = <span class="hljs-number">100</span> ;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">char</span> greeting[MAX_STRING];<br><span class="hljs-keyword">int</span> comm_sz;<br><span class="hljs-keyword">int</span> my_rank;<br>MPI_Status status;<br><br><span class="hljs-built_in">MPI_Init</span>(&amp;argc,&amp;argv);<br><br><span class="hljs-built_in">MPI_Comm_size</span>(MPI_COMM_WORLD,&amp;comm_sz);<br><span class="hljs-built_in">MPI_Comm_rank</span>(MPI_COMM_WORLD,&amp;my_rank);<br><br><span class="hljs-keyword">if</span>(my_rank != <span class="hljs-number">0</span>)<br>&#123;<br><span class="hljs-comment">//å…¶ä»–è¿›ç¨‹å‘0å·è¿›ç¨‹å‘æ¶ˆæ¯</span><br><span class="hljs-built_in">sprintf</span>(greeting,<span class="hljs-string">&quot;Greetings from process %d of %d!&quot;</span>,my_rank,comm_sz);<br><span class="hljs-built_in">MPI_Send</span>(greeting,<span class="hljs-built_in">strlen</span>(greeting)+<span class="hljs-number">1</span>,MPI_CHAR,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,MPI_COMM_WORLD); <br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Greetings from process %d of %d!\n&quot;</span>,my_rank,comm_sz);<br><span class="hljs-comment">//0å·è¿›ç¨‹æ¥å—æ¥è‡ªå…¶ä»–è¿›ç¨‹çš„æ¶ˆæ¯å¹¶è¾“å‡º</span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> q=<span class="hljs-number">1</span>;q&lt;comm_sz;q++)<br>&#123;<br><span class="hljs-built_in">MPI_Recv</span>(greeting,MAX_STRING,MPI_CHAR,q,<span class="hljs-number">0</span>,MPI_COMM_WORLD,&amp;status);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>,greeting);<br>&#125;<br>&#125;<br><span class="hljs-built_in">MPI_Finalize</span>();<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¿è¡Œç»“æœ"><a href="#ç¨‹åºè¿è¡Œç»“æœ" class="headerlink" title="ç¨‹åºè¿è¡Œç»“æœ"></a>ç¨‹åºè¿è¡Œç»“æœ</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">Greetings from process <span class="hljs-number">0</span> of <span class="hljs-number">4</span>!<br>Greetings from process <span class="hljs-number">1</span> of <span class="hljs-number">4</span>!<br>Greetings from process <span class="hljs-number">2</span> of <span class="hljs-number">4</span>!<br>Greetings from process <span class="hljs-number">3</span> of <span class="hljs-number">4</span>!<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AVXå‘é‡åŒ–å­¦ä¹ (äºŒ)-å†…å­˜å¯¹é½çš„åº”ç”¨</title>
    <link href="/2022/06/12/AVX%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%A6%E4%B9%A0(%E4%BA%8C)-%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E7%9A%84%E5%BA%94%E7%94%A8/"/>
    <url>/2022/06/12/AVX%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%A6%E4%B9%A0(%E4%BA%8C)-%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E7%9A%84%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ-å†…å­˜å¯¹é½ç‰ˆ"><a href="#AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ-å†…å­˜å¯¹é½ç‰ˆ" class="headerlink" title="AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ(å†…å­˜å¯¹é½ç‰ˆ)"></a>AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ(å†…å­˜å¯¹é½ç‰ˆ)</h1><p>ä½¿ç”¨AVXæŒ‡ä»¤é›†è¿›è¡Œ2ä¸ªdoubleå‹çš„æ•°ç»„ç›¸åŠ æ“ä½œ</p><h2 id="å¸¸ç”¨çš„å†…å­˜å¯¹é½å‡½æ•°"><a href="#å¸¸ç”¨çš„å†…å­˜å¯¹é½å‡½æ•°" class="headerlink" title="å¸¸ç”¨çš„å†…å­˜å¯¹é½å‡½æ•°"></a>å¸¸ç”¨çš„å†…å­˜å¯¹é½å‡½æ•°</h2><p>å› ä¸ºAVXä¸­è¦æ±‚mem__addrå¿…é¡»åœ¨32å­—èŠ‚è¾¹ç•Œä¸Šå¯¹é½ï¼Œå¦åˆ™å¯èƒ½ä¼šäº§ç”Ÿé€šç”¨ä¿æŠ¤å¼‚å¸¸ã€‚  </p><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span>*a =(<span class="hljs-keyword">double</span>*)<span class="hljs-built_in">memalign</span>(<span class="hljs-number">32</span>,<span class="hljs-number">9</span>*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>));<br></code></pre></div></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span>*a =(<span class="hljs-keyword">double</span>*)_mm_malloc(<span class="hljs-number">9</span>*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>),<span class="hljs-number">32</span>);<br></code></pre></div></td></tr></table></figure><h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">double</span>*a =(<span class="hljs-keyword">double</span>*)<span class="hljs-built_in">aligned_alloc</span>(<span class="hljs-number">32</span>,<span class="hljs-number">9</span>*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>));<br></code></pre></div></td></tr></table></figure><h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__attribute__ ((<span class="hljs-built_in">aligned</span>(<span class="hljs-number">32</span>)))<span class="hljs-keyword">double</span> a[<span class="hljs-number">9</span>]  =&#123;<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>,<span class="hljs-number">4.4</span>,<span class="hljs-number">5.5</span>,<span class="hljs-number">6.6</span>,<span class="hljs-number">7.7</span>,<span class="hljs-number">8.8</span>,<span class="hljs-number">2.1</span>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"><a href="#ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»" class="headerlink" title="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"></a>ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1."></a>1.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256d _mm256_load_pd (<span class="hljs-keyword">double</span> <span class="hljs-keyword">const</span> * mem_addr)<br></code></pre></div></td></tr></table></figure><p><strong>Description</strong></p><p>Load 256-bits (composed of 4 packed double-precision (64-bit) floating-point elements) from memory into dst. mem_addr must be aligned on a 32-byte boundary or a general-protection exception may be generated.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">dst[<span class="hljs-number">255</span>:<span class="hljs-number">0</span>] := MEM[mem_addr+<span class="hljs-number">255</span>:mem_addr]<br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h3 id="2-1"><a href="#2-1" class="headerlink" title="2."></a>2.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256 _mm256_add_ps (__m256 a, __m256 b)<br></code></pre></div></td></tr></table></figure><p><strong>Description</strong></p><p>Add packed single-precision (32-bit) floating-point elements in a and b, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">FOR</span> j := <span class="hljs-number">0</span> to <span class="hljs-number">7</span><br><span class="hljs-attribute">i</span> := j*<span class="hljs-number">32</span><br><span class="hljs-attribute">dst</span>[i+<span class="hljs-number">31</span>:i] := a[i+<span class="hljs-number">31</span>:i] + b[i+<span class="hljs-number">31</span>:i]<br><span class="hljs-attribute">ENDFOR</span><br><span class="hljs-attribute">dst</span>[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h3 id="3-streamçš„ä½œç”¨ï¼šç»•è¿‡ç¼“å­˜ç›´æ¥å†™å…¥å†…å­˜"><a href="#3-streamçš„ä½œç”¨ï¼šç»•è¿‡ç¼“å­˜ç›´æ¥å†™å…¥å†…å­˜" class="headerlink" title="3.streamçš„ä½œç”¨ï¼šç»•è¿‡ç¼“å­˜ç›´æ¥å†™å…¥å†…å­˜"></a>3.streamçš„ä½œç”¨ï¼šç»•è¿‡ç¼“å­˜ç›´æ¥å†™å…¥å†…å­˜</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">void</span> _mm256_stream_pd (<span class="hljs-keyword">double</span> * mem_addr, __m256d a)<br></code></pre></div></td></tr></table></figure><p><strong>Description</strong></p><p>Store 256-bits (composed of 4 packed double-precision (64-bit) floating-point elements) from a into memory using a non-temporal memory hint. mem_addr must be aligned on a 32-byte boundary or a general-protection exception may be generated.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">MEM[mem_addr+<span class="hljs-number">255</span>:mem_addr] := a[<span class="hljs-number">255</span>:<span class="hljs-number">0</span>]<br></code></pre></div></td></tr></table></figure><h2 id="æ ·ä¾‹ç¨‹åºä¸¾ä¾‹ï¼š"><a href="#æ ·ä¾‹ç¨‹åºä¸¾ä¾‹ï¼š" class="headerlink" title="æ ·ä¾‹ç¨‹åºä¸¾ä¾‹ï¼š"></a>æ ·ä¾‹ç¨‹åºä¸¾ä¾‹ï¼š</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;malloc.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">double</span>*a =(<span class="hljs-keyword">double</span>*)<span class="hljs-built_in">memalign</span>(<span class="hljs-number">32</span>,<span class="hljs-number">9</span>*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>));<br><span class="hljs-keyword">double</span>*b =(<span class="hljs-keyword">double</span>*)<span class="hljs-built_in">memalign</span>(<span class="hljs-number">32</span>,<span class="hljs-number">4</span>*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>));<br><span class="hljs-keyword">double</span> af[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>,<span class="hljs-number">4.4</span>,<span class="hljs-number">5.5</span>,<span class="hljs-number">6.6</span>,<span class="hljs-number">7.7</span>,<span class="hljs-number">8.8</span>,<span class="hljs-number">2.1</span>&#125; ;<br><span class="hljs-keyword">double</span> bf[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">2.1</span>,<span class="hljs-number">3.2</span>,<span class="hljs-number">6.4</span>,<span class="hljs-number">8.6</span>,<span class="hljs-number">3.7</span>,<span class="hljs-number">9.9</span>,<span class="hljs-number">5.1</span>,<span class="hljs-number">4.2</span>,<span class="hljs-number">6.6</span>&#125;;<br><span class="hljs-keyword">double</span>*c =(<span class="hljs-keyword">double</span>*)<span class="hljs-built_in">memalign</span>(<span class="hljs-number">32</span>,<span class="hljs-number">4</span>*<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">double</span>));<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br>a[i]=af[i];<br>b[i]=bf[i];<br>&#125;<br><span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br>__m256d v0;<br>__m256d v1;<br>__m256d v2;<br><span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-number">9</span><span class="hljs-number">-4</span>;i+=<span class="hljs-number">4</span>)<br>&#123;<br>v0 = _mm256_load_pd(a+i);<br>v1 = _mm256_load_pd(b+i);<br>v2=_mm256_add_pd(v0,v1);<br> _mm256_stream_pd(c+i,v2);<br><br>&#125;<br><span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br>c[i]=a[i]+b[i];<br><br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is c.\n&quot;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf\n&quot;</span>,c[i]);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125; <br></code></pre></div></td></tr></table></figure><h2 id="æ ·ä¾‹ç¨‹åºè¾“å‡ºï¼š"><a href="#æ ·ä¾‹ç¨‹åºè¾“å‡ºï¼š" class="headerlink" title="æ ·ä¾‹ç¨‹åºè¾“å‡ºï¼š"></a>æ ·ä¾‹ç¨‹åºè¾“å‡ºï¼š</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">this</span> is c.<br><span class="hljs-number">3.200000</span><br><span class="hljs-number">5.400000</span><br><span class="hljs-number">9.700000</span><br><span class="hljs-number">13.000000</span><br><span class="hljs-number">9.200000</span><br><span class="hljs-number">16.500000</span><br><span class="hljs-number">12.800000</span><br><span class="hljs-number">13.000000</span><br><span class="hljs-number">8.700000</span><br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p>[<a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/]">https://software.intel.com/sites/landingpage/IntrinsicsGuide/]</a>: â€œIntelÂ® Intrinsics Guideâ€</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AVX</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AVXå‘é‡åŒ–å­¦ä¹ (ä¸€)</title>
    <link href="/2022/06/12/AVX%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%A6%E4%B9%A0(%E4%B8%80)/"/>
    <url>/2022/06/12/AVX%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%A6%E4%B9%A0(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<h1 id="AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ"><a href="#AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ" class="headerlink" title="AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ"></a>AVXæŒ‡ä»¤é›†çš„ç®€å•æ“ä½œ</h1><p>ä½¿ç”¨AVXæŒ‡ä»¤é›†è¿›è¡Œ2ä¸ªdoubleå‹çš„æ•°ç»„ç›¸åŠ æ“ä½œ</p><h2 id="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"><a href="#ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»" class="headerlink" title="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"></a>ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256 _mm256_loadu_ps (<span class="hljs-keyword">float</span> <span class="hljs-keyword">const</span> * mem_addr)<br></code></pre></div></td></tr></table></figure><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Load 256-bits (composed of 8 packed single-precision (32-bit) floating-point elements) from memory into dst. mem_addr does not need to be aligned on any particular boundary.</p><h3 id="Operation"><a href="#Operation" class="headerlink" title="Operation"></a>Operation</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">dst[<span class="hljs-number">255</span>:<span class="hljs-number">0</span>] := MEM[mem_addr+<span class="hljs-number">255</span>:mem_addr]<br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256d _mm256_add_pd (__m256d a, __m256d b)<br></code></pre></div></td></tr></table></figure><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Add packed double-precision (64-bit) floating-point elements in a and b, and store the results in dst.</p><h3 id="Operation-1"><a href="#Operation-1" class="headerlink" title="Operation"></a>Operation</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">FOR j := <span class="hljs-number">0</span> to <span class="hljs-number">3</span><br>i := j*<span class="hljs-number">64</span><br>dst[i+<span class="hljs-number">63</span>:i] := a[i+<span class="hljs-number">63</span>:i] + b[i+<span class="hljs-number">63</span>:i]<br>ENDFOR<br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">void</span> _mm256_storeu_pd (<span class="hljs-keyword">double</span> * mem_addr, __m256d a)<br></code></pre></div></td></tr></table></figure><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>Store 256-bits (composed of 4 packed double-precision (64-bit) floating-point elements) from a into memory. mem_addr does not need to be aligned on any particular boundary.</p><h3 id="Operation-2"><a href="#Operation-2" class="headerlink" title="Operation"></a>Operation</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">MEM[mem_addr+<span class="hljs-number">255</span>:mem_addr] := a[<span class="hljs-number">255</span>:<span class="hljs-number">0</span>]<br></code></pre></div></td></tr></table></figure><h2 id="æœªè¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ"><a href="#æœªè¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ" class="headerlink" title="æœªè¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ"></a>æœªè¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ</h2><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">double</span> a[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>,<span class="hljs-number">4.4</span>,<span class="hljs-number">5.5</span>,<span class="hljs-number">6.6</span>,<span class="hljs-number">7.7</span>,<span class="hljs-number">8.8</span>,<span class="hljs-number">2.1</span>&#125;;<br><span class="hljs-keyword">double</span> b[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">2.1</span>,<span class="hljs-number">3.2</span>,<span class="hljs-number">6.4</span>,<span class="hljs-number">8.6</span>,<span class="hljs-number">3.7</span>,<span class="hljs-number">9.9</span>,<span class="hljs-number">5.1</span>,<span class="hljs-number">4.2</span>,<span class="hljs-number">6.6</span>&#125;;<br><span class="hljs-keyword">double</span> c[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span> ;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br>c[i]=a[i]+b[i];<br><br>&#125;<br><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is c.\n&quot;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf\n&quot;</span>,c[i]);<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125; <br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">this</span> is c.<br><span class="hljs-number">3.200000</span><br><span class="hljs-number">5.400000</span><br><span class="hljs-number">9.700000</span><br><span class="hljs-number">13.000000</span><br><span class="hljs-number">9.200000</span><br><span class="hljs-number">16.500000</span><br><span class="hljs-number">12.800000</span><br><span class="hljs-number">13.000000</span><br><span class="hljs-number">8.700000</span><br></code></pre></div></td></tr></table></figure><h2 id="è¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ"><a href="#è¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ" class="headerlink" title="è¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ"></a>è¿›è¡ŒAVXå‘é‡åŒ–çš„æƒ…å†µ</h2><h3 id="ç¨‹åºæºä»£ç -1"><a href="#ç¨‹åºæºä»£ç -1" class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">double</span> a[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>,<span class="hljs-number">4.4</span>,<span class="hljs-number">5.5</span>,<span class="hljs-number">6.6</span>,<span class="hljs-number">7.7</span>,<span class="hljs-number">8.8</span>,<span class="hljs-number">2.1</span>&#125;;<br><span class="hljs-keyword">double</span> b[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">2.1</span>,<span class="hljs-number">3.2</span>,<span class="hljs-number">6.4</span>,<span class="hljs-number">8.6</span>,<span class="hljs-number">3.7</span>,<span class="hljs-number">9.9</span>,<span class="hljs-number">5.1</span>,<span class="hljs-number">4.2</span>,<span class="hljs-number">6.6</span>&#125;;<br><span class="hljs-keyword">double</span> c[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>__m256d v0;<br>__m256d v1;<br>__m256d v2;<br><span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-number">9</span><span class="hljs-number">-4</span>;i+=<span class="hljs-number">4</span>)<br>&#123;<br>v0 = _mm256_loadu_pd(a+i);<br>v1 = _mm256_loadu_pd(b+i);<br>v2=_mm256_add_pd(v0,v1);<br> _mm256_storeu_pd(c+i,v2);<br><br>&#125;<br><span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br>c[i]=a[i]+b[i];<br><br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is c with AVX.\n&quot;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf\n&quot;</span>,c[i]);<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125; <br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡º-1"><a href="#ç¨‹åºè¾“å‡º-1" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">this</span> is c with AVX.<br><span class="hljs-number">3.200000</span><br><span class="hljs-number">5.400000</span><br><span class="hljs-number">9.700000</span><br><span class="hljs-number">13.000000</span><br><span class="hljs-number">9.200000</span><br><span class="hljs-number">16.500000</span><br><span class="hljs-number">12.800000</span><br><span class="hljs-number">13.000000</span><br><span class="hljs-number">8.700000</span><br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p>[<a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/]">https://software.intel.com/sites/landingpage/IntrinsicsGuide/]</a>: â€œ IntelÂ® Intrinsics Guideâ€</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AVX</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Slurm</title>
    <link href="/2022/05/20/slurm001/"/>
    <url>/2022/05/20/slurm001/</url>
    
    <content type="html"><![CDATA[<h2 id="Slurm"><a href="#Slurm" class="headerlink" title="Slurm"></a>Slurm</h2><h4 id="1-sstat-æŸ¥çœ‹RUNNINGä½œä¸š"><a href="#1-sstat-æŸ¥çœ‹RUNNINGä½œä¸š" class="headerlink" title="1.sstat æŸ¥çœ‹RUNNINGä½œä¸š"></a>1.sstat æŸ¥çœ‹RUNNINGä½œä¸š</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sstat -e<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/slurm001/image-20220520174453969.png" alt="image-20220520174453969"></p><p><strong>ä½¿ç”¨ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sstat -a --format=&quot;JobId,Pids,AveCPU,AveRSS,MaxRSS&quot;  1755818<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/slurm001/image-20220520175001331.png" alt="image-20220520175001331"></p><h4 id="2-sacct-æŸ¥çœ‹FINISHEDä½œä¸š"><a href="#2-sacct-æŸ¥çœ‹FINISHEDä½œä¸š" class="headerlink" title="2.sacct æŸ¥çœ‹FINISHEDä½œä¸š"></a>2.sacct æŸ¥çœ‹FINISHEDä½œä¸š</h4><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sacct -e<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/slurm001/image-20220520174622868.png" alt="image-20220520174622868"></p><p><strong>ä½¿ç”¨ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sacct --format=&quot;JobId,Elapsed,CPUTime,CPUTimeRAW,AveCPU,TotalCPU,UserCPU,SystemCPU,AveRSS,MaxRSS&quot; -j 1754217<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/slurm001/image-20220520174807162.png" alt="image-20220520174807162"></p><h4 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h4><p><a href="https://blog.csdn.net/kongxx/article/details/52556943">(28æ¡æ¶ˆæ¯) SlurmæŸ¥çœ‹ä½œä¸šCPUå’ŒMEM_kongxxçš„åšå®¢-CSDNåšå®¢_slurm æŸ¥çœ‹èŠ‚ç‚¹</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Slurm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>numactl</title>
    <link href="/2022/05/20/numactl001/"/>
    <url>/2022/05/20/numactl001/</url>
    
    <content type="html"><![CDATA[<ol><li></li></ol><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">numactl --hardware<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/numactl001/image-20220520173911653.png" alt="image-20220520173911653"></p><ol start="2"><li></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shelll">numastat<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/numactl001/image-20220520174030171.png" alt="image-20220520174030171"></p><ol start="3"><li></li></ol><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">numactl --show<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/numactl001/image-20220520174148487.png" alt="image-20220520174148487"></p><h5 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h5><p><a href="https://blog.csdn.net/qccz123456/article/details/81979819">(28æ¡æ¶ˆæ¯) Linuxå·¥å…·ä¹‹numactl_qccz123456çš„åšå®¢-CSDNåšå®¢_numactl</a></p><p><a href="https://baijiahao.baidu.com/s?id=1699088343604813491&wfr=spider&for=pc&searchword=numactl">å®‹å®åï¼šä¸ºä»€ä¹ˆnumactlå†…å­˜ç»‘å®šå¯¹ä»£ç æ®µä¸èµ·ä½œç”¨ (baidu.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Numactl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linuxçš„jobs,fg,bgå‘½ä»¤</title>
    <link href="/2022/05/20/Linux002/"/>
    <url>/2022/05/20/Linux002/</url>
    
    <content type="html"><![CDATA[<h3 id="linuxè®©å‰å°ç¨‹åºè„±ç¦»ç»ˆç«¯è¿è¡Œ"><a href="#linuxè®©å‰å°ç¨‹åºè„±ç¦»ç»ˆç«¯è¿è¡Œ" class="headerlink" title="linuxè®©å‰å°ç¨‹åºè„±ç¦»ç»ˆç«¯è¿è¡Œ"></a>linuxè®©å‰å°ç¨‹åºè„±ç¦»ç»ˆç«¯è¿è¡Œ</h3><p>1.é¦–å…ˆè¿è¡Œä½ çš„ç¨‹åº</p><p><img src="/2022/05/20/Linux002/image-20220520171436032.png" alt="image-20220520171436032"></p><p>2.éšåä½¿ç”¨Ctrl + zï¼ŒæŒ‚èµ·ä½ çš„è¿›ç¨‹</p><p><img src="/2022/05/20/Linux002/image-20220520171510946.png" alt="image-20220520171510946"></p><p>3.ç„¶åä½¿ç”¨jobsæŸ¥çœ‹æ‰€æœ‰çš„è¿›ç¨‹</p><p><img src="/2022/05/20/Linux002/image-20220520171913979.png" alt="image-20220520171913979"></p><p>4.éšåä½¿ç”¨bg+idï¼Œè¡¨ç¤ºè¯¥ä»»åŠ¡ä¸ºåå°1å·ä»»åŠ¡</p><p>bgå‘½ä»¤ç”¨äºå°†ä½œä¸šæ”¾åˆ°åå°è¿è¡Œï¼Œä½¿å‰å°å¯ä»¥æ‰§è¡Œå…¶ä»–ä»»åŠ¡</p><p><img src="/2022/05/20/Linux002/image-20220520172110992.png" alt="image-20220520172110992"></p><h3 id="linuxè®©åå°ç¨‹åºç§»åŠ¨åˆ°å‰å°ç»ˆç«¯"><a href="#linuxè®©åå°ç¨‹åºç§»åŠ¨åˆ°å‰å°ç»ˆç«¯" class="headerlink" title="linuxè®©åå°ç¨‹åºç§»åŠ¨åˆ°å‰å°ç»ˆç«¯"></a>linuxè®©åå°ç¨‹åºç§»åŠ¨åˆ°å‰å°ç»ˆç«¯</h3><p>Linuxå¸¸ç”¨å‘½ä»¤fgä¸»è¦ç”¨äºå°†åå°ä½œä¸šç§»åŠ¨åˆ°å‰å°ç»ˆç«¯è¿è¡Œ</p><p><img src="/2022/05/20/Linux002/image-20220520172358345.png" alt="image-20220520172358345"></p>]]></content>
    
    
    <categories>
      
      <category>Operating System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå¸¸ç”¨æŒ‡ä»¤</title>
    <link href="/2022/05/20/Linux001/"/>
    <url>/2022/05/20/Linux001/</url>
    
    <content type="html"><![CDATA[<h2 id="Linuxå¸¸ç”¨æŒ‡ä»¤"><a href="#Linuxå¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="Linuxå¸¸ç”¨æŒ‡ä»¤"></a>Linuxå¸¸ç”¨æŒ‡ä»¤</h2><h4 id="æ€æ­»è¿›ç¨‹"><a href="#æ€æ­»è¿›ç¨‹" class="headerlink" title="æ€æ­»è¿›ç¨‹"></a>æ€æ­»è¿›ç¨‹</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">kill <span class="hljs-number">-9</span> id<br></code></pre></div></td></tr></table></figure><p><img src="/2022/05/20/Linux001/image-20220520171246860.png" alt="image-20220520171246860"></p>]]></content>
    
    
    <categories>
      
      <category>Operating System</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-å®Œæ•´æ ·ä¾‹-SLIC</title>
    <link href="/2022/05/08/tool004/"/>
    <url>/2022/05/08/tool004/</url>
    
    <content type="html"><![CDATA[<h2 id="gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-å®Œæ•´æ ·ä¾‹-SLIC"><a href="#gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-å®Œæ•´æ ·ä¾‹-SLIC" class="headerlink" title="gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-å®Œæ•´æ ·ä¾‹-SLIC"></a>gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-å®Œæ•´æ ·ä¾‹-SLIC</h2><h3 id="gcovä»£ç è¦†ç›–ç‡æµ‹è¯•ä»‹ç»ï¼š"><a href="#gcovä»£ç è¦†ç›–ç‡æµ‹è¯•ä»‹ç»ï¼š" class="headerlink" title="gcovä»£ç è¦†ç›–ç‡æµ‹è¯•ä»‹ç»ï¼š"></a>gcovä»£ç è¦†ç›–ç‡æµ‹è¯•ä»‹ç»ï¼š</h3><p><a href="https://xingyuanjie.top/2022/01/18/tool002/">gcovä»£ç è¦†ç›–ç‡æµ‹è¯• - è®¡ç®—æœºå¥‡å¦™ä¹‹æ—… (xingyuanjie.top)</a></p><h3 id="å®Œæ•´æ ·ä¾‹-SLICï¼š"><a href="#å®Œæ•´æ ·ä¾‹-SLICï¼š" class="headerlink" title="å®Œæ•´æ ·ä¾‹-SLICï¼š"></a>å®Œæ•´æ ·ä¾‹-SLICï¼š</h3><p><a href="https://xingyuanjie.top/2022/05/08/tool004/result.zip">https://xingyuanjie.top/2022/05/08/tool004/result.zip</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½åˆ†æå·¥å…·</tag>
      
      <tag>gcov</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-036 ç½‘çº¢ç‚¹æ‰“å¡æ”»ç•¥ (25 åˆ†)</title>
    <link href="/2022/04/23/Algorithm032/"/>
    <url>/2022/04/23/Algorithm032/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-036-ç½‘çº¢ç‚¹æ‰“å¡æ”»ç•¥-25-åˆ†"><a href="#L2-036-ç½‘çº¢ç‚¹æ‰“å¡æ”»ç•¥-25-åˆ†" class="headerlink" title="L2-036 ç½‘çº¢ç‚¹æ‰“å¡æ”»ç•¥ (25 åˆ†)"></a>L2-036 ç½‘çº¢ç‚¹æ‰“å¡æ”»ç•¥ (25 åˆ†)</h2><p>ä¸€ä¸ªæ—…æ¸¸æ™¯ç‚¹ï¼Œå¦‚æœè¢«å¸¦ç«äº†çš„è¯ï¼Œå°±è¢«ç§°ä¸ºâ€œç½‘çº¢ç‚¹â€ã€‚å¤§å®¶æ¥ç½‘çº¢ç‚¹æ¸¸ç©ï¼Œä¿—ç§°â€œæ‰“å¡â€ã€‚åœ¨å„ä¸ªç½‘çº¢ç‚¹æ‰“å¡çš„å¿«ï¼ˆçœï¼‰ä¹ï¼ˆé’±ï¼‰æ–¹æ³•ç§°ä¸ºâ€œæ”»ç•¥â€ã€‚ä½ çš„ä»»åŠ¡å°±æ˜¯ä»ä¸€å¤§å †æ”»ç•¥ä¸­ï¼Œæ‰¾å‡ºé‚£ä¸ªèƒ½åœ¨æ¯ä¸ªç½‘çº¢ç‚¹æ‰“å¡ä»…ä¸€æ¬¡ã€å¹¶ä¸”è·¯ä¸ŠèŠ±è´¹æœ€å°‘çš„æ”»ç•¥ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>é¦–å…ˆç¬¬ä¸€è¡Œç»™å‡ºä¸¤ä¸ªæ­£æ•´æ•°ï¼šç½‘çº¢ç‚¹çš„ä¸ªæ•° <em>N</em>ï¼ˆ1&lt;<em>N</em>â‰¤200ï¼‰å’Œç½‘çº¢ç‚¹ä¹‹é—´é€šè·¯çš„æ¡æ•° <em>M</em>ã€‚éšå <em>M</em> è¡Œï¼Œæ¯è¡Œç»™å‡ºæœ‰é€šè·¯çš„ä¸¤ä¸ªç½‘çº¢ç‚¹ã€ä»¥åŠè¿™æ¡è·¯ä¸Šçš„æ—…è¡ŒèŠ±è´¹ï¼ˆä¸ºæ­£æ•´æ•°ï¼‰ï¼Œæ ¼å¼ä¸ºâ€œç½‘çº¢ç‚¹1 ç½‘çº¢ç‚¹2 è´¹ç”¨â€ï¼Œå…¶ä¸­ç½‘çº¢ç‚¹ä» 1 åˆ° <em>N</em> ç¼–å·ï¼›åŒæ—¶ä¹Ÿç»™å‡ºä½ å®¶åˆ°æŸäº›ç½‘çº¢ç‚¹çš„èŠ±è´¹ï¼Œæ ¼å¼ç›¸åŒï¼Œå…¶ä¸­ä½ å®¶çš„ç¼–å·å›ºå®šä¸º <code>0</code>ã€‚</p><p>å†ä¸‹ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•° <em>K</em>ï¼Œæ˜¯å¾…æ£€éªŒçš„æ”»ç•¥çš„æ•°é‡ã€‚éšå <em>K</em> è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€æ¡å¾…æ£€æ”»ç•¥ï¼Œæ ¼å¼ä¸ºï¼š</p><p><em>n</em> <em>V</em>1 <em>V</em>2 â‹¯ Vn</p><p>å…¶ä¸­ <em>n</em>(â‰¤200) æ˜¯æ”»ç•¥ä¸­çš„ç½‘çº¢ç‚¹æ•°ï¼Œ<em>Vi</em> æ˜¯è·¯å¾„ä¸Šçš„ç½‘çº¢ç‚¹ç¼–å·ã€‚è¿™é‡Œå‡è®¾ä½ ä»å®¶é‡Œå‡ºå‘ï¼Œä» <em>V</em>1 å¼€å§‹æ‰“å¡ï¼Œæœ€åä» <em>Vn</em> å›å®¶ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>åœ¨ç¬¬ä¸€è¡Œè¾“å‡ºæ»¡è¶³è¦æ±‚çš„æ”»ç•¥çš„ä¸ªæ•°ã€‚</p><p>åœ¨ç¬¬äºŒè¡Œä¸­ï¼Œé¦–å…ˆè¾“å‡ºé‚£ä¸ªèƒ½åœ¨æ¯ä¸ªç½‘çº¢ç‚¹æ‰“å¡ä»…ä¸€æ¬¡ã€å¹¶ä¸”è·¯ä¸ŠèŠ±è´¹æœ€å°‘çš„æ”»ç•¥çš„åºå·ï¼ˆä» 1 å¼€å§‹ï¼‰ï¼Œç„¶åè¾“å‡ºè¿™ä¸ªæ”»ç•¥çš„æ€»è·¯è´¹ï¼Œå…¶é—´ä»¥ä¸€ä¸ªç©ºæ ¼åˆ†éš”ã€‚å¦‚æœè¿™æ ·çš„æ”»ç•¥ä¸å”¯ä¸€ï¼Œåˆ™è¾“å‡ºåºå·æœ€å°çš„é‚£ä¸ªã€‚</p><p>é¢˜ç›®ä¿è¯è‡³å°‘å­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆæ”»ç•¥ï¼Œå¹¶ä¸”æ€»è·¯è´¹ä¸è¶…è¿‡ 109ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">6 13<br>0 5 2<br>6 2 2<br>6 0 1<br>3 4 2<br>1 5 2<br>2 5 1<br>3 1 1<br>4 1 2<br>1 6 1<br>6 3 2<br>1 2 1<br>4 5 3<br>2 0 2<br>7<br>6 5 1 4 3 6 2<br>6 5 2 1 6 3 4<br>8 6 2 1 6 3 4 5 2<br>3 2 1 5<br>6 6 1 3 4 5 2<br>7 6 2 1 3 4 5 2<br>6 5 2 1 4 3 6<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">3<br>5 11<br></code></pre></div></td></tr></table></figure><h3 id="æ ·ä¾‹è¯´æ˜ï¼š"><a href="#æ ·ä¾‹è¯´æ˜ï¼š" class="headerlink" title="æ ·ä¾‹è¯´æ˜ï¼š"></a>æ ·ä¾‹è¯´æ˜ï¼š</h3><p>ç¬¬ 2ã€3ã€4ã€6 æ¡éƒ½ä¸æ»¡è¶³æ”»ç•¥çš„åŸºæœ¬è¦æ±‚ï¼Œå³ä¸èƒ½åšåˆ°ä»å®¶é‡Œå‡ºå‘ï¼Œåœ¨æ¯ä¸ªç½‘çº¢ç‚¹æ‰“å¡ä»…ä¸€æ¬¡ï¼Œä¸”èƒ½å›åˆ°å®¶é‡Œã€‚æ‰€ä»¥æ»¡è¶³æ¡ä»¶çš„æ”»ç•¥æœ‰ 3 æ¡ã€‚</p><p>ç¬¬ 1 æ¡æ”»ç•¥çš„æ€»è·¯è´¹æ˜¯ï¼š(0-&gt;5) 2 + (5-&gt;1) 2 + (1-&gt;4) 2 + (4-&gt;3) 2 + (3-&gt;6) 2 + (6-&gt;2) 2 + (2-&gt;0) 2 &#x3D; 14ï¼›</p><p>ç¬¬ 5 æ¡æ”»ç•¥çš„æ€»è·¯è´¹åŒç†å¯ç®—å¾—ï¼š1 + 1 + 1 + 2 + 3 + 1 + 2 &#x3D; 11ï¼Œæ˜¯ä¸€æ¡æ›´çœé’±çš„æ”»ç•¥ï¼›</p><p>ç¬¬ 7 æ¡æ”»ç•¥çš„æ€»è·¯è´¹åŒç†å¯ç®—å¾—ï¼š2 + 1 + 1 + 2 + 2 + 2 + 1 &#x3D; 11ï¼Œä¸ç¬¬ 5 æ¡èŠ±è´¹ç›¸åŒï¼Œä½†åºå·è¾ƒå¤§ï¼Œæ‰€ä»¥ä¸è¾“å‡ºã€‚</p><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> n,m;<br><span class="hljs-keyword">int</span> g[<span class="hljs-number">205</span>][<span class="hljs-number">205</span>];<br><span class="hljs-keyword">int</span> minsize=INT_MAX;<span class="hljs-comment">//åˆå§‹åŒ–ä¸ºINT_MAX</span><br><span class="hljs-keyword">int</span> minid=<span class="hljs-number">0</span>;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin&gt;&gt;n&gt;&gt;m;<br>    <span class="hljs-keyword">int</span> cnt=<span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">memset</span>(g,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(g));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;m ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> a,b,c;<br>        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;<br>        g[a][b]=c;<br>        g[b][a]=c;<br>    &#125;<br>    <span class="hljs-keyword">int</span> time;<br>    cin&gt;&gt;time;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;time ; ++j) &#123;<br>        <span class="hljs-keyword">int</span> k;<br>        cin&gt;&gt;k;<br>        <span class="hljs-keyword">int</span> roll[k+<span class="hljs-number">5</span>];<br>        <span class="hljs-keyword">int</span> has[k+<span class="hljs-number">5</span>];<br>        <span class="hljs-built_in">memset</span>(has,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(has));<br>        roll[<span class="hljs-number">0</span>]=roll[k+<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;<span class="hljs-comment">//èµ·ç‚¹å’Œç»ˆç‚¹å¿…å®šæ˜¯å®¶</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=k ; ++i) &#123;<br>            cin&gt;&gt;roll[i];<br>            <span class="hljs-keyword">if</span>(has[roll[i]]) has[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;<span class="hljs-comment">//æ¯ä¸ªæ‰“å¡ç‚¹ä»…èƒ½æ‰“å¡ä¸€æ¬¡</span><br>            <span class="hljs-keyword">else</span> has[roll[i]]=<span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">int</span> flag=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">int</span> tmpsize=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span>(k!=n||has[<span class="hljs-number">0</span>]) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">1</span>; l &lt;=k+<span class="hljs-number">1</span> ; ++l) &#123;<br>            <span class="hljs-keyword">if</span>(g[roll[l<span class="hljs-number">-1</span>]][roll[l]]==<span class="hljs-number">0</span>)<br>            &#123;<br>                flag=<span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            tmpsize+=g[roll[l<span class="hljs-number">-1</span>]][roll[l]];<br>        &#125;<br>        <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">1</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(tmpsize&lt;minsize)&#123;<br>                minsize=tmpsize;<br>                minid=j+<span class="hljs-number">1</span>;<br><br>            &#125;<br>            cnt++;<br>        &#125;<br>    &#125;<br>    cout&lt;&lt;cnt&lt;&lt;endl;<br>    cout&lt;&lt;minid&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;minsize&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482059">é¢˜ç›®è¯¦æƒ… - L2-036 ç½‘çº¢ç‚¹æ‰“å¡æ”»ç•¥ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Graph</tag>
      
      <tag>é‚»æ¥çŸ©é˜µ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-039 æ¸…ç‚¹ä»£ç åº“ (25 åˆ†)</title>
    <link href="/2022/04/23/Algorithm031/"/>
    <url>/2022/04/23/Algorithm031/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-039-æ¸…ç‚¹ä»£ç åº“-25-åˆ†"><a href="#L2-039-æ¸…ç‚¹ä»£ç åº“-25-åˆ†" class="headerlink" title="L2-039 æ¸…ç‚¹ä»£ç åº“ (25 åˆ†)"></a>L2-039 æ¸…ç‚¹ä»£ç åº“ (25 åˆ†)</h2><p><img src="/2022/04/23/Algorithm031/58e6a034-993d-4049-8deb-23d769c8597e.jpg" alt="code.jpg"></p><p>ä¸Šå›¾è½¬è‡ªæ–°æµªå¾®åšï¼šâ€œé˜¿é‡Œä»£ç åº“æœ‰å‡ äº¿è¡Œä»£ç ï¼Œä½†å…¶ä¸­æœ‰å¾ˆå¤šåŠŸèƒ½é‡å¤çš„ä»£ç ï¼Œæ¯”å¦‚å•å•å¿«æ’å°±è¢«é‡å†™äº†å‡ ç™¾éã€‚è¯·è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œèƒ½å¤Ÿå°†ä»£ç åº“ä¸­æ‰€æœ‰åŠŸèƒ½é‡å¤çš„ä»£ç æ‰¾å‡ºã€‚å„ä½å¤§ä½¬æœ‰å•¥æƒ³æ³•ï¼Œæˆ‘å½“æ—¶å°±æ‡µäº†ï¼Œç„¶åå°±æŒ‚äº†ã€‚ã€‚ã€‚â€</p><p>è¿™é‡Œæˆ‘ä»¬æŠŠé—®é¢˜ç®€åŒ–ä¸€ä¸‹ï¼šé¦–å…ˆå‡è®¾ä¸¤ä¸ªåŠŸèƒ½æ¨¡å—å¦‚æœæ¥å—åŒæ ·çš„è¾“å…¥ï¼Œæ€»æ˜¯ç»™å‡ºåŒæ ·çš„è¾“å‡ºï¼Œåˆ™å®ƒä»¬å°±æ˜¯åŠŸèƒ½é‡å¤çš„ï¼›å…¶æ¬¡æˆ‘ä»¬æŠŠæ¯ä¸ªæ¨¡å—çš„è¾“å‡ºéƒ½ç®€åŒ–ä¸ºä¸€ä¸ªæ•´æ•°ï¼ˆåœ¨ <strong>int</strong> èŒƒå›´å†…ï¼‰ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ç³»åˆ—è¾“å…¥ï¼Œæ£€æŸ¥æ‰€æœ‰åŠŸèƒ½æ¨¡å—çš„å¯¹åº”è¾“å‡ºï¼Œä»è€ŒæŸ¥å‡ºåŠŸèƒ½é‡å¤çš„ä»£ç ã€‚ä½ çš„ä»»åŠ¡å°±æ˜¯è®¾è®¡å¹¶å®ç°è¿™ä¸ªç®€åŒ–é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œä¸­ç»™å‡º 2 ä¸ªæ­£æ•´æ•°ï¼Œä¾æ¬¡ä¸º <em>N</em>ï¼ˆâ‰¤104ï¼‰å’Œ <em>M</em>ï¼ˆâ‰¤102ï¼‰ï¼Œå¯¹åº”åŠŸèƒ½æ¨¡å—çš„ä¸ªæ•°å’Œç³»åˆ—æµ‹è¯•è¾“å…¥çš„ä¸ªæ•°ã€‚</p><p>éšå <em>N</em> è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€ä¸ªåŠŸèƒ½æ¨¡å—çš„ <em>M</em> ä¸ªå¯¹åº”è¾“å‡ºï¼Œæ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>é¦–å…ˆåœ¨ç¬¬ä¸€è¡Œè¾“å‡ºä¸åŒåŠŸèƒ½çš„ä¸ªæ•° <em>K</em>ã€‚éšå <em>K</em> è¡Œï¼Œæ¯è¡Œç»™å‡ºå…·æœ‰è¿™ä¸ªåŠŸèƒ½çš„æ¨¡å—çš„ä¸ªæ•°ï¼Œä»¥åŠè¿™ä¸ªåŠŸèƒ½çš„å¯¹åº”è¾“å‡ºã€‚æ•°å­—é—´ä»¥ 1 ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡Œé¦–å°¾ä¸å¾—æœ‰å¤šä½™ç©ºæ ¼ã€‚è¾“å‡ºé¦–å…ˆæŒ‰æ¨¡å—ä¸ªæ•°éé€’å¢é¡ºåºï¼Œå¦‚æœæœ‰å¹¶åˆ—ï¼Œåˆ™æŒ‰è¾“å‡ºåºåˆ—çš„é€’å¢åºç»™å‡ºã€‚</p><p>æ³¨ï¼šæ‰€è°“æ•°åˆ— { <em>A</em>1, â€¦, <em>A</em>M } æ¯” { <em>B</em>1, â€¦, <em>B</em>M } å¤§ï¼Œæ˜¯æŒ‡å­˜åœ¨ 1â‰¤i&lt;*M*ï¼Œä½¿å¾— *A*1&#x3D;*B*1ï¼Œâ€¦ï¼Œ*Ai*&#x3D;*Bi* æˆç«‹ï¼Œä¸” *Ai*+1&gt;<em>B</em>+1ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">7 3<br>35 28 74<br>-1 -1 22<br>28 74 35<br>-1 -1 22<br>11 66 0<br>35 28 74<br>35 28 74<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">4<br>3 35 28 74<br>2 -1 -1 22<br>1 11 66 0<br>1 28 74 35<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>åˆ©ç”¨mapçš„æ˜ å°„å…³ç³»</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>map&lt;vector&lt;<span class="hljs-keyword">int</span>&gt;,<span class="hljs-keyword">int</span>&gt; mp;   <span class="hljs-comment">//keyï¼Œvalue</span><br>vector&lt;<span class="hljs-keyword">int</span>&gt; tmp;<br><span class="hljs-keyword">int</span> n,m;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(pair&lt;vector&lt;<span class="hljs-keyword">int</span>&gt;,<span class="hljs-keyword">int</span>&gt; a,pair&lt;vector&lt;<span class="hljs-keyword">int</span>&gt;,<span class="hljs-keyword">int</span>&gt; b)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(a.second==b.second)<br>    &#123;<br>        <span class="hljs-keyword">return</span> a.first&lt;b.first;<br>    &#125;<br>    <span class="hljs-keyword">return</span> a.second&gt;b.second;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin&gt;&gt;n&gt;&gt;m;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; ++j) &#123;<br>            <span class="hljs-keyword">int</span> num;<br>            cin&gt;&gt;num;<br>            tmp.<span class="hljs-built_in">push_back</span>(num);<br>        &#125;<br>        mp[tmp]++;<br>        tmp.<span class="hljs-built_in">clear</span>();<br>    &#125;<br>    vector&lt;pair&lt;vector&lt;<span class="hljs-keyword">int</span>&gt;,<span class="hljs-keyword">int</span>&gt;&gt; <span class="hljs-built_in">v</span>(mp.<span class="hljs-built_in">begin</span>(),mp.<span class="hljs-built_in">end</span>());<span class="hljs-comment">//æŠŠmapç±»å‹è½¬åŒ–æˆvector</span><br>    cout&lt;&lt;v.<span class="hljs-built_in">size</span>()&lt;&lt;endl;<br>    <span class="hljs-built_in">sort</span>(v.<span class="hljs-built_in">begin</span>(),v.<span class="hljs-built_in">end</span>(),cmp);<span class="hljs-comment">//sortæ’åºï¼Œæ³¨æ„ç»ˆç‚¹å’Œèµ·ç‚¹</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;v.<span class="hljs-built_in">size</span>() ; ++k) &#123;<br>        cout&lt;&lt;v[k].second&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;m ; ++i) &#123;<br>            <span class="hljs-keyword">if</span>(i!=m<span class="hljs-number">-1</span>)&#123;<br>                cout&lt;&lt;v[k].first[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>            &#125; <span class="hljs-keyword">else</span>&#123;<br>                cout&lt;&lt;v[k].first[i]&lt;&lt;endl;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1386335159927652362">é¢˜ç›®è¯¦æƒ… - L2-039 æ¸…ç‚¹ä»£ç åº“ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Sort</tag>
      
      <tag>Vector</tag>
      
      <tag>Map</tag>
      
      <tag>Pair</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-005 é›†åˆç›¸ä¼¼åº¦ (25 åˆ†)</title>
    <link href="/2022/04/23/Algorithm030/"/>
    <url>/2022/04/23/Algorithm030/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-005-é›†åˆç›¸ä¼¼åº¦-25-åˆ†"><a href="#L2-005-é›†åˆç›¸ä¼¼åº¦-25-åˆ†" class="headerlink" title="L2-005 é›†åˆç›¸ä¼¼åº¦ (25 åˆ†)"></a>L2-005 é›†åˆç›¸ä¼¼åº¦ (25 åˆ†)</h2><p>ç»™å®šä¸¤ä¸ªæ•´æ•°é›†åˆï¼Œå®ƒä»¬çš„ç›¸ä¼¼åº¦å®šä¹‰ä¸ºï¼šNc&#x2F;NtÃ—100%ã€‚å…¶ä¸­Ncæ˜¯ä¸¤ä¸ªé›†åˆéƒ½æœ‰çš„ä¸ç›¸ç­‰æ•´æ•°çš„ä¸ªæ•°ï¼ŒNtæ˜¯ä¸¤ä¸ªé›†åˆä¸€å…±æœ‰çš„ä¸ç›¸ç­‰æ•´æ•°çš„ä¸ªæ•°ã€‚ä½ çš„ä»»åŠ¡å°±æ˜¯è®¡ç®—ä»»æ„ä¸€å¯¹ç»™å®šé›†åˆçš„ç›¸ä¼¼åº¦ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<em>N</em>ï¼ˆâ‰¤50ï¼‰ï¼Œæ˜¯é›†åˆçš„ä¸ªæ•°ã€‚éšå<em>N</em>è¡Œï¼Œæ¯è¡Œå¯¹åº”ä¸€ä¸ªé›†åˆã€‚æ¯ä¸ªé›†åˆé¦–å…ˆç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<em>M</em>ï¼ˆâ‰¤104ï¼‰ï¼Œæ˜¯é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ï¼›ç„¶åè·Ÿ<em>M</em>ä¸ª[0,109]åŒºé—´å†…çš„æ•´æ•°ã€‚</p><p>ä¹‹åä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<em>K</em>ï¼ˆâ‰¤2000ï¼‰ï¼Œéšå<em>K</em>è¡Œï¼Œæ¯è¡Œå¯¹åº”ä¸€å¯¹éœ€è¦è®¡ç®—ç›¸ä¼¼åº¦çš„é›†åˆçš„ç¼–å·ï¼ˆé›†åˆä»1åˆ°<em>N</em>ç¼–å·ï¼‰ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹æ¯ä¸€å¯¹éœ€è¦è®¡ç®—çš„é›†åˆï¼Œåœ¨ä¸€è¡Œä¸­è¾“å‡ºå®ƒä»¬çš„ç›¸ä¼¼åº¦ï¼Œä¸ºä¿ç•™å°æ•°ç‚¹å2ä½çš„ç™¾åˆ†æ¯”æ•°å­—ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">3<br>3 99 87 101<br>4 87 101 5 87<br>7 99 101 18 5 135 18 99<br>2<br>1 2<br>1 3<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">50.00%<br>33.33%<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>åŒsetæ¨¡æ‹Ÿ</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    set&lt;<span class="hljs-keyword">int</span>&gt; s[<span class="hljs-number">55</span>];<br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> time;<br>        cin&gt;&gt;time;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;time ; ++j) &#123;<br>            <span class="hljs-keyword">int</span> num;<br>            cin&gt;&gt;num;<br>            s[i].<span class="hljs-built_in">insert</span>(num);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">int</span> find;<br>    cin&gt;&gt;find;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">0</span>; l &lt;find ; ++l) &#123;<br>        <span class="hljs-keyword">int</span> a,b;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        <span class="hljs-keyword">int</span> sum=<span class="hljs-number">0</span>;<br>        set&lt;<span class="hljs-keyword">int</span>&gt;::iterator it;<span class="hljs-comment">//è¿­ä»£å™¨</span><br>        <span class="hljs-keyword">int</span> cnt=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (it=s[a<span class="hljs-number">-1</span>].<span class="hljs-built_in">begin</span>(); it!=s[a<span class="hljs-number">-1</span>].<span class="hljs-built_in">end</span>() ; it++) &#123;<br>            <span class="hljs-keyword">if</span>(s[b<span class="hljs-number">-1</span>].<span class="hljs-built_in">find</span>(*it)!=s[b<span class="hljs-number">-1</span>].<span class="hljs-built_in">end</span>())&#123;<span class="hljs-comment">//æ‰¾åˆ°äº†</span><br>                cnt++;<span class="hljs-comment">//Nc</span><br>            &#125;<br>        &#125;<br>        sum=s[a<span class="hljs-number">-1</span>].<span class="hljs-built_in">size</span>()+s[b<span class="hljs-number">-1</span>].<span class="hljs-built_in">size</span>()-cnt;<span class="hljs-comment">//Nt=ä¸¤ä¸ªé›†åˆçš„æ€»ä¸ªæ•°-ç›¸åŒä¸ªæ•°</span><br>        <span class="hljs-keyword">double</span> ans=<span class="hljs-built_in"><span class="hljs-keyword">double</span></span>(<span class="hljs-built_in"><span class="hljs-keyword">double</span></span>(cnt)/<span class="hljs-built_in"><span class="hljs-keyword">double</span></span>(sum))*<span class="hljs-number">100.0</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.2lf%\n&quot;</span>,ans);<br><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805070149828608">é¢˜ç›®è¯¦æƒ… - L2-005 é›†åˆç›¸ä¼¼åº¦ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Set</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>æ¨¡æ‹Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>STLä¸­mapçš„ä½¿ç”¨</title>
    <link href="/2022/04/16/Algorithm029/"/>
    <url>/2022/04/16/Algorithm029/</url>
    
    <content type="html"><![CDATA[<h2 id="STLä¸­mapçš„ä½¿ç”¨"><a href="#STLä¸­mapçš„ä½¿ç”¨" class="headerlink" title="STLä¸­mapçš„ä½¿ç”¨"></a>STLä¸­mapçš„ä½¿ç”¨</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>map æ˜¯ STL çš„ä¸€ä¸ªå…³è”å®¹å™¨ï¼Œå®ƒæä¾›ä¸€å¯¹ä¸€çš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚</p><p>map å¯¹è±¡æ˜¯<strong>æ¨¡æ¿ç±»</strong>ï¼Œéœ€è¦<strong>å…³é”®å­—</strong>å’Œ<strong>å­˜å‚¨å¯¹è±¡</strong>ä¸¤ä¸ªæ¨¡æ¿å‚æ•°ï¼šå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ç§°ä¸ºå…³é”®å­—ï¼Œæ¯ä¸ªå…³é”®å­—åªèƒ½åœ¨ map ä¸­å‡ºç°ä¸€æ¬¡ï¼›ç¬¬äºŒä¸ªå‚æ•°ç§°ä¸ºè¯¥å…³é”®å­—çš„å€¼ã€‚å¯ä»¥å°†å…³é”®å­—å’Œå­˜å‚¨å¯¹è±¡ç†è§£ä¸ºâ€œ{é”®ï¼Œå€¼}å¯¹â€ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">map&lt;<span class="hljs-keyword">int</span>,string&gt; mp;<br></code></pre></div></td></tr></table></figure><h3 id="mapçš„æ•°æ®æ’å…¥æ“ä½œ"><a href="#mapçš„æ•°æ®æ’å…¥æ“ä½œ" class="headerlink" title="mapçš„æ•°æ®æ’å…¥æ“ä½œ"></a>mapçš„æ•°æ®æ’å…¥æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//ä½¿ç”¨insertå‡½æ•°æ’å…¥pairæ•°æ®</span><br>mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,string&gt;(<span class="hljs-number">3</span>,<span class="hljs-string">&quot;xingyuanjie&quot;</span>));<br><span class="hljs-comment">//ä½¿ç”¨æ•°ç»„æ–¹å¼æ’å…¥æ•°æ®</span><br>mp[<span class="hljs-number">2</span>]=<span class="hljs-string">&quot;wangzhouyang&quot;</span>;<br></code></pre></div></td></tr></table></figure><p><strong>è¯´æ˜ï¼šä¸Šé¢çš„ä¸¤ç§æ–¹æ³•æ˜¯æœ‰åŒºåˆ«çš„ï¼Œç”¨ insert å‡½æ•°æ’å…¥æ•°æ®ï¼Œæ¶‰åŠåˆ°é›†åˆçš„å”¯ä¸€æ€§è¿™ä¸ªæ¦‚å¿µï¼Œå³å½“ map ä¸­æœ‰è¿™ä¸ªå…³é”®å­—æ—¶ï¼Œinsert æ“ä½œæ˜¯ä¸èƒ½å®ç°æ•°æ®æ’å…¥çš„ï¼›ä½†æ˜¯æ•°ç»„æ–¹å¼èƒ½å¤Ÿæ’å…¥æ•°æ®ï¼Œæ’å…¥çš„æ•°æ®ä¼šè¦†ç›–è¯¥å…³é”®å­—ä¹‹å‰å¯¹åº”çš„å€¼ã€‚</strong></p><h3 id="mapä¸­æ•°æ®çš„éå†"><a href="#mapä¸­æ•°æ®çš„éå†" class="headerlink" title="mapä¸­æ•°æ®çš„éå†"></a>mapä¸­æ•°æ®çš„éå†</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">map&lt;<span class="hljs-keyword">int</span>,string&gt;::iterator it;<span class="hljs-comment">//è¿­ä»£å™¨</span><br><span class="hljs-keyword">for</span> (it=mp.<span class="hljs-built_in">begin</span>();it!=mp.<span class="hljs-built_in">end</span>();it++) &#123;<br>    cout&lt;&lt;it-&gt;first&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;it-&gt;second&lt;&lt;endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="mapä¸­æ•°æ®çš„æŸ¥æ‰¾"><a href="#mapä¸­æ•°æ®çš„æŸ¥æ‰¾" class="headerlink" title="mapä¸­æ•°æ®çš„æŸ¥æ‰¾"></a>mapä¸­æ•°æ®çš„æŸ¥æ‰¾</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">map&lt;<span class="hljs-keyword">int</span>,string&gt;::iterator it;<span class="hljs-comment">//è¿­ä»£å™¨</span><br>it=mp.<span class="hljs-built_in">find</span>(<span class="hljs-number">1</span>);<br><span class="hljs-keyword">if</span>(it!=mp.<span class="hljs-built_in">end</span>())&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Find it, the relative value is: &quot;</span> &lt;&lt; it-&gt;second &lt;&lt; endl;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>       cout &lt;&lt; <span class="hljs-string">&quot;Can not find the relative value.&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="mapä¸­æ•°æ®çš„åˆ é™¤"><a href="#mapä¸­æ•°æ®çš„åˆ é™¤" class="headerlink" title="mapä¸­æ•°æ®çš„åˆ é™¤"></a>mapä¸­æ•°æ®çš„åˆ é™¤</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">map&lt;<span class="hljs-keyword">int</span>,string&gt;::iterator it;<span class="hljs-comment">//è¿­ä»£å™¨</span><br>it = mp.<span class="hljs-built_in">find</span>(<span class="hljs-number">2</span>);<br>mp.<span class="hljs-built_in">erase</span>(it);<br></code></pre></div></td></tr></table></figure><h3 id="mapä¸­æ•°æ®çš„æ’åº"><a href="#mapä¸­æ•°æ®çš„æ’åº" class="headerlink" title="mapä¸­æ•°æ®çš„æ’åº"></a>mapä¸­æ•°æ®çš„æ’åº</h3><p><strong>map ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šæ ¹æ®å…ƒç´ çš„é”®å€¼ï¼Œè‡ªåŠ¨è¿›è¡Œå‡åºæ’åºã€‚</strong></p><h3 id="å®Œæ•´æ“ä½œ"><a href="#å®Œæ•´æ“ä½œ" class="headerlink" title="å®Œæ•´æ“ä½œ"></a>å®Œæ•´æ“ä½œ</h3><h4 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>map&lt;<span class="hljs-keyword">int</span>,string&gt; mp;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//ä½¿ç”¨insertå‡½æ•°æ’å…¥pairæ•°æ®</span><br>    mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,string&gt;(<span class="hljs-number">3</span>,<span class="hljs-string">&quot;xingyuanjie&quot;</span>));<br>    mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,string&gt;(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;shicheng&quot;</span>));<br>    mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,string&gt;(<span class="hljs-number">4</span>,<span class="hljs-string">&quot;tanghaipeng&quot;</span>));<br>    mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,string&gt;(<span class="hljs-number">6</span>,<span class="hljs-string">&quot;zhouyuhao&quot;</span>));<br>    mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,string&gt;(<span class="hljs-number">5</span>,<span class="hljs-string">&quot;heqichuan&quot;</span>));<br>    <span class="hljs-comment">//ä½¿ç”¨æ•°ç»„æ–¹å¼æ’å…¥æ•°æ®</span><br>    mp[<span class="hljs-number">2</span>]=<span class="hljs-string">&quot;wangzhouyang&quot;</span>;<br>    <span class="hljs-comment">//mapçš„éå†</span><br>    map&lt;<span class="hljs-keyword">int</span>,string&gt;::iterator it;<br>    <span class="hljs-keyword">for</span> (it=mp.<span class="hljs-built_in">begin</span>();it!=mp.<span class="hljs-built_in">end</span>();it++) &#123;<br>        cout&lt;&lt;it-&gt;first&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;it-&gt;second&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-comment">//æŸ¥æ‰¾æ“ä½œ</span><br>    it=mp.<span class="hljs-built_in">find</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span>(it!=mp.<span class="hljs-built_in">end</span>())&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Find it, the relative value is: &quot;</span> &lt;&lt; it-&gt;second &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Can not find the relative value.&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-comment">//åˆ é™¤æ“ä½œ</span><br>    it = mp.<span class="hljs-built_in">find</span>(<span class="hljs-number">2</span>);<br>    mp.<span class="hljs-built_in">erase</span>(it);<br>    <span class="hljs-keyword">for</span> (it=mp.<span class="hljs-built_in">begin</span>();it!=mp.<span class="hljs-built_in">end</span>();it++) &#123;<br>        cout&lt;&lt;it-&gt;first&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;it-&gt;second&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºè¾“å‡ºï¼š"><a href="#ç¨‹åºè¾“å‡ºï¼š" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">1</span> shicheng<br><span class="hljs-number">2</span> wangzhouyang<br><span class="hljs-number">3</span> xingyuanjie<br><span class="hljs-number">4</span> tanghaipeng<br><span class="hljs-number">5</span> heqichuan<br><span class="hljs-number">6</span> zhouyuhao<br>Find it, the relative value is: shicheng<br><span class="hljs-number">1</span> shicheng<br><span class="hljs-number">3</span> xingyuanjie<br><span class="hljs-number">4</span> tanghaipeng<br><span class="hljs-number">5</span> heqichuan<br><span class="hljs-number">6</span> zhouyuhao<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://blog.csdn.net/liitdar/article/details/80009712">(20æ¡æ¶ˆæ¯) STLä¸­mapä»‹ç»_liitdarçš„åšå®¢-CSDNåšå®¢_stlmap</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>STL</tag>
      
      <tag>Map</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-010 æ’åº§ä½ (25 åˆ†)</title>
    <link href="/2022/04/16/Algorithm028/"/>
    <url>/2022/04/16/Algorithm028/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-010-æ’åº§ä½-25-åˆ†"><a href="#L2-010-æ’åº§ä½-25-åˆ†" class="headerlink" title="L2-010 æ’åº§ä½ (25 åˆ†)"></a><strong>L2-010 æ’åº§ä½ (25 åˆ†)</strong></h2><p>å¸ƒç½®å®´å¸­æœ€å¾®å¦™çš„äº‹æƒ…ï¼Œå°±æ˜¯ç»™å‰æ¥å‚å®´çš„å„ä½å®¾å®¢å®‰æ’åº§ä½ã€‚æ— è®ºå¦‚ä½•ï¼Œæ€»ä¸èƒ½æŠŠä¸¤ä¸ªæ­»å¯¹å¤´æ’åˆ°åŒä¸€å¼ å®´ä¼šæ¡Œæ—ï¼è¿™ä¸ªè‰°å·¨ä»»åŠ¡ç°åœ¨å°±äº¤ç»™ä½ ï¼Œå¯¹ä»»ä½•ä¸€å¯¹å®¢äººï¼Œè¯·ç¼–å†™ç¨‹åºå‘Šè¯‰ä¸»äººä»–ä»¬æ˜¯å¦èƒ½è¢«å®‰æ’åŒå¸­ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥ç¬¬ä¸€è¡Œç»™å‡º3ä¸ªæ­£æ•´æ•°ï¼š<code>N</code>ï¼ˆâ‰¤100ï¼‰ï¼Œå³å‰æ¥å‚å®´çš„å®¾å®¢æ€»äººæ•°ï¼Œåˆ™è¿™äº›äººä»1åˆ°<code>N</code>ç¼–å·ï¼›<code>M</code>ä¸ºå·²çŸ¥ä¸¤ä¸¤å®¾å®¢ä¹‹é—´çš„å…³ç³»æ•°ï¼›<code>K</code>ä¸ºæŸ¥è¯¢çš„æ¡æ•°ã€‚éšå<code>M</code>è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€å¯¹å®¾å®¢ä¹‹é—´çš„å…³ç³»ï¼Œæ ¼å¼ä¸ºï¼š<code>å®¾å®¢1 å®¾å®¢2 å…³ç³»</code>ï¼Œå…¶ä¸­<code>å…³ç³»</code>ä¸º1è¡¨ç¤ºæ˜¯æœ‹å‹ï¼Œ-1è¡¨ç¤ºæ˜¯æ­»å¯¹å¤´ã€‚æ³¨æ„ä¸¤ä¸ªäººä¸å¯èƒ½æ—¢æ˜¯æœ‹å‹åˆæ˜¯æ•Œäººã€‚æœ€å<code>K</code>è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€å¯¹éœ€è¦æŸ¥è¯¢çš„å®¾å®¢ç¼–å·ã€‚</p><p>è¿™é‡Œå‡è®¾æœ‹å‹çš„æœ‹å‹ä¹Ÿæ˜¯æœ‹å‹ã€‚ä½†æ•Œäººçš„æ•Œäººå¹¶ä¸ä¸€å®šå°±æ˜¯æœ‹å‹ï¼Œæœ‹å‹çš„æ•Œäººä¹Ÿä¸ä¸€å®šæ˜¯æ•Œäººã€‚åªæœ‰å•çº¯ç›´æ¥çš„æ•Œå¯¹å…³ç³»æ‰æ˜¯ç»å¯¹ä¸èƒ½åŒå¸­çš„ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹æ¯ä¸ªæŸ¥è¯¢è¾“å‡ºä¸€è¡Œç»“æœï¼šå¦‚æœä¸¤ä½å®¾å®¢ä¹‹é—´æ˜¯æœ‹å‹ï¼Œä¸”æ²¡æœ‰æ•Œå¯¹å…³ç³»ï¼Œåˆ™è¾“å‡º<code>No problem</code>ï¼›å¦‚æœä»–ä»¬ä¹‹é—´å¹¶ä¸æ˜¯æœ‹å‹ï¼Œä½†ä¹Ÿä¸æ•Œå¯¹ï¼Œåˆ™è¾“å‡º<code>OK</code>ï¼›å¦‚æœä»–ä»¬ä¹‹é—´æœ‰æ•Œå¯¹ï¼Œç„¶è€Œä¹Ÿæœ‰å…±åŒçš„æœ‹å‹ï¼Œåˆ™è¾“å‡º<code>OK but...</code>ï¼›å¦‚æœä»–ä»¬ä¹‹é—´åªæœ‰æ•Œå¯¹å…³ç³»ï¼Œåˆ™è¾“å‡º<code>No way</code>ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">7 8 4<br>5 6 1<br>2 7 -1<br>1 3 1<br>3 4 1<br>6 7 -1<br>1 2 1<br>1 4 1<br>2 3 -1<br>3 4<br>5 7<br>2 3<br>7 2<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">No problem<br>OK<br>OK but...<br>No way<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>é‚»æ¥çŸ©é˜µ + å¹¶æŸ¥é›†</strong></p><p><strong>å¹¶æŸ¥é›†å…·ä½“é“¾æ¥ï¼š</strong></p><p><a href="https://xingyuanjie.top/2022/01/04/Algorithm004/">å¹¶æŸ¥é›† - è®¡ç®—æœºå¥‡å¦™ä¹‹æ—… (xingyuanjie.top)</a></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> pre[<span class="hljs-number">100</span>];<span class="hljs-comment">//çˆ¶èŠ‚ç‚¹</span><br><span class="hljs-keyword">int</span> deep[<span class="hljs-number">100</span>];<span class="hljs-comment">//æ·±åº¦</span><br><span class="hljs-keyword">int</span> g[<span class="hljs-number">101</span>][<span class="hljs-number">101</span>];<span class="hljs-comment">//é‚»æ¥çŸ©é˜µå»ºå›¾</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        pre[i]=i;<br>        deep[i]=<span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(pre[x]==x)&#123;<br>        <span class="hljs-keyword">return</span> x;<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> pre[x]=<span class="hljs-built_in">find</span>(pre[x]);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>&#123;<br>    x=<span class="hljs-built_in">find</span>(x);<br>    y=<span class="hljs-built_in">find</span>(y);<br>    <span class="hljs-keyword">if</span>(x==y) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span>(deep[x]&lt;deep[y])&#123;<br>        pre[x]=y;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        pre[y]=x;<br>        <span class="hljs-keyword">if</span>(deep[x]==deep[y])&#123;<br>            deep[x]++;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n,m,k;<br>    <span class="hljs-built_in">init</span>(<span class="hljs-number">105</span>);<br>    <span class="hljs-built_in">memset</span>(g,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(g));<br>    cin&gt;&gt;n&gt;&gt;m&gt;&gt;k;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;m ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> a,b,c;<br>        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;<br>        g[a][b]=g[b][a]=c;<br>        <span class="hljs-keyword">if</span>(c==<span class="hljs-number">1</span>) <span class="hljs-built_in">unit</span>(a,b);<span class="hljs-comment">//å¦‚æœæ˜¯æœ‹å‹åˆ™åˆå¹¶</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;k ; ++j) &#123;<br>        <span class="hljs-keyword">int</span> a,b;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        <span class="hljs-keyword">if</span>(g[a][b]==<span class="hljs-number">1</span>&amp;&amp;g[b][a]==<span class="hljs-number">1</span>) cout&lt;&lt;<span class="hljs-string">&quot;No problem&quot;</span>&lt;&lt;endl;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(g[a][b]==<span class="hljs-number">0</span>&amp;&amp;g[b][a]==<span class="hljs-number">0</span>) cout&lt;&lt;<span class="hljs-string">&quot;OK&quot;</span>&lt;&lt;endl;<span class="hljs-comment">//ä¸¤äººæ¯«æ— å…³ç³»</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(g[a][b]==<span class="hljs-number">-1</span>&amp;&amp;g[b][a]==<span class="hljs-number">-1</span>&amp;&amp;<span class="hljs-built_in">find</span>(a)==<span class="hljs-built_in">find</span>(b)) cout&lt;&lt;<span class="hljs-string">&quot;OK but...&quot;</span>&lt;&lt;endl;<span class="hljs-comment">//æ•Œå¯¹ä¸”æœ‰å…±åŒæœ‹å‹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(g[a][b]==<span class="hljs-number">-1</span>&amp;&amp;g[b][a]==<span class="hljs-number">-1</span>) cout&lt;&lt;<span class="hljs-string">&quot;No way&quot;</span>&lt;&lt;endl;<span class="hljs-comment">//ä»…æ•Œå¯¹</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://blog.csdn.net/weixin_45260385/article/details/109752008">(20æ¡æ¶ˆæ¯) ã€PTAã€‘ L2-010 æ’åº§ä½ (25åˆ†) ã€ç®€å•å¹¶æŸ¥é›†ã€‘_é»‘æ¡ƒï¸çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805066135879680">é¢˜ç›®è¯¦æƒ… - L2-010 æ’åº§ä½ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Graph</tag>
      
      <tag>é‚»æ¥çŸ©é˜µ</tag>
      
      <tag>å¹¶æŸ¥é›†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-009 æŠ¢çº¢åŒ… (25 åˆ†)</title>
    <link href="/2022/04/16/Algorithm027/"/>
    <url>/2022/04/16/Algorithm027/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-009-æŠ¢çº¢åŒ…-25-åˆ†"><a href="#L2-009-æŠ¢çº¢åŒ…-25-åˆ†" class="headerlink" title="L2-009 æŠ¢çº¢åŒ… (25 åˆ†)"></a><strong>L2-009 æŠ¢çº¢åŒ… (25 åˆ†)</strong></h2><p>æ²¡æœ‰äººæ²¡æŠ¢è¿‡çº¢åŒ…å§â€¦â€¦ è¿™é‡Œç»™å‡º<em>N</em>ä¸ªäººä¹‹é—´äº’ç›¸å‘çº¢åŒ…ã€æŠ¢çº¢åŒ…çš„è®°å½•ï¼Œè¯·ä½ ç»Ÿè®¡ä¸€ä¸‹ä»–ä»¬æŠ¢çº¢åŒ…çš„æ”¶è·ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<em>N</em>ï¼ˆâ‰¤104ï¼‰ï¼Œå³å‚ä¸å‘çº¢åŒ…å’ŒæŠ¢çº¢åŒ…çš„æ€»äººæ•°ï¼Œåˆ™è¿™äº›äººä»1åˆ°<em>N</em>ç¼–å·ã€‚éšå<em>N</em>è¡Œï¼Œç¬¬<em>i</em>è¡Œç»™å‡ºç¼–å·ä¸º<em>i</em>çš„äººå‘çº¢åŒ…çš„è®°å½•ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><p><em>K     N</em>1 <em>P</em>1â‹¯ NK PK</p><p>å…¶ä¸­<em>K</em>ï¼ˆ0â‰¤<em>K</em>â‰¤20ï¼‰æ˜¯å‘å‡ºå»çš„çº¢åŒ…ä¸ªæ•°ï¼Œ<em>N</em>i<em>æ˜¯æŠ¢åˆ°çº¢åŒ…çš„äººçš„ç¼–å·ï¼Œ</em>Piï¼ˆ&gt;0ï¼‰æ˜¯å…¶æŠ¢åˆ°çš„çº¢åŒ…é‡‘é¢ï¼ˆä»¥åˆ†ä¸ºå•ä½ï¼‰ã€‚æ³¨æ„ï¼šå¯¹äºåŒä¸€ä¸ªäººå‘å‡ºçš„çº¢åŒ…ï¼Œæ¯äººæœ€å¤šåªèƒ½æŠ¢1æ¬¡ï¼Œä¸èƒ½é‡å¤æŠ¢ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>æŒ‰ç…§æ”¶å…¥é‡‘é¢ä»é«˜åˆ°ä½çš„é€’å‡é¡ºåºè¾“å‡ºæ¯ä¸ªäººçš„ç¼–å·å’Œæ”¶å…¥é‡‘é¢ï¼ˆä»¥å…ƒä¸ºå•ä½ï¼Œè¾“å‡ºå°æ•°ç‚¹å2ä½ï¼‰ã€‚æ¯ä¸ªäººçš„ä¿¡æ¯å ä¸€è¡Œï¼Œä¸¤æ•°å­—é—´æœ‰1ä¸ªç©ºæ ¼ã€‚å¦‚æœæ”¶å…¥é‡‘é¢æœ‰å¹¶åˆ—ï¼Œåˆ™æŒ‰æŠ¢åˆ°çº¢åŒ…çš„ä¸ªæ•°é€’å‡è¾“å‡ºï¼›å¦‚æœè¿˜æœ‰å¹¶åˆ—ï¼Œåˆ™æŒ‰ä¸ªäººç¼–å·é€’å¢è¾“å‡ºã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">10<br>3 2 22 10 58 8 125<br>5 1 345 3 211 5 233 7 13 8 101<br>1 7 8800<br>2 1 1000 2 1000<br>2 4 250 10 320<br>6 5 11 9 22 8 33 7 44 10 55 4 2<br>1 3 8800<br>2 1 23 2 123<br>1 8 250<br>4 2 121 4 516 7 112 9 10<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">1 11.63<br>2 3.63<br>8 3.63<br>3 2.11<br>7 1.69<br>6 -1.67<br>9 -2.18<br>10 -3.26<br>5 -3.26<br>4 -12.32<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>ç»“æ„ä½“ + Sort</strong></p><p><strong>éœ€è¦æ³¨æ„çš„å°±æ˜¯doubleç±»å‹ç›¸ç­‰çš„æ¯”è¾ƒ</strong></p><p><strong>é¦–å…ˆï¼Œæµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­å¹¶ä¸èƒ½ç²¾ç¡®çš„è¡¨ç¤ºï¼Œæ‰€ä»¥åœ¨åˆ¤æ–­ä¸¤ä¸ªdoubleç±»å‹çš„æ•°æ—¶éœ€è¦å…¶ä»–çš„æ‰‹æ®µï¼Œè€Œä¸æ˜¯ç›´æ¥ a&#x3D;&#x3D; b</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">student</span>&#123;</span><br>    <span class="hljs-keyword">int</span> id=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">double</span> money=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> cnt=<span class="hljs-number">0</span>;<br>&#125;;<br><span class="hljs-keyword">double</span> dis=<span class="hljs-number">1e-6</span>;<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªè¯¯å·®</span><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(student a,student b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(a.money-b.money)&lt;dis)&#123;<span class="hljs-comment">//å¦‚æœä¸¤ä¸ªdoubleå‹ç›¸å‡åœ¨è¯¯å·®çš„èŒƒå›´å†…ï¼Œæˆ‘ä»¬è®¤å®šè¿™ä¸¤ä¸ªdoubleç±»å‹ç›¸ç­‰</span><br>        <span class="hljs-keyword">if</span>(a.cnt==b.cnt)&#123;<br>            <span class="hljs-keyword">return</span> a.id&lt;b.id;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> a.cnt&gt;b.cnt;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> a.money&gt;b.money;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;n;<br>    student st[n+<span class="hljs-number">5</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> time;<br>        cin&gt;&gt;time;<br>        st[i].id=i+<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;time ; ++j) &#123;<br>            <span class="hljs-keyword">int</span> p;<br>            <span class="hljs-keyword">double</span> x;<br>            cin&gt;&gt;p&gt;&gt;x;<br>            st[p<span class="hljs-number">-1</span>].money+=x/<span class="hljs-number">100</span>;<br>            st[i].money-=x/<span class="hljs-number">100</span>;<br>            st[p<span class="hljs-number">-1</span>].cnt++;<span class="hljs-comment">//è®°å½•æŠ¢åˆ°çš„çº¢åŒ…æ•°</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">sort</span>(st,st+n,cmp);<span class="hljs-comment">//sortä»æ•°ç»„ä¸‹æ ‡0å¼€å§‹æ’åºï¼Œå·¦é—­å³å¼€</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;n ; ++k) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %.2lf\n&quot;</span>,st[k].id,st[k].money);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://blog.csdn.net/dingpiao190/article/details/73512811?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_default&utm_relevant_index=1">(20æ¡æ¶ˆæ¯) doubleç±»å‹æ˜¯å¦ç›¸ç­‰çš„åˆ¤æ–­æ–¹æ³•_dingpiao190çš„åšå®¢-CSDNåšå®¢_doubleåˆ¤æ–­ç›¸ç­‰</a></p><p><a href="https://blog.csdn.net/patrick_star_cowboy/article/details/82083392">(20æ¡æ¶ˆæ¯) å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªdoubleç±»å‹çš„æ•°æ˜¯å¦ç›¸ç­‰ï¼Ÿ_Patrick-Starçš„åšå®¢-CSDNåšå®¢_ä¸¤ä¸ªdoubleæ€ä¹ˆåˆ¤æ–­ç›¸ç­‰</a></p><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805066890854400">é¢˜ç›®è¯¦æƒ… - L2-009 æŠ¢çº¢åŒ… (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Sort</tag>
      
      <tag>ç»“æ„ä½“</tag>
      
      <tag>Doubleç±»å‹ç›¸ç­‰æ¯”è¾ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-003 æœˆé¥¼ (25 åˆ†)</title>
    <link href="/2022/04/15/Algorithm026/"/>
    <url>/2022/04/15/Algorithm026/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-003-æœˆé¥¼-25-åˆ†"><a href="#L2-003-æœˆé¥¼-25-åˆ†" class="headerlink" title="L2-003 æœˆé¥¼ (25 åˆ†)"></a>L2-003 æœˆé¥¼ (25 åˆ†)</h2><p>æœˆé¥¼æ˜¯ä¸­å›½äººåœ¨ä¸­ç§‹ä½³èŠ‚æ—¶åƒçš„ä¸€ç§ä¼ ç»Ÿé£Ÿå“ï¼Œä¸åŒåœ°åŒºæœ‰è®¸å¤šä¸åŒé£å‘³çš„æœˆé¥¼ã€‚ç°ç»™å®šæ‰€æœ‰ç§ç±»æœˆé¥¼çš„åº“å­˜é‡ã€æ€»å”®ä»·ã€ä»¥åŠå¸‚åœºçš„æœ€å¤§éœ€æ±‚é‡ï¼Œè¯·ä½ è®¡ç®—å¯ä»¥è·å¾—çš„æœ€å¤§æ”¶ç›Šæ˜¯å¤šå°‘ã€‚</p><p>æ³¨æ„ï¼šé”€å”®æ—¶å…è®¸å–å‡ºä¸€éƒ¨åˆ†åº“å­˜ã€‚æ ·ä¾‹ç»™å‡ºçš„æƒ…å½¢æ˜¯è¿™æ ·çš„ï¼šå‡å¦‚æˆ‘ä»¬æœ‰ 3 ç§æœˆé¥¼ï¼Œå…¶åº“å­˜é‡åˆ†åˆ«ä¸º 18ã€15ã€10 ä¸‡å¨ï¼Œæ€»å”®ä»·åˆ†åˆ«ä¸º 75ã€72ã€45 äº¿å…ƒã€‚å¦‚æœå¸‚åœºçš„æœ€å¤§éœ€æ±‚é‡åªæœ‰ 20 ä¸‡å¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å¤§æ”¶ç›Šç­–ç•¥åº”è¯¥æ˜¯å–å‡ºå…¨éƒ¨ 15 ä¸‡å¨ç¬¬ 2 ç§æœˆé¥¼ã€ä»¥åŠ 5 ä¸‡å¨ç¬¬ 3 ç§æœˆé¥¼ï¼Œè·å¾— 72 + 45&#x2F;2 &#x3D; 94.5ï¼ˆäº¿å…ƒï¼‰ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>æ¯ä¸ªè¾“å…¥åŒ…å«ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹å…ˆç»™å‡ºä¸€ä¸ªä¸è¶…è¿‡ 1000 çš„æ­£æ•´æ•° <em>N</em> è¡¨ç¤ºæœˆé¥¼çš„ç§ç±»æ•°ã€ä»¥åŠä¸è¶…è¿‡ 500ï¼ˆä»¥ä¸‡å¨ä¸ºå•ä½ï¼‰çš„æ­£æ•´æ•° <em>D</em> è¡¨ç¤ºå¸‚åœºæœ€å¤§éœ€æ±‚é‡ã€‚éšåä¸€è¡Œç»™å‡º <em>N</em> ä¸ªæ­£æ•°è¡¨ç¤ºæ¯ç§æœˆé¥¼çš„åº“å­˜é‡ï¼ˆä»¥ä¸‡å¨ä¸ºå•ä½ï¼‰ï¼›æœ€åä¸€è¡Œç»™å‡º <em>N</em> ä¸ªæ­£æ•°è¡¨ç¤ºæ¯ç§æœˆé¥¼çš„æ€»å”®ä»·ï¼ˆä»¥äº¿å…ƒä¸ºå•ä½ï¼‰ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹æ¯ç»„æµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨ä¸€è¡Œä¸­è¾“å‡ºæœ€å¤§æ”¶ç›Šï¼Œä»¥äº¿å…ƒä¸ºå•ä½å¹¶ç²¾ç¡®åˆ°å°æ•°ç‚¹å 2 ä½ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">3 20<br>18 15 10<br>75 72 45<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">94.50<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>è´ªå¿ƒ + Sort</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mooncake</span>&#123;</span><br>    <span class="hljs-keyword">double</span> pow;<br>    <span class="hljs-keyword">double</span> price;<br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(mooncake a,mooncake b)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> a.price*<span class="hljs-number">1.0</span>/a.pow&gt;b.price*<span class="hljs-number">1.0</span>/b.pow;<span class="hljs-comment">//è¿”å›å•ä»·é«˜çš„</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    <span class="hljs-keyword">double</span> d;<br>    cin&gt;&gt;n&gt;&gt;d;<br>    mooncake m[n];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;<br>        cin&gt;&gt;m[i].pow;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;n ; ++j) &#123;<br>        cin&gt;&gt;m[j].price;<br>    &#125;<br>    <span class="hljs-built_in">sort</span>(m,m+n,cmp);<br>    <span class="hljs-keyword">double</span> price=<span class="hljs-number">0.0</span>;<br>    <span class="hljs-keyword">double</span> tmpd=d;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;n ; ++k) &#123;<span class="hljs-comment">//æ¨¡æ‹Ÿæ±‚è§£</span><br>        <span class="hljs-keyword">if</span>(m[k].pow&lt;=tmpd)&#123;<br>            tmpd-=m[k].pow;<br>            price+=m[k].price;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(m[k].pow&gt;tmpd)&#123;<br>            price+=tmpd*(m[k].price/m[k].pow);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.2f\n&quot;</span>,price);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805071789801472">é¢˜ç›®è¯¦æƒ… - L2-003 æœˆé¥¼ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Sort</tag>
      
      <tag>ç»“æ„ä½“</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-013 çº¢è‰²è­¦æŠ¥ (25 åˆ†)</title>
    <link href="/2022/04/15/Algorithm025/"/>
    <url>/2022/04/15/Algorithm025/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-013-çº¢è‰²è­¦æŠ¥-25-åˆ†"><a href="#L2-013-çº¢è‰²è­¦æŠ¥-25-åˆ†" class="headerlink" title="L2-013 çº¢è‰²è­¦æŠ¥ (25 åˆ†)"></a>L2-013 çº¢è‰²è­¦æŠ¥ (25 åˆ†)</h2><p>æˆ˜äº‰ä¸­ä¿æŒå„ä¸ªåŸå¸‚é—´çš„è¿é€šæ€§éå¸¸é‡è¦ã€‚æœ¬é¢˜è¦æ±‚ä½ ç¼–å†™ä¸€ä¸ªæŠ¥è­¦ç¨‹åºï¼Œå½“å¤±å»ä¸€ä¸ªåŸå¸‚å¯¼è‡´å›½å®¶è¢«åˆ†è£‚ä¸ºå¤šä¸ªæ— æ³•è¿é€šçš„åŒºåŸŸæ—¶ï¼Œå°±å‘å‡ºçº¢è‰²è­¦æŠ¥ã€‚æ³¨æ„ï¼šè‹¥è¯¥å›½æœ¬æ¥å°±ä¸å®Œå…¨è¿é€šï¼Œæ˜¯åˆ†è£‚çš„kä¸ªåŒºåŸŸï¼Œè€Œå¤±å»ä¸€ä¸ªåŸå¸‚å¹¶ä¸æ”¹å˜å…¶ä»–åŸå¸‚ä¹‹é—´çš„è¿é€šæ€§ï¼Œåˆ™ä¸è¦å‘å‡ºè­¦æŠ¥ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡ºä¸¤ä¸ªæ•´æ•°<code>N</code>ï¼ˆ0 &lt; <code>N</code> â‰¤ 500ï¼‰å’Œ<code>M</code>ï¼ˆâ‰¤ 5000ï¼‰ï¼Œåˆ†åˆ«ä¸ºåŸå¸‚ä¸ªæ•°ï¼ˆäºæ˜¯é»˜è®¤åŸå¸‚ä»0åˆ°<code>N</code>-1ç¼–å·ï¼‰å’Œè¿æ¥ä¸¤åŸå¸‚çš„é€šè·¯æ¡æ•°ã€‚éšå<code>M</code>è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€æ¡é€šè·¯æ‰€è¿æ¥çš„ä¸¤ä¸ªåŸå¸‚çš„ç¼–å·ï¼Œå…¶é—´ä»¥1ä¸ªç©ºæ ¼åˆ†éš”ã€‚åœ¨åŸå¸‚ä¿¡æ¯ä¹‹åç»™å‡ºè¢«æ”»å çš„ä¿¡æ¯ï¼Œå³ä¸€ä¸ªæ­£æ•´æ•°<code>K</code>å’Œéšåçš„<code>K</code>ä¸ªè¢«æ”»å çš„åŸå¸‚çš„ç¼–å·ã€‚</p><p>æ³¨æ„ï¼šè¾“å…¥ä¿è¯ç»™å‡ºçš„è¢«æ”»å çš„åŸå¸‚ç¼–å·éƒ½æ˜¯åˆæ³•çš„ä¸”æ— é‡å¤ï¼Œä½†å¹¶ä¸ä¿è¯ç»™å‡ºçš„é€šè·¯æ²¡æœ‰é‡å¤ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹æ¯ä¸ªè¢«æ”»å çš„åŸå¸‚ï¼Œå¦‚æœå®ƒä¼šæ”¹å˜æ•´ä¸ªå›½å®¶çš„è¿é€šæ€§ï¼Œåˆ™è¾“å‡º<code>Red Alert: City k is lost!</code>ï¼Œå…¶ä¸­<code>k</code>æ˜¯è¯¥åŸå¸‚çš„ç¼–å·ï¼›å¦åˆ™åªè¾“å‡º<code>City k is lost.</code>å³å¯ã€‚å¦‚æœè¯¥å›½å¤±å»äº†æœ€åä¸€ä¸ªåŸå¸‚ï¼Œåˆ™å¢åŠ ä¸€è¡Œè¾“å‡º<code>Game Over.</code>ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">5 4<br>0 1<br>1 3<br>3 0<br>0 4<br>5<br>1 2 0 4 3<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">City 1 is lost.<br>City 2 is lost.<br>Red Alert: City 0 is lost!<br>City 4 is lost.<br>City 3 is lost.<br>Game Over.<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>é‚»æ¥çŸ©é˜µå»ºå›¾ + DFSç»Ÿè®¡è¿é€šåˆ†é‡æ•°</strong></p><p><strong>å¯¹äºæ— å‘å›¾æ¥è¯´ï¼Œdfstrave()ä¸­dfs()æˆ–bfstrave()ä¸­bfs()çš„è°ƒç”¨æ¬¡æ•°ç­‰äºè¯¥å›¾çš„è¿é€šåˆ†é‡æ•°</strong></p><p><strong>æ— å‘å›¾ä¸­çš„æå¤§è¿é€šå­å›¾ç§°ä¸ºè¿é€šåˆ†é‡</strong></p><p><strong>æå¤§è¿é€šå­å›¾å¿…é¡»è¿é€šï¼Œä¸”åŒ…å«å°½å¯èƒ½å¤šçš„é¡¶ç‚¹å’Œè¾¹</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> n,m;<br><span class="hljs-keyword">int</span> g[<span class="hljs-number">505</span>][<span class="hljs-number">505</span>];<span class="hljs-comment">//é‚»æ¥çŸ©é˜µå­˜å›¾</span><br><span class="hljs-keyword">int</span> visit[<span class="hljs-number">505</span>];<span class="hljs-comment">//æ ‡è®°è®¿é—®æ•°ç»„</span><br><span class="hljs-keyword">int</span> lost[<span class="hljs-number">505</span>];<span class="hljs-comment">//è®°å½•è¢«æ”»å çš„åŸå¸‚</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> node)</span></span>&#123;<span class="hljs-comment">//æ­£å¸¸çš„DFS</span><br>    visit[node]=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(visit[i]==<span class="hljs-number">0</span>&amp;&amp;g[node][i]==<span class="hljs-number">1</span>)<br>        &#123;<br>            <span class="hljs-built_in">dfs</span>(i);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfstrave</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">int</span> cnt=<span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">memset</span>(visit,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(visit));<span class="hljs-comment">//åˆå§‹åŒ–è®¿é—®æ•°ç»„</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>        <span class="hljs-keyword">if</span>(lost[i]==<span class="hljs-number">1</span>) visit[i]=<span class="hljs-number">1</span>;<span class="hljs-comment">//å¦‚æœè¯¥åŸå¸‚è¢«æ”»å ï¼Œåˆ™æ ‡è®°ä»–ä¸ºä»¥è®¿é—®</span><br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>        <span class="hljs-keyword">if</span>(visit[i]==<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-built_in">dfs</span>(i);<br>            cnt++;      <span class="hljs-comment">//ç»Ÿè®¡è¿é€šåˆ†é‡æ•°</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> cnt;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin&gt;&gt;n&gt;&gt;m;<br>    <span class="hljs-built_in">memset</span>(lost,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(lost));<span class="hljs-comment">//åˆå§‹åŒ–</span><br>    <span class="hljs-built_in">memset</span>(g,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(g));<span class="hljs-comment">//åˆå§‹åŒ–</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;m;i++)&#123;<br>        <span class="hljs-keyword">int</span> a,b;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        g[a][b]=g[b][a]=<span class="hljs-number">1</span>;<span class="hljs-comment">//å­˜å‚¨æ— å‘å›¾</span><br>    &#125;<br>    <span class="hljs-keyword">int</span> cnt=<span class="hljs-built_in">dfstrave</span>();<span class="hljs-comment">//è·å¾—åˆå§‹çš„è¿é€šåˆ†é‡æ•°</span><br>    <span class="hljs-keyword">int</span> k;<br>    cin&gt;&gt;k;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> w=<span class="hljs-number">0</span>;w&lt;k;w++)&#123;<br>        <span class="hljs-keyword">int</span> city;<br>        cin&gt;&gt;city;<br>        lost[city]=<span class="hljs-number">1</span>;<span class="hljs-comment">//è®°å½•è¯¥åŸå¸‚è¢«æ”»å </span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<br>            <span class="hljs-keyword">if</span>(g[city][i]==<span class="hljs-number">1</span>)&#123;<br>                g[city][i]=g[i][city]=<span class="hljs-number">0</span>;<span class="hljs-comment">//æ ‡è®°å’Œä»–ç›¸è¿çš„åŸå¸‚ä¸å†ç›¸è¿</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">int</span> tempcnt=<span class="hljs-built_in">dfstrave</span>();<span class="hljs-comment">//å½“å‰çš„è¿é€šåˆ†é‡</span><br>        <span class="hljs-keyword">if</span>(tempcnt&lt;=cnt)&#123;<span class="hljs-comment">//å¦‚æœå½“å‰çš„è¿é€šåˆ†é‡å°äºç­‰äºåŸæ¥çš„è¿é€šåˆ†é‡ï¼Œè¯´æ˜å›¾çš„è¿é€šæ€§æ²¡æœ‰è¢«æ”¹å˜</span><br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;City %d is lost.\n&quot;</span>, city);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-comment">//å¦åˆ™ï¼Œè¿é€šæ€§è¢«æ”¹å˜äº†</span><br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Red Alert: City %d is lost!\n&quot;</span>, city);<br>        &#125;<br>        cnt=tempcnt;<span class="hljs-comment">//æ›´æ–°è¿é€šåˆ†é‡</span><br>        <span class="hljs-keyword">if</span>(w==n<span class="hljs-number">-1</span>)&#123;<span class="hljs-comment">//åŸå¸‚å·²ç»è¢«æ”»å å®Œæ¯•</span><br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Game Over.\n&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805063963230208">é¢˜ç›®è¯¦æƒ… - L2-013 çº¢è‰²è­¦æŠ¥ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Graph</tag>
      
      <tag>é‚»æ¥çŸ©é˜µ</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-011 ç©è½¬äºŒå‰æ ‘ (25 åˆ†)</title>
    <link href="/2022/04/14/Algorithm024/"/>
    <url>/2022/04/14/Algorithm024/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-011-ç©è½¬äºŒå‰æ ‘-25-åˆ†"><a href="#L2-011-ç©è½¬äºŒå‰æ ‘-25-åˆ†" class="headerlink" title="L2-011 ç©è½¬äºŒå‰æ ‘ (25 åˆ†)"></a><strong>L2-011 ç©è½¬äºŒå‰æ ‘ (25 åˆ†)</strong></h2><p>ç»™å®šä¸€æ£µäºŒå‰æ ‘çš„ä¸­åºéå†å’Œå‰åºéå†ï¼Œè¯·ä½ å…ˆå°†æ ‘åšä¸ªé•œé¢åè½¬ï¼Œå†è¾“å‡ºåè½¬åçš„å±‚åºéå†çš„åºåˆ—ã€‚æ‰€è°“é•œé¢åè½¬ï¼Œæ˜¯æŒ‡å°†æ‰€æœ‰éå¶ç»“ç‚¹çš„å·¦å³å­©å­å¯¹æ¢ã€‚è¿™é‡Œå‡è®¾é”®å€¼éƒ½æ˜¯äº’ä¸ç›¸ç­‰çš„æ­£æ•´æ•°ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<code>N</code>ï¼ˆâ‰¤30ï¼‰ï¼Œæ˜¯äºŒå‰æ ‘ä¸­ç»“ç‚¹çš„ä¸ªæ•°ã€‚ç¬¬äºŒè¡Œç»™å‡ºå…¶ä¸­åºéå†åºåˆ—ã€‚ç¬¬ä¸‰è¡Œç»™å‡ºå…¶å‰åºéå†åºåˆ—ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>åœ¨ä¸€è¡Œä¸­è¾“å‡ºè¯¥æ ‘åè½¬åçš„å±‚åºéå†çš„åºåˆ—ã€‚æ•°å­—é—´ä»¥1ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡Œé¦–å°¾ä¸å¾—æœ‰å¤šä½™ç©ºæ ¼ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">7<br>1 2 3 4 5 6 7<br>4 1 3 2 6 5 7<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">4 6 1 7 5 3 2<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>é•œé¢åè½¬å³ä¸ºåœ¨å±‚åºéå†æ—¶äº¤æ¢å·¦å³å­æ ‘çš„éå†é¡ºåºï¼Œå·¦-&gt;å³å˜æˆå³-&gt;å·¦</strong></p><p><strong>å‰åº + ä¸­åº å»ºæ ‘ + BFS</strong></p><p><strong>å»ºæ ‘è¯¦ç»†è¿‡ç¨‹ï¼š</strong></p><p><a href="https://xingyuanjie.top/2022/04/07/Algorithm014/">ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘(å‰åº+ä¸­åº;ååº+ä¸­åº) - è®¡ç®—æœºå¥‡å¦™ä¹‹æ—… (xingyuanjie.top)</a></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span>&#123;</span><br>    <span class="hljs-keyword">int</span> data;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span> *<span class="hljs-title">lchild</span>,*<span class="hljs-title">rchild</span>;</span><br>&#125;BiTNode,*BiTree;<br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> in[<span class="hljs-number">35</span>];<br><span class="hljs-keyword">int</span> pre[<span class="hljs-number">35</span>];<br><span class="hljs-function">BiTree <span class="hljs-title">PostCreate</span><span class="hljs-params">(<span class="hljs-keyword">int</span> prel,<span class="hljs-keyword">int</span> prer,<span class="hljs-keyword">int</span> inl,<span class="hljs-keyword">int</span> inr)</span></span>&#123;<span class="hljs-comment">//å‰åºåŠ ä¸­åºå»ºæ ‘</span><br>    <span class="hljs-keyword">if</span>(prel&gt;prer)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>    BiTNode *root;<br>    root=(BiTNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(BiTNode));<br>    root-&gt;data=pre[prel];<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = inl; i &lt;=inr; ++i) &#123;<br>        <span class="hljs-keyword">if</span>(pre[prel]==in[i])&#123;<br>            index=i;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">int</span> numleft=index-inl;<br>    root-&gt;lchild=<span class="hljs-built_in">PostCreate</span>(prel+<span class="hljs-number">1</span>,prel+numleft,inl,index<span class="hljs-number">-1</span>);<br>    root-&gt;rchild=<span class="hljs-built_in">PostCreate</span>(prel+numleft+<span class="hljs-number">1</span>,prer,index+<span class="hljs-number">1</span>,inr);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LevelOrder</span><span class="hljs-params">(BiTree T)</span></span><br><span class="hljs-function"></span>&#123;<br>    queue&lt;BiTree&gt; q;<br>    q.<span class="hljs-built_in">push</span>(T);<br>    <span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>())&#123;<br>        BiTNode *tmp =q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">if</span>(i!=n<span class="hljs-number">-1</span>)&#123;<span class="hljs-comment">//è¾“å‡ºæ ¼å¼æ§åˆ¶</span><br>            cout&lt;&lt;tmp-&gt;data&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            cout&lt;&lt;tmp-&gt;data;<br>        &#125;<br>        i++;<br>        <span class="hljs-keyword">if</span>(tmp-&gt;rchild!=<span class="hljs-literal">NULL</span>)&#123;<span class="hljs-comment">//é•œé¢åè½¬ï¼Œå·¦-&gt;å³å˜æˆå³-&gt;å·¦</span><br>            q.<span class="hljs-built_in">push</span>(tmp-&gt;rchild);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(tmp-&gt;lchild!=<span class="hljs-literal">NULL</span>)&#123;<br>            q.<span class="hljs-built_in">push</span>(tmp-&gt;lchild);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    BiTree tree;<br>    tree=<span class="hljs-literal">NULL</span>;<br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        cin&gt;&gt;in[i];<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;n ; ++j) &#123;<br>        cin&gt;&gt;pre[j];<br>    &#125;<br>    tree=<span class="hljs-built_in">PostCreate</span>(<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>);<br>    <span class="hljs-built_in">LevelOrder</span>(tree);<br>    cout&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805065406070784">é¢˜ç›®è¯¦æƒ… - L2-011 ç©è½¬äºŒå‰æ ‘ (25 åˆ†) (pintia.cn)</a></p><p><a href="https://xingyuanjie.top/2022/04/07/Algorithm014/">ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘(å‰åº+ä¸­åº;ååº+ä¸­åº) - è®¡ç®—æœºå¥‡å¦™ä¹‹æ—… (xingyuanjie.top)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Binary tree</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-035 å®Œå…¨äºŒå‰æ ‘çš„å±‚åºéå† (25 åˆ†)</title>
    <link href="/2022/04/14/Algorithm023/"/>
    <url>/2022/04/14/Algorithm023/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-035-å®Œå…¨äºŒå‰æ ‘çš„å±‚åºéå†-25-åˆ†"><a href="#L2-035-å®Œå…¨äºŒå‰æ ‘çš„å±‚åºéå†-25-åˆ†" class="headerlink" title="L2-035 å®Œå…¨äºŒå‰æ ‘çš„å±‚åºéå† (25 åˆ†)"></a>L2-035 å®Œå…¨äºŒå‰æ ‘çš„å±‚åºéå† (25 åˆ†)</h2><p>ä¸€ä¸ªäºŒå‰æ ‘ï¼Œå¦‚æœæ¯ä¸€ä¸ªå±‚çš„ç»“ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œåˆ™è¿™ä¸ªäºŒå‰æ ‘å°±æ˜¯<strong>å®Œç¾äºŒå‰æ ‘</strong>ã€‚å¯¹äºæ·±åº¦ä¸º <em>D</em> çš„ï¼Œæœ‰ <em>N</em> ä¸ªç»“ç‚¹çš„äºŒå‰æ ‘ï¼Œè‹¥å…¶ç»“ç‚¹å¯¹åº”äºç›¸åŒæ·±åº¦å®Œç¾äºŒå‰æ ‘çš„å±‚åºéå†çš„å‰ <em>N</em> ä¸ªç»“ç‚¹ï¼Œè¿™æ ·çš„æ ‘å°±æ˜¯<strong>å®Œå…¨äºŒå‰æ ‘</strong>ã€‚</p><p>ç»™å®šä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„ååºéå†ï¼Œè¯·ä½ ç»™å‡ºè¿™æ£µæ ‘çš„å±‚åºéå†ç»“æœã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œä¸­ç»™å‡ºæ­£æ•´æ•° <em>N</em>ï¼ˆâ‰¤30ï¼‰ï¼Œå³æ ‘ä¸­ç»“ç‚¹ä¸ªæ•°ã€‚ç¬¬äºŒè¡Œç»™å‡ºååºéå†åºåˆ—ï¼Œä¸º <em>N</em> ä¸ªä¸è¶…è¿‡ 100 çš„æ­£æ•´æ•°ã€‚åŒä¸€è¡Œä¸­æ‰€æœ‰æ•°å­—éƒ½ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>åœ¨ä¸€è¡Œä¸­è¾“å‡ºè¯¥æ ‘çš„å±‚åºéå†åºåˆ—ã€‚æ‰€æœ‰æ•°å­—éƒ½ä»¥ 1 ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡Œé¦–å°¾ä¸å¾—æœ‰å¤šä½™ç©ºæ ¼ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">8<br>91 71 2 34 10 15 55 18<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">18 34 55 71 2 10 15 91<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>ååºéå†å»ºæ ‘ + å®Œå…¨äºŒå‰æ ‘æ€§è´¨</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> tree[<span class="hljs-number">10001</span>];<br><span class="hljs-keyword">int</span> n;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">post</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span></span>&#123;<span class="hljs-comment">//æ ¹æ®ååºéå†å»ºæ ‘</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i&lt;=n)&#123;<span class="hljs-comment">//å½“2*i&lt;=næ—¶ï¼Œç»“ç‚¹içš„å·¦å­©å­ç¼–å·ä¸º2*iï¼Œå¦åˆ™æ— å·¦å­©å­</span><br>        <span class="hljs-built_in">post</span>(<span class="hljs-number">2</span>*i);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>&lt;=n)&#123;<span class="hljs-comment">//å½“2*i+1&lt;=næ—¶ï¼Œç»“ç‚¹içš„å³å­©å­ç¼–å·ä¸º2*i+1ï¼Œå¦åˆ™æ— å³å­©å­</span><br>        <span class="hljs-built_in">post</span>(<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>);<br>    &#125;<br>    cin&gt;&gt;tree[i];<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>    cin&gt;&gt;n;<br>    <span class="hljs-built_in">post</span>(<span class="hljs-number">1</span>);           <span class="hljs-comment">//ååºéå†å»ºæ ‘</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n ; ++i) &#123;<span class="hljs-comment">//é¡ºåºè¾“å‡ºå³ä¸ºå±‚åºéå†</span><br>        <span class="hljs-keyword">if</span>(i!=n)&#123;<br>            cout&lt;&lt;tree[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            cout&lt;&lt;tree[i];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482058">https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482058</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Binary tree</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-031 æ·±å…¥è™ç©´ (25 åˆ†)</title>
    <link href="/2022/04/13/Algorithm022/"/>
    <url>/2022/04/13/Algorithm022/</url>
    
    <content type="html"><![CDATA[<p>è‘—åçš„ç‹ç‰Œé—´è° 007 éœ€è¦æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œè·å–æ•Œæ–¹çš„æœºå¯†æƒ…æŠ¥ã€‚å·²çŸ¥æƒ…æŠ¥è—åœ¨ä¸€ä¸ªåœ°ä¸‹è¿·å®«é‡Œï¼Œè¿·å®«åªæœ‰ä¸€ä¸ªå…¥å£ï¼Œé‡Œé¢æœ‰å¾ˆå¤šæ¡é€šè·¯ï¼Œæ¯æ¡è·¯é€šå‘ä¸€æ‰‡é—¨ã€‚æ¯ä¸€æ‰‡é—¨èƒŒåæˆ–è€…æ˜¯ä¸€ä¸ªæˆ¿é—´ï¼Œæˆ–è€…åˆæœ‰å¾ˆå¤šæ¡è·¯ï¼ŒåŒæ ·æ˜¯æ¯æ¡è·¯é€šå‘ä¸€æ‰‡é—¨â€¦â€¦ ä»–çš„æ‰‹é‡Œæœ‰ä¸€å¼ è¡¨æ ¼ï¼Œæ˜¯å…¶ä»–é—´è°å¸®ä»–æ”¶é›†åˆ°çš„æƒ…æŠ¥ï¼Œä»–ä»¬è®°ä¸‹äº†æ¯æ‰‡é—¨çš„ç¼–å·ï¼Œä»¥åŠè¿™æ‰‡é—¨èƒŒåçš„æ¯ä¸€æ¡é€šè·¯æ‰€åˆ°è¾¾çš„é—¨çš„ç¼–å·ã€‚007 å‘ç°ä¸å­˜åœ¨ä¸¤æ¡è·¯é€šå‘åŒä¸€æ‰‡é—¨ã€‚</p><p>å†…çº¿å‘Šè¯‰ä»–ï¼Œæƒ…æŠ¥å°±è—åœ¨è¿·å®«çš„æœ€æ·±å¤„ã€‚ä½†æ˜¯è¿™ä¸ªè¿·å®«å¤ªå¤§äº†ï¼Œä»–éœ€è¦ä½ çš„å¸®åŠ© â€”â€” è¯·ç¼–ç¨‹å¸®ä»–æ‰¾å‡ºè·ç¦»å…¥å£æœ€è¿œçš„é‚£æ‰‡é—¨ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥é¦–å…ˆåœ¨ä¸€è¡Œä¸­ç»™å‡ºæ­£æ•´æ•° <em>N</em>ï¼ˆ&lt;105ï¼‰ï¼Œæ˜¯é—¨çš„æ•°é‡ã€‚æœ€å <em>N</em> è¡Œï¼Œç¬¬ <em>i</em> è¡Œï¼ˆ1â‰¤<em>i</em>â‰¤<em>N</em>ï¼‰æŒ‰ä»¥ä¸‹æ ¼å¼æè¿°ç¼–å·ä¸º <em>i</em> çš„é‚£æ‰‡é—¨èƒŒåèƒ½é€šå‘çš„é—¨ï¼š</p><figure class="highlight mathematica"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mathematica"><span class="hljs-built_in">K</span> <span class="hljs-built_in">D</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-built_in">D</span><span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">...</span> <span class="hljs-built_in">D</span><span class="hljs-punctuation">[</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">]</span><br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <code>K</code> æ˜¯é€šé“çš„æ•°é‡ï¼Œå…¶åæ˜¯æ¯æ‰‡é—¨çš„ç¼–å·ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>åœ¨ä¸€è¡Œä¸­è¾“å‡ºè·ç¦»å…¥å£æœ€è¿œçš„é‚£æ‰‡é—¨çš„ç¼–å·ã€‚é¢˜ç›®ä¿è¯è¿™æ ·çš„ç»“æœæ˜¯å”¯ä¸€çš„ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">13<br>3 2 3 4<br>2 5 6<br>1 7<br>1 8<br>1 9<br>0<br>2 11 10<br>1 13<br>0<br>0<br>1 12<br>0<br>0<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">12<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>é‚»æ¥è¡¨ + BFS</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>vector&lt;<span class="hljs-keyword">int</span>&gt; v[<span class="hljs-number">100005</span>];<br><span class="hljs-keyword">int</span> book[<span class="hljs-number">100005</span>];<br><span class="hljs-keyword">int</span> start=<span class="hljs-number">0</span>;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-comment">//BFS</span><br>    queue&lt;<span class="hljs-keyword">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(start);<span class="hljs-comment">//æ ¹èŠ‚ç‚¹å…¥é˜Ÿ</span><br>    <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>())&#123;<br>        x=q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;v[x].<span class="hljs-built_in">size</span>() ; ++i) &#123;<br>            q.<span class="hljs-built_in">push</span>(v[x][i]);<br>        &#125;<br>    &#125;<span class="hljs-comment">//åœ¨ä¸€è¡Œä¸­è¾“å‡ºè·ç¦»å…¥å£æœ€è¿œçš„é‚£æ‰‡é—¨çš„ç¼–å·ã€‚é¢˜ç›®ä¿è¯è¿™æ ·çš„ç»“æœæ˜¯å”¯ä¸€çš„ã€‚</span><br>    <span class="hljs-keyword">return</span> x;<span class="hljs-comment">//æ‰€ä»¥æœ€åä¸€å±‚åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œæ‰€ä»¥BFSæœ€åä¸€ä¸ªå…ƒç´ ï¼Œå³ä¸ºæœ€è¿œçš„é—¨</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> time;<br>        cin&gt;&gt;time;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;=time ; ++j) &#123;<br>            <span class="hljs-keyword">int</span> num;<br>            cin&gt;&gt;num;<br>            book[num]=<span class="hljs-number">1</span>;<br>            v[i].<span class="hljs-built_in">push_back</span>(num);<br><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;=n ; ++k) &#123;<span class="hljs-comment">//æ‰¾å…¥å£</span><br>        <span class="hljs-keyword">if</span>(book[k]==<span class="hljs-number">0</span>) start=k;<span class="hljs-comment">//æ²¡æœ‰é—¨é€šå‘çš„é—¨ï¼Œå³ä¸ºå…¥å£</span><br>    &#125;<br>    <span class="hljs-keyword">int</span> ans=<span class="hljs-built_in">bfs</span>();<br>    cout&lt;&lt;ans&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1111914599412858888">é¢˜ç›®è¯¦æƒ… - L2-031 æ·±å…¥è™ç©´ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>é‚»æ¥è¡¨</tag>
      
      <tag>Vector</tag>
      
      <tag>Binary tree</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-040 å“²å“²æ‰“æ¸¸æˆ (25 åˆ†)</title>
    <link href="/2022/04/13/Algorithm021/"/>
    <url>/2022/04/13/Algorithm021/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-040-å“²å“²æ‰“æ¸¸æˆ-25-åˆ†"><a href="#L2-040-å“²å“²æ‰“æ¸¸æˆ-25-åˆ†" class="headerlink" title="L2-040 å“²å“²æ‰“æ¸¸æˆ (25 åˆ†)"></a><strong>L2-040 å“²å“²æ‰“æ¸¸æˆ (25 åˆ†)</strong></h2><p>å“²å“²æ˜¯ä¸€ä½ç¡¬æ ¸æ¸¸æˆç©å®¶ã€‚æœ€è¿‘ä¸€æ¬¾åå«ã€Šè¾¾è¯ºè¾¾è¯ºã€‹çš„æ–°æ¸¸æˆåˆšåˆšä¸Šå¸‚ï¼Œå“²å“²è‡ªç„¶è¦å¿«é€Ÿæ”»ç•¥æ¸¸æˆï¼Œå®ˆæŠ¤ç¡¬æ ¸æ¸¸æˆç©å®¶çš„ä¸€åˆ‡ï¼</p><p>ä¸ºç®€åŒ–æ¨¡å‹ï¼Œæˆ‘ä»¬ä¸å¦¨å‡è®¾æ¸¸æˆæœ‰ <em>N</em> ä¸ªå‰§æƒ…ç‚¹ï¼Œé€šè¿‡æ¸¸æˆé‡Œä¸åŒçš„æ“ä½œæˆ–é€‰æ‹©å¯ä»¥ä»æŸä¸ªå‰§æƒ…ç‚¹å»å¾€å¦å¤–ä¸€ä¸ªå‰§æƒ…ç‚¹ã€‚æ­¤å¤–ï¼Œæ¸¸æˆè¿˜è®¾ç½®äº†ä¸€äº›<strong>å­˜æ¡£</strong>ï¼Œåœ¨æŸä¸ªå‰§æƒ…ç‚¹å¯ä»¥å°†ç©å®¶çš„æ¸¸æˆè¿›åº¦ä¿å­˜åœ¨ä¸€ä¸ªæ¡£ä½ä¸Šï¼Œè¯»å–å­˜æ¡£åå¯ä»¥å›åˆ°å‰§æƒ…ç‚¹ï¼Œé‡æ–°è¿›è¡Œæ“ä½œæˆ–è€…é€‰æ‹©ï¼Œåˆ°è¾¾ä¸åŒçš„å‰§æƒ…ç‚¹ã€‚</p><p>ä¸ºäº†è¿½è¸ªç¡¬æ ¸æ¸¸æˆç©å®¶å“²å“²çš„æ”»ç•¥è¿›åº¦ï¼Œä½ æ‰“ç®—å†™ä¸€ä¸ªç¨‹åºæ¥å®Œæˆè¿™ä¸ªå·¥ä½œã€‚å‡è®¾ä½ å·²ç»çŸ¥é“äº†æ¸¸æˆçš„å…¨éƒ¨å‰§æƒ…ç‚¹å’Œæµç¨‹ï¼Œä»¥åŠå“²å“²çš„æ¸¸æˆæ“ä½œï¼Œè¯·ä½ è¾“å‡ºå“²å“²çš„æ¸¸æˆè¿›åº¦ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ­£æ•´æ•° <em>N</em> å’Œ <em>M</em> (1â‰¤<em>N</em>,<em>M</em>â‰¤105)ï¼Œè¡¨ç¤ºæ€»å…±æœ‰ <em>N</em> ä¸ªå‰§æƒ…ç‚¹ï¼Œå“²å“²æœ‰ <em>M</em> ä¸ªæ¸¸æˆæ“ä½œã€‚</p><p>æ¥ä¸‹æ¥çš„ <em>N</em> è¡Œï¼Œæ¯è¡Œå¯¹åº”ä¸€ä¸ªå‰§æƒ…ç‚¹çš„å‘å±•è®¾å®šã€‚ç¬¬ <em>i</em> è¡Œçš„ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯ <em>K**i</em>ï¼Œè¡¨ç¤ºå‰§æƒ…ç‚¹ <em>i</em> é€šè¿‡ä¸€äº›æ“ä½œæˆ–é€‰æ‹©èƒ½å»å¾€ä¸‹é¢ <em>K**i</em> ä¸ªå‰§æƒ…ç‚¹ï¼›æ¥ä¸‹æ¥æœ‰ <em>K**i</em> ä¸ªæ•°å­—ï¼Œç¬¬ <em>k</em> ä¸ªæ•°å­—è¡¨ç¤ºåšç¬¬ <em>k</em> ä¸ªæ“ä½œæˆ–é€‰æ‹©å¯ä»¥å»å¾€çš„å‰§æƒ…ç‚¹ç¼–å·ã€‚</p><p>æœ€åæœ‰ <em>M</em> è¡Œï¼Œæ¯è¡Œç¬¬ä¸€ä¸ªæ•°å­—æ˜¯ 0ã€1 æˆ– 2ï¼Œåˆ†åˆ«è¡¨ç¤ºï¼š</p><ul><li>0 è¡¨ç¤ºå“²å“²åšå‡ºäº†æŸä¸ªæ“ä½œæˆ–é€‰æ‹©ï¼Œåé¢ç´§æ¥ç€ä¸€ä¸ªæ•°å­— <em>j</em>ï¼Œè¡¨ç¤ºå“²å“²åœ¨å½“å‰å‰§æƒ…ç‚¹åšå‡ºäº†ç¬¬ <em>j</em> ä¸ªé€‰æ‹©ã€‚æˆ‘ä»¬ä¿è¯å“²å“²çš„é€‰æ‹©æ°¸è¿œæ˜¯åˆæ³•çš„ã€‚</li><li>1 è¡¨ç¤ºå“²å“²è¿›è¡Œäº†ä¸€æ¬¡å­˜æ¡£ï¼Œåé¢ç´§æ¥ç€æ˜¯ä¸€ä¸ªæ•°å­— <em>j</em>ï¼Œè¡¨ç¤ºå­˜æ¡£æ”¾åœ¨äº†ç¬¬ <em>j</em> ä¸ªæ¡£ä½ä¸Šã€‚</li><li>2 è¡¨ç¤ºå“²å“²è¿›è¡Œäº†ä¸€æ¬¡è¯»å–å­˜æ¡£çš„æ“ä½œï¼Œåé¢ç´§æ¥ç€æ˜¯ä¸€ä¸ªæ•°å­— <em>j</em>ï¼Œè¡¨ç¤ºè¯»å–äº†æ”¾åœ¨ç¬¬ <em>j</em> ä¸ªä½ç½®çš„å­˜æ¡£ã€‚</li></ul><p>çº¦å®šï¼šæ‰€æœ‰æ“ä½œæˆ–é€‰æ‹©ä»¥åŠå‰§æƒ…ç‚¹ç¼–å·éƒ½ä» 1 å·å¼€å§‹ã€‚å­˜æ¡£çš„æ¡£ä½ä¸è¶…è¿‡ 100 ä¸ªï¼Œç¼–å·ä¹Ÿä» 1 å¼€å§‹ã€‚æ¸¸æˆé»˜è®¤ä» 1 å·å‰§æƒ…ç‚¹å¼€å§‹ã€‚æ€»çš„é€‰é¡¹æ•°ï¼ˆå³ âˆ‘<em>K**i</em>ï¼‰ä¸è¶…è¿‡ 106ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹äºæ¯ä¸ª 1ï¼ˆå³å­˜æ¡£ï¼‰æ“ä½œï¼Œåœ¨ä¸€è¡Œä¸­è¾“å‡ºå­˜æ¡£çš„å‰§æƒ…ç‚¹ç¼–å·ã€‚</p><p>æœ€åä¸€è¡Œè¾“å‡ºå“²å“²æœ€ååˆ°è¾¾çš„å‰§æƒ…ç‚¹ç¼–å·ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">10 11<br>3 2 3 4<br>1 6<br>3 4 7 5<br>1 3<br>1 9<br>2 3 5<br>3 1 8 5<br>1 9<br>2 8 10<br>0<br>1 1<br>0 3<br>0 1<br>1 2<br>0 2<br>0 2<br>2 2<br>0 3<br>0 1<br>1 1<br>0 2<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">1<br>3<br>9<br>10<br></code></pre></div></td></tr></table></figure><h3 id="æ ·ä¾‹è§£é‡Šï¼š"><a href="#æ ·ä¾‹è§£é‡Šï¼š" class="headerlink" title="æ ·ä¾‹è§£é‡Šï¼š"></a>æ ·ä¾‹è§£é‡Šï¼š</h3><p>ç®€å•ç»™å‡ºæ ·ä¾‹ä¸­ç»è¿‡çš„å‰§æƒ…ç‚¹é¡ºåºï¼š</p><p>1 -&gt; 4 -&gt; 3 -&gt; 7 -&gt; 8 -&gt; 3 -&gt; 5 -&gt; 9 -&gt; 10ã€‚</p><p>æ¡£ä½ 1 å¼€å§‹å­˜çš„æ˜¯ 1 å·å‰§æƒ…ç‚¹ï¼›æ¡£ä½ 2 å­˜çš„æ˜¯ 3 å·å‰§æƒ…ç‚¹ï¼›æ¡£ä½ 1 åæ¥åˆå­˜äº† 9 å·å‰§æƒ…ç‚¹ã€‚</p><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>é‚»æ¥è¡¨ + æ¨¡æ‹Ÿï¼Œä¸»è¦æ˜¯ç†è§£é¢˜æ„</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n,k;<br>    cin&gt;&gt;n&gt;&gt;k;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; v[n+<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">int</span> save[<span class="hljs-number">105</span>];<span class="hljs-comment">//å­˜æ¡£ç‚¹</span><br>    <span class="hljs-keyword">int</span> now=<span class="hljs-number">1</span>;<span class="hljs-comment">//å½“å‰å‰§æƒ…ç‚¹</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> num;<br>        cin&gt;&gt;num;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;num ; ++j) &#123;<br>            <span class="hljs-keyword">int</span> x;<br>            cin&gt;&gt;x;<br>            v[i].<span class="hljs-built_in">push_back</span>(x);<span class="hljs-comment">//é‚»æ¥è¡¨å­˜æ“ä½œæ•°</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">0</span>; l &lt;k ; ++l) &#123;<span class="hljs-comment">//æ¨¡æ‹Ÿè¿‡ç¨‹</span><br>        <span class="hljs-keyword">int</span> a,b;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        <span class="hljs-keyword">if</span>(a==<span class="hljs-number">1</span>)&#123;<br>            save[b]=now;<br>            cout&lt;&lt;now&lt;&lt;endl;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(a==<span class="hljs-number">0</span>)&#123;<br>            now=v[now][b<span class="hljs-number">-1</span>];<br>        &#125;<br>        <span class="hljs-keyword">if</span>(a==<span class="hljs-number">2</span>)&#123;<br>            now=save[b];<br>        &#125;<br>    &#125;<br>    cout&lt;&lt;now&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1386335159927652363">é¢˜ç›®è¯¦æƒ… - L2-040 å“²å“²æ‰“æ¸¸æˆ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>é‚»æ¥è¡¨</tag>
      
      <tag>Vector</tag>
      
      <tag>æ¨¡æ‹Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-027 åäººå ‚ä¸ä»£é‡‘åˆ¸ (25 åˆ†)</title>
    <link href="/2022/04/13/Algorithm020/"/>
    <url>/2022/04/13/Algorithm020/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-027-åäººå ‚ä¸ä»£é‡‘åˆ¸-25-åˆ†"><a href="#L2-027-åäººå ‚ä¸ä»£é‡‘åˆ¸-25-åˆ†" class="headerlink" title="L2-027 åäººå ‚ä¸ä»£é‡‘åˆ¸ (25 åˆ†)"></a>L2-027 åäººå ‚ä¸ä»£é‡‘åˆ¸ (25 åˆ†)</h2><p>å¯¹äºåœ¨ä¸­å›½å¤§å­¦MOOCï¼ˆ<a href="http://www.icourse163.org/">http://www.icourse163.org/</a> ï¼‰å­¦ä¹ â€œæ•°æ®ç»“æ„â€è¯¾ç¨‹çš„å­¦ç”Ÿï¼Œæƒ³è¦è·å¾—ä¸€å¼ åˆæ ¼è¯ä¹¦ï¼Œæ€»è¯„æˆç»©å¿…é¡»è¾¾åˆ° 60 åˆ†åŠä»¥ä¸Šï¼Œå¹¶ä¸”æœ‰å¦åŠ ç¦åˆ©ï¼šæ€»è¯„åˆ†åœ¨ [G, 100] åŒºé—´å†…è€…ï¼Œå¯ä»¥å¾—åˆ° 50 å…ƒ PAT ä»£é‡‘åˆ¸ï¼›åœ¨ [60, G) åŒºé—´å†…è€…ï¼Œå¯ä»¥å¾—åˆ° 20 å…ƒPATä»£é‡‘åˆ¸ã€‚å…¨å›½è€ƒç‚¹é€šç”¨ï¼Œä¸€å¹´æœ‰æ•ˆã€‚åŒæ—¶ä»»è¯¾è€å¸ˆè¿˜ä¼šæŠŠæ€»è¯„æˆç»©å‰ K åçš„å­¦ç”Ÿåˆ—å…¥è¯¾ç¨‹â€œåäººå ‚â€ã€‚æœ¬é¢˜å°±è¯·ä½ ç¼–å†™ç¨‹åºï¼Œå¸®åŠ©è€å¸ˆåˆ—å‡ºåäººå ‚çš„å­¦ç”Ÿï¼Œå¹¶ç»Ÿè®¡ä¸€å…±å‘å‡ºäº†é¢å€¼å¤šå°‘å…ƒçš„ PAT ä»£é‡‘åˆ¸ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡º 3 ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«æ˜¯ Nï¼ˆä¸è¶…è¿‡ 10 000 çš„æ­£æ•´æ•°ï¼Œä¸ºå­¦ç”Ÿæ€»æ•°ï¼‰ã€Gï¼ˆåœ¨ (60,100) åŒºé—´å†…çš„æ•´æ•°ï¼Œä¸ºé¢˜é¢ä¸­æè¿°çš„ä»£é‡‘åˆ¸ç­‰çº§åˆ†ç•Œçº¿ï¼‰ã€Kï¼ˆä¸è¶…è¿‡ 100 ä¸”ä¸è¶…è¿‡ N çš„æ­£æ•´æ•°ï¼Œä¸ºè¿›å…¥åäººå ‚çš„æœ€ä½åæ¬¡ï¼‰ã€‚æ¥ä¸‹æ¥ N è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€ä½å­¦ç”Ÿçš„è´¦å·ï¼ˆé•¿åº¦ä¸è¶…è¿‡15ä½ã€ä¸å¸¦ç©ºæ ¼çš„å­—ç¬¦ä¸²ï¼‰å’Œæ€»è¯„æˆç»©ï¼ˆåŒºé—´ [0, 100] å†…çš„æ•´æ•°ï¼‰ï¼Œå…¶é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚é¢˜ç›®ä¿è¯æ²¡æœ‰é‡å¤çš„è´¦å·ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>é¦–å…ˆåœ¨ä¸€è¡Œä¸­è¾“å‡ºå‘å‡ºçš„ PAT ä»£é‡‘åˆ¸çš„æ€»é¢å€¼ã€‚ç„¶åæŒ‰æ€»è¯„æˆç»©éå‡åºè¾“å‡ºè¿›å…¥åäººå ‚çš„å­¦ç”Ÿçš„åæ¬¡ã€è´¦å·å’Œæˆç»©ï¼Œå…¶é—´ä»¥ 1 ä¸ªç©ºæ ¼åˆ†éš”ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæˆç»©ç›¸åŒçš„å­¦ç”Ÿäº«æœ‰å¹¶åˆ—çš„æ’åï¼Œæ’åå¹¶åˆ—æ—¶ï¼ŒæŒ‰è´¦å·çš„å­—æ¯åºå‡åºè¾“å‡ºã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">10 80 5<br>cy@zju.edu.cn 78<br>cy@pat-edu.com 87<br>1001@qq.com 65<br>uh-oh@163.com 96<br>test@126.com 39<br>anyone@qq.com 87<br>zoe@mit.edu 80<br>jack@ucla.edu 88<br>bob@cmu.edu 80<br>ken@163.com 70<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">360<br>1 uh-oh@163.com 96<br>2 jack@ucla.edu 88<br>3 anyone@qq.com 87<br>3 cy@pat-edu.com 87<br>5 bob@cmu.edu 80<br>5 zoe@mit.edu 80<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>ç»“æ„ä½“æ•°ç»„+sortæ’åºï¼Œéœ€è¦æ³¨æ„è¾“å‡ºæ ¼å¼æ§åˆ¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">student</span>&#123;</span><br>    <span class="hljs-keyword">int</span> score=<span class="hljs-number">0</span>;<br>    string email;<br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(student a,student b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(a.score==b.score) <span class="hljs-keyword">return</span> a.email&lt;b.email;<span class="hljs-comment">//å¦‚æœåˆ†æ•°ç›¸åŒè¿”å›å­—å…¸åºå°çš„</span><br>    <span class="hljs-keyword">return</span> a.score&gt;b.score;<span class="hljs-comment">//è¿”å›åˆ†æ•°æœ€å¤§çš„</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n,g,k;<br>    cin&gt;&gt;n&gt;&gt;g&gt;&gt;k;<br>    student st[n];<br>    <span class="hljs-keyword">int</span> money=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<span class="hljs-comment">//è¾“å…¥åŠ å­˜é’±</span><br>        cin&gt;&gt;st[i].email&gt;&gt;st[i].score;<br>        <span class="hljs-keyword">if</span>(g&lt;=st[i].score&amp;&amp;st[i].score&lt;=<span class="hljs-number">100</span>)&#123;<br>            money+=<span class="hljs-number">50</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-number">60</span>&lt;=st[i].score&amp;&amp;st[i].score&lt;g)&#123;<br>            money+=<span class="hljs-number">20</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">sort</span>(st,st+n,cmp);<span class="hljs-comment">//æ’åº</span><br>    cout&lt;&lt;money&lt;&lt;endl;<br>    <span class="hljs-keyword">int</span> cnt =<span class="hljs-number">1</span>;<span class="hljs-comment">//ç”¨æ¥åˆ¤æ–­ç”¨å¦è¶…è¿‡åäººå ‚ä¸ªæ•°</span><br>    <span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<span class="hljs-comment">//éå†stç»“æ„ä½“æ•°ç»„</span><br>    <span class="hljs-keyword">int</span> same=<span class="hljs-number">1</span>;<span class="hljs-comment">//åˆ†æ•°ç›¸åŒçš„ä¸ªæ•°</span><br>    <span class="hljs-keyword">int</span> fscore=st[<span class="hljs-number">0</span>].score;<span class="hljs-comment">//ç”¨æ¥åˆ¤æ–­åˆ†æ•°æ˜¯å¦ç›¸åŒ</span><br>    <span class="hljs-comment">//è¿™é“é¢˜å°±æ ¼å¼è¾“å‡ºéœ€è¦æ³¨æ„ä¸‹ï¼</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) &#123;<br><br>        <span class="hljs-keyword">if</span>(fscore==st[i].score)&#123;<br>            cout&lt;&lt;cnt&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;st[i].email&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;st[i].score&lt;&lt;endl;<span class="hljs-comment">//ç›¸åŒå³è¾“å‡º</span><br>            <span class="hljs-keyword">if</span>(i!=<span class="hljs-number">0</span>) same++;<span class="hljs-comment">//ä¸ä¸º0å·ï¼Œåˆ™same++ã€‚</span><br>        &#125;<br>        <span class="hljs-keyword">if</span>(fscore&gt;st[i].score)&#123;<br>            cnt=cnt+same;<span class="hljs-comment">//ä¸ç­‰ï¼Œæ›´æ–°cntå€¼</span><br>            same=<span class="hljs-number">1</span>;<span class="hljs-comment">//æ›´æ–°sameå€¼</span><br>            <span class="hljs-keyword">if</span>(cnt&gt;k)&#123; <span class="hljs-keyword">break</span>;&#125;<span class="hljs-comment">//å¤§äºåäººå ‚ä¸ªæ•°ç»“æŸ</span><br>            cout&lt;&lt;cnt&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;st[i].email&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;st[i].score&lt;&lt;endl;<br>            fscore=st[i].score;<span class="hljs-comment">//æ›´æ–°ç”¨æ¥åˆ¤æ–­åˆ†æ•°æ˜¯å¦ç›¸åŒçš„fscore</span><br><br>        &#125;<br>        i++;<br><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805055176163328">é¢˜ç›®è¯¦æƒ… - L2-027 åäººå ‚ä¸ä»£é‡‘åˆ¸ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Sort</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-026 å°å­—è¾ˆ (25 åˆ†)</title>
    <link href="/2022/04/13/Algorithm019/"/>
    <url>/2022/04/13/Algorithm019/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-026-å°å­—è¾ˆ-25-åˆ†"><a href="#L2-026-å°å­—è¾ˆ-25-åˆ†" class="headerlink" title="L2-026 å°å­—è¾ˆ (25 åˆ†)"></a><strong>L2-026 å°å­—è¾ˆ (25 åˆ†)</strong></h2><p>æœ¬é¢˜ç»™å®šä¸€ä¸ªåºå¤§å®¶æ—çš„å®¶è°±ï¼Œè¦è¯·ä½ ç»™å‡ºæœ€å°ä¸€è¾ˆçš„åå•ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡ºå®¶æ—äººå£æ€»æ•° Nï¼ˆä¸è¶…è¿‡ 100 000 çš„æ­£æ•´æ•°ï¼‰ â€”â€” ç®€å•èµ·è§ï¼Œæˆ‘ä»¬æŠŠå®¶æ—æˆå‘˜ä» 1 åˆ° N ç¼–å·ã€‚éšåç¬¬äºŒè¡Œç»™å‡º N ä¸ªç¼–å·ï¼Œå…¶ä¸­ç¬¬ i ä¸ªç¼–å·å¯¹åº”ç¬¬ i ä½æˆå‘˜çš„çˆ¶&#x2F;æ¯ã€‚å®¶è°±ä¸­è¾ˆåˆ†æœ€é«˜çš„è€ç¥–å®—å¯¹åº”çš„çˆ¶&#x2F;æ¯ç¼–å·ä¸º -1ã€‚ä¸€è¡Œä¸­çš„æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>é¦–å…ˆè¾“å‡ºæœ€å°çš„è¾ˆåˆ†ï¼ˆè€ç¥–å®—çš„è¾ˆåˆ†ä¸º 1ï¼Œä»¥ä¸‹é€çº§é€’å¢ï¼‰ã€‚ç„¶ååœ¨ç¬¬äºŒè¡ŒæŒ‰é€’å¢é¡ºåºè¾“å‡ºè¾ˆåˆ†æœ€å°çš„æˆå‘˜çš„ç¼–å·ã€‚ç¼–å·é—´ä»¥ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡Œé¦–å°¾ä¸å¾—æœ‰å¤šä½™ç©ºæ ¼ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">9<br>2 6 5 5 -1 5 6 4 7<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">4<br>1 9<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><p><strong>é‚»æ¥è¡¨å»ºæ ‘+BFS</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>vector&lt;<span class="hljs-keyword">int</span>&gt; tree[<span class="hljs-number">100005</span>];<span class="hljs-comment">//é‚»æ¥è¡¨å»ºæ ‘</span><br><span class="hljs-keyword">int</span> deeptree[<span class="hljs-number">100005</span>];<span class="hljs-comment">//è®°å½•æ ‘çš„æ·±åº¦</span><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> root;<span class="hljs-comment">//æ ¹èŠ‚ç‚¹</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-comment">//bfs</span><br>    queue&lt;<span class="hljs-keyword">int</span>&gt; q;<br>    q.<span class="hljs-built_in">push</span>(root);<span class="hljs-comment">//æ ¹èŠ‚ç‚¹å…¥é˜Ÿ</span><br>    <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>())&#123;<br>        x=q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;tree[x].<span class="hljs-built_in">size</span>() ; ++i) &#123;<br>            deeptree[tree[x][i]]=deeptree[x]+<span class="hljs-number">1</span>;<span class="hljs-comment">//æ¯ä¸€å±‚çš„æ·±åº¦ä¸ºä¸Šä¸€å±‚åŠ 1</span><br>            q.<span class="hljs-built_in">push</span>(tree[x][i]);<br><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> deeptree[x];<span class="hljs-comment">//è¿”å›æœ€åä¸€ä¸ªç»“ç‚¹çš„æ·±åº¦ï¼Œå³æ·±åº¦çš„æœ€å¤§å€¼</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    n;<br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">int</span> a[n];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n ; ++i) &#123;<br>        cin&gt;&gt;a[i];<br>        <span class="hljs-keyword">if</span>(a[i]==<span class="hljs-number">-1</span>)&#123;<br>            root=i;<span class="hljs-comment">//æ‰¾æ ¹èŠ‚ç‚¹</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;=n ; ++j) &#123;<span class="hljs-comment">//å»ºæ ‘</span><br>        tree[a[j]].<span class="hljs-built_in">push_back</span>(j);<span class="hljs-comment">//jæ˜¯a[j]çš„å­©å­èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">if</span>(a[j]==<span class="hljs-number">-1</span>) deeptree[j]=<span class="hljs-number">1</span>;<span class="hljs-comment">//åˆå§‹åŒ–æ ¹èŠ‚ç‚¹æ·±åº¦ä¸º1</span><br>    &#125;<br>    <span class="hljs-keyword">int</span> ans=<span class="hljs-built_in">bfs</span>();<br>    cout&lt;&lt;ans&lt;&lt;endl;<br>    <span class="hljs-keyword">int</span> maxdeepcnt=<span class="hljs-number">0</span>;<span class="hljs-comment">//è®°å½•æœ€å¤§æ·±åº¦çš„ä¸ªæ•°</span><br>    <span class="hljs-keyword">int</span> tmp[n];<span class="hljs-comment">//æ‰¾æœ€å¤§æ·±åº¦çš„id</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;=n ; ++k) &#123;<br>        <span class="hljs-keyword">if</span>(ans==deeptree[k])&#123;<br>            maxdeepcnt++;<br>            tmp[maxdeepcnt]=k;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//è¾“å‡ºæ ¼å¼æ§åˆ¶</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">1</span>; l &lt;=maxdeepcnt ; ++l) &#123;<br>        <span class="hljs-keyword">if</span>(l!=maxdeepcnt) cout&lt;&lt;tmp[l]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>        <span class="hljs-keyword">else</span> cout&lt;&lt;tmp[l]&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805055679479808">é¢˜ç›®è¯¦æƒ… - L2-026 å°å­—è¾ˆ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>é‚»æ¥è¡¨</tag>
      
      <tag>Vector</tag>
      
      <tag>Binary tree</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-023 å›¾ç€è‰²é—®é¢˜ (25 åˆ†)</title>
    <link href="/2022/04/12/Algorithm018/"/>
    <url>/2022/04/12/Algorithm018/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-023-å›¾ç€è‰²é—®é¢˜-25-åˆ†"><a href="#L2-023-å›¾ç€è‰²é—®é¢˜-25-åˆ†" class="headerlink" title="L2-023 å›¾ç€è‰²é—®é¢˜ (25 åˆ†)"></a>L2-023 å›¾ç€è‰²é—®é¢˜ (25 åˆ†)</h2><p>å›¾ç€è‰²é—®é¢˜æ˜¯ä¸€ä¸ªè‘—åçš„NPå®Œå…¨é—®é¢˜ã€‚ç»™å®šæ— å‘å›¾<em>G</em>&#x3D;(<em>V</em>,<em>E</em>)ï¼Œé—®å¯å¦ç”¨<em>K</em>ç§é¢œè‰²ä¸º<em>V</em>ä¸­çš„æ¯ä¸€ä¸ªé¡¶ç‚¹åˆ†é…ä¸€ç§é¢œè‰²ï¼Œä½¿å¾—ä¸ä¼šæœ‰ä¸¤ä¸ªç›¸é‚»é¡¶ç‚¹å…·æœ‰åŒä¸€ç§é¢œè‰²ï¼Ÿ</p><p>ä½†æœ¬é¢˜å¹¶ä¸æ˜¯è¦ä½ è§£å†³è¿™ä¸ªç€è‰²é—®é¢˜ï¼Œè€Œæ˜¯å¯¹ç»™å®šçš„ä¸€ç§é¢œè‰²åˆ†é…ï¼Œè¯·ä½ åˆ¤æ–­è¿™æ˜¯å¦æ˜¯å›¾ç€è‰²é—®é¢˜çš„ä¸€ä¸ªè§£ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡º3ä¸ªæ•´æ•°<em>V</em>ï¼ˆ0&lt;<em>V</em>â‰¤500ï¼‰ã€<em>E</em>ï¼ˆâ‰¥0ï¼‰å’Œ<em>K</em>ï¼ˆ0&lt;<em>K</em>â‰¤<em>V</em>ï¼‰ï¼Œåˆ†åˆ«æ˜¯æ— å‘å›¾çš„é¡¶ç‚¹æ•°ã€è¾¹æ•°ã€ä»¥åŠé¢œè‰²æ•°ã€‚é¡¶ç‚¹å’Œé¢œè‰²éƒ½ä»1åˆ°<em>V</em>ç¼–å·ã€‚éšå<em>E</em>è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹çš„ç¼–å·ã€‚åœ¨å›¾çš„ä¿¡æ¯ç»™å‡ºä¹‹åï¼Œç»™å‡ºäº†ä¸€ä¸ªæ­£æ•´æ•°<em>N</em>ï¼ˆâ‰¤20ï¼‰ï¼Œæ˜¯å¾…æ£€æŸ¥çš„é¢œè‰²åˆ†é…æ–¹æ¡ˆçš„ä¸ªæ•°ã€‚éšå<em>N</em>è¡Œï¼Œæ¯è¡Œé¡ºæ¬¡ç»™å‡º<em>V</em>ä¸ªé¡¶ç‚¹çš„é¢œè‰²ï¼ˆç¬¬<em>i</em>ä¸ªæ•°å­—è¡¨ç¤ºç¬¬<em>i</em>ä¸ªé¡¶ç‚¹çš„é¢œè‰²ï¼‰ï¼Œæ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚é¢˜ç›®ä¿è¯ç»™å®šçš„æ— å‘å›¾æ˜¯åˆæ³•çš„ï¼ˆå³ä¸å­˜åœ¨è‡ªå›è·¯å’Œé‡è¾¹ï¼‰ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹æ¯ç§é¢œè‰²åˆ†é…æ–¹æ¡ˆï¼Œå¦‚æœæ˜¯å›¾ç€è‰²é—®é¢˜çš„ä¸€ä¸ªè§£åˆ™è¾“å‡º<code>Yes</code>ï¼Œå¦åˆ™è¾“å‡º<code>No</code>ï¼Œæ¯å¥å ä¸€è¡Œã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><img src="/2022/04/12/Algorithm018/graph.png" alt="graph" style="zoom: 67%;"><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">6 8 3<br>2 1<br>1 3<br>4 6<br>2 5<br>2 4<br>5 4<br>5 6<br>3 6<br>4<br>1 2 3 3 1 2<br>4 5 6 6 4 5<br>1 2 3 4 5 6<br>2 3 4 2 3 4<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">Yes<br>Yes<br>No<br>No<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><p><strong>Set + é‚»æ¥è¡¨</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> v,e,k;<br>    cin&gt;&gt;v&gt;&gt;e&gt;&gt;k;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; g[<span class="hljs-number">505</span>];<span class="hljs-comment">//é‚»æ¥è¡¨</span><br>    <span class="hljs-keyword">int</span> color[<span class="hljs-number">505</span>];<span class="hljs-comment">//è®°å½•é¢œè‰²</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;e ; ++i) &#123;       <span class="hljs-comment">//å»ºç«‹é‚»æ¥è¡¨</span><br>        <span class="hljs-keyword">int</span> a,b;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        g[a].<span class="hljs-built_in">push_back</span>(b);<br>        g[b].<span class="hljs-built_in">push_back</span>(a);<br>    &#125;<br>    <span class="hljs-keyword">int</span> time;<br>    cin&gt;&gt;time;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;time ; ++j) &#123;<br>        <span class="hljs-keyword">int</span> flag=<span class="hljs-number">1</span>;<br>        set&lt;<span class="hljs-keyword">int</span>&gt; s;<span class="hljs-comment">//ç”¨æ¥ç»Ÿè®¡é¢œè‰²æ€»æ•°</span><br>        s.<span class="hljs-built_in">clear</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=v; ++i) &#123;<br>            <span class="hljs-keyword">int</span> num;<br>            cin&gt;&gt;num;<br>            color[i]=num;<br>            s.<span class="hljs-built_in">insert</span>(num);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(s.<span class="hljs-built_in">size</span>()!=k)&#123;<span class="hljs-comment">//å¦‚æœé¢œè‰²æ•°ä¸ç­‰äºkå³éæ³•</span><br>            cout&lt;&lt;<span class="hljs-string">&quot;No&quot;</span>&lt;&lt;endl;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">1</span>; l &lt;=v ; ++l) &#123;<span class="hljs-comment">//éå†é‚»æ¥è¡¨</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;g[l].<span class="hljs-built_in">size</span>(); ++i) &#123;<br>                <span class="hljs-keyword">if</span>(color[l]==color[g[l][i]])&#123;<span class="hljs-comment">//å¦‚æœç›¸é‚»ç»“ç‚¹é¢œè‰²ä¸€æ ·åˆ™ä¸ºå‡</span><br>                    flag=<span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">1</span>)&#123;<br>            cout&lt;&lt;<span class="hljs-string">&quot;Yes&quot;</span>&lt;&lt;endl;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            cout&lt;&lt;<span class="hljs-string">&quot;No&quot;</span>&lt;&lt;endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805057298481152">é¢˜ç›®è¯¦æƒ… - L2-023 å›¾ç€è‰²é—®é¢˜ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>C++</tag>
      
      <tag>Set</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Graph</tag>
      
      <tag>é‚»æ¥è¡¨</tag>
      
      <tag>Vector</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-022 é‡æ’é“¾è¡¨ (25 åˆ†)</title>
    <link href="/2022/04/12/Algorithm017/"/>
    <url>/2022/04/12/Algorithm017/</url>
    
    <content type="html"><![CDATA[<h2 id="L2-022-é‡æ’é“¾è¡¨-25-åˆ†"><a href="#L2-022-é‡æ’é“¾è¡¨-25-åˆ†" class="headerlink" title="L2-022 é‡æ’é“¾è¡¨ (25 åˆ†)"></a>L2-022 é‡æ’é“¾è¡¨ (25 åˆ†)</h2><p>ç»™å®šä¸€ä¸ªå•é“¾è¡¨ <em>L</em>1â†’<em>L</em>2â†’â‹¯â†’<em>Ln</em>âˆ’1â†’<em>Ln</em>ï¼Œè¯·ç¼–å†™ç¨‹åºå°†é“¾è¡¨é‡æ–°æ’åˆ—ä¸º <em>Ln</em>â†’<em>L</em>1â†’<em>Ln</em>âˆ’1â†’<em>L</em>2â†’â‹¯ã€‚ä¾‹å¦‚ï¼šç»™å®š<em>L</em>ä¸º1â†’2â†’3â†’4â†’5â†’6ï¼Œåˆ™è¾“å‡ºåº”è¯¥ä¸º6â†’1â†’5â†’2â†’4â†’3ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>æ¯ä¸ªè¾“å…¥åŒ…å«1ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç¬¬1è¡Œç»™å‡ºç¬¬1ä¸ªç»“ç‚¹çš„åœ°å€å’Œç»“ç‚¹æ€»ä¸ªæ•°ï¼Œå³æ­£æ•´æ•°<em>N</em> (â‰¤105)ã€‚ç»“ç‚¹çš„åœ°å€æ˜¯5ä½éè´Ÿæ•´æ•°ï¼ŒNULLåœ°å€ç”¨âˆ’1è¡¨ç¤ºã€‚</p><p>æ¥ä¸‹æ¥æœ‰<em>N</em>è¡Œï¼Œæ¯è¡Œæ ¼å¼ä¸ºï¼š</p><figure class="highlight purebasic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs purebasic">Address <span class="hljs-keyword">Data</span> <span class="hljs-keyword">Next</span><br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­<code>Address</code>æ˜¯ç»“ç‚¹åœ°å€ï¼›<code>Data</code>æ˜¯è¯¥ç»“ç‚¹ä¿å­˜çš„æ•°æ®ï¼Œä¸ºä¸è¶…è¿‡105çš„æ­£æ•´æ•°ï¼›<code>Next</code>æ˜¯ä¸‹ä¸€ç»“ç‚¹çš„åœ°å€ã€‚é¢˜ç›®ä¿è¯ç»™å‡ºçš„é“¾è¡¨ä¸Šè‡³å°‘æœ‰ä¸¤ä¸ªç»“ç‚¹ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>å¯¹æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œé¡ºåºè¾“å‡ºé‡æ’åçš„ç»“æœé“¾è¡¨ï¼Œå…¶ä¸Šæ¯ä¸ªç»“ç‚¹å ä¸€è¡Œï¼Œæ ¼å¼ä¸è¾“å…¥ç›¸åŒã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">00100 6<br>00000 4 99999<br>00100 1 12309<br>68237 6 -1<br>33218 3 00000<br>99999 5 68237<br>12309 2 33218<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">68237 6 00100<br>00100 1 99999<br>99999 5 12309<br>12309 2 00000<br>00000 4 33218<br>33218 3 -1<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><p><strong>åˆ©ç”¨åŒå‘é“¾è¡¨ï¼Œå¤´å°¾æŒ‡é’ˆæ¥æ¨¡æ‹Ÿ</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">linklist</span>&#123;</span><br>    <span class="hljs-keyword">int</span> address=<span class="hljs-number">0</span>;<span class="hljs-comment">//è®°å½•å½“å‰ç»“ç‚¹çš„åœ°å€ï¼Œè™½ç„¶ä¹Ÿæ²¡ç”¨åˆ°</span><br>    <span class="hljs-keyword">int</span> data=<span class="hljs-number">0</span>;<span class="hljs-comment">//è®°å½•æ•°æ®åŸŸ</span><br>    <span class="hljs-keyword">int</span> next=<span class="hljs-number">0</span>;<span class="hljs-comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªç»“ç‚¹çš„åœ°å€</span><br>    <span class="hljs-keyword">int</span> pre=<span class="hljs-number">0</span>;<span class="hljs-comment">//æŒ‡å‘ä¸Šä¸€ä¸ªç»“ç‚¹çš„åœ°å€</span><br>&#125;l[<span class="hljs-number">100005</span>];<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> start,back=<span class="hljs-number">-1</span>;<span class="hljs-comment">//å¤´å°¾æŒ‡é’ˆ</span><br>    <span class="hljs-keyword">int</span> tmp;<span class="hljs-comment">//ç”¨æ¥éå†å½“å‰é“¾è¡¨ç”¨äºç»Ÿè®¡é“¾è¡¨çš„é•¿åº¦</span><br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;start&gt;&gt;n;<br>    tmp=start;<br>    <span class="hljs-keyword">int</span> address, data, next;<br>    l[start].pre=<span class="hljs-number">-1</span>;   <span class="hljs-comment">//åˆå§‹åŒ–ç¬¬ä¸€ä¸ªç»“ç‚¹çš„å‰ä¸€ä¸ªç»“ç‚¹ä½ç½®ä¸º-1</span><br>    <span class="hljs-keyword">int</span> cnt=<span class="hljs-number">0</span>;  <span class="hljs-comment">//è®°å½•é“¾è¡¨é•¿</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>       cin&gt;&gt;address&gt;&gt;data&gt;&gt;next;<br>       l[address].address=address;<br>       l[address].data=data;<br>       l[address].next=next;<br>       <span class="hljs-keyword">if</span>(next!=<span class="hljs-number">-1</span>)&#123;<br>           l[next].pre=address;<span class="hljs-comment">//è®¾å€¼ä¸Šä¸€ä¸ªç»“ç‚¹çš„åœ°å€</span><br>       &#125;<br>    &#125;<br>    <span class="hljs-comment">//è¿™é“é¢˜æ¯”è¾ƒå‘çš„åœ°æ–¹æ˜¯ä¼šå‡ºç°ä¸æ˜¯è¿™ä¸ªé“¾è¡¨çš„ç»“ç‚¹ï¼Œæ‰€ä»¥nä¸æ˜¯çœŸæ­£çš„é“¾è¡¨é•¿ï¼Œéœ€è¦ç»Ÿè®¡çœŸæ­£çš„é“¾è¡¨é•¿</span><br>    <span class="hljs-comment">//å¦‚æœæ²¡æ³¨æ„è¿™ç‚¹ï¼Œç¬¬ä¸‰ä¸ªæµ‹è¯•ç‚¹ä¼šä¸é€šè¿‡ï¼Œä¸è¿‡ä¹Ÿèƒ½å¾—åˆ°21åˆ†</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        cnt++;<span class="hljs-comment">//ç»Ÿè®¡é“¾è¡¨é•¿</span><br>        <span class="hljs-keyword">if</span>(l[tmp].next==<span class="hljs-number">-1</span>)&#123;<br>            back=tmp;       <span class="hljs-comment">//å°¾æŒ‡é’ˆ</span><br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        tmp=l[tmp].next;<br>    &#125;<br>    <span class="hljs-keyword">int</span> flag=<span class="hljs-number">0</span>;<br>    <span class="hljs-comment">//flag=0åŠ¨å°¾æŒ‡é’ˆ,flag=1åŠ¨å¤´æŒ‡é’ˆã€‚æˆ‘å¹¶æ²¡æœ‰æ”¹å˜åŸæ¥é“¾è¡¨ï¼</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;cnt ; ++k) &#123;<br>            <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-keyword">if</span>(k==cnt<span class="hljs-number">-1</span>)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%05d %d %d\n&quot;</span>,l[back].address,l[back].data,<span class="hljs-number">-1</span>);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%05d %d %05d\n&quot;</span>,l[back].address,l[back].data,start);<br>                &#125;<br>                back=l[back].pre;<br>                flag=<span class="hljs-number">1</span>;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-keyword">if</span>(k==cnt<span class="hljs-number">-1</span>)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%05d %d %d\n&quot;</span>,l[start].address,l[start].data,<span class="hljs-number">-1</span>);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%05d %d %05d\n&quot;</span>,l[start].address,l[start].data,back);<br>                &#125;<br>                start=l[start].next;<br>                flag=<span class="hljs-number">0</span>;<br>            &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805057860517888">é¢˜ç›®è¯¦æƒ… - L2-022 é‡æ’é“¾è¡¨ (25 åˆ†) (pintia.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>LinkList</tag>
      
      <tag>åŒå‘é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>L2-021 ç‚¹èµç‹‚é­” (25 åˆ†)</title>
    <link href="/2022/04/11/Algorithm016/"/>
    <url>/2022/04/11/Algorithm016/</url>
    
    <content type="html"><![CDATA[<h1 id="L2-021-ç‚¹èµç‹‚é­”-25-åˆ†"><a href="#L2-021-ç‚¹èµç‹‚é­”-25-åˆ†" class="headerlink" title="L2-021 ç‚¹èµç‹‚é­” (25 åˆ†)"></a>L2-021 ç‚¹èµç‹‚é­” (25 åˆ†)</h1><p>å¾®åšä¸Šæœ‰ä¸ªâ€œç‚¹èµâ€åŠŸèƒ½ï¼Œä½ å¯ä»¥ä¸ºä½ å–œæ¬¢çš„åšæ–‡ç‚¹ä¸ªèµè¡¨ç¤ºæ”¯æŒã€‚æ¯ç¯‡åšæ–‡éƒ½æœ‰ä¸€äº›åˆ»ç”»å…¶ç‰¹æ€§çš„æ ‡ç­¾ï¼Œè€Œä½ ç‚¹èµçš„åšæ–‡çš„ç±»å‹ï¼Œä¹Ÿé—´æ¥åˆ»ç”»äº†ä½ çš„ç‰¹æ€§ã€‚ç„¶è€Œæœ‰è¿™ä¹ˆä¸€ç§äººï¼Œä»–ä»¬ä¼šé€šè¿‡ç»™è‡ªå·±çœ‹åˆ°çš„ä¸€åˆ‡å†…å®¹ç‚¹èµæ¥ç‹‚åˆ·å­˜åœ¨æ„Ÿï¼Œè¿™ç§äººå°±è¢«ç§°ä¸ºâ€œç‚¹èµç‹‚é­”â€ã€‚ä»–ä»¬ç‚¹èµçš„æ ‡ç­¾éå¸¸åˆ†æ•£ï¼Œæ— æ³•ä½“ç°å‡ºæ˜æ˜¾çš„ç‰¹æ€§ã€‚æœ¬é¢˜å°±è¦æ±‚ä½ å†™ä¸ªç¨‹åºï¼Œé€šè¿‡ç»Ÿè®¡æ¯ä¸ªäººç‚¹èµçš„ä¸åŒæ ‡ç­¾çš„æ•°é‡ï¼Œæ‰¾å‡ºå‰3åç‚¹èµç‹‚é­”ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<em>N</em>ï¼ˆâ‰¤100ï¼‰ï¼Œæ˜¯å¾…ç»Ÿè®¡çš„ç”¨æˆ·æ•°ã€‚éšå<em>N</em>è¡Œï¼Œæ¯è¡Œåˆ—å‡ºä¸€ä½ç”¨æˆ·çš„ç‚¹èµæ ‡ç­¾ã€‚æ ¼å¼ä¸ºâ€œ<code>Name</code> <em>K</em> <em>F</em>1â‹¯<em>F**K</em>â€ï¼Œå…¶ä¸­<code>Name</code>æ˜¯ä¸è¶…è¿‡8ä¸ªè‹±æ–‡å°å†™å­—æ¯çš„éç©ºç”¨æˆ·åï¼Œ1â‰¤<em>K</em>â‰¤1000ï¼Œ<em>F**i</em>ï¼ˆ<em>i</em>&#x3D;1,â‹¯,<em>K</em>ï¼‰æ˜¯ç‰¹æ€§æ ‡ç­¾çš„ç¼–å·ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ç‰¹æ€§æ ‡ç­¾ä» 1 åˆ° 107 ç¼–å·ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>ç»Ÿè®¡æ¯ä¸ªäººç‚¹èµçš„ä¸åŒæ ‡ç­¾çš„æ•°é‡ï¼Œæ‰¾å‡ºæ•°é‡æœ€å¤§çš„å‰3åï¼Œåœ¨ä¸€è¡Œä¸­é¡ºåºè¾“å‡ºä»–ä»¬çš„ç”¨æˆ·å,å…¶é—´ä»¥1ä¸ªç©ºæ ¼åˆ†éš”,ä¸”è¡Œæœ«ä¸å¾—æœ‰å¤šä½™ç©ºæ ¼ã€‚å¦‚æœæœ‰å¹¶åˆ—ï¼Œåˆ™è¾“å‡ºæ ‡ç­¾å‡ºç°æ¬¡æ•°å¹³å‡å€¼æœ€å°çš„é‚£ä¸ªï¼Œé¢˜ç›®ä¿è¯è¿™æ ·çš„ç”¨æˆ·æ²¡æœ‰å¹¶åˆ—ã€‚è‹¥ä¸è¶³3äººï¼Œåˆ™ç”¨<code>-</code>è¡¥é½ç¼ºå¤±ï¼Œä¾‹å¦‚<code>mike jenny -</code>å°±è¡¨ç¤ºåªæœ‰2äººã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">5<br>bob 11 101 102 103 104 105 106 107 108 108 107 107<br>peter 8 1 2 3 4 3 2 5 1<br>chris 12 1 2 3 4 5 6 7 8 9 1 2 3<br>john 10 8 7 6 5 4 3 2 1 7 5<br>jack 9 6 7 8 9 10 11 12 13 14<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">jack chris john<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><p><strong>ç»“æ„ä½“æ•°ç»„ + sortæ’åº</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">person</span>&#123;</span><br>    <span class="hljs-keyword">char</span> name[<span class="hljs-number">10</span>];<br>    set&lt;<span class="hljs-keyword">int</span>&gt; s;<span class="hljs-comment">//setå®¹å™¨ä¸­çš„æ¯ä¸ªå…ƒç´ å€¼å”¯ä¸€</span><br>    <span class="hljs-keyword">int</span> all=<span class="hljs-number">0</span>;<span class="hljs-comment">//è®°å½•ç‚¹èµæ¬¡æ•°</span><br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(person a,person b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(a.s.<span class="hljs-built_in">size</span>()==b.s.<span class="hljs-built_in">size</span>()) <span class="hljs-keyword">return</span> a.all&lt;b.all;<span class="hljs-comment">//å¦‚æœæœ‰å¹¶åˆ—ï¼Œåˆ™è¾“å‡ºæ ‡ç­¾å‡ºç°æ¬¡æ•°å¹³å‡å€¼æœ€å°çš„é‚£ä¸ª</span><br>    <span class="hljs-keyword">return</span> a.s.<span class="hljs-built_in">size</span>()&gt;b.s.<span class="hljs-built_in">size</span>();<span class="hljs-comment">//ç‚¹èµçš„ä¸åŒæ ‡ç­¾çš„æ•°é‡æœ€å¤šçš„</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;n;<br>    person p[n];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        cin&gt;&gt;p[i].name;<br>        <span class="hljs-keyword">int</span> time;<br>        cin&gt;&gt;time;<br>        p[i].all=time;<span class="hljs-comment">//è®°å½•ç‚¹èµæ¬¡æ•°</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; time; ++j) &#123;<br>            <span class="hljs-keyword">int</span> tmp;<br>            cin&gt;&gt;tmp;<br>            p[i].s.<span class="hljs-built_in">insert</span>(tmp);<span class="hljs-comment">//æ’å…¥setå®¹å™¨</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">sort</span>(p,p+n,cmp);<span class="hljs-comment">//æ’åº</span><br>    <span class="hljs-keyword">if</span>(n&gt;=<span class="hljs-number">3</span>)&#123;<br>        cout&lt;&lt;p[<span class="hljs-number">0</span>].name&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;p[<span class="hljs-number">1</span>].name&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;p[<span class="hljs-number">2</span>].name&lt;&lt;endl;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(n==<span class="hljs-number">2</span>)&#123;<br>        cout&lt;&lt;p[<span class="hljs-number">0</span>].name&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;p[<span class="hljs-number">1</span>].name&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;<span class="hljs-string">&quot;-&quot;</span>&lt;&lt;endl;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>)&#123;<br>        cout&lt;&lt;p[<span class="hljs-number">0</span>].name&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;<span class="hljs-string">&quot;-&quot;</span>&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;<span class="hljs-string">&quot;-&quot;</span>&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805058485469184">é¢˜ç›®è¯¦æƒ… - L2-021 ç‚¹èµç‹‚é­” (25 åˆ†) (pintia.cn)</a></p><p><a href="https://blog.csdn.net/changjiale110/article/details/79108447">(19æ¡æ¶ˆæ¯) STLä¸­çš„setä½¿ç”¨æ–¹æ³•è¯¦ç»†ï¼ï¼ï¼ï¼_çŸ¥è¶³â€“å¸¸ä¹çš„åšå®¢-CSDNåšå®¢_set stl</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>STL</tag>
      
      <tag>C++</tag>
      
      <tag>Set</tag>
      
      <tag>å›¢ä½“ç¨‹åºè®¾è®¡å¤©æ¢¯èµ›</tag>
      
      <tag>Sort</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++çš„STLä¸­å­—ç¬¦ä¸²stringè‡ªå¸¦æ–¹æ³•findæŸ¥æ‰¾</title>
    <link href="/2022/04/08/Algorithm015/"/>
    <url>/2022/04/08/Algorithm015/</url>
    
    <content type="html"><![CDATA[<h1 id="C-çš„STLä¸­å­—ç¬¦ä¸²stringè‡ªå¸¦æ–¹æ³•findæŸ¥æ‰¾"><a href="#C-çš„STLä¸­å­—ç¬¦ä¸²stringè‡ªå¸¦æ–¹æ³•findæŸ¥æ‰¾" class="headerlink" title="C++çš„STLä¸­å­—ç¬¦ä¸²stringè‡ªå¸¦æ–¹æ³•findæŸ¥æ‰¾"></a>C++çš„STLä¸­å­—ç¬¦ä¸²stringè‡ªå¸¦æ–¹æ³•findæŸ¥æ‰¾</h1><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">string str = <span class="hljs-string">&quot;abcd&quot;</span>;<br>cout &lt;&lt; str.<span class="hljs-built_in">find</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br><span class="hljs-comment">//è¿”å›çš„æ˜¯ä¸‹æ ‡çš„å€¼è€Œä¸æ˜¯æŒ‡é’ˆæˆ–æ˜¯è¿­ä»£å™¨</span><br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">string str = <span class="hljs-string">&quot;abcd&quot;</span><br>string sub = <span class="hljs-string">&quot;cd&quot;</span><br><span class="hljs-keyword">if</span>(str.<span class="hljs-built_in">find</span>(sub)!=string::npos)&#123;<br>    cout&lt;&lt;<span class="hljs-string">&quot;æ‰¾åˆ°äº†&quot;</span>&lt;&lt;endl;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    cout&lt;&lt;<span class="hljs-string">&quot;æ²¡æœ‰æ‰¾åˆ°&quot;</span>&lt;&lt;endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¦æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å›çš„æ˜¯str::npos<br>æ³¨æ„ï¼Œåªæœ‰stringçš„findæ–¹æ³•æ˜¯è¿”å›çš„ä¸‹æ ‡ï¼Œå› ä¸ºstringæ˜¯é¡ºåºç´¢å¼•ï¼Œset,map,multiset,multimapéƒ½ä¸æ˜¯é¡ºåºç´¢å¼•çš„æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯è¿­ä»£å™¨ã€‚</p><h2 id="æ ·ä¾‹ä¸€-L1-070-åƒç«é”…-15-åˆ†"><a href="#æ ·ä¾‹ä¸€-L1-070-åƒç«é”…-15-åˆ†" class="headerlink" title="æ ·ä¾‹ä¸€:L1-070 åƒç«é”… (15 åˆ†)"></a>æ ·ä¾‹ä¸€:<strong>L1-070 åƒç«é”… (15 åˆ†)</strong></h2><p><strong>é¢˜ç›®é“¾æ¥ï¼š</strong></p><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482053">https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482053</a></p><p><img src="/2022/04/08/Algorithm015/68518b64-f2f7-4694-aaeb-d32afe657f7b.jpg" alt="chg.jpg"></p><p>ä»¥ä¸Šå›¾ç‰‡æ¥è‡ªå¾®ä¿¡æœ‹å‹åœˆï¼šè¿™ç§å¤©æ°”ä½ æœ‰ä»€ä¹ˆç ´äº‹æ‰“ç”µè¯ç»™æˆ‘åŸºæœ¬æ²¡ç”¨ã€‚ä½†æ˜¯å¦‚æœä½ è¯´â€œåƒç«é”…â€ï¼Œé‚£å°±å‰å®³äº†ï¼Œæˆ‘ä»¬çš„æ•…äº‹å°±å¼€å§‹äº†ã€‚</p><p>æœ¬é¢˜è¦æ±‚ä½ å®ç°ä¸€ä¸ªç¨‹åºï¼Œè‡ªåŠ¨æ£€æŸ¥ä½ æœ‹å‹ç»™ä½ å‘æ¥çš„ä¿¡æ¯é‡Œæœ‰æ²¡æœ‰ <code>chi1 huo3 guo1</code>ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥æ¯è¡Œç»™å‡ºä¸€å¥ä¸è¶…è¿‡ 80 ä¸ªå­—ç¬¦çš„ã€ä»¥å›è½¦ç»“å°¾çš„æœ‹å‹ä¿¡æ¯ï¼Œä¿¡æ¯ä¸ºéç©ºå­—ç¬¦ä¸²ï¼Œä»…åŒ…æ‹¬å­—æ¯ã€æ•°å­—ã€ç©ºæ ¼ã€å¯è§çš„åŠè§’æ ‡ç‚¹ç¬¦å·ã€‚å½“è¯»åˆ°æŸä¸€è¡Œåªæœ‰ä¸€ä¸ªè‹±æ–‡å¥ç‚¹ <code>.</code> æ—¶ï¼Œè¾“å…¥ç»“æŸï¼Œæ­¤è¡Œä¸ç®—åœ¨æœ‹å‹ä¿¡æ¯é‡Œã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>é¦–å…ˆåœ¨ä¸€è¡Œä¸­è¾“å‡ºæœ‹å‹ä¿¡æ¯çš„æ€»æ¡æ•°ã€‚ç„¶åå¯¹æœ‹å‹çš„æ¯ä¸€è¡Œä¿¡æ¯ï¼Œæ£€æŸ¥å…¶ä¸­æ˜¯å¦åŒ…å« <code>chi1 huo3 guo1</code>ï¼Œå¹¶ä¸”ç»Ÿè®¡è¿™æ ·å‰å®³çš„ä¿¡æ¯æœ‰å¤šå°‘æ¡ã€‚åœ¨ç¬¬äºŒè¡Œä¸­é¦–å…ˆè¾“å‡ºç¬¬ä¸€æ¬¡å‡ºç° <code>chi1 huo3 guo1</code> çš„ä¿¡æ¯æ˜¯ç¬¬å‡ æ¡ï¼ˆä» 1 å¼€å§‹è®¡æ•°ï¼‰ï¼Œç„¶åè¾“å‡ºè¿™ç±»ä¿¡æ¯çš„æ€»æ¡æ•°ï¼Œå…¶é—´ä»¥ä¸€ä¸ªç©ºæ ¼åˆ†éš”ã€‚é¢˜ç›®ä¿è¯è¾“å‡ºçš„æ‰€æœ‰æ•°å­—ä¸è¶…è¿‡ 100ã€‚</p><p>å¦‚æœæœ‹å‹ä»å¤´åˆ°å°¾éƒ½æ²¡æ <code>chi1 huo3 guo1</code> è¿™ä¸ªå…³é”®è¯ï¼Œåˆ™åœ¨ç¬¬äºŒè¡Œè¾“å‡ºä¸€ä¸ªè¡¨æƒ… <code>-_-#</code>ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹-1ï¼š"><a href="#è¾“å…¥æ ·ä¾‹-1ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ 1ï¼š"></a>è¾“å…¥æ ·ä¾‹ 1ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">Hello!<br>are you there?<br>wantta chi1 huo3 guo1?<br>that&#x27;s so li hai le<br>our story begins from chi1 huo3 guo1 le<br>.<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹-1ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹-1ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ 1ï¼š"></a>è¾“å‡ºæ ·ä¾‹ 1ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">5<br>3 2<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å…¥æ ·ä¾‹-2ï¼š"><a href="#è¾“å…¥æ ·ä¾‹-2ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ 2ï¼š"></a>è¾“å…¥æ ·ä¾‹ 2ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">Hello!<br>are you there?<br>wantta qi huo3 guo1 chi1huo3guo1?<br>that&#x27;s so li hai le<br>our story begins from ci1 huo4 guo2 le<br>.<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹-2ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹-2ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ 2ï¼š"></a>è¾“å‡ºæ ·ä¾‹ 2ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">5<br>-_-#<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> flag=<span class="hljs-number">0</span>;<span class="hljs-comment">//ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡æ‰¾åˆ°åƒç«é”…</span><br>    <span class="hljs-keyword">int</span> cnt=<span class="hljs-number">0</span>;<span class="hljs-comment">//ç”¨æ¥è®°å½•æ€»è¡Œæ•°</span><br>    <span class="hljs-keyword">int</span> count=<span class="hljs-number">0</span>;<span class="hljs-comment">//ç”¨æ¥è®°å½•æœ‰å¤šå°‘ä¸ªåƒç«é”…</span><br>    <span class="hljs-keyword">int</span> firstp=<span class="hljs-number">0</span>;<span class="hljs-comment">//ç”¨æ¥è®°å½•ç¬¬ä¸€æ¬¡å‡ºç°åƒç«é”…çš„ä½ç½®</span><br>    string cmp=<span class="hljs-string">&quot;chi1 huo3 guo1&quot;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)<br>    &#123;<br>        string s;<br>        s.<span class="hljs-built_in">clear</span>();<br>        <span class="hljs-built_in">getline</span>(cin,s);<br>        <span class="hljs-keyword">if</span>(s.<span class="hljs-built_in">size</span>()==<span class="hljs-number">1</span>&amp;&amp;s==<span class="hljs-string">&quot;.&quot;</span>)&#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        string tmp =s;<br>        <span class="hljs-keyword">if</span>(tmp.<span class="hljs-built_in">find</span>(cmp)!=string::npos)&#123;<br>            <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">0</span>) &#123;<br>                flag =<span class="hljs-number">1</span>;<br>                firstp = cnt+<span class="hljs-number">1</span>;<br>            &#125;<br>            count=count+<span class="hljs-number">1</span>;<br>        &#125;<br>        cnt=cnt+<span class="hljs-number">1</span>;<br><br>    &#125;<br>    <span class="hljs-keyword">if</span>(count==<span class="hljs-number">0</span>)&#123;<br>        cout&lt;&lt;cnt&lt;&lt;endl;<br>        cout&lt;&lt;<span class="hljs-string">&quot;-_-#&quot;</span>&lt;&lt;endl;<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        cout&lt;&lt;cnt&lt;&lt;endl;<br>        cout&lt;&lt;firstp&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;count&lt;&lt;endl;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/qq_50675813/article/details/113313343">(18æ¡æ¶ˆæ¯) c++STLä¸­çš„find()å‡½æ•° æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•_æˆ‘ä»¬ä¸ç”Ÿäº§ä»£ç ï¼Œåªæ˜¯ä»£ç çš„æ¬è¿å·¥çš„åšå®¢-CSDNåšå®¢_c++ä¸­findå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•</a></p><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482053">https://pintia.cn/problem-sets/994805046380707840/problems/1336215880692482053</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>String</tag>
      
      <tag>Find</tag>
      
      <tag>STL</tag>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘(å‰åº+ä¸­åº;ååº+ä¸­åº)</title>
    <link href="/2022/04/07/Algorithm014/"/>
    <url>/2022/04/07/Algorithm014/</url>
    
    <content type="html"><![CDATA[<h1 id="ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘-å‰åº-ä¸­åº-ååº-ä¸­åº"><a href="#ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘-å‰åº-ä¸­åº-ååº-ä¸­åº" class="headerlink" title="ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘(å‰åº+ä¸­åº;ååº+ä¸­åº)"></a>ç”±éå†é¡ºåºæ„å»ºäºŒå‰æ ‘(å‰åº+ä¸­åº;ååº+ä¸­åº)</h1><h2 id="å‰åº-ä¸­åº"><a href="#å‰åº-ä¸­åº" class="headerlink" title="å‰åº+ä¸­åº"></a>å‰åº+ä¸­åº</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">BiTree <span class="hljs-title">PreAndInCreateTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span> prel,<span class="hljs-keyword">int</span> prer, <span class="hljs-keyword">int</span> inl,<span class="hljs-keyword">int</span> inr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(prel&gt;prer)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>    BiTNode *root;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    root=(BiTNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(BiTNode));<span class="hljs-comment">//è®°ä½åˆ†é…ç©ºé—´</span><br>    root-&gt;data=preF[prel];<span class="hljs-comment">//å‰åºéå†çš„ç¬¬ä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹ç»“ç‚¹</span><br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">for</span>(i=inl;i&lt;=inr;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(preF[prel]==inF[i])&#123;<br>            index=i;<br>            <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">//æ‰¾åˆ°äº†æ ¹ç»“ç‚¹ï¼Œç›®çš„æ˜¯åœ¨ä¸­åºéå†ä¸­åˆ’åˆ†å·¦å³å­æ ‘</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//åˆ™å…¶å·¦å­æ ‘èŠ‚ç‚¹ä¸ªæ•°ä¸ºindex-inl</span><br>    <span class="hljs-comment">//å‰åºéå†çš„ç¬¬ä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹ç»“ç‚¹,æ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯prel+1,åˆ°prel+index-inl,</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯inl,index-1</span><br>    root-&gt;lchild=<span class="hljs-built_in">PreAndInCreateTree</span>(prel+<span class="hljs-number">1</span>,prel+index-inl,inl,index<span class="hljs-number">-1</span>);<br>    <span class="hljs-comment">//å‰åºéå†æ˜¯æ ¹å·¦å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯prel+index-inl+1,prep</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯index+1,inr</span><br>    root-&gt;rchild=<span class="hljs-built_in">PreAndInCreateTree</span>(prel+index-inl+<span class="hljs-number">1</span>,prer,index+<span class="hljs-number">1</span>,inr);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ååº-ä¸­åº"><a href="#ååº-ä¸­åº" class="headerlink" title="ååº+ä¸­åº"></a>ååº+ä¸­åº</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">BiTree <span class="hljs-title">PostAndInCreateTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span> postl,<span class="hljs-keyword">int</span> postr, <span class="hljs-keyword">int</span> inl,<span class="hljs-keyword">int</span> inr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(postl&gt;postr)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>    BiTNode *root;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    root=(BiTNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(BiTNode));<br>    root-&gt;data=posts[postr];<span class="hljs-comment">//ååºéå†çš„æœ€åä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹ç»“ç‚¹</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = inl; i &lt;=inr ; ++i) &#123;<br>        <span class="hljs-keyword">if</span>(posts[postr]==ins[i])<br>        &#123;<br>            index =i;<br>            <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">//æ‰¾åˆ°äº†æ ¹ç»“ç‚¹ï¼Œç›®çš„æ˜¯åœ¨ä¸­åºéå†ä¸­åˆ’åˆ†å·¦å³å­æ ‘</span><br>        &#125;<br>    &#125;<span class="hljs-comment">//åˆ™å…¶å·¦å­æ ‘èŠ‚ç‚¹ä¸ªæ•°ä¸ºindex-inl</span><br>    <span class="hljs-comment">//åç»­éå†çš„æœ€åä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯ï¼Œpostl,postl+index-inl-1</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯inl,index-1</span><br>    root-&gt;lchild=<span class="hljs-built_in">PostAndInCreateTree</span>(postl,postl+index-inl<span class="hljs-number">-1</span>,inl,index<span class="hljs-number">-1</span>);<br>    <span class="hljs-comment">//ååºéå†æ˜¯å·¦å³æ ¹ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯postl+index-inl,postr-1</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯index+1,inr</span><br>    root-&gt;rchild=<span class="hljs-built_in">PostAndInCreateTree</span>(postl+index-inl,postr<span class="hljs-number">-1</span>,index+<span class="hljs-number">1</span>,inr);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å®Œæ•´ä»£ç ç¤ºä¾‹"><a href="#å®Œæ•´ä»£ç ç¤ºä¾‹" class="headerlink" title="å®Œæ•´ä»£ç ç¤ºä¾‹"></a>å®Œæ•´ä»£ç ç¤ºä¾‹</h2><p><strong>å‰åº+ä¸­åºï¼›ååº+ä¸­åºã€‚é€’å½’è°ƒç”¨å¯è§†åŒ–æŸ¥çœ‹ï¼š(æœ‰åŠ©äºç†è§£é€’å½’è°ƒç”¨è¿‡ç¨‹)</strong></p><p><a href="https://pythontutor.com/">Python Tutor - Visualize Python, Java, C, C++, JavaScript, TypeScript, and Ruby code execution</a></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span>&#123;</span><br>    <span class="hljs-keyword">int</span> data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span> *<span class="hljs-title">lchild</span>,*<span class="hljs-title">rchild</span>;</span><span class="hljs-comment">//å·¦å³å­©å­æŒ‡é’ˆ</span><br>&#125;BiTNode,*BiTree;<br><span class="hljs-comment">//tree</span><br><span class="hljs-keyword">int</span> preF[<span class="hljs-number">6</span>]=&#123;<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;;<span class="hljs-comment">//å‰åºéå†</span><br><span class="hljs-keyword">int</span> inF[<span class="hljs-number">6</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">5</span>&#125;;<span class="hljs-comment">//ä¸­åºéå†</span><br><span class="hljs-comment">//trees</span><br><span class="hljs-keyword">int</span> posts[<span class="hljs-number">7</span>]=&#123;<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>&#125;;<span class="hljs-comment">//ååºéå†</span><br><span class="hljs-keyword">int</span> ins[<span class="hljs-number">7</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>&#125;;<span class="hljs-comment">//ä¸­åºéå†</span><br><span class="hljs-function">BiTree <span class="hljs-title">PreAndInCreateTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span> prel,<span class="hljs-keyword">int</span> prer, <span class="hljs-keyword">int</span> inl,<span class="hljs-keyword">int</span> inr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(prel&gt;prer)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>    BiTNode *root;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    root=(BiTNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(BiTNode));<span class="hljs-comment">//è®°ä½åˆ†é…ç©ºé—´</span><br>    root-&gt;data=preF[prel];<span class="hljs-comment">//å‰åºéå†çš„ç¬¬ä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹ç»“ç‚¹</span><br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">for</span>(i=inl;i&lt;=inr;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(preF[prel]==inF[i])&#123;<br>            index=i;<br>            <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">//æ‰¾åˆ°äº†æ ¹ç»“ç‚¹ï¼Œç›®çš„æ˜¯åœ¨ä¸­åºéå†ä¸­åˆ’åˆ†å·¦å³å­æ ‘</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//åˆ™å…¶å·¦å­æ ‘èŠ‚ç‚¹ä¸ªæ•°ä¸ºindex-inl</span><br>    <span class="hljs-comment">//å‰åºéå†çš„ç¬¬ä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹ç»“ç‚¹,æ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯prel+1,åˆ°prel+index-inl,</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯inl,index-1</span><br>    root-&gt;lchild=<span class="hljs-built_in">PreAndInCreateTree</span>(prel+<span class="hljs-number">1</span>,prel+index-inl,inl,index<span class="hljs-number">-1</span>);<br>    <span class="hljs-comment">//å‰åºéå†æ˜¯æ ¹å·¦å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯prel+index-inl+1,prep</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯index+1,inr</span><br>    root-&gt;rchild=<span class="hljs-built_in">PreAndInCreateTree</span>(prel+index-inl+<span class="hljs-number">1</span>,prer,index+<span class="hljs-number">1</span>,inr);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br><span class="hljs-function">BiTree <span class="hljs-title">PostAndInCreateTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span> postl,<span class="hljs-keyword">int</span> postr, <span class="hljs-keyword">int</span> inl,<span class="hljs-keyword">int</span> inr)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(postl&gt;postr)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    &#125;<br>    BiTNode *root;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    root=(BiTNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(BiTNode));<br>    root-&gt;data=posts[postr];<span class="hljs-comment">//ååºéå†çš„æœ€åä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹ç»“ç‚¹</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = inl; i &lt;=inr ; ++i) &#123;<br>        <span class="hljs-keyword">if</span>(posts[postr]==ins[i])<br>        &#123;<br>            index =i;<br>            <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">//æ‰¾åˆ°äº†æ ¹ç»“ç‚¹ï¼Œç›®çš„æ˜¯åœ¨ä¸­åºéå†ä¸­åˆ’åˆ†å·¦å³å­æ ‘</span><br>        &#125;<br>    &#125;<span class="hljs-comment">//åˆ™å…¶å·¦å­æ ‘èŠ‚ç‚¹ä¸ªæ•°ä¸ºindex-inl</span><br>    <span class="hljs-comment">//åç»­éå†çš„æœ€åä¸€ä¸ªç»“ç‚¹æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯ï¼Œpostl,postl+index-inl-1</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯inl,index-1</span><br>    root-&gt;lchild=<span class="hljs-built_in">PostAndInCreateTree</span>(postl,postl+index-inl<span class="hljs-number">-1</span>,inl,index<span class="hljs-number">-1</span>);<br>    <span class="hljs-comment">//ååºéå†æ˜¯å·¦å³æ ¹ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯postl+index-inl,postr-1</span><br>    <span class="hljs-comment">//ä¸­åºéå†æ˜¯å·¦æ ¹å³ï¼Œæ‰€ä»¥æ–°çš„é€’å½’åŒºé—´æ˜¯index+1,inr</span><br>    root-&gt;rchild=<span class="hljs-built_in">PostAndInCreateTree</span>(postl+index-inl,postr<span class="hljs-number">-1</span>,index+<span class="hljs-number">1</span>,inr);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LevelOrder</span><span class="hljs-params">(BiTree T)</span></span><br><span class="hljs-function"></span>&#123;<br>    queue&lt;BiTree&gt; q;<br>    q.<span class="hljs-built_in">push</span>(T);<br>    <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>())&#123;<br>        BiTNode *tmp =q.<span class="hljs-built_in">front</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        cout&lt;&lt;tmp-&gt;data;<br>        <span class="hljs-keyword">if</span>(tmp-&gt;lchild!=<span class="hljs-literal">NULL</span>)&#123;<br>            q.<span class="hljs-built_in">push</span>(tmp-&gt;lchild);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(tmp-&gt;rchild!=<span class="hljs-literal">NULL</span>)&#123;<br>            q.<span class="hljs-built_in">push</span>(tmp-&gt;rchild);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>    BiTree tree;<br>    tree=<span class="hljs-literal">NULL</span>;<br>    tree=<span class="hljs-built_in">PreAndInCreateTree</span>(<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>);<br>    cout&lt;&lt;<span class="hljs-string">&quot;è¾“å…¥ä¸ºå‰åºåŠ ä¸­åºéå†ï¼Œè¾“å‡ºä»–çš„å±‚åºéå†ï¼š&quot;</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">LevelOrder</span>(tree);<br>    cout&lt;&lt;endl;<br>    BiTree trees;<br>    trees=<span class="hljs-literal">NULL</span>;<br>    cout&lt;&lt;<span class="hljs-string">&quot;è¾“å…¥ä¸ºååºåŠ ä¸­åºéå†ï¼Œè¾“å‡ºä»–çš„å±‚åºéå†ï¼š&quot;</span>&lt;&lt;endl;<br>    trees=<span class="hljs-built_in">PostAndInCreateTree</span>(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>);<br>    <span class="hljs-built_in">LevelOrder</span>(trees);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">è¾“å…¥ä¸ºå‰åºåŠ ä¸­åºéå†ï¼Œè¾“å‡ºä»–çš„å±‚åºéå†ï¼š<br><span class="hljs-number">425136</span><br>è¾“å…¥ä¸ºååºåŠ ä¸­åºéå†ï¼Œè¾“å‡ºä»–çš„å±‚åºéå†ï¼š<br><span class="hljs-number">4163572</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„</title>
    <link href="/2022/04/06/Algorithm012/"/>
    <url>/2022/04/06/Algorithm012/</url>
    
    <content type="html"><![CDATA[<h1 id="äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„"><a href="#äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„" class="headerlink" title="äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„"></a>äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„</h1><h2 id="1-é¡ºåºå­˜å‚¨æ–¹å¼"><a href="#1-é¡ºåºå­˜å‚¨æ–¹å¼" class="headerlink" title="1.é¡ºåºå­˜å‚¨æ–¹å¼"></a>1.é¡ºåºå­˜å‚¨æ–¹å¼</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSize 100</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">TreeNode</span>&#123;</span><br>    ElemType value;<span class="hljs-comment">//ç»“ç‚¹ä¸­çš„æ•°æ®å…ƒç´ </span><br>    <span class="hljs-keyword">bool</span> isEmpty;<span class="hljs-comment">//ç»“ç‚¹æ˜¯å¦ä¸ºç©º</span><br>&#125;;<br><br>TreeNode t[MaxSize];<br></code></pre></div></td></tr></table></figure><h2 id="2-é“¾å¼å­˜å‚¨ç»“æ„"><a href="#2-é“¾å¼å­˜å‚¨ç»“æ„" class="headerlink" title="2.é“¾å¼å­˜å‚¨ç»“æ„"></a>2.é“¾å¼å­˜å‚¨ç»“æ„</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span>&#123;</span><br>    ElemType data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span> *<span class="hljs-title">lchild</span>,*<span class="hljs-title">rchild</span>;</span><span class="hljs-comment">//å·¦å³å­©å­æŒ‡é’ˆ</span><br>&#125;BiTNode,*BiTree;<br></code></pre></div></td></tr></table></figure><h2 id="3-ä¸‰å‰é“¾è¡¨"><a href="#3-ä¸‰å‰é“¾è¡¨" class="headerlink" title="3.ä¸‰å‰é“¾è¡¨"></a>3.ä¸‰å‰é“¾è¡¨</h2><p>ä¸‰å‰é“¾è¡¨â€”æ–¹ä¾¿æ‰¾çˆ¶èŠ‚ç‚¹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span>&#123;</span><br>    ElemType data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span> *<span class="hljs-title">lchild</span>,*<span class="hljs-title">rchild</span>;</span><span class="hljs-comment">//å·¦å³å­©å­æŒ‡é’ˆ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BiTNode</span> *<span class="hljs-title">parent</span>;</span><span class="hljs-comment">//çˆ¶ç»“ç‚¹æŒ‡é’ˆ</span><br>&#125;BiTNode,*BiTree;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸²çš„å­˜å‚¨ç»“æ„</title>
    <link href="/2022/04/06/Algorithm011/"/>
    <url>/2022/04/06/Algorithm011/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸²çš„å­˜å‚¨ç»“æ„"><a href="#ä¸²çš„å­˜å‚¨ç»“æ„" class="headerlink" title="ä¸²çš„å­˜å‚¨ç»“æ„"></a>ä¸²çš„å­˜å‚¨ç»“æ„</h1><h2 id="1-å®šé•¿é¡ºåºå­˜å‚¨è¡¨ç¤º"><a href="#1-å®šé•¿é¡ºåºå­˜å‚¨è¡¨ç¤º" class="headerlink" title="1.å®šé•¿é¡ºåºå­˜å‚¨è¡¨ç¤º"></a>1.å®šé•¿é¡ºåºå­˜å‚¨è¡¨ç¤º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXLEN 255<span class="hljs-comment">//é¢„å®šä¹‰æœ€å¤§ä¸²é•¿</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-keyword">char</span> ch[MAXLEN];<span class="hljs-comment">//æ¯ä¸ªåˆ†é‡å­˜å‚¨ä¸€ä¸ªå­—ç¬¦</span><br>    <span class="hljs-keyword">int</span> length;<span class="hljs-comment">//ä¸²çš„å®é™…é•¿åº¦</span><br>&#125;SSting;<br></code></pre></div></td></tr></table></figure><h2 id="2-å †åˆ†é…å­˜å‚¨è¡¨ç¤º"><a href="#2-å †åˆ†é…å­˜å‚¨è¡¨ç¤º" class="headerlink" title="2.å †åˆ†é…å­˜å‚¨è¡¨ç¤º"></a>2.å †åˆ†é…å­˜å‚¨è¡¨ç¤º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    <span class="hljs-keyword">char</span> *ch;<span class="hljs-comment">//æŒ‰ä¸²é•¿åˆ†é…å­˜å‚¨åŒºï¼ŒchæŒ‡å‘ä¸²çš„åŸºåœ°å€</span><br>    <span class="hljs-keyword">int</span> length;<span class="hljs-comment">//ä¸²çš„é•¿åº¦</span><br>&#125;HString;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MPIå­¦ä¹ (å…­)-ä¸¤ä¸ªçŸ©é˜µç›¸åŠ MPIç‰ˆæœ¬</title>
    <link href="/2022/04/02/mpi006/"/>
    <url>/2022/04/02/mpi006/</url>
    
    <content type="html"><![CDATA[<h1 id="MPIå­¦ä¹ -å…­-ä¸¤ä¸ªçŸ©é˜µç›¸åŠ MPIç‰ˆæœ¬"><a href="#MPIå­¦ä¹ -å…­-ä¸¤ä¸ªçŸ©é˜µç›¸åŠ MPIç‰ˆæœ¬" class="headerlink" title="MPIå­¦ä¹ (å…­)-ä¸¤ä¸ªçŸ©é˜µç›¸åŠ MPIç‰ˆæœ¬"></a>MPIå­¦ä¹ (å…­)-ä¸¤ä¸ªçŸ©é˜µç›¸åŠ MPIç‰ˆæœ¬</h1><p>è¿™é‡Œï¼Œæˆ‘ä»¬æ¼”ç¤ºäº†ä¸¤ä¸ªç®€å•çš„ç¨‹åºï¼Œä¸€ä¸ªæ˜¯çŸ©é˜µç›¸åŠ ä¸²è¡Œç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯çŸ©é˜µç›¸åŠ MPIç‰ˆæœ¬</p><h2 id="ä¸²è¡Œç‰ˆæœ¬"><a href="#ä¸²è¡Œç‰ˆæœ¬" class="headerlink" title="ä¸²è¡Œç‰ˆæœ¬"></a>ä¸²è¡Œç‰ˆæœ¬</h2><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> a[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<br><span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<br><span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<br><span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>&#125;;<br><span class="hljs-keyword">int</span> b[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<br><span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<br><span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">17</span>,<span class="hljs-number">5</span>,<br><span class="hljs-number">15</span>,<span class="hljs-number">14</span>,<span class="hljs-number">20</span>,<span class="hljs-number">3</span>&#125;;<br><span class="hljs-keyword">int</span> c[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>];<br><span class="hljs-built_in">memset</span>(c,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(c)); <br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)<br>&#123;<br>c[i][j]=a[i][j]+b[i][j];<br>&#125;<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,c[i][j]);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">8</span> <span class="hljs-number">11</span><br><span class="hljs-number">6</span> <span class="hljs-number">9</span> <span class="hljs-number">15</span> <span class="hljs-number">17</span><br><span class="hljs-number">20</span> <span class="hljs-number">22</span> <span class="hljs-number">28</span> <span class="hljs-number">17</span><br><span class="hljs-number">28</span> <span class="hljs-number">28</span> <span class="hljs-number">35</span> <span class="hljs-number">19</span><br></code></pre></div></td></tr></table></figure><h2 id="MPIç‰ˆæœ¬"><a href="#MPIç‰ˆæœ¬" class="headerlink" title="MPIç‰ˆæœ¬"></a>MPIç‰ˆæœ¬</h2><h3 id="ç¨‹åºè¿è¡Œå¹³å°"><a href="#ç¨‹åºè¿è¡Œå¹³å°" class="headerlink" title="ç¨‹åºè¿è¡Œå¹³å°"></a>ç¨‹åºè¿è¡Œå¹³å°</h3><p>åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒA3åˆ†åŒº</p><h3 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h3><p>mpi&#x2F;intel&#x2F;2017.5</p><h3 id="ç¼–è¯‘æŒ‡ä»¤"><a href="#ç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="ç¼–è¯‘æŒ‡ä»¤"></a>ç¼–è¯‘æŒ‡ä»¤</h3><p>mpicxx mpi006.c -o mpi006</p><h3 id="è¿è¡ŒæŒ‡ä»¤"><a href="#è¿è¡ŒæŒ‡ä»¤" class="headerlink" title="è¿è¡ŒæŒ‡ä»¤"></a>è¿è¡ŒæŒ‡ä»¤</h3><p>srun -p amd_256 -N 1 -n  5  .&#x2F;mpi006(ä½¿ç”¨SLURMä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ)</p><p>1ä¸ªåˆ†åŒºï¼Œæ ¸æ•°ä¸º5</p><h3 id="ç¨‹åºæºä»£ç -1"><a href="#ç¨‹åºæºä»£ç -1" class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;mpi.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc ,<span class="hljs-keyword">char</span> **argv)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> a[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<br><span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<br><span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<br><span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>&#125;;<br><span class="hljs-keyword">int</span> b[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<br><span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<br><span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">17</span>,<span class="hljs-number">5</span>,<br><span class="hljs-number">15</span>,<span class="hljs-number">14</span>,<span class="hljs-number">20</span>,<span class="hljs-number">3</span>&#125;;<br><span class="hljs-keyword">int</span> c[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>];<br><span class="hljs-keyword">int</span> tmp[<span class="hljs-number">4</span>];<br><span class="hljs-built_in">memset</span>(c,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(c));<br><span class="hljs-keyword">int</span> myid, numprocs;<br>MPI_Status status;<br>MPI_Request request;<br><span class="hljs-built_in">MPI_Init</span>(&amp;argc,&amp;argv);<br><span class="hljs-built_in">MPI_Comm_size</span>(MPI_COMM_WORLD,&amp;numprocs);<br><span class="hljs-built_in">MPI_Comm_rank</span>(MPI_COMM_WORLD,&amp;myid);<br><span class="hljs-keyword">if</span>(myid == <span class="hljs-number">0</span>)<span class="hljs-comment">//0å·è¿›ç¨‹æ¥å—æ¥è‡ªå…¶ä»–è¿›ç¨‹çš„æ¶ˆæ¯</span><br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;numprocs;i++)<br>&#123;<br><span class="hljs-built_in">MPI_Irecv</span>(&amp;c[i<span class="hljs-number">-1</span>][<span class="hljs-number">0</span>],<span class="hljs-number">4</span>,MPI_INT,i,<span class="hljs-number">0</span>,MPI_COMM_WORLD,&amp;request);<span class="hljs-comment">//é‡‡ç”¨éé˜»å¡æ¥å—</span><br><span class="hljs-built_in">MPI_Wait</span>(&amp;request,&amp;status);<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<span class="hljs-comment">//æ‰“å°çŸ©é˜µ</span><br>&#123;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,c[i][j]);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>(myid != <span class="hljs-number">0</span> )<span class="hljs-comment">//å½“è¿›ç¨‹ä¸æ˜¯0å·è¿›ç¨‹æ—¶ï¼Œåˆ™å‘0å·è¿›ç¨‹å‘é€æ¶ˆæ¯</span><br>&#123;<br><span class="hljs-built_in">memset</span>(tmp,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(tmp));<span class="hljs-comment">//åˆå§‹åŒ–tmpæ•°ç»„</span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>&#123;<br>tmp[i]=a[myid<span class="hljs-number">-1</span>][i]+b[myid<span class="hljs-number">-1</span>][i];<span class="hljs-comment">//ç”¨tmpæ¥ä¸´æ—¶å­˜å‚¨ç›¸åŠ ç»“æœï¼Œéšåå‘é€ç»™0å·è¿›ç¨‹</span><br><br>&#125;<br><span class="hljs-built_in">MPI_Isend</span>(&amp;tmp,<span class="hljs-number">4</span>,MPI_INT,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,MPI_COMM_WORLD,&amp;request);<span class="hljs-comment">//é‡‡ç”¨éé˜»å¡å‘é€</span><br><span class="hljs-built_in">MPI_Wait</span>(&amp;request,&amp;status);<br>&#125;<br><span class="hljs-built_in">MPI_Finalize</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡º-1"><a href="#ç¨‹åºè¾“å‡º-1" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">8</span> <span class="hljs-number">11</span> <br><span class="hljs-number">6</span> <span class="hljs-number">9</span> <span class="hljs-number">15</span> <span class="hljs-number">17</span> <br><span class="hljs-number">20</span> <span class="hljs-number">22</span> <span class="hljs-number">28</span> <span class="hljs-number">17</span> <br><span class="hljs-number">28</span> <span class="hljs-number">28</span> <span class="hljs-number">35</span> <span class="hljs-number">19</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜Ÿåˆ—</title>
    <link href="/2022/03/31/Algorithm010/"/>
    <url>/2022/03/31/Algorithm010/</url>
    
    <content type="html"><![CDATA[<h2 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h2><h3 id="é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨è§£æ„"><a href="#é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨è§£æ„" class="headerlink" title="é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨è§£æ„"></a>é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨è§£æ„</h3><h4 id="é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨"><a href="#é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨" class="headerlink" title="é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨"></a>é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨</h4><p>é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨ç±»å‹å¯æè¿°ä¸º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSize 50<span class="hljs-comment">//å®šä¹‰é˜Ÿåˆ—ä¸­å…ƒç´ çš„æœ€å¤§ä¸ªæ•°</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    ElemType data[MaxSize];<span class="hljs-comment">//å­˜æ”¾é˜Ÿåˆ—å…ƒç´ </span><br>    <span class="hljs-keyword">int</span> front,rear;<span class="hljs-comment">//é˜Ÿå¤´æŒ‡é’ˆå’Œé˜Ÿå°¾æŒ‡é’ˆ</span><br>&#125;SqQueue;<br></code></pre></div></td></tr></table></figure><h4 id="å¾ªç¯é˜Ÿåˆ—çš„æ“ä½œ"><a href="#å¾ªç¯é˜Ÿåˆ—çš„æ“ä½œ" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—çš„æ“ä½œ"></a>å¾ªç¯é˜Ÿåˆ—çš„æ“ä½œ</h4><p>(1)åˆå§‹åŒ–</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitQueue</span><span class="hljs-params">(SqQueue &amp;Q)</span></span>&#123;<br>    Q.rear=Q.front=<span class="hljs-number">0</span>;<span class="hljs-comment">//åˆå§‹åŒ–é˜Ÿé¦–ã€é˜Ÿå°¾æŒ‡é’ˆ</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>(2)åˆ¤é˜Ÿç©º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">(SqQueue Q)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.rear == Q.front) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//é˜Ÿç©ºæ¡ä»¶</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>(3)å…¥é˜Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">EnQueue</span><span class="hljs-params">(SqQueue &amp;Q,ElemType x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>((Q.rear+<span class="hljs-number">1</span>)%MaxSize==Q.front)    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//é˜Ÿæ»¡åˆ™æŠ¥é”™</span><br>    Q.data[Q.rear]=x;<br>    Q.rear=(Q.rear+<span class="hljs-number">1</span>)%MaxSize;<span class="hljs-comment">//é˜Ÿå°¾æŒ‡é’ˆåŠ 1å–æ¨¡</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>(4)å‡ºé˜Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">DeQueue</span><span class="hljs-params">(SqQueue &amp;Q,ElemType &amp;x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.rear == Q.front)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">//é˜Ÿåˆ—ç©ºåˆ™æŠ¥é”™</span><br>    x=Q.data[Q.front];<br>    Q.front=(Q.front+<span class="hljs-number">1</span>)%MaxSize;<span class="hljs-comment">//é˜Ÿå¤´æŒ‡é’ˆåŠ 1å–æ¨¡</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="å¾ªç¯é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ"><a href="#å¾ªç¯é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ"></a>å¾ªç¯é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ</h4><h5 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">int</span> ElemType;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSize 50<span class="hljs-comment">//å®šä¹‰é˜Ÿåˆ—ä¸­å…ƒç´ çš„æœ€å¤§ä¸ªæ•°</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    ElemType data[MaxSize];<span class="hljs-comment">//å­˜æ”¾é˜Ÿåˆ—å…ƒç´ </span><br>    <span class="hljs-keyword">int</span> front,rear;<span class="hljs-comment">//é˜Ÿå¤´æŒ‡é’ˆå’Œé˜Ÿå°¾æŒ‡é’ˆ</span><br>&#125;SqQueue;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitQueue</span><span class="hljs-params">(SqQueue &amp;Q)</span></span>&#123;<br>    Q.rear=Q.front=<span class="hljs-number">0</span>;<span class="hljs-comment">//åˆå§‹åŒ–é˜Ÿé¦–ã€é˜Ÿå°¾æŒ‡é’ˆ</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">(SqQueue Q)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.rear == Q.front) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//é˜Ÿç©ºæ¡ä»¶</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">EnQueue</span><span class="hljs-params">(SqQueue &amp;Q,ElemType x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>((Q.rear+<span class="hljs-number">1</span>)%MaxSize==Q.front)    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//é˜Ÿæ»¡åˆ™æŠ¥é”™</span><br>    Q.data[Q.rear]=x;<br>    Q.rear=(Q.rear+<span class="hljs-number">1</span>)%MaxSize;<span class="hljs-comment">//é˜Ÿå°¾æŒ‡é’ˆåŠ 1å–æ¨¡</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">DeQueue</span><span class="hljs-params">(SqQueue &amp;Q,ElemType &amp;x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.rear == Q.front)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">//é˜Ÿåˆ—ç©ºåˆ™æŠ¥é”™</span><br>    x=Q.data[Q.front];<br>    Q.front=(Q.front+<span class="hljs-number">1</span>)%MaxSize;<span class="hljs-comment">//é˜Ÿå¤´æŒ‡é’ˆåŠ 1å–æ¨¡</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintSqQueue</span><span class="hljs-params">(SqQueue Q)</span></span>&#123;<span class="hljs-comment">//éå†æ“ä½œ </span><br><span class="hljs-keyword">int</span> point = Q.front;<br><span class="hljs-keyword">while</span>(point!=Q.rear)<span class="hljs-comment">//å¦‚æœpointæŒ‡å‘Q.rearè¯´æ˜éå†ç»“æŸ </span><br>&#123;<span class="hljs-comment">//ä¹Ÿå°±æ˜¯pointæŒ‡å‘äº†é˜Ÿå°¾å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½® </span><br>cout&lt;&lt;Q.data[point]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>point=(point+<span class="hljs-number">1</span>)%MaxSize;<br>&#125;<br>cout&lt;&lt;endl;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>SqQueue Q;<span class="hljs-comment">//å£°æ˜äº†ä¸€ä¸ªé¡ºåºé˜Ÿåˆ— </span><br><span class="hljs-built_in">InitQueue</span>(Q);<span class="hljs-comment">//åˆå§‹åŒ–è¿™ä¸ªé˜Ÿåˆ— </span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">5</span>;i++)<br>&#123;<br><span class="hljs-built_in">EnQueue</span>(Q,i);<span class="hljs-comment">//å…¥é˜Ÿæ“ä½œ </span><br>&#125;<br><span class="hljs-built_in">PrintSqQueue</span>(Q);<span class="hljs-comment">//éå† </span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">5</span>;i++)<br>&#123;<br><span class="hljs-keyword">int</span> x;<br><span class="hljs-built_in">DeQueue</span>(Q,x);<span class="hljs-comment">//å‡ºé˜Ÿ </span><br>cout&lt;&lt;<span class="hljs-string">&quot;è¿™æ˜¯ç¬¬&quot;</span>&lt;&lt;i&lt;&lt;<span class="hljs-string">&quot;æ¬¡å‡ºé˜Ÿ&quot;</span>&lt;&lt;<span class="hljs-string">&quot;å‡ºé˜Ÿçš„å…ƒç´ æ˜¯&quot;</span> &lt;&lt;x&lt;&lt;endl;<br><span class="hljs-keyword">if</span>(!<span class="hljs-built_in">isEmpty</span>(Q))<span class="hljs-comment">//é˜Ÿåˆ—éç©ºåˆ™éå† </span><br>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;å½“å‰é˜Ÿåˆ—ä¸ºï¼š&quot;</span>;<br><span class="hljs-built_in">PrintSqQueue</span>(Q);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;æ­¤æ—¶çš„é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—&quot;</span>&lt;&lt;endl;<br>&#125;<br><br>&#125; <br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></div></td></tr></table></figure><h5 id="ç¨‹åºè¾“å‡ºï¼š"><a href="#ç¨‹åºè¾“å‡ºï¼š" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">1</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">0</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">2</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">1</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">3</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">2</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">3</span> <span class="hljs-number">4</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">4</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">3</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">4</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">5</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">4</span><br>æ­¤æ—¶çš„é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—<br></code></pre></div></td></tr></table></figure><h3 id="é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ç»“æ„"><a href="#é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ç»“æ„" class="headerlink" title="é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ç»“æ„"></a>é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ç»“æ„</h3><h4 id="é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨"><a href="#é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨" class="headerlink" title="é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨"></a>é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨</h4><p>é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ç±»å‹å¯æè¿°ä¸º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LinkNode</span>&#123;</span><span class="hljs-comment">//é“¾å¼é˜Ÿåˆ—ç»“ç‚¹</span><br>    ElemType data;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LinkNode</span> *<span class="hljs-title">next</span>;</span><br>&#125;LinkNode;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><span class="hljs-comment">//é“¾å¼é˜Ÿåˆ—</span><br>    LinkNode *front,*rear;<span class="hljs-comment">//é˜Ÿåˆ—çš„å¯¹å¤´å’Œé˜Ÿå°¾æŒ‡é’ˆ</span><br>&#125;LinkQueue;<br></code></pre></div></td></tr></table></figure><h4 id="é“¾å¼é˜Ÿåˆ—çš„åŸºæœ¬æ“ä½œ"><a href="#é“¾å¼é˜Ÿåˆ—çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="é“¾å¼é˜Ÿåˆ—çš„åŸºæœ¬æ“ä½œ"></a>é“¾å¼é˜Ÿåˆ—çš„åŸºæœ¬æ“ä½œ</h4><p>(1)åˆå§‹åŒ–</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitQueue</span><span class="hljs-params">(LinkQueue &amp;Q)</span></span>&#123;<br>    Q.front = Q.rear=(LinkNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LinkNode));<span class="hljs-comment">//å»ºç«‹å¤´ç»“ç‚¹</span><br>    Q.front-&gt;next=<span class="hljs-literal">NULL</span>;<span class="hljs-comment">//åˆå§‹ä¸ºç©º</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>(2åˆ¤é˜Ÿç©º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsEmpty</span><span class="hljs-params">(LinkQueue Q)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.front==Q.rear)<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>(3)å…¥é˜Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">EnQueue</span><span class="hljs-params">(LinkQueue &amp;Q,ElemType x)</span></span>&#123;<br>    LinkNode *s =(LinkNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LinkNode));<br>    s-&gt;data=x;<span class="hljs-comment">//åˆ›å»ºæ–°ç»“ç‚¹ï¼Œæ’å…¥åˆ°é“¾å°¾</span><br>    s-&gt;next=<span class="hljs-literal">NULL</span>;<br>    Q.rear-&gt;next=s;<br>    Q.rear=s;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>(4)å‡ºé˜Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">DeQueue</span><span class="hljs-params">(LinkQueue &amp;Q,ElemType &amp;x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.front == Q.rear)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//ç©ºé˜Ÿ</span><br>    LinkNode *p =Q.front-&gt;next;<br>    x=p-&gt;data;<br>    Q.front-&gt;next=p-&gt;next;<br>    <span class="hljs-keyword">if</span>(Q.rear==p)&#123;<br>        Q.rear = Q.front;<span class="hljs-comment">//è‹¥åŸé˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œåˆ é™¤åå˜ç©º</span><br>    &#125;<br>    <span class="hljs-built_in">free</span>(p);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="é“¾å¼é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ"><a href="#é“¾å¼é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ" class="headerlink" title="é“¾å¼é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ"></a>é“¾å¼é˜Ÿåˆ—çš„å®Œæ•´æ“ä½œ</h4><h5 id="ç¨‹åºæºä»£ç ï¼š-1"><a href="#ç¨‹åºæºä»£ç ï¼š-1" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std; <br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LinkNode</span>&#123;</span><span class="hljs-comment">//é“¾å¼é˜Ÿåˆ—ç»“ç‚¹</span><br>    <span class="hljs-keyword">int</span> data;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LinkNode</span> *<span class="hljs-title">next</span>;</span><br>&#125;LinkNode;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><span class="hljs-comment">//é“¾å¼é˜Ÿåˆ—</span><br>    LinkNode *front,*rear;<span class="hljs-comment">//é˜Ÿåˆ—çš„å¯¹å¤´å’Œé˜Ÿå°¾æŒ‡é’ˆ</span><br>&#125;LinkQueue;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitQueue</span><span class="hljs-params">(LinkQueue &amp;Q)</span></span>&#123;<br>    Q.front = Q.rear=(LinkNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LinkNode));<span class="hljs-comment">//å»ºç«‹å¤´ç»“ç‚¹</span><br>    Q.front-&gt;next=<span class="hljs-literal">NULL</span>;<span class="hljs-comment">//åˆå§‹ä¸ºç©º</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsEmpty</span><span class="hljs-params">(LinkQueue Q)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.front==Q.rear)<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">EnQueue</span><span class="hljs-params">(LinkQueue &amp;Q,<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    LinkNode *s =(LinkNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LinkNode));<br>    s-&gt;data=x;<span class="hljs-comment">//åˆ›å»ºæ–°ç»“ç‚¹ï¼Œæ’å…¥åˆ°é“¾å°¾</span><br>    s-&gt;next=<span class="hljs-literal">NULL</span>;<br>    Q.rear-&gt;next=s;<br>    Q.rear=s;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">DeQueue</span><span class="hljs-params">(LinkQueue &amp;Q,<span class="hljs-keyword">int</span> &amp;x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(Q.front == Q.rear)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//ç©ºé˜Ÿ</span><br>    LinkNode *p =Q.front-&gt;next;<br>    x=p-&gt;data;<br>    Q.front-&gt;next=p-&gt;next;<br>    <span class="hljs-keyword">if</span>(Q.rear==p)&#123;<br>        Q.rear = Q.front;<span class="hljs-comment">//è‹¥åŸé˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œåˆ é™¤åå˜ç©º</span><br>    &#125;<br>    <span class="hljs-built_in">free</span>(p);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintQueue</span><span class="hljs-params">(LinkQueue Q)</span><span class="hljs-comment">//éå†é˜Ÿåˆ— </span></span><br><span class="hljs-function"></span>&#123;<br>LinkNode *tmp=Q.front-&gt;next;<span class="hljs-comment">//å£°æ˜ä¸€ä¸ªç»“ç‚¹ç”¨äºéå†</span><br><span class="hljs-keyword">while</span>(tmp!=<span class="hljs-literal">NULL</span>)<span class="hljs-comment">//å¦‚æœè¿™ä¸ªç»“ç‚¹ä¸ºç©ºåˆ™åœæ­¢éå†</span><br>&#123;<span class="hljs-comment">//è¿™é‡Œå³tmpå·²ç»æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„-&gt;next</span><br>cout&lt;&lt;tmp-&gt;data&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<span class="hljs-comment">//å› ä¸ºåœ¨åˆå§‹åŒ–æ—¶å·²ç»ç½®æœ€åä¸€ä¸ªå…ƒç´ çš„-&gt;next=NULL</span><br>tmp=tmp-&gt;next;<span class="hljs-comment">//æ‰€ä»¥è¯´è¿™é‡Œåªéœ€è¦åˆ¤æ–­tmpä¸ºç©ºå³å¯</span><br>&#125;<br>cout&lt;&lt;endl;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>LinkQueue Q;<span class="hljs-comment">//å£°æ˜é“¾å¼ä¸€ä¸ªé˜Ÿåˆ— </span><br><span class="hljs-built_in">InitQueue</span>(Q);<span class="hljs-comment">//åˆå§‹åŒ–é˜Ÿåˆ— </span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">5</span>;i&gt;<span class="hljs-number">0</span>;i--)     <span class="hljs-comment">//åˆ›å»ºé˜Ÿåˆ— </span><br>&#123;<br><span class="hljs-built_in">EnQueue</span>(Q,i);<br>&#125;<br><span class="hljs-built_in">PrintQueue</span>(Q);      <span class="hljs-comment">//éå† </span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">5</span>;i++)<br>&#123;<br><span class="hljs-keyword">int</span> x;<br><span class="hljs-built_in">DeQueue</span>(Q,x);<span class="hljs-comment">//å‡ºé˜Ÿ </span><br>cout&lt;&lt;<span class="hljs-string">&quot;è¿™æ˜¯ç¬¬&quot;</span>&lt;&lt;i&lt;&lt;<span class="hljs-string">&quot;æ¬¡å‡ºé˜Ÿ&quot;</span>&lt;&lt;<span class="hljs-string">&quot;å‡ºé˜Ÿçš„å…ƒç´ æ˜¯&quot;</span> &lt;&lt;x&lt;&lt;endl;<br><span class="hljs-keyword">if</span>(!<span class="hljs-built_in">IsEmpty</span>(Q))<span class="hljs-comment">//é˜Ÿåˆ—éç©ºåˆ™éå† </span><br>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;å½“å‰é˜Ÿåˆ—ä¸ºï¼š&quot;</span>;<br><span class="hljs-built_in">PrintQueue</span>(Q);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;æ­¤æ—¶çš„é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—&quot;</span>&lt;&lt;endl;<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="ç¨‹åºè¾“å‡ºï¼š-1"><a href="#ç¨‹åºè¾“å‡ºï¼š-1" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">1</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">5</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">2</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">4</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">3</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">3</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">4</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">2</span><br>å½“å‰é˜Ÿåˆ—ä¸ºï¼š<span class="hljs-number">1</span><br>è¿™æ˜¯ç¬¬<span class="hljs-number">5</span>æ¬¡å‡ºé˜Ÿå‡ºé˜Ÿçš„å…ƒç´ æ˜¯<span class="hljs-number">1</span><br>æ­¤æ—¶çš„é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ˆ</title>
    <link href="/2022/03/30/Algorithm009/"/>
    <url>/2022/03/30/Algorithm009/</url>
    
    <content type="html"><![CDATA[<h2 id="æ ˆçš„é¡ºåºå­˜å‚¨ç»“æ„"><a href="#æ ˆçš„é¡ºåºå­˜å‚¨ç»“æ„" class="headerlink" title="æ ˆçš„é¡ºåºå­˜å‚¨ç»“æ„"></a>æ ˆçš„é¡ºåºå­˜å‚¨ç»“æ„</h2><h3 id="é¡ºåºæ ˆçš„å®ç°"><a href="#é¡ºåºæ ˆçš„å®ç°" class="headerlink" title="é¡ºåºæ ˆçš„å®ç°"></a>é¡ºåºæ ˆçš„å®ç°</h3><p>æ ˆçš„é¡ºåºå­˜å‚¨ç±»å‹å¯æè¿°ä¸ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSize 50<span class="hljs-comment">//å®šä¹‰æ ˆä¸­å…ƒç´ çš„æœ€å¤§ä¸ªæ•°</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    ElemType data[MaxSize];<span class="hljs-comment">//å­˜æ”¾æ ˆä¸­å…ƒç´ </span><br>    <span class="hljs-keyword">int</span> top;<span class="hljs-comment">//æ ˆé¡¶æŒ‡é’ˆ</span><br>&#125;SqStack;<br></code></pre></div></td></tr></table></figure><h3 id="é¡ºåºæ ˆçš„åŸºæœ¬è¿ç®—"><a href="#é¡ºåºæ ˆçš„åŸºæœ¬è¿ç®—" class="headerlink" title="é¡ºåºæ ˆçš„åŸºæœ¬è¿ç®—"></a>é¡ºåºæ ˆçš„åŸºæœ¬è¿ç®—</h3><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitStack</span><span class="hljs-params">(SqStack &amp;s)</span></span>&#123;<br>    s.top=<span class="hljs-number">-1</span>;<span class="hljs-comment">//åˆå§‹åŒ–æ ˆé¡¶æŒ‡é’ˆ</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="åˆ¤æ ˆç©º"><a href="#åˆ¤æ ˆç©º" class="headerlink" title="åˆ¤æ ˆç©º"></a>åˆ¤æ ˆç©º</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">StackEmpty</span><span class="hljs-params">(SqStack S)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == <span class="hljs-number">-1</span>)<span class="hljs-comment">//æ ˆç©º</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">else</span><span class="hljs-comment">//ä¸ç©º</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;      <br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="è¿›æ ˆ"><a href="#è¿›æ ˆ" class="headerlink" title="è¿›æ ˆ"></a>è¿›æ ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Push</span><span class="hljs-params">(SqStack &amp;s,ElemType x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == MaxSize<span class="hljs-number">-1</span>)<span class="hljs-comment">//æ ˆæ»¡ï¼ŒæŠ¥é”™</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    s.data[++s.top]=x;<span class="hljs-comment">//æŒ‡é’ˆå…ˆåŠ 1ï¼Œåœ¨å…¥æ ˆ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="å‡ºæ ˆ"><a href="#å‡ºæ ˆ" class="headerlink" title="å‡ºæ ˆ"></a>å‡ºæ ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Pop</span><span class="hljs-params">(SqStack &amp;s,ElemType &amp;x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == <span class="hljs-number">-1</span>)<span class="hljs-comment">//æ ˆç©ºï¼ŒæŠ¥é”™</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    x=s.data[s.top--];<span class="hljs-comment">//å…ˆå‡ºæ ˆï¼ŒæŒ‡é’ˆå†å‡1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="è¯»æ ˆé¡¶å…ƒç´ "><a href="#è¯»æ ˆé¡¶å…ƒç´ " class="headerlink" title="è¯»æ ˆé¡¶å…ƒç´ "></a>è¯»æ ˆé¡¶å…ƒç´ </h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">GetTop</span><span class="hljs-params">(SqStack s,ElemType &amp;x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == <span class="hljs-number">-1</span> )<span class="hljs-comment">//æ ˆç©ºï¼ŒæŠ¥é”™</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>   x=s.data[s.top];<span class="hljs-comment">//xè®°å½•æ ˆé¡¶å…ƒç´ </span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="é¡ºåºæ ˆçš„å®Œæ•´æ“ä½œ"><a href="#é¡ºåºæ ˆçš„å®Œæ•´æ“ä½œ" class="headerlink" title="é¡ºåºæ ˆçš„å®Œæ•´æ“ä½œ"></a>é¡ºåºæ ˆçš„å®Œæ•´æ“ä½œ</h3><h4 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std; <br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">int</span> ElemType;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSize 50<span class="hljs-comment">//å®šä¹‰æ ˆä¸­å…ƒç´ çš„æœ€å¤§ä¸ªæ•°</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><br>    ElemType data[MaxSize];<span class="hljs-comment">//å­˜æ”¾æ ˆä¸­å…ƒç´ </span><br>    <span class="hljs-keyword">int</span> top;<span class="hljs-comment">//æ ˆé¡¶æŒ‡é’ˆ</span><br>&#125;SqStack;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InitStack</span><span class="hljs-params">(SqStack &amp;s)</span></span>&#123;<br>    s.top=<span class="hljs-number">-1</span>;<span class="hljs-comment">//åˆå§‹åŒ–æ ˆé¡¶æŒ‡é’ˆ</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">StackEmpty</span><span class="hljs-params">(SqStack S)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(S.top == <span class="hljs-number">-1</span>)<span class="hljs-comment">//æ ˆç©º</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">else</span><span class="hljs-comment">//ä¸ç©º</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;      <br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Push</span><span class="hljs-params">(SqStack &amp;s,ElemType x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == MaxSize<span class="hljs-number">-1</span>)<span class="hljs-comment">//æ ˆæ»¡ï¼ŒæŠ¥é”™</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    s.data[++s.top]=x;<span class="hljs-comment">//æŒ‡é’ˆå…ˆåŠ 1ï¼Œåœ¨å…¥æ ˆ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Pop</span><span class="hljs-params">(SqStack &amp;s,ElemType &amp;x)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == <span class="hljs-number">-1</span>)<span class="hljs-comment">//æ ˆç©ºï¼ŒæŠ¥é”™</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    x=s.data[s.top--];<span class="hljs-comment">//å…ˆå‡ºæ ˆï¼ŒæŒ‡é’ˆå†å‡1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">GetTop</span><span class="hljs-params">(SqStack s,ElemType &amp;x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(s.top == <span class="hljs-number">-1</span> )<span class="hljs-comment">//æ ˆç©ºï¼ŒæŠ¥é”™</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>   x=s.data[s.top];<span class="hljs-comment">//xè®°å½•æ ˆé¡¶å…ƒç´ </span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintSqStack</span><span class="hljs-params">(SqStack s)</span><span class="hljs-comment">//éå†æ ˆ </span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> tmp = s.top;<br><span class="hljs-keyword">while</span>(tmp!=<span class="hljs-number">-1</span>)<span class="hljs-comment">//å¦‚æœtmp==-1è¯´æ˜éå†ç»“æŸ </span><br>&#123; <br>cout&lt;&lt;s.data[tmp--]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br>cout&lt;&lt;endl; <br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>SqStack s;<span class="hljs-comment">//å£°æ˜ä¸€ä¸ªé¡ºåºæ ˆ </span><br><span class="hljs-built_in">InitStack</span>(s);<span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ªé¡ºåºæ ˆ </span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">5</span>;i++)<br>&#123;<br><span class="hljs-built_in">Push</span>(s,i);<span class="hljs-comment">//å…¥æ ˆ </span><br>&#125;<br><span class="hljs-built_in">PrintSqStack</span>(s);<span class="hljs-comment">//éå† </span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">5</span>;i++)&#123;<span class="hljs-comment">//ä¸ºäº†å¯¹æ¯”GetTopå’ŒPopæ“ä½œ </span><br><span class="hljs-keyword">int</span> x; <br><span class="hljs-built_in">GetTop</span>(s,x);<span class="hljs-comment">//å–æ ˆé¡¶å…ƒç´  </span><br>cout&lt;&lt;<span class="hljs-string">&quot;è¿™æ˜¯GetTopæ“ä½œ,æ ˆé¡¶å…ƒç´ ä¸º&quot;</span>&lt;&lt;x&lt;&lt;endl;<br>cout&lt;&lt;<span class="hljs-string">&quot;è¿™æ˜¯GetTopæ“ä½œåçš„æ ˆéå†:&quot;</span>;<br><span class="hljs-built_in">PrintSqStack</span>(s); <br><span class="hljs-built_in">Pop</span>(s,x);<span class="hljs-comment">//å‡ºæ ˆ </span><br>cout&lt;&lt;<span class="hljs-string">&quot;è¿™æ˜¯Popæ“ä½œ,å‡ºæ ˆçš„å…ƒç´ ä¸º&quot;</span>&lt;&lt;x&lt;&lt;endl;<br><span class="hljs-keyword">if</span>(!<span class="hljs-built_in">StackEmpty</span>(s))<br>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;è¿™æ˜¯Popæ“ä½œåçš„æ ˆéå†:&quot;</span>;<br><span class="hljs-built_in">PrintSqStack</span>(s); <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;æ­¤æ—¶æ ˆç©ºï¼&quot;</span>&lt;&lt;endl;<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºè¾“å‡ºï¼š"><a href="#ç¨‹åºè¾“å‡ºï¼š" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯GetTopæ“ä½œ,æ ˆé¡¶å…ƒç´ ä¸º<span class="hljs-number">5</span><br>è¿™æ˜¯GetTopæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯Popæ“ä½œ,å‡ºæ ˆçš„å…ƒç´ ä¸º<span class="hljs-number">5</span><br>è¿™æ˜¯Popæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯GetTopæ“ä½œ,æ ˆé¡¶å…ƒç´ ä¸º<span class="hljs-number">4</span><br>è¿™æ˜¯GetTopæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯Popæ“ä½œ,å‡ºæ ˆçš„å…ƒç´ ä¸º<span class="hljs-number">4</span><br>è¿™æ˜¯Popæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯GetTopæ“ä½œ,æ ˆé¡¶å…ƒç´ ä¸º<span class="hljs-number">3</span><br>è¿™æ˜¯GetTopæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯Popæ“ä½œ,å‡ºæ ˆçš„å…ƒç´ ä¸º<span class="hljs-number">3</span><br>è¿™æ˜¯Popæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯GetTopæ“ä½œ,æ ˆé¡¶å…ƒç´ ä¸º<span class="hljs-number">2</span><br>è¿™æ˜¯GetTopæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">2</span> <span class="hljs-number">1</span><br>è¿™æ˜¯Popæ“ä½œ,å‡ºæ ˆçš„å…ƒç´ ä¸º<span class="hljs-number">2</span><br>è¿™æ˜¯Popæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">1</span><br>è¿™æ˜¯GetTopæ“ä½œ,æ ˆé¡¶å…ƒç´ ä¸º<span class="hljs-number">1</span><br>è¿™æ˜¯GetTopæ“ä½œåçš„æ ˆéå†:<span class="hljs-number">1</span><br>è¿™æ˜¯Popæ“ä½œ,å‡ºæ ˆçš„å…ƒç´ ä¸º<span class="hljs-number">1</span><br>æ­¤æ—¶æ ˆç©ºï¼<br></code></pre></div></td></tr></table></figure><h3 id="æ ˆçš„é“¾å¼å­˜å‚¨ç»“æ„"><a href="#æ ˆçš„é“¾å¼å­˜å‚¨ç»“æ„" class="headerlink" title="æ ˆçš„é“¾å¼å­˜å‚¨ç»“æ„"></a>æ ˆçš„é“¾å¼å­˜å‚¨ç»“æ„</h3><p>æ ˆçš„é“¾å¼å­˜å‚¨ç±»å‹å¯æè¿°ä¸º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Linknode</span>&#123;</span><br>    ElemType data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Linknode</span> *<span class="hljs-title">next</span>;</span><span class="hljs-comment">//æŒ‡é’ˆåŸŸ</span><br>&#125;*Linknode;<span class="hljs-comment">//æ ˆç±»å‹æ“ä½œ</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŒé“¾è¡¨ä¸é™æ€é“¾è¡¨</title>
    <link href="/2022/03/29/Algorithm008/"/>
    <url>/2022/03/29/Algorithm008/</url>
    
    <content type="html"><![CDATA[<h2 id="åŒé“¾è¡¨"><a href="#åŒé“¾è¡¨" class="headerlink" title="åŒé“¾è¡¨"></a>åŒé“¾è¡¨</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>åŒé“¾è¡¨ä¸­ç»“ç‚¹ç±»å‹çš„æè¿°å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">DNode</span>&#123;</span><span class="hljs-comment">//å®šä¹‰åŒé“¾è¡¨ç»“ç‚¹ç±»å‹</span><br>    ElemType data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">DNode</span> *<span class="hljs-title">prior</span>,*<span class="hljs-title">next</span>;</span><span class="hljs-comment">//å‰é©±å’Œåç»§æŒ‡é’ˆ</span><br>&#125;DNode,*DLinkList;<br></code></pre></div></td></tr></table></figure><h3 id="åŒé“¾è¡¨çš„æ’å…¥æ“ä½œ"><a href="#åŒé“¾è¡¨çš„æ’å…¥æ“ä½œ" class="headerlink" title="åŒé“¾è¡¨çš„æ’å…¥æ“ä½œ"></a>åŒé“¾è¡¨çš„æ’å…¥æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//pæ‰€æŒ‡ç»“ç‚¹æ˜¯sæ‰€æŒ‡ç»“ç‚¹çš„å‰é©±ç»“ç‚¹</span><br>s-&gt;next=p-&gt;next;           <span class="hljs-comment">//å°†ç»“ç‚¹*sæ’å…¥åˆ°ç»“ç‚¹*pä¹‹å</span><br>p-&gt;next-&gt;prior=s;<br>s-&gt;prior=p;<br>p-&gt;next=s;<br></code></pre></div></td></tr></table></figure><h3 id="åŒé“¾è¡¨çš„åˆ é™¤æ“ä½œ"><a href="#åŒé“¾è¡¨çš„åˆ é™¤æ“ä½œ" class="headerlink" title="åŒé“¾è¡¨çš„åˆ é™¤æ“ä½œ"></a>åŒé“¾è¡¨çš„åˆ é™¤æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//åˆ é™¤åŒé“¾è¡¨ä¸­ç»“ç‚¹*pçš„åç»§ç»“ç‚¹*q</span><br>p-&gt;next=q-&gt;next;<br>q-&gt;next-&gt;prior=p;<br><span class="hljs-built_in">free</span>(q);<span class="hljs-comment">//é‡Šæ”¾èŠ‚ç‚¹ç©ºé—´</span><br></code></pre></div></td></tr></table></figure><h2 id="é™æ€é“¾è¡¨"><a href="#é™æ€é“¾è¡¨" class="headerlink" title="é™æ€é“¾è¡¨"></a>é™æ€é“¾è¡¨</h2><h3 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>é™æ€é“¾è¡¨ç»“æ„ç±»å‹çš„æè¿°å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSize 50<span class="hljs-comment">//é™æ€é“¾è¡¨çš„æœ€å¤§é•¿åº¦</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>&#123;</span><span class="hljs-comment">//é™æ€é“¾è¡¨ç»“æ„ç±»å‹çš„å®šä¹‰</span><br>    ElemType data;<span class="hljs-comment">//å‚¨å­˜æ•°æ®å…ƒç´ </span><br>    <span class="hljs-keyword">int</span> next;<span class="hljs-comment">//ä¸‹ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ä¸‹æ ‡</span><br>&#125;SLinkList[MaxSize];<br></code></pre></div></td></tr></table></figure><h3 id="å¯¹é™æ€é“¾è¡¨ç»“æ„ç±»å‹çš„å®šä¹‰çš„ç†è§£ä¸çŒœæƒ³éªŒè¯"><a href="#å¯¹é™æ€é“¾è¡¨ç»“æ„ç±»å‹çš„å®šä¹‰çš„ç†è§£ä¸çŒœæƒ³éªŒè¯" class="headerlink" title="å¯¹é™æ€é“¾è¡¨ç»“æ„ç±»å‹çš„å®šä¹‰çš„ç†è§£ä¸çŒœæƒ³éªŒè¯"></a>å¯¹é™æ€é“¾è¡¨ç»“æ„ç±»å‹çš„å®šä¹‰çš„ç†è§£ä¸çŒœæƒ³éªŒè¯</h3><p><img src="/2022/03/29/Algorithm008/%E9%9D%99%E6%80%81%E9%93%BE%E8%A1%A8-16485415016461.png" alt="é™æ€é“¾è¡¨"></p><p><img src="/2022/03/29/Algorithm008/123-16485415073922.png" alt="123"></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å•é“¾è¡¨ä¸Šçš„åŸºæœ¬æ“ä½œ</title>
    <link href="/2022/03/28/Algorithm007/"/>
    <url>/2022/03/28/Algorithm007/</url>
    
    <content type="html"><![CDATA[<h2 id="å•é“¾è¡¨çš„å®šä¹‰"><a href="#å•é“¾è¡¨çš„å®šä¹‰" class="headerlink" title="å•é“¾è¡¨çš„å®šä¹‰"></a>å•é“¾è¡¨çš„å®šä¹‰</h2><p>å•é“¾è¡¨ä¸­ç»“ç‚¹ç±»å‹çš„æè¿°å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span>&#123;</span><span class="hljs-comment">//å®šä¹‰å•é“¾è¡¨ç»“ç‚¹ç±»å‹</span><br>    ElemType data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span> *<span class="hljs-title">next</span>;</span><span class="hljs-comment">//æŒ‡é’ˆåŸŸ</span><br>&#125;LNode,*LinkList;<br></code></pre></div></td></tr></table></figure><h2 id="å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®ç°"><a href="#å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®ç°" class="headerlink" title="å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®ç°"></a>å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®ç°</h2><h3 id="1-é‡‡ç”¨å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨"><a href="#1-é‡‡ç”¨å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨" class="headerlink" title="1.é‡‡ç”¨å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨"></a>1.é‡‡ç”¨å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">LinkList <span class="hljs-title">List_HeadInsert</span><span class="hljs-params">(LinkList &amp;L)</span></span>&#123;<span class="hljs-comment">//é€†å‘å»ºç«‹å•é“¾è¡¨</span><br>    LNode *s;<br>    <span class="hljs-keyword">int</span> x;<br>    L=(LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<span class="hljs-comment">//åˆ›å»ºå¤´ç»“ç‚¹</span><br>    L-&gt;next = <span class="hljs-literal">NULL</span>;<span class="hljs-comment">//åˆå§‹åŒ–ä¸ºç©ºé“¾è¡¨</span><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<span class="hljs-comment">//è¾“å…¥ç»“ç‚¹çš„å€¼</span><br>    <span class="hljs-keyword">while</span>(x!=<span class="hljs-number">9999</span>)&#123;<span class="hljs-comment">//è¾“å…¥9999è¡¨ç¤ºç»“æŸ</span><br>        s = (LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<span class="hljs-comment">//å»ºç«‹æ–°ç»“ç‚¹</span><br>        s-&gt;data = x;<br>        s-&gt;next = L-&gt;next;<br>        L-&gt;next = s;<span class="hljs-comment">//å°†æ–°ç»“ç‚¹æ’å…¥è¡¨ä¸­ï¼ŒLä¸ºå¤´æŒ‡é’ˆ</span><br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<br>    &#125;<br>    <span class="hljs-keyword">return</span> L;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="2-é‡‡ç”¨å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨"><a href="#2-é‡‡ç”¨å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨" class="headerlink" title="2.é‡‡ç”¨å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨"></a>2.é‡‡ç”¨å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">LinkList <span class="hljs-title">List_TailInsert</span><span class="hljs-params">(LinkList &amp;L)</span></span>&#123;<span class="hljs-comment">//æ­£å‘å»ºç«‹å•é“¾è¡¨</span><br>    <span class="hljs-keyword">int</span> x;<span class="hljs-comment">//è®¾ç½®å…ƒç´ ç±»å‹ä¸ºæ•´å‹</span><br>    L=(LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<br>    LNode *s,*r=L;<span class="hljs-comment">//rä¸ºè¡¨å°¾æŒ‡é’ˆ</span><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<br>    <span class="hljs-keyword">while</span>(x!=<span class="hljs-number">9999</span>)&#123;<br>        s = (LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<br>        s-&gt;data=x;<br>        r-&gt;next = s;<br>        r = s;<span class="hljs-comment">//ræŒ‡å‘æ–°çš„è¡¨å°¾ç»“ç‚¹</span><br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<br>        <br>    &#125;<br>    r-&gt;next = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-keyword">return</span> L;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="3-æŒ‰åºå·æŸ¥æ‰¾ç»“ç‚¹å€¼"><a href="#3-æŒ‰åºå·æŸ¥æ‰¾ç»“ç‚¹å€¼" class="headerlink" title="3.æŒ‰åºå·æŸ¥æ‰¾ç»“ç‚¹å€¼"></a>3.æŒ‰åºå·æŸ¥æ‰¾ç»“ç‚¹å€¼</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">LNode *<span class="hljs-title">GetElem</span><span class="hljs-params">(LinkList L,<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>;<span class="hljs-comment">//è®¡æ•°ï¼Œåˆå§‹ä¸º1</span><br>    LNode *p = L-&gt;next;<span class="hljs-comment">//ç¬¬1ä¸ªç»“ç‚¹æŒ‡é’ˆèµ‹ç»™p</span><br>    <span class="hljs-keyword">if</span>(i==<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> L;<span class="hljs-comment">//è‹¥iç­‰äº0ï¼Œåˆ™è¿”å›å¤´ç»“ç‚¹</span><br>    <span class="hljs-keyword">if</span>(i&lt;<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<span class="hljs-comment">//è‹¥iæ— æ•ˆï¼Œåˆ™è¿”å›NULL</span><br>    <span class="hljs-keyword">while</span>(p&amp;&amp;j&lt;i)<span class="hljs-comment">//ä»ç¬¬ä¸€ä¸ªç»“ç‚¹å¼€å§‹æ‰¾ï¼ŒæŸ¥æ‰¾ç¬¬iä¸ªç»“ç‚¹</span><br>    &#123;<br>        p=p-&gt;next;<br>        j++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<span class="hljs-comment">//è¿”å›ç¬¬iä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œè‹¥iå¤§äºè¡¨é•¿ï¼Œåˆ™è¿”å›NULL</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="4-æŒ‰å€¼æŸ¥æ‰¾è¡¨ç»“ç‚¹"><a href="#4-æŒ‰å€¼æŸ¥æ‰¾è¡¨ç»“ç‚¹" class="headerlink" title="4.æŒ‰å€¼æŸ¥æ‰¾è¡¨ç»“ç‚¹"></a>4.æŒ‰å€¼æŸ¥æ‰¾è¡¨ç»“ç‚¹</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">LNode *<span class="hljs-title">LocateElem</span><span class="hljs-params">(LinkList L,ElemType e)</span></span>&#123;<br>    LNode *p = L-&gt;next;<br>    <span class="hljs-keyword">while</span>(p!=<span class="hljs-literal">NULL</span>&amp;&amp;p-&gt;data!=e)<span class="hljs-comment">//ä»ç¬¬iä¸ªç»“ç‚¹å¼€å§‹æŸ¥æ‰¾dataåŸŸä¸ºeçš„ç»“ç‚¹</span><br>    &#123;<br>        p=p-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<span class="hljs-comment">//æ‰¾åˆ°åè¿”å›è¯¥ç»“ç‚¹æŒ‡é’ˆï¼Œå¦åˆ™è¿”å›NULL</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="5-æ’å…¥ç»“ç‚¹æ“ä½œ"><a href="#5-æ’å…¥ç»“ç‚¹æ“ä½œ" class="headerlink" title="5.æ’å…¥ç»“ç‚¹æ“ä½œ"></a>5.æ’å…¥ç»“ç‚¹æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//pæ‰€æŒ‡ç»“ç‚¹æ˜¯sæ‰€æŒ‡ç»“ç‚¹çš„å‰é©±ç»“ç‚¹</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Insert</span><span class="hljs-params">(LinkList &amp;L,<span class="hljs-keyword">int</span> i,<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>LNode *p;<br>LNode *s=(LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<span class="hljs-comment">//ä¸€å®šè¦åˆ†é…ç©ºé—´ï¼ï¼ï¼ï¼ï¼</span><br>s-&gt;data=x;<br>s-&gt;next=<span class="hljs-literal">NULL</span>; <br>p=<span class="hljs-built_in">GetElem</span>(L,i<span class="hljs-number">-1</span>);<br><span class="hljs-keyword">if</span>(p!=<span class="hljs-literal">NULL</span>)&#123;<br>s-&gt;next =p-&gt;next;<br>p-&gt;next=s;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;æ’å…¥å€¼éæ³•&quot;</span>&lt;&lt;endl;<br><span class="hljs-keyword">return</span> ; <br>&#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯¹æŸä¸€ç»“ç‚¹è¿›è¡Œå‰æ’æ“ä½œ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//æ³¨æ„ä¸æ’å…¥ç»“ç‚¹ç›¸å¯¹æ¯”!!!!!!!!</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Delect</span><span class="hljs-params">(LinkList &amp;L,<span class="hljs-keyword">int</span> i)</span></span>&#123;<br><span class="hljs-comment">//pæ‰€æŒ‡ç»“ç‚¹æ˜¯qæ‰€æŒ‡ç»“ç‚¹çš„å‰é©±ç»“ç‚¹</span><br>LNode *p;<br>LNode *q=(LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));   <span class="hljs-comment">//ç”³è¯·ç©ºé—´ </span><br>p=<span class="hljs-built_in">GetElem</span>(L,i<span class="hljs-number">-1</span>);    <span class="hljs-comment">//æŸ¥æ‰¾åˆ é™¤ä½ç½®çš„å‰é©±ç»“ç‚¹</span><br><span class="hljs-keyword">if</span>(p==<span class="hljs-literal">NULL</span>||p-&gt;next==<span class="hljs-literal">NULL</span>)          <span class="hljs-comment">//p==NULLæ˜¯iå€¼ä¸åˆæ³•çš„æƒ…å†µ </span><br>&#123;    <span class="hljs-comment">//p-&gt;next==NUllæ˜¯i-1å·ç»“ç‚¹åå·²æ— å…¶ä»–ç»“ç‚¹ </span><br>cout&lt;&lt;<span class="hljs-string">&quot;åˆ é™¤å€¼éæ³•&quot;</span>&lt;&lt;endl;<br><span class="hljs-built_in">free</span>(q);<br><span class="hljs-keyword">return</span> ;<br>&#125;<br>q=p-&gt;next;<span class="hljs-comment">//ä»¤qæŒ‡å‘è¢«åˆ é™¤çš„ç»“ç‚¹</span><br>p-&gt;next=q-&gt;next;<span class="hljs-comment">//å°†*qç»“ç‚¹ä»é“¾ä¸­â€œæ–­å¼€â€</span><br><span class="hljs-built_in">free</span>(q);<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="6-åˆ é™¤ç»“ç‚¹æ“ä½œ"><a href="#6-åˆ é™¤ç»“ç‚¹æ“ä½œ" class="headerlink" title="6.åˆ é™¤ç»“ç‚¹æ“ä½œ"></a>6.åˆ é™¤ç»“ç‚¹æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//pæ‰€æŒ‡ç»“ç‚¹æ˜¯qæ‰€æŒ‡ç»“ç‚¹çš„å‰é©±ç»“ç‚¹</span><br>p=<span class="hljs-built_in">GetElem</span>(L,i<span class="hljs-number">-1</span>)<span class="hljs-comment">//æŸ¥æ‰¾åˆ é™¤ä½ç½®çš„å‰é©±ç»“ç‚¹</span><br>q=p-&gt;next;<span class="hljs-comment">//ä»¤qæŒ‡å‘è¢«åˆ é™¤çš„ç»“ç‚¹</span><br>p-&gt;next=q-&gt;next;<span class="hljs-comment">//å°†*qç»“ç‚¹ä»é“¾ä¸­â€œæ–­å¼€â€</span><br><span class="hljs-built_in">free</span>(q);<span class="hljs-comment">//é‡Šæ”¾ç»“ç‚¹çš„å‚¨å­˜ç©ºé—´</span><br></code></pre></div></td></tr></table></figure><p>æ‹“å±•:åˆ é™¤ç»“ç‚¹*p</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">q=p-&gt;next;<span class="hljs-comment">//ä»¤qæŒ‡å‘*pçš„åç»§èŠ‚ç‚¹</span><br>p-&gt;data = p-&gt;next-&gt;data<span class="hljs-comment">//å’Œåç»§ç»“ç‚¹äº¤æ¢æ•°æ®åŸŸ</span><br>p-&gt;next = q-&gt;next;<span class="hljs-comment">//å°†*qç»“ç‚¹ä»é“¾ä¸­â€œæ–­å¼€â€</span><br><span class="hljs-built_in">free</span>(q);<span class="hljs-comment">//é‡Šæ”¾åç»§ç»“ç‚¹çš„å‚¨å­˜ç©ºé—´</span><br></code></pre></div></td></tr></table></figure><h2 id="å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®Œæ•´å®ç°"><a href="#å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®Œæ•´å®ç°" class="headerlink" title="å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®Œæ•´å®ç°"></a>å•é“¾è¡¨ä¸ŠåŸºæœ¬æ“ä½œçš„å®Œæ•´å®ç°</h2><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">int</span> ElemType;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span>&#123;</span><span class="hljs-comment">//å®šä¹‰å•é“¾è¡¨ç»“ç‚¹ç±»å‹</span><br>    ElemType data;<span class="hljs-comment">//æ•°æ®åŸŸ</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span> *<span class="hljs-title">next</span>;</span><span class="hljs-comment">//æŒ‡é’ˆåŸŸ</span><br>&#125;LNode,*LinkList;<br><span class="hljs-function">LinkList <span class="hljs-title">List_HeadInsert</span><span class="hljs-params">(LinkList &amp;L)</span></span>&#123;<span class="hljs-comment">//é€†å‘å»ºç«‹å•é“¾è¡¨</span><br>    LNode *s;<br>    <span class="hljs-keyword">int</span> x;<br>    L=(LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<span class="hljs-comment">//åˆ›å»ºå¤´ç»“ç‚¹</span><br>    L-&gt;next = <span class="hljs-literal">NULL</span>;<span class="hljs-comment">//åˆå§‹åŒ–ä¸ºç©ºé“¾è¡¨</span><br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<span class="hljs-comment">//è¾“å…¥ç»“ç‚¹çš„å€¼</span><br>    <span class="hljs-keyword">while</span>(x!=<span class="hljs-number">9999</span>)&#123;<span class="hljs-comment">//è¾“å…¥9999è¡¨ç¤ºç»“æŸ</span><br>        s = (LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<span class="hljs-comment">//å»ºç«‹æ–°ç»“ç‚¹</span><br>        s-&gt;data = x;<br>        s-&gt;next = L-&gt;next;<br>        L-&gt;next = s;<span class="hljs-comment">//å°†æ–°ç»“ç‚¹æ’å…¥è¡¨ä¸­ï¼ŒLä¸ºå¤´æŒ‡é’ˆ</span><br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<br>    &#125;<br>    <span class="hljs-keyword">return</span> L;<br>&#125;<br><span class="hljs-function">LNode *<span class="hljs-title">GetElem</span><span class="hljs-params">(LinkList L,<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>;<span class="hljs-comment">//è®¡æ•°ï¼Œåˆå§‹ä¸º1</span><br>    LNode *p = L-&gt;next;<span class="hljs-comment">//ç¬¬1ä¸ªç»“ç‚¹æŒ‡é’ˆèµ‹ç»™p</span><br>    <span class="hljs-keyword">if</span>(i==<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> L;<span class="hljs-comment">//è‹¥iç­‰äº0ï¼Œåˆ™è¿”å›å¤´ç»“ç‚¹</span><br>    <span class="hljs-keyword">if</span>(i&lt;<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<span class="hljs-comment">//è‹¥iæ— æ•ˆï¼Œåˆ™è¿”å›NULL</span><br>    <span class="hljs-keyword">while</span>(p&amp;&amp;j&lt;i)<span class="hljs-comment">//ä»ç¬¬ä¸€ä¸ªç»“ç‚¹å¼€å§‹æ‰¾ï¼ŒæŸ¥æ‰¾ç¬¬iä¸ªç»“ç‚¹</span><br>    &#123;<br>        p=p-&gt;next;<br>        j++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<span class="hljs-comment">//è¿”å›ç¬¬iä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œè‹¥iå¤§äºè¡¨é•¿ï¼Œåˆ™è¿”å›NULL</span><br>&#125;<br><span class="hljs-function">LNode *<span class="hljs-title">LocateElem</span><span class="hljs-params">(LinkList L,ElemType e)</span></span>&#123;<br>    LNode *p = L-&gt;next;<br>    <span class="hljs-keyword">while</span>(p!=<span class="hljs-literal">NULL</span>&amp;&amp;p-&gt;data!=e)<span class="hljs-comment">//ä»ç¬¬iä¸ªç»“ç‚¹å¼€å§‹æŸ¥æ‰¾dataåŸŸä¸ºeçš„ç»“ç‚¹</span><br>    &#123;<br>        p=p-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<span class="hljs-comment">//æ‰¾åˆ°åè¿”å›è¯¥ç»“ç‚¹æŒ‡é’ˆï¼Œå¦åˆ™è¿”å›NULL</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintLinkList</span><span class="hljs-params">(LinkList L)</span></span>&#123;        <span class="hljs-comment">//è¿™æ®µä»£ç æ ¹æ®é“¾è¡¨è¡¨å°¾ç»“ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘ NULL æ¥éå†æ•´ä¸ªé“¾è¡¨ã€‚</span><br>LNode *tmp = L-&gt;next;<br><span class="hljs-keyword">if</span>(tmp==<span class="hljs-literal">NULL</span>)<br>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;é“¾è¡¨ä¸ºç©º&quot;</span>&lt;&lt;endl;<br><span class="hljs-keyword">return</span> ; <br>&#125;<br><span class="hljs-keyword">while</span>(tmp!=<span class="hljs-literal">NULL</span>)&#123;<br>cout&lt;&lt;tmp-&gt;data&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>tmp=tmp-&gt;next;<br>&#125;<br>cout&lt;&lt;endl; <br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Insert</span><span class="hljs-params">(LinkList &amp;L,<span class="hljs-keyword">int</span> i,<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>LNode *p;<br>LNode *s=(LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));<span class="hljs-comment">//ç”³è¯·ç©ºé—´ </span><br>s-&gt;data=x;<br>s-&gt;next=<span class="hljs-literal">NULL</span>; <br>p=<span class="hljs-built_in">GetElem</span>(L,i<span class="hljs-number">-1</span>);<br><span class="hljs-keyword">if</span>(p!=<span class="hljs-literal">NULL</span>)&#123;<br>s-&gt;next =p-&gt;next;<br>p-&gt;next=s;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;æ’å…¥å€¼éæ³•&quot;</span>&lt;&lt;endl;<br><span class="hljs-keyword">return</span> ; <br>&#125;<br><br>&#125;<br><span class="hljs-comment">//æ³¨æ„ä¸æ’å…¥ç»“ç‚¹ç›¸å¯¹æ¯”!!!!!!!!</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Delect</span><span class="hljs-params">(LinkList &amp;L,<span class="hljs-keyword">int</span> i)</span></span>&#123;<br><span class="hljs-comment">//pæ‰€æŒ‡ç»“ç‚¹æ˜¯qæ‰€æŒ‡ç»“ç‚¹çš„å‰é©±ç»“ç‚¹</span><br>LNode *p;<br>LNode *q=(LNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(LNode));   <span class="hljs-comment">//ç”³è¯·ç©ºé—´ </span><br>p=<span class="hljs-built_in">GetElem</span>(L,i<span class="hljs-number">-1</span>);    <span class="hljs-comment">//æŸ¥æ‰¾åˆ é™¤ä½ç½®çš„å‰é©±ç»“ç‚¹</span><br><span class="hljs-keyword">if</span>(p==<span class="hljs-literal">NULL</span>||p-&gt;next==<span class="hljs-literal">NULL</span>)          <span class="hljs-comment">//p==NULLæ˜¯iå€¼ä¸åˆæ³•çš„æƒ…å†µ </span><br>&#123;    <span class="hljs-comment">//p-&gt;next==NUllæ˜¯i-1å·ç»“ç‚¹åå·²æ— å…¶ä»–ç»“ç‚¹ </span><br>cout&lt;&lt;<span class="hljs-string">&quot;åˆ é™¤å€¼éæ³•&quot;</span>&lt;&lt;endl;<br><span class="hljs-built_in">free</span>(q);<br><span class="hljs-keyword">return</span> ;<br>&#125;<br>q=p-&gt;next;<span class="hljs-comment">//ä»¤qæŒ‡å‘è¢«åˆ é™¤çš„ç»“ç‚¹</span><br>p-&gt;next=q-&gt;next;<span class="hljs-comment">//å°†*qç»“ç‚¹ä»é“¾ä¸­â€œæ–­å¼€â€</span><br><span class="hljs-built_in">free</span>(q);<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>LinkList L;<span class="hljs-comment">//å£°æ˜ä¸€ä¸ªå•é“¾è¡¨ </span><br><span class="hljs-built_in">List_HeadInsert</span>(L);<span class="hljs-comment">//ä½¿ç”¨å¤´æ’æ³•æ’å…¥4ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«æ˜¯1,2,3,4 </span><br><span class="hljs-built_in">PrintLinkList</span>(L);<span class="hljs-comment">//éå†è¿™ä¸ªå•é“¾è¡¨</span><br>LNode *tmp;<br>tmp=<span class="hljs-built_in">GetElem</span>(L,<span class="hljs-number">2</span>);<span class="hljs-comment">//æ‰¾åˆ°ä½ç½®ä¸º2çš„å…ƒç´  </span><br><span class="hljs-keyword">if</span>(tmp!=<span class="hljs-literal">NULL</span>)&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;ä½ç½®ä¸º2çš„å…ƒç´ æ˜¯ï¼š&quot;</span>&lt;&lt;tmp-&gt;data&lt;&lt;endl;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;éæ³•çš„ä½ç½®&quot;</span>&lt;&lt;endl;<br>&#125;<br>tmp=<span class="hljs-built_in">LocateElem</span>(L,<span class="hljs-number">1</span>);<span class="hljs-comment">//æ‰¾åˆ°å€¼ä¸º1çš„å…ƒç´ </span><br><span class="hljs-keyword">if</span>(tmp!=<span class="hljs-literal">NULL</span>)&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;å­˜åœ¨å€¼ä¸º1çš„å…ƒç´ ï¼š&quot;</span>&lt;&lt;tmp-&gt;data&lt;&lt;endl;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;æ²¡æœ‰æ‰¾åˆ°è¯¥å€¼&quot;</span>&lt;&lt;endl;<br>&#125;<br><span class="hljs-built_in">PrintLinkList</span>(L);<span class="hljs-comment">//éå†è¿™ä¸ªå•é“¾è¡¨</span><br><span class="hljs-built_in">Insert</span>(L,<span class="hljs-number">5</span>,<span class="hljs-number">110</span>);<span class="hljs-comment">//åœ¨5è¿™ä¸ªä½ç½®æ’å…¥å…ƒç´ 110</span><br><span class="hljs-built_in">PrintLinkList</span>(L);<span class="hljs-comment">//éå†è¿™ä¸ªå•é“¾è¡¨</span><br><span class="hljs-built_in">Delect</span>(L,<span class="hljs-number">2</span>);        <span class="hljs-comment">//åˆ é™¤ä½åºä¸º2çš„å…ƒç´ </span><br><span class="hljs-built_in">PrintLinkList</span>(L);<span class="hljs-comment">//éå†è¿™ä¸ªå•é“¾è¡¨</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br>ä½ç½®ä¸º<span class="hljs-number">2</span>çš„å…ƒç´ æ˜¯ï¼š<span class="hljs-number">3</span><br>å­˜åœ¨å€¼ä¸º<span class="hljs-number">1</span>çš„å…ƒç´ ï¼š<span class="hljs-number">1</span><br><span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br><span class="hljs-number">4</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">110</span><br><span class="hljs-number">4</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">110</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å•é“¾è¡¨çš„å®šä¹‰</title>
    <link href="/2022/03/28/Algorithm006/"/>
    <url>/2022/03/28/Algorithm006/</url>
    
    <content type="html"><![CDATA[<h1 id="å•é“¾è¡¨çš„å®šä¹‰"><a href="#å•é“¾è¡¨çš„å®šä¹‰" class="headerlink" title="å•é“¾è¡¨çš„å®šä¹‰"></a>å•é“¾è¡¨çš„å®šä¹‰</h1><h2 id="1-å•é“¾è¡¨çš„å®šä¹‰"><a href="#1-å•é“¾è¡¨çš„å®šä¹‰" class="headerlink" title="1.å•é“¾è¡¨çš„å®šä¹‰"></a>1.å•é“¾è¡¨çš„å®šä¹‰</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span>&#123;</span>      <span class="hljs-comment">//å®šä¹‰å•é“¾è¡¨ç»“ç‚¹ç±»å‹</span><br>    ElemType data;         <span class="hljs-comment">//æ¯ä¸ªç»“ç‚¹å­˜æ”¾ä¸€ä¸ªæ•°æ®å…ƒç´ </span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span> *<span class="hljs-title">next</span>;</span>    <span class="hljs-comment">//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>&#125;LNode,*LinkList;<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span>&#123;</span>      <span class="hljs-comment">//å®šä¹‰å•é“¾è¡¨ç»“ç‚¹ç±»å‹</span><br>    ElemType data;         <span class="hljs-comment">//æ¯ä¸ªç»“ç‚¹å­˜æ”¾ä¸€ä¸ªæ•°æ®å…ƒç´ </span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span> *<span class="hljs-title">next</span>;</span>    <span class="hljs-comment">//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>&#125;;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span> <span class="hljs-title">LNode</span>;</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LNode</span> *<span class="hljs-title">LinkList</span>;</span><br></code></pre></div></td></tr></table></figure><p>è¿™ä¸¤ç§å®šä¹‰æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼</p><p>è¦è¡¨ç¤ºä¸€ä¸ªå•é“¾è¡¨æ—¶ï¼Œåªéœ€è¦å£°æ˜ä¸€ä¸ªå¤´æŒ‡é’ˆLï¼ŒæŒ‡å‘å•é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">LNoode *L;      <span class="hljs-comment">//å£°æ˜ä¸€ä¸ªæŒ‡å‘å•é“¾è¡¨ç¬¬ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆ</span><br><span class="hljs-comment">//æˆ–ï¼š</span><br>LinkList L;     <span class="hljs-comment">//å£°æ˜ä¸€ä¸ªæŒ‡å‘å•é“¾è¡¨ç¬¬ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆ</span><br></code></pre></div></td></tr></table></figure><h2 id="æ ·ä¾‹ä»£ç "><a href="#æ ·ä¾‹ä»£ç " class="headerlink" title="æ ·ä¾‹ä»£ç "></a>æ ·ä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">LNode *Lï¼›<br><span class="hljs-comment">//å’Œï¼š</span><br>LinkList L;<br><span class="hljs-comment">//ä¸¤è€…çš„åŒºåˆ«å°±æ˜¯å¼ºè°ƒä¸åŒ</span><br></code></pre></div></td></tr></table></figure><p><img src="/2022/03/28/Algorithm006/%E6%BC%94%E7%A4%BA.png"></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¼˜å…ˆé˜Ÿåˆ—</title>
    <link href="/2022/03/11/Algorithm005/"/>
    <url>/2022/03/11/Algorithm005/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¼˜å…ˆé˜Ÿåˆ—"><a href="#ä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="ä¼˜å…ˆé˜Ÿåˆ—"></a>ä¼˜å…ˆé˜Ÿåˆ—</h1><h2 id="å®šä¹‰ï¼š"><a href="#å®šä¹‰ï¼š" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h2><p>å®šä¹‰ï¼špriority_queue&lt;Type, Container, Functional&gt;</p><p>Type å°±æ˜¯æ•°æ®ç±»å‹ï¼ŒContainer å°±æ˜¯å®¹å™¨ç±»å‹ï¼ˆContainerå¿…é¡»æ˜¯ç”¨æ•°ç»„å®ç°çš„å®¹å™¨ï¼Œæ¯”å¦‚vector,dequeç­‰ç­‰ï¼Œä½†ä¸èƒ½ç”¨ listã€‚STLé‡Œé¢é»˜è®¤ç”¨çš„æ˜¯vectorï¼‰ï¼ŒFunctional å°±æ˜¯æ¯”è¾ƒçš„æ–¹å¼ã€‚</p><p>å½“éœ€è¦ç”¨è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹æ—¶æ‰éœ€è¦ä¼ å…¥è¿™ä¸‰ä¸ªå‚æ•°ï¼Œä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œåªéœ€è¦ä¼ å…¥æ•°æ®ç±»å‹ï¼Œé»˜è®¤æ˜¯å¤§é¡¶å †ã€‚<br>ä¸€èˆ¬æ˜¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//å‡åºé˜Ÿåˆ—ï¼Œå°é¡¶å †</span><br>priority_queue &lt;<span class="hljs-keyword">int</span>,vector&lt;<span class="hljs-keyword">int</span>&gt;,greater&lt;<span class="hljs-keyword">int</span>&gt; &gt; q;<br><span class="hljs-comment">//é™åºé˜Ÿåˆ—ï¼Œå¤§é¡¶å †</span><br>priority_queue &lt;<span class="hljs-keyword">int</span>,vector&lt;<span class="hljs-keyword">int</span>&gt;,less&lt;<span class="hljs-keyword">int</span>&gt; &gt;q;<br><br><span class="hljs-comment">//greaterå’Œlessæ˜¯stdå®ç°çš„ä¸¤ä¸ªä»¿å‡½æ•°ï¼ˆå°±æ˜¯ä½¿ä¸€ä¸ªç±»çš„ä½¿ç”¨çœ‹ä¸Šå»åƒä¸€ä¸ªå‡½æ•°ã€‚å…¶å®ç°å°±æ˜¯ç±»ä¸­å®ç°ä¸€ä¸ªoperator()ï¼Œè¿™ä¸ªç±»å°±æœ‰äº†ç±»ä¼¼å‡½æ•°çš„è¡Œä¸ºï¼Œå°±æ˜¯ä¸€ä¸ªä»¿å‡½æ•°ç±»äº†ï¼‰</span><br></code></pre></div></td></tr></table></figure><h2 id="æ ·ä¾‹ä¸€P1090-NOIP2004-æé«˜ç»„-åˆå¹¶æœå­-x2F-USACO06NOV-Fence-Repair-G"><a href="#æ ·ä¾‹ä¸€P1090-NOIP2004-æé«˜ç»„-åˆå¹¶æœå­-x2F-USACO06NOV-Fence-Repair-G" class="headerlink" title="æ ·ä¾‹ä¸€P1090 [NOIP2004 æé«˜ç»„] åˆå¹¶æœå­ &#x2F; [USACO06NOV] Fence Repair G"></a>æ ·ä¾‹ä¸€P1090 [NOIP2004 æé«˜ç»„] åˆå¹¶æœå­ &#x2F; [USACO06NOV] Fence Repair G</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>åœ¨ä¸€ä¸ªæœå›­é‡Œï¼Œå¤šå¤šå·²ç»å°†æ‰€æœ‰çš„æœå­æ‰“äº†ä¸‹æ¥ï¼Œè€Œä¸”æŒ‰æœå­çš„ä¸åŒç§ç±»åˆ†æˆäº†ä¸åŒçš„å †ã€‚å¤šå¤šå†³å®šæŠŠæ‰€æœ‰çš„æœå­åˆæˆä¸€å †ã€‚</p><p>æ¯ä¸€æ¬¡åˆå¹¶ï¼Œå¤šå¤šå¯ä»¥æŠŠä¸¤å †æœå­åˆå¹¶åˆ°ä¸€èµ·ï¼Œæ¶ˆè€—çš„ä½“åŠ›ç­‰äºä¸¤å †æœå­çš„é‡é‡ä¹‹å’Œã€‚å¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰çš„æœå­ç»è¿‡ n-1æ¬¡åˆå¹¶ä¹‹åï¼Œ å°±åªå‰©ä¸‹ä¸€å †äº†ã€‚å¤šå¤šåœ¨åˆå¹¶æœå­æ—¶æ€»å…±æ¶ˆè€—çš„ä½“åŠ›ç­‰äºæ¯æ¬¡åˆå¹¶æ‰€è€—ä½“åŠ›ä¹‹å’Œã€‚</p><p>å› ä¸ºè¿˜è¦èŠ±å¤§åŠ›æ°”æŠŠè¿™äº›æœå­æ¬å›å®¶ï¼Œæ‰€ä»¥å¤šå¤šåœ¨åˆå¹¶æœå­æ—¶è¦å°½å¯èƒ½åœ°èŠ‚çœä½“åŠ›ã€‚å‡å®šæ¯ä¸ªæœå­é‡é‡éƒ½ä¸º 1 ï¼Œå¹¶ä¸”å·²çŸ¥æœå­çš„ç§ç±» æ•°å’Œæ¯ç§æœå­çš„æ•°ç›®ï¼Œä½ çš„ä»»åŠ¡æ˜¯è®¾è®¡å‡ºåˆå¹¶çš„æ¬¡åºæ–¹æ¡ˆï¼Œä½¿å¤šå¤šè€—è´¹çš„ä½“åŠ›æœ€å°‘ï¼Œå¹¶è¾“å‡ºè¿™ä¸ªæœ€å°çš„ä½“åŠ›è€—è´¹å€¼ã€‚</p><p>ä¾‹å¦‚æœ‰ 33ç§æœå­ï¼Œæ•°ç›®ä¾æ¬¡ä¸º 1 ï¼Œ 2 ï¼Œ 9 ã€‚å¯ä»¥å…ˆå°† 1 ã€ 2 å †åˆå¹¶ï¼Œæ–°å †æ•°ç›®ä¸º 3 ï¼Œè€—è´¹ä½“åŠ›ä¸º 3 ã€‚æ¥ç€ï¼Œå°†æ–°å †ä¸åŸå…ˆçš„ç¬¬ä¸‰å †åˆå¹¶ï¼Œåˆå¾—åˆ°æ–°çš„å †ï¼Œæ•°ç›®ä¸º 12 ï¼Œè€—è´¹ä½“åŠ›ä¸º 12 ã€‚æ‰€ä»¥å¤šå¤šæ€»å…±è€—è´¹ä½“åŠ› &#x3D;3+12&#x3D;15 ã€‚å¯ä»¥è¯æ˜ 15ä¸ºæœ€å°çš„ä½“åŠ›è€—è´¹å€¼ã€‚</p><h3 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼"></a>è¾“å…¥æ ¼å¼</h3><p>å…±ä¸¤è¡Œã€‚<br>ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•° n*(1â‰¤<em>n</em>â‰¤10000) ï¼Œè¡¨ç¤ºæœå­çš„ç§ç±»æ•°ã€‚</p><p>ç¬¬äºŒè¡ŒåŒ…å« <em>n</em> ä¸ªæ•´æ•°ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼Œç¬¬ <em>i</em> ä¸ªæ•´æ•° a<strong>i*(1â‰¤*a</strong>i<em>â‰¤20000) æ˜¯ç¬¬ i</em> ç§æœå­çš„æ•°ç›®ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h3><p>ä¸€ä¸ªæ•´æ•°ï¼Œä¹Ÿå°±æ˜¯æœ€å°çš„ä½“åŠ›è€—è´¹å€¼ã€‚è¾“å…¥æ•°æ®ä¿è¯è¿™ä¸ªå€¼å°äº 2^{31} ã€‚</p><h3 id="è¾“å…¥è¾“å‡ºæ ·ä¾‹"><a href="#è¾“å…¥è¾“å‡ºæ ·ä¾‹" class="headerlink" title="è¾“å…¥è¾“å‡ºæ ·ä¾‹"></a>è¾“å…¥è¾“å‡ºæ ·ä¾‹</h3><h4 id="è¾“å…¥-1"><a href="#è¾“å…¥-1" class="headerlink" title="è¾“å…¥ #1"></a><strong>è¾“å…¥ #1</strong></h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">3</span> <br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">9</span> <br></code></pre></div></td></tr></table></figure><h4 id="è¾“å‡º-1"><a href="#è¾“å‡º-1" class="headerlink" title="è¾“å‡º #1"></a><strong>è¾“å‡º #1</strong></h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">15</span><br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>priority_queue&lt;<span class="hljs-keyword">int</span>,vector&lt;<span class="hljs-keyword">int</span>&gt;,greater&lt;<span class="hljs-keyword">int</span>&gt; &gt; q;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">int</span> ans;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> num;<br>        cin&gt;&gt;num;<br>        q.<span class="hljs-built_in">push</span>(num);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;n<span class="hljs-number">-1</span> ; ++j) &#123;<br>        <span class="hljs-keyword">int</span> a=q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">int</span> b=q.<span class="hljs-built_in">top</span>();<br>        q.<span class="hljs-built_in">pop</span>();<br>        ans+=a+b;<br>        q.<span class="hljs-built_in">push</span>(a+b);<br>    &#125;<br>    cout&lt;&lt;ans&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.cnblogs.com/huashanqingzhu/p/11040390.html">c++ä¼˜å…ˆé˜Ÿåˆ—(priority_queue)ç”¨æ³•è¯¦è§£ - åå±±é’ç«¹ - åšå®¢å›­ (cnblogs.com)</a></p><p>[P1090 <a href="https://www.luogu.com.cn/problem/P1090">NOIP2004 æé«˜ç»„] åˆå¹¶æœå­ &#x2F; [USACO06NOV] Fence Repair G - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>perf-ç³»ç»Ÿçº§æ€§èƒ½åˆ†æå·¥å…·</title>
    <link href="/2022/01/19/tool003/"/>
    <url>/2022/01/19/tool003/</url>
    
    <content type="html"><![CDATA[<p>ç³»ç»Ÿçº§æ€§èƒ½ä¼˜åŒ–é€šå¸¸åŒ…æ‹¬ä¸¤ä¸ªé˜¶æ®µï¼šæ€§èƒ½å‰–æï¼ˆperformance profilingï¼‰å’Œä»£ç ä¼˜åŒ–ã€‚</p><p>æ€§èƒ½å‰–æçš„ç›®æ ‡æ˜¯å¯»æ‰¾æ€§èƒ½ç“¶é¢ˆï¼ŒæŸ¥æ‰¾å¼•å‘æ€§èƒ½é—®é¢˜çš„åŸå› åŠçƒ­ç‚¹ä»£ç ã€‚</p><p>ä»£ç ä¼˜åŒ–çš„ç›®æ ‡æ˜¯é’ˆå¯¹å…·ä½“æ€§èƒ½é—®é¢˜è€Œä¼˜åŒ–ä»£ç æˆ–ç¼–è¯‘é€‰é¡¹ï¼Œä»¥æ”¹å–„è½¯ä»¶æ€§èƒ½ã€‚</p><p>åœ¨æ€§èƒ½å‰–æé˜¶æ®µï¼Œéœ€è¦å€ŸåŠ©äºç°æœ‰çš„profilingå·¥å…·ï¼Œå¦‚perfç­‰ã€‚åœ¨ä»£ç ä¼˜åŒ–é˜¶æ®µå¾€å¾€éœ€è¦å€ŸåŠ©å¼€å‘è€…çš„ç»éªŒï¼Œç¼–å†™ç®€æ´é«˜æ•ˆçš„ä»£ç ï¼Œç”šè‡³åœ¨æ±‡ç¼–çº§åˆ«åˆç†ä½¿ç”¨å„ç§æŒ‡ä»¤ï¼Œåˆç†å®‰æ’å„ç§æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚</p><p>perfæ˜¯ä¸€æ¬¾Linuxæ€§èƒ½åˆ†æå·¥å…·ã€‚Linuxæ€§èƒ½è®¡æ•°å™¨æ˜¯ä¸€ä¸ªæ–°çš„åŸºäºå†…æ ¸çš„å­ç³»ç»Ÿï¼Œå®ƒæä¾›ä¸€ä¸ªæ€§èƒ½åˆ†ææ¡†æ¶ï¼Œæ¯”å¦‚ç¡¬ä»¶ï¼ˆCPUã€PMU(Performance Monitoring Unit)ï¼‰åŠŸèƒ½å’Œè½¯ä»¶(è½¯ä»¶è®¡æ•°å™¨ã€tracepoint)åŠŸèƒ½ã€‚<br>é€šè¿‡perfï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åˆ©ç”¨PMUã€tracepointå’Œå†…æ ¸ä¸­çš„è®¡æ•°å™¨æ¥è¿›è¡Œæ€§èƒ½ç»Ÿè®¡ã€‚å®ƒä¸ä½†å¯ä»¥åˆ†æåˆ¶å®šåº”ç”¨ç¨‹åºçš„æ€§èƒ½é—®é¢˜ï¼ˆper threadï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åˆ†æå†…æ ¸çš„æ€§èƒ½é—®é¢˜ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŒæ—¶åˆ†æåº”ç”¨ç¨‹åºå’Œå†…æ ¸ï¼Œä»è€Œå…¨é¢ç†è§£åº”ç”¨ç¨‹åºä¸­çš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>ä½¿ç”¨perfï¼Œå¯ä»¥åˆ†æç¨‹åºè¿è¡ŒæœŸé—´å‘ç”Ÿçš„ç¡¬ä»¶äº‹ä»¶ï¼Œæ¯”å¦‚instructions retiredã€processor clock cyclesç­‰ï¼›ä¹Ÿå¯ä»¥åˆ†æè½¯ä»¶æ—¶é—´ï¼Œæ¯”å¦‚page faultå’Œè¿›ç¨‹åˆ‡æ¢ã€‚</p><p>perfæ˜¯ä¸€æ¬¾ç»¼åˆæ€§åˆ†æå·¥å…·ï¼Œå¤§åˆ°ç³»ç»Ÿå…¨å±€æ€§æ€§èƒ½ï¼Œå†å°åˆ°è¿›ç¨‹çº¿ç¨‹çº§åˆ«ï¼Œç”šè‡³åˆ°å‡½æ•°åŠæ±‡ç¼–çº§åˆ«ã€‚</p><p>perfæä¾›äº†åå…«èˆ¬æ­¦å™¨ï¼Œå¯ä»¥æ‹¿å¤§åˆ€å¤§å¸å…«å—ï¼Œä¹Ÿå¯ä»¥æ‹¿èµ·æ‰‹æœ¯åˆ€ç»†è‡´åˆ†æã€‚</p><h1 id="1-èƒŒæ™¯çŸ¥è¯†"><a href="#1-èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="1. èƒŒæ™¯çŸ¥è¯†"></a>1. èƒŒæ™¯çŸ¥è¯†</h1><h2 id="1-1-tracepoints"><a href="#1-1-tracepoints" class="headerlink" title="1.1 tracepoints"></a>1.1 tracepoints</h2><p>tracepointsæ˜¯æ•£è½åœ¨å†…æ ¸æºç ä¸­çš„ä¸€äº›hookï¼Œå®ƒä»¬å¯ä»¥åœ¨ç‰¹å®šçš„ä»£ç è¢«æ‰§è¡Œåˆ°æ—¶è§¦å‘ï¼Œè¿™ä¸€ç‰¹å®šå¯ä»¥è¢«å„ç§trace&#x2F;debugå·¥å…·æ‰€ä½¿ç”¨ã€‚</p><p>perfå°†tracepointäº§ç”Ÿçš„æ—¶é—´è®°å½•ä¸‹æ¥ï¼Œç”ŸæˆæŠ¥å‘Šï¼Œé€šè¿‡åˆ†æè¿™äº›æŠ¥å‘Šï¼Œä¾¿å¯ä»¥äº†è§£ç¨‹åºè¿è¡ŒæœŸé—´å†…æ ¸çš„å„ç§ç»†èŠ‚ï¼Œå¯¹æ€§èƒ½ç—‡çŠ¶åšå‡ºå‡†ç¡®çš„è¯Šæ–­ã€‚</p><p>è¿™äº›tracepintçš„å¯¹åº”çš„sysfsèŠ‚ç‚¹åœ¨&#x2F;sys&#x2F;kernel&#x2F;debug&#x2F;tracing&#x2F;eventsç›®å½•ä¸‹ã€‚</p><h2 id="1-2-ç¡¬ä»¶ç‰¹æ€§ä¹‹cache"><a href="#1-2-ç¡¬ä»¶ç‰¹æ€§ä¹‹cache" class="headerlink" title="1.2 ç¡¬ä»¶ç‰¹æ€§ä¹‹cache"></a>1.2 ç¡¬ä»¶ç‰¹æ€§ä¹‹cache</h2><p>å†…å­˜è¯»å†™æ˜¯å¾ˆå¿«çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•å’Œå¤„ç†å™¨æŒ‡ä»¤æ‰§è¡Œé€Ÿåº¦ç›¸æ¯”ã€‚ä¸ºäº†ä»å†…å­˜ä¸­è¯»å–æŒ‡ä»¤å’Œæ•°æ®ï¼Œå¤„ç†å™¨éœ€è¦ç­‰å¾…ï¼Œç”¨å¤„ç†å™¨æ—¶é—´æ¥è¡¡é‡ï¼Œè¿™ç§ç­‰å¾…éå¸¸æ¼«é•¿ã€‚cacheæ˜¯ä¸€ç§SRAMï¼Œè¯»å†™é€Ÿåº¦éå¸¸å¿«ï¼Œèƒ½å’Œå¤„ç†å™¨ç›¸åŒ¹é…ã€‚å› æ­¤å°†å¸¸ç”¨çš„æ•°æ®ä¿å­˜åœ¨cacheä¸­ï¼Œå¤„ç†å™¨ä¾¿æ— éœ€ç­‰å¾…ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚cacheçš„å°ºå¯¸ä¸€èˆ¬éƒ½å¾ˆå°ï¼Œå……åˆ†åˆ©ç”¨cacheæ˜¯è½¯ä»¶è°ƒä¼˜éå¸¸é‡è¦éƒ¨åˆ†ã€‚</p><h1 id="2-ä¸»è¦å…³æ³¨ç‚¹"><a href="#2-ä¸»è¦å…³æ³¨ç‚¹" class="headerlink" title="2. ä¸»è¦å…³æ³¨ç‚¹"></a>2. ä¸»è¦å…³æ³¨ç‚¹</h1><p>åŸºäºæ€§èƒ½åˆ†æï¼Œå¯ä»¥è¿›è¡Œç®—æ³•ä¼˜åŒ–ï¼ˆç©ºé—´å¤æ‚åº¦å’Œæ—¶é—´å¤æ‚åº¦æƒè¡¡ï¼‰ã€ä»£ç ä¼˜åŒ–ï¼ˆæé«˜æ‰§è¡Œé€Ÿåº¦ã€å‡å°‘å†…å­˜å ç”¨ï¼‰ã€‚</p><p>è¯„ä¼°ç¨‹åºå¯¹ç¡¬ä»¶èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œä¾‹å¦‚å„çº§cacheçš„è®¿é—®æ¬¡æ•°ã€å„çº§cacheçš„ä¸¢å¤±æ¬¡æ•°ã€æµæ°´çº¿åœé¡¿å‘¨æœŸã€å‰ç«¯æ€»çº¿è®¿é—®æ¬¡æ•°ç­‰ã€‚</p><p>è¯„ä¼°ç¨‹åºå¯¹æ“ä½œç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ã€ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ã€ä»»åŠ¡è¿ç§»æ¬¡æ•°ã€‚</p><p>äº‹ä»¶å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š</p><ol><li>Hardware Eventç”±PMUéƒ¨ä»¶äº§ç”Ÿï¼Œåœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹æ¢æµ‹æ€§èƒ½äº‹ä»¶æ˜¯å¦å‘ç”Ÿä»¥åŠå‘ç”Ÿçš„æ¬¡æ•°ã€‚æ¯”å¦‚cacheå‘½ä¸­ã€‚</li><li>Software Eventæ˜¯å†…æ ¸äº§ç”Ÿçš„äº‹ä»¶ï¼Œåˆ†å¸ƒåœ¨å„ä¸ªåŠŸèƒ½æ¨¡å—ä¸­ï¼Œç»Ÿè®¡å’Œæ“ä½œç³»ç»Ÿç›¸å…³æ€§èƒ½äº‹ä»¶ã€‚æ¯”å¦‚è¿›ç¨‹åˆ‡æ¢ï¼Œtickæ•°ç­‰ã€‚</li><li>Tracepoint Eventæ˜¯å†…æ ¸ä¸­é™æ€tracepointæ‰€è§¦å‘çš„äº‹ä»¶ï¼Œè¿™äº›tracepointç”¨æ¥åˆ¤æ–­ç¨‹åºè¿è¡ŒæœŸé—´å†…æ ¸çš„è¡Œä¸ºç»†èŠ‚ï¼Œæ¯”å¦‚slabåˆ†é…å™¨çš„åˆ†é…æ¬¡æ•°ç­‰ã€‚</li></ol><h1 id="3-perfçš„ä½¿ç”¨"><a href="#3-perfçš„ä½¿ç”¨" class="headerlink" title="3. perfçš„ä½¿ç”¨"></a>3. perfçš„ä½¿ç”¨</h1><p>perf â€“helpåå¯ä»¥çœ‹åˆ°perfçš„äºŒçº§å‘½ä»¤</p><p><img src="/2022/01/19/tool003/image-20220119120817508.png"></p><h2 id="3-1perf-list"><a href="#3-1perf-list" class="headerlink" title="3.1perf list"></a>3.1perf list</h2><p>perf listæŸ¥çœ‹æ”¯æŒçš„äº‹ä»¶ç±»å‹</p><p><img src="/2022/01/19/tool003/image-20220119121131231.png"></p><h2 id="3-2perf-top"><a href="#3-2perf-top" class="headerlink" title="3.2perf top"></a>3.2perf top</h2><p>å³å¯ä»¥æ­£å¸¸æ˜¾ç¤ºperf topå¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€åˆ—ï¼šç¬¦å·å¼•å‘çš„æ€§èƒ½äº‹ä»¶çš„æ¯”ä¾‹ï¼ŒæŒ‡å ç”¨çš„cpuå‘¨æœŸæ¯”ä¾‹ã€‚</p><p>ç¬¬äºŒåˆ—ï¼šç¬¦å·æ‰€åœ¨çš„DSO(Dynamic Shared Object)ï¼Œå¯ä»¥æ˜¯åº”ç”¨ç¨‹åºã€å†…æ ¸ã€åŠ¨æ€é“¾æ¥åº“ã€æ¨¡å—ã€‚</p><p>ç¬¬ä¸‰åˆ—ï¼šDSOçš„ç±»å‹ã€‚[.]è¡¨ç¤ºæ­¤ç¬¦å·å±äºç”¨æˆ·æ€çš„ELFæ–‡ä»¶ï¼ŒåŒ…æ‹¬å¯æ‰§è¡Œæ–‡ä»¶ä¸åŠ¨æ€é“¾æ¥åº“ï¼›[k]è¡¨è¿°æ­¤ç¬¦å·å±äºå†…æ ¸æˆ–æ¨¡å—ã€‚</p><p>ç¬¬å››åˆ—ï¼šç¬¦å·åã€‚æœ‰äº›ç¬¦å·ä¸èƒ½è§£æä¸ºå‡½æ•°åï¼Œåªèƒ½ç”¨åœ°å€è¡¨ç¤ºã€‚</p><p><img src="/2022/01/19/tool003/image-20220119121453395.png"></p><h2 id="3-3-perf-stat"><a href="#3-3-perf-stat" class="headerlink" title="3.3 perf stat"></a>3.3 perf stat</h2><p>perf statç”¨äºè¿è¡ŒæŒ‡ä»¤ï¼Œå¹¶åˆ†æå…¶ç»Ÿè®¡ç»“æœã€‚è™½ç„¶perf topä¹Ÿå¯ä»¥æŒ‡å®špidï¼Œä½†æ˜¯å¿…é¡»å…ˆå¯åŠ¨åº”ç”¨æ‰èƒ½æŸ¥çœ‹ä¿¡æ¯ã€‚</p><p>perf statèƒ½å®Œæ•´ç»Ÿè®¡åº”ç”¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„ä¿¡æ¯ã€‚</p><p>å‘½ä»¤æ ¼å¼ä¸ºï¼š</p><blockquote><p>perf stat [-e <EVENT> | â€“event&#x3D;EVENT] [-a] <command><br>perf stat [-e <EVENT> | â€“event&#x3D;EVENT] [-a] â€” <command> [<options>]</options></EVENT></EVENT></p></blockquote><p><img src="/2022/01/19/tool003/image-20220119122351095.png" alt="image-20220119122351095"></p><p><img src="/2022/01/19/tool003/C2DDB2280E83453D6D8FE0D11A4380C3.png"></p><p>cpu-clockï¼šä»»åŠ¡çœŸæ­£å ç”¨çš„å¤„ç†å™¨æ—¶é—´ï¼Œå•ä½ä¸ºmsã€‚CPUs utilized &#x3D; task-clock &#x2F; time elapsedï¼ŒCPUçš„å ç”¨ç‡ã€‚</p><p>context-switchesï¼šç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸Šä¸‹æ–‡çš„åˆ‡æ¢æ¬¡æ•°ã€‚</p><p>CPU-migrationsï¼šç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¤„ç†å™¨è¿ç§»æ¬¡æ•°ã€‚Linuxä¸ºäº†ç»´æŒå¤šä¸ªå¤„ç†å™¨çš„è´Ÿè½½å‡è¡¡ï¼Œåœ¨ç‰¹å®šæ¡ä»¶ä¸‹ä¼šå°†æŸä¸ªä»»åŠ¡ä»ä¸€ä¸ªCPUè¿ç§»åˆ°å¦ä¸€ä¸ªCPUã€‚</p><p>CPUè¿ç§»å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼šå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ä¸ä¸€å®šä¼šå‘ç”ŸCPUè¿ç§»ï¼Œè€Œå‘ç”ŸCPUè¿ç§»æ—¶è‚¯å®šä¼šå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢æœ‰å¯èƒ½åªæ˜¯æŠŠä¸Šä¸‹æ–‡ä»å½“å‰CPUä¸­æ¢å‡ºï¼Œä¸‹ä¸€æ¬¡è°ƒåº¦å™¨è¿˜æ˜¯å°†è¿›ç¨‹å®‰æ’åœ¨è¿™ä¸ªCPUä¸Šæ‰§è¡Œã€‚</p><p>page-faultsï¼šç¼ºé¡µå¼‚å¸¸çš„æ¬¡æ•°ã€‚å½“åº”ç”¨ç¨‹åºè¯·æ±‚çš„é¡µé¢å°šæœªå»ºç«‹ã€è¯·æ±‚çš„é¡µé¢ä¸åœ¨å†…å­˜ä¸­ï¼Œæˆ–è€…è¯·æ±‚çš„é¡µé¢è™½ç„¶åœ¨å†…å­˜ä¸­ï¼Œä½†ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€çš„æ˜ å°„å…³ç³»å°šæœªå»ºç«‹æ—¶ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡ç¼ºé¡µå¼‚å¸¸ã€‚å¦å¤–TLBä¸å‘½ä¸­ï¼Œé¡µé¢è®¿é—®æƒé™ä¸åŒ¹é…ç­‰æƒ…å†µä¹Ÿä¼šè§¦å‘ç¼ºé¡µå¼‚å¸¸ã€‚</p><p>cyclesï¼šæ¶ˆè€—çš„å¤„ç†å™¨å‘¨æœŸæ•°ã€‚å¦‚æœæŠŠè¢«lsä½¿ç”¨çš„cpu cyclesçœ‹æˆæ˜¯ä¸€ä¸ªå¤„ç†å™¨çš„ï¼Œé‚£ä¹ˆå®ƒçš„ä¸»é¢‘ä¸º2.486GHzã€‚å¯ä»¥ç”¨cycles &#x2F; task-clockç®—å‡ºã€‚</p><p>stalled-cycles-frontendï¼šæŒ‡ä»¤è¯»å–æˆ–è§£ç çš„è´¨é‡æ­¥éª¤ï¼Œæœªèƒ½æŒ‰ç†æƒ³çŠ¶æ€å‘æŒ¥å¹¶è¡Œå·¦å³ï¼Œå‘ç”Ÿåœæ»çš„æ—¶é’Ÿå‘¨æœŸã€‚</p><p>stalled-cycles-backendï¼šæŒ‡ä»¤æ‰§è¡Œæ­¥éª¤ï¼Œå‘ç”Ÿåœæ»çš„æ—¶é’Ÿå‘¨æœŸã€‚</p><p>instructionsï¼šæ‰§è¡Œäº†å¤šå°‘æ¡æŒ‡ä»¤ã€‚IPCä¸ºå¹³å‡æ¯ä¸ªcpu cycleæ‰§è¡Œäº†å¤šå°‘æ¡æŒ‡ä»¤ã€‚</p><p>branchesï¼šé‡åˆ°çš„åˆ†æ”¯æŒ‡ä»¤æ•°ã€‚branch-missesæ˜¯é¢„æµ‹é”™è¯¯çš„åˆ†æ”¯æŒ‡ä»¤æ•°ã€‚</p><h2 id="3-4-perf-record-amp-report"><a href="#3-4-perf-record-amp-report" class="headerlink" title="3.4 perf record &amp; report"></a>3.4 perf record &amp; report</h2><p>è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶å°†å…¶æ•°æ®ä¿å­˜åˆ°perf.dataä¸­ã€‚éšåï¼Œå¯ä»¥ä½¿ç”¨perf reportè¿›è¡Œåˆ†æã€‚</p><p>perf recordå’Œperf reportå¯ä»¥æ›´ç²¾ç¡®çš„åˆ†æä¸€ä¸ªåº”ç”¨ï¼Œperf recordå¯ä»¥ç²¾ç¡®åˆ°å‡½æ•°çº§åˆ«ã€‚å¹¶ä¸”åœ¨å‡½æ•°é‡Œé¢æ··åˆæ˜¾ç¤ºæ±‡ç¼–è¯­è¨€å’Œä»£ç ã€‚</p><p><img src="/2022/01/19/tool003/image-20220119123152290.png"></p><p>1.ç¼–è¯‘ç¨‹åº(è¿™é‡Œä»¥test.cä¸ºä¾‹å­)</p><p><img src="/2022/01/19/tool003/image-20220119124049654.png"></p><p>2.perf record</p><p><img src="/2022/01/19/tool003/image-20220119124217563.png"></p><p>3.perf report</p><p><img src="/2022/01/19/tool003/image-20220119124149337.png"></p><p><img src="/2022/01/19/tool003/image-20220119124013315.png"></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://www.cnblogs.com/arnoldlu/p/6241297.html">ç³»ç»Ÿçº§æ€§èƒ½åˆ†æå·¥å…·perfçš„ä»‹ç»ä¸ä½¿ç”¨ - ArnoldLu - åšå®¢å›­ (cnblogs.com)</a>-ç³»ç»Ÿæ€§èƒ½åˆ†æå·¥å…·perfçš„ä»‹ç»ä¸ä½¿ç”¨</p><p><a href="https://www.bilibili.com/video/BV1MK4y1m7Uj?from=search&seid=11304698501320722134&spm_id_from=333.337.0.0">å¦‚ä½•ä½¿ç”¨gcovå’Œperfå·¥å…·æŠ“çƒ­ç‚¹ä»£ç  - é™ˆå°æ¬§ - 20210331 - PLCTå®éªŒå®¤_å“”å“©å“”å“©_bilibili</a>-å¦‚ä½•ä½¿ç”¨gcovå’Œperfå·¥å…·æŠ“çƒ­ç‚¹ä»£ç  - é™ˆå°æ¬§ - 20210331 - PLCTå®éªŒå®¤</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½åˆ†æå·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gcovä»£ç è¦†ç›–ç‡æµ‹è¯•</title>
    <link href="/2022/01/18/tool002/"/>
    <url>/2022/01/18/tool002/</url>
    
    <content type="html"><![CDATA[<h1 id="gcovä»£ç è¦†ç›–ç‡æµ‹è¯•"><a href="#gcovä»£ç è¦†ç›–ç‡æµ‹è¯•" class="headerlink" title="gcovä»£ç è¦†ç›–ç‡æµ‹è¯•"></a>gcovä»£ç è¦†ç›–ç‡æµ‹è¯•</h1><h2 id="gcovçš„ç®€å•ä»‹ç»"><a href="#gcovçš„ç®€å•ä»‹ç»" class="headerlink" title="gcovçš„ç®€å•ä»‹ç»"></a>gcovçš„ç®€å•ä»‹ç»</h2><p>1.gcovæ˜¯ä¸€ä¸ªæµ‹è¯•ä»£ç è¦†ç›–ç‡çš„å·¥å…·ã€‚ä¸GCCä¸€èµ·ä½¿ç”¨æ¥åˆ†æç¨‹åºï¼Œä»¥å¸®åŠ©åˆ›å»ºæ›´é«˜æ•ˆã€æ›´å¿«çš„è¿è¡Œä»£ç ï¼Œå¹¶å‘ç°ç¨‹åºçš„æœªæµ‹è¯•éƒ¨åˆ†<br>2.æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œæ–¹å¼çš„æ§åˆ¶å°ç¨‹åºã€‚éœ€è¦ç»“åˆlcov,gcovrç­‰å‰ç«¯å›¾å½¢å·¥å…·æ‰èƒ½å®ç°ç»Ÿè®¡æ•°æ®å›¾å½¢åŒ–<br>3.ä¼´éšGCCå‘å¸ƒï¼Œä¸éœ€è¦å•ç‹¬ä¸‹è½½gcovå·¥å…·ã€‚é…åˆGCCå…±åŒå®ç°å¯¹c&#x2F;c++æ–‡ä»¶çš„è¯­å¥è¦†ç›–å’Œåˆ†æ”¯è¦†ç›–æµ‹è¯•<br>4.ä¸ç¨‹åºæ¦‚è¦åˆ†æå·¥å…·ï¼ˆprofiling toolï¼Œä¾‹å¦‚gprofï¼‰ä¸€èµ·å·¥ä½œï¼Œå¯ä»¥ä¼°è®¡ç¨‹åºä¸­å“ªæ®µä»£ç æœ€è€—æ—¶</p><h2 id="gcovèƒ½åšä»€ä¹ˆ"><a href="#gcovèƒ½åšä»€ä¹ˆ" class="headerlink" title="gcovèƒ½åšä»€ä¹ˆ"></a>gcovèƒ½åšä»€ä¹ˆ</h2><p>ä½¿ç”¨åƒgcovæˆ–gprofè¿™æ ·çš„åˆ†æå™¨ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€äº›åŸºæœ¬çš„æ€§èƒ½ç»Ÿè®¡æ•°æ®ï¼š</p><ul><li>æ¯ä¸€è¡Œä»£ç æ‰§è¡Œçš„é¢‘ç‡æ˜¯å¤šå°‘</li><li>å®é™…æ‰§è¡Œäº†å“ªäº›è¡Œä»£ç ï¼Œé…åˆæµ‹è¯•ç”¨ä¾‹è¾¾åˆ°æ»¡æ„çš„è¦†ç›–ç‡å’Œé¢„æœŸå·¥ä½œ</li><li>æ¯æ®µä»£ç ä½¿ç”¨äº†å¤šå°‘è®¡ç®—æ—¶é—´ï¼Œä»è€Œæ‰¾åˆ°çƒ­ç‚¹ä¼˜åŒ–ä»£ç </li><li>gcovåˆ›å»ºä¸€ä¸ªsourcefile.gcovçš„æ—¥å¿—æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶æ ‡è¯†æºæ–‡ä»¶sourcefile.cæ¯ä¸€è¡Œæ‰§è¡Œçš„æ¬¡æ•°,æ‚¨å¯ä»¥ä¸gprofä¸€èµ·ä½¿ç”¨è¿™äº›æ—¥å¿—æ–‡ä»¶æ¥å¸®åŠ©ä¼˜åŒ–ç¨‹åºçš„æ€§èƒ½ã€‚gprofæä¾›äº†æ‚¨å¯ä»¥ä½¿ç”¨çš„æ—¶é—´ä¿¡æ¯ä»¥åŠä»gcovè·å¾—çš„ä¿¡æ¯ã€‚</li></ul><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>1.é€šè¿‡å°†ä¸€äº›ä»£ç è¡Œåˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¯èƒ½ä¸ä¼šæä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥æŸ¥æ‰¾ä»£ç ä½¿ç”¨å¤§é‡è®¡ç®—æœºæ—¶é—´çš„â€œçƒ­ç‚¹â€ã€‚åŒæ ·åœ°ï¼Œç”±äºgcovæŒ‰è¡Œ(åœ¨æœ€ä½çš„åˆ†è¾¨ç‡ä¸‹)ç§¯ç´¯ç»Ÿè®¡æ•°æ®ï¼Œå®ƒæœ€é€‚åˆäºåªåœ¨æ¯è¡Œä¸Šæ”¾ç½®ä¸€ä¸ªè¯­å¥çš„ç¼–ç¨‹é£æ ¼ã€‚å¦‚æœæ‚¨ä½¿ç”¨æ‰©å±•åˆ°å¾ªç¯æˆ–å…¶ä»–æ§åˆ¶ç»“æ„çš„å¤æ‚å®ï¼Œé‚£ä¹ˆç»Ÿè®¡ä¿¡æ¯å°±æ²¡æœ‰é‚£ä¹ˆæœ‰ç”¨äº†â€”â€”å®ƒä»¬åªæŠ¥å‘Šå‡ºç°å®è°ƒç”¨çš„è¡Œã€‚å¦‚æœæ‚¨çš„å¤æ‚å®çš„è¡Œä¸ºç±»ä¼¼äºå‡½æ•°ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ç”¨inline fuæ›¿æ¢å®ƒä»¬ã€‚<br>2.gcovåªåœ¨ä½¿ç”¨GCCç¼–è¯‘çš„ä»£ç ä¸Šå·¥ä½œã€‚å®ƒä¸ä»»ä½•å…¶ä»–æ¦‚è¦æˆ–æµ‹è¯•è¦†ç›–æœºåˆ¶ä¸å…¼å®¹ã€‚</p><h2 id="ä½¿ç”¨gcovçš„3ä¸ªé˜¶æ®µ"><a href="#ä½¿ç”¨gcovçš„3ä¸ªé˜¶æ®µ" class="headerlink" title="ä½¿ç”¨gcovçš„3ä¸ªé˜¶æ®µ"></a>ä½¿ç”¨gcovçš„3ä¸ªé˜¶æ®µ</h2><h3 id="1-ç¼–è¯‘é˜¶æ®µ"><a href="#1-ç¼–è¯‘é˜¶æ®µ" class="headerlink" title="1.ç¼–è¯‘é˜¶æ®µ"></a>1.ç¼–è¯‘é˜¶æ®µ</h3><p>è¦å¼€å¯gcovåŠŸèƒ½ï¼Œéœ€è¦åœ¨æºç ç¼–è¯‘å‚æ•°ä¸­åŠ å…¥-fprofile-arcs -ftest-coverage</p><ul><li>-ftest-coverageï¼šåœ¨ç¼–è¯‘çš„æ—¶å€™äº§ç”Ÿ.gcnoæ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†é‡å»ºåŸºæœ¬å—å›¾å’Œç›¸åº”çš„å—çš„æºç çš„è¡Œå·çš„ä¿¡æ¯ã€‚</li><li>-fprofile-arcsï¼šåœ¨è¿è¡Œç¼–è¯‘è¿‡çš„ç¨‹åºçš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿ.gcdaæ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†å¼§è·³å˜çš„æ¬¡æ•°ç­‰ä¿¡æ¯ã€‚</li></ul><p>ä»¥ä¸‹æˆ‘ä»¬ä»¥test.cè¿™ä¸ªç¨‹åºä¸ºä¾‹å­ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> n=<span class="hljs-number">4</span>;<br><span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;n;i++)<br>&#123;<br>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World!\n&quot;</span>);<br>&#125;<br><span class="hljs-keyword">int</span> a =<span class="hljs-number">20220118</span>;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,a);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>ç¼–è¯‘é˜¶æ®µï¼š</strong></p><p><img src="/2022/01/18/tool002/image-20220118145007919.png"></p><h3 id="2-gcovæ”¶é›†ä»£ç è¿è¡Œä¿¡æ¯"><a href="#2-gcovæ”¶é›†ä»£ç è¿è¡Œä¿¡æ¯" class="headerlink" title="2. gcovæ”¶é›†ä»£ç è¿è¡Œä¿¡æ¯"></a>2. gcovæ”¶é›†ä»£ç è¿è¡Œä¿¡æ¯</h3><ul><li>è¿è¡Œ<code>./test</code>äº§ç”Ÿ<code>test.gcda</code>æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†ä»£ç åŸºæœ¬å—å’Œç‹è·³å˜æ¬¡æ•°ç»Ÿè®¡ä¿¡æ¯</li></ul><p><img src="/2022/01/18/tool002/image-20220118145103922.png"></p><h4 id="3-ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š"><a href="#3-ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š" class="headerlink" title="3. ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š"></a>3. ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š</h4><ul><li>å†æ¬¡è¿è¡Œ<code>gcov test.c</code>äº§ç”Ÿçš„<code>test.c.gcov</code>ä¸­åŒ…å«äº†ä»£ç è¦†ç›–ç‡æ•°æ®,å…¶æ•°æ®çš„æ¥æºä¸º<code>test.gcda</code></li></ul><p><img src="/2022/01/18/tool002/image-20220118145303290.png"></p><h3 id="4-æŸ¥çœ‹ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š"><a href="#4-æŸ¥çœ‹ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š" class="headerlink" title="4.æŸ¥çœ‹ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š"></a>4.æŸ¥çœ‹ç”Ÿæˆgcovä»£ç è¦†ç›–ç‡æŠ¥å‘Š</h3><p><img src="/2022/01/18/tool002/image-20220118145514099.png"></p><p>å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ç»“æœï¼š</p><ul><li>å…¶ä¸­<code>#####</code>è¡¨ç¤ºæœªè¿è¡Œçš„è¡Œ</li><li>æ¯è¡Œå‰é¢çš„æ•°å­—è¡¨ç¤ºè¡Œè¿è¡Œçš„æ¬¡æ•°</li><li>â€”ä»£è¡¨ä¸å¿…æ‰§è¡Œ</li></ul><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c">-:    <span class="hljs-number">0</span>:Source:test.c<br>-:    <span class="hljs-number">0</span>:Graph:test.gcno<br>-:    <span class="hljs-number">0</span>:Data:test.gcda<br>-:    <span class="hljs-number">0</span>:Runs:<span class="hljs-number">1</span><br>-:    <span class="hljs-number">0</span>:Programs:<span class="hljs-number">1</span><br>-:    <span class="hljs-number">1</span>:<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-number">1</span>:    <span class="hljs-number">2</span>:<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function">-:    3:</span>&#123;<br><span class="hljs-number">1</span>:    <span class="hljs-number">4</span>:        <span class="hljs-keyword">int</span> n=<span class="hljs-number">4</span>;<br><span class="hljs-number">1</span>:    <span class="hljs-number">5</span>:        <span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br><span class="hljs-number">5</span>:    <span class="hljs-number">6</span>:        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;n;i++)<br>-:    <span class="hljs-number">7</span>:        &#123;<br><span class="hljs-number">4</span>:    <span class="hljs-number">8</span>:           <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World!\n&quot;</span>);<br>-:    <span class="hljs-number">9</span>:        &#125;<br><span class="hljs-number">1</span>:   <span class="hljs-number">10</span>:        <span class="hljs-keyword">int</span> a =<span class="hljs-number">20220118</span>;<br><span class="hljs-number">1</span>:   <span class="hljs-number">11</span>:        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,a);<br><span class="hljs-number">1</span>:   <span class="hljs-number">12</span>:        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>-:   <span class="hljs-number">13</span>:&#125;<br></code></pre></div></td></tr></table></figure><h2 id="é…åˆlcovä½¿ç”¨ï¼Œå›¾å½¢åŒ–æ˜¾ç¤º"><a href="#é…åˆlcovä½¿ç”¨ï¼Œå›¾å½¢åŒ–æ˜¾ç¤º" class="headerlink" title="é…åˆlcovä½¿ç”¨ï¼Œå›¾å½¢åŒ–æ˜¾ç¤º"></a>é…åˆlcovä½¿ç”¨ï¼Œå›¾å½¢åŒ–æ˜¾ç¤º</h2><p><strong>1.centoså®‰è£…lcov:</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">yum install lcov<br></code></pre></div></td></tr></table></figure><p><strong>2.è¿è¡Œlcovï¼Œç”Ÿæˆç›¸åº”ä¿¡æ¯</strong></p><p><img src="/2022/01/18/tool002/image-20220118151526665.png"></p><p>è¿è¡Œç»“æœï¼š</p><p><img src="/2022/01/18/tool002/image-20220118151553801.png"></p><p><strong>3.ç”Ÿæˆwebå¯è§†åŒ–ä¿¡æ¯</strong></p><p><img src="/2022/01/18/tool002/image-20220118151821325.png"></p><p>è¿è¡Œç»“æœï¼š</p><p><img src="/2022/01/18/tool002/image-20220118151853477.png"></p><p><strong>4.æ‰“åŒ…resultæ–‡ä»¶</strong></p><p><img src="/2022/01/18/tool002/image-20220118152629648.png"></p><p><strong>5.ä»æœåŠ¡å™¨ä¸‹è½½åˆ°æœ¬åœ°</strong></p><p><img src="/2022/01/18/tool002/image-20220118152705023.png"></p><p><strong>6.æŸ¥çœ‹web</strong></p><p>â€‹1ï¼‰æŸ¥çœ‹index.htmlï¼š</p><p><img src="/2022/01/18/tool002/image-20220118152825105.png"></p><p>â€‹2ï¼‰è¯¦ç»†ä¿¡æ¯ï¼š</p><p><img src="/2022/01/18/tool002/image-20220118152908078.png"></p><p>ä¸Šè¿°ç•Œé¢åŒ…å«ï¼š</p><ul><li>å‡½æ•°è¦†ç›–ç‡ï¼ˆæ‰§è¡Œç‡ï¼‰</li><li>ä»£ç è¡Œæ•°è¦†ç›–ç‡ï¼ˆæ‰§è¡Œç‡ï¼‰</li><li>è¯­å¥æ‰§è¡Œæ¬¡æ•°</li><li>æºç çº§çš„è¯¦ç»†ä¿¡æ¯</li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/yanxiangyfg/article/details/80989680">(6æ¡æ¶ˆæ¯) gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-åŸç†å’Œå®è·µæ€»ç»“_yanxiangyfgçš„ä¸“æ -CSDNåšå®¢_gcovä»£ç è¦†ç›–ç‡</a>-gcovä»£ç è¦†ç›–ç‡æµ‹è¯•-åŸç†å’Œå®è·µæ€»ç»“</p><p><a href="https://blog.csdn.net/u012247418/article/details/90137291">(6æ¡æ¶ˆæ¯) ä»£ç è¦†ç›–ç‡æµ‹è¯•å·¥å…·ï¼šgcovå’Œlcovçš„ä½¿ç”¨_ARM-Linux-CSDNåšå®¢</a>-ä»£ç è¦†ç›–ç‡æµ‹è¯•å·¥å…·ï¼šgcovå’Œlcovçš„ä½¿ç”¨</p><p><a href="https://www.cnblogs.com/haoshine/p/5777735.html">linuxæ–‡ä»¶å¤¹æ‰“åŒ…å‘½ä»¤ - å°ä½œä¸€ä¸ª - åšå®¢å›­ (cnblogs.com)</a>-Linuxæ–‡ä»¶æ‰“åŒ…å‘½ä»¤</p><p><a href="https://www.bilibili.com/video/BV1MK4y1m7Uj?from=search&seid=16561916178807634748&spm_id_from=333.337.0.0">å¦‚ä½•ä½¿ç”¨gcovå’Œperfå·¥å…·æŠ“çƒ­ç‚¹ä»£ç  - é™ˆå°æ¬§ - 20210331 - PLCTå®éªŒå®¤_å“”å“©å“”å“©_bilibili</a>-å¦‚ä½•ä½¿ç”¨gcovå’Œperfå·¥å…·æŠ“çƒ­ç‚¹ä»£ç  - é™ˆå°æ¬§ - 20210331 - PLCTå®éªŒå®¤</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½åˆ†æå·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AVXå‘é‡åŒ–å­¦ä¹ (äº”)-INTå‹æ•°ç»„ç›¸åŠ æ“ä½œ</title>
    <link href="/2022/01/17/AVX005/"/>
    <url>/2022/01/17/AVX005/</url>
    
    <content type="html"><![CDATA[<h1 id="AVXå‘é‡åŒ–å­¦ä¹ -äº”-INTå‹æ•°ç»„ç›¸åŠ æ“ä½œ"><a href="#AVXå‘é‡åŒ–å­¦ä¹ -äº”-INTå‹æ•°ç»„ç›¸åŠ æ“ä½œ" class="headerlink" title="AVXå‘é‡åŒ–å­¦ä¹ (äº”)-INTå‹æ•°ç»„ç›¸åŠ æ“ä½œ"></a>AVXå‘é‡åŒ–å­¦ä¹ (äº”)-INTå‹æ•°ç»„ç›¸åŠ æ“ä½œ</h1><p>ä½¿ç”¨AVXæŒ‡ä»¤é›†è¿›è¡Œ2ä¸ªINTå‹çš„æ•°ç»„ç›¸åŠ æ“ä½œ</p><h2 id="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"><a href="#ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»" class="headerlink" title="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"></a>ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256i _mm256_loadu_si256 (__m256i <span class="hljs-keyword">const</span> * mem_addr)<br></code></pre></div></td></tr></table></figure><p><strong>Synopsis</strong></p><p>m256i _mm256_loadu_si256 (m256i const * mem_addr)<br>#include &lt;immintrin.h&gt;<br>Instruction: vmovdqu ymm, m256<br>CPUID Flags: AVX</p><p><strong>Description</strong></p><p>Load 256-bits of integer data from memory into dst. mem_addr does not need to be aligned on any particular boundary.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">dst[<span class="hljs-number">255</span>:<span class="hljs-number">0</span>] := MEM[mem_addr+<span class="hljs-number">255</span>:mem_addr] <br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p><strong>Performance</strong></p><table><thead><tr><th align="left">Architecture</th><th align="center">Latency</th><th align="center">Throughput (CPI)</th></tr></thead><tbody><tr><td align="left">Icelake</td><td align="center">7</td><td align="center">0.5</td></tr><tr><td align="left">Skylake</td><td align="center">7</td><td align="center">0.5</td></tr><tr><td align="left">Broadwell</td><td align="center">1</td><td align="center">0.25</td></tr><tr><td align="left">Haswell</td><td align="center">1</td><td align="center">0.25</td></tr><tr><td align="left">Ivy Bridge</td><td align="center">1</td><td align="center">0.5</td></tr></tbody></table><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256i _mm256_add_epi32 (__m256i a, __m256i b)<br></code></pre></div></td></tr></table></figure><p><strong>Synopsis</strong></p><p>m256i _mm256_add_epi32 (m256i a, __m256i b)<br>#include &lt;immintrin.h&gt;<br>Instruction: vpaddd ymm, ymm, ymm<br>CPUID Flags: AVX2</p><p><strong>Description</strong></p><p>Add packed 32-bit integers in a and b, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">FOR</span> j := <span class="hljs-number">0</span> to <span class="hljs-number">7</span> <br>     <span class="hljs-attribute">i</span> := j*<span class="hljs-number">32</span> <br>     <span class="hljs-attribute">dst</span>[i+<span class="hljs-number">31</span>:i] := a[i+<span class="hljs-number">31</span>:i] + b[i+<span class="hljs-number">31</span>:i] <br><span class="hljs-attribute">ENDFOR</span> <br><span class="hljs-attribute">dst</span>[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p><strong>Performance</strong></p><table><thead><tr><th align="left">Architecture</th><th align="center">Latency</th><th align="center">Throughput (CPI)</th></tr></thead><tbody><tr><td align="left">Icelake</td><td align="center">1</td><td align="center">0.33</td></tr><tr><td align="left">Skylake</td><td align="center">1</td><td align="center">0.33</td></tr><tr><td align="left">Broadwell</td><td align="center">1</td><td align="center">0.5</td></tr><tr><td align="left">Haswell</td><td align="center">1</td><td align="center">0.5</td></tr></tbody></table><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> a[<span class="hljs-number">40</span>];<br><span class="hljs-keyword">int</span> b[<span class="hljs-number">40</span>];<br><span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">int</span> ans1[<span class="hljs-number">40</span>];    <span class="hljs-comment">//è®°å½•ä¸²è¡Œç»“æœ </span><br><span class="hljs-keyword">int</span> ans2[<span class="hljs-number">40</span>]; <span class="hljs-comment">//è®°å½•AVXå‘é‡åŒ–åçš„ç»“æœ</span><br><span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span>;i++)<br>&#123;<br>a[i]=i;<br>b[i]=<span class="hljs-number">2</span>*i;<br>&#125;<br><span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span>;i++)<br>&#123;<br>ans1[i]=a[i]+b[i];<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ä¸²è¡Œè®¡ç®—ç»“æœï¼š\n&quot;</span>);<br><span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,ans1[i]);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>__m256i v0;<br>__m256i v1;<br>__m256i v2;<br><span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span><span class="hljs-number">-8</span>;i+=<span class="hljs-number">8</span>)<br>&#123;<br>v0 = _mm256_loadu_si256((<span class="hljs-keyword">const</span> __m256i*)(a+i)); <span class="hljs-comment">//å¼ºåˆ¶ç±»å‹è½¬æ¢</span><br>v1 = _mm256_loadu_si256((<span class="hljs-keyword">const</span> __m256i*)(b+i)); <span class="hljs-comment">//å¼ºåˆ¶ç±»å‹è½¬åŒ–</span><br>v2 = _mm256_add_epi32(v0,v1);     <span class="hljs-comment">//v0+v1</span><br>_mm256_storeu_si256((__m256i*)(ans2+i),v2);<br><br>&#125;<span class="hljs-comment">//è¾¹ç•Œå¤„ç†</span><br><span class="hljs-keyword">for</span> (;i&lt;<span class="hljs-number">40</span>;i++)<br>&#123;<br>ans2[i]=a[i]+b[i];<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;å¹¶è¡Œè®¡ç®—ç»“æœï¼š\n&quot;</span>);<br><span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,ans2[i]);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">ä¸²è¡Œè®¡ç®—ç»“æœï¼š<br><span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">6</span> <span class="hljs-number">9</span> <span class="hljs-number">12</span> <span class="hljs-number">15</span> <span class="hljs-number">18</span> <span class="hljs-number">21</span> <span class="hljs-number">24</span> <span class="hljs-number">27</span> <span class="hljs-number">30</span> <span class="hljs-number">33</span> <span class="hljs-number">36</span> <span class="hljs-number">39</span> <span class="hljs-number">42</span> <span class="hljs-number">45</span> <span class="hljs-number">48</span> <span class="hljs-number">51</span> <span class="hljs-number">54</span> <span class="hljs-number">57</span> <span class="hljs-number">60</span> <span class="hljs-number">63</span> <span class="hljs-number">66</span> <span class="hljs-number">69</span> <span class="hljs-number">72</span> <span class="hljs-number">75</span> <span class="hljs-number">78</span> <span class="hljs-number">81</span> <span class="hljs-number">84</span> <span class="hljs-number">87</span> <span class="hljs-number">90</span> <span class="hljs-number">93</span> <span class="hljs-number">96</span> <span class="hljs-number">99</span> <span class="hljs-number">102</span> <span class="hljs-number">105</span> <span class="hljs-number">108</span> <span class="hljs-number">111</span> <span class="hljs-number">114</span> <span class="hljs-number">117</span><br>å¹¶è¡Œè®¡ç®—ç»“æœï¼š<br><span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">6</span> <span class="hljs-number">9</span> <span class="hljs-number">12</span> <span class="hljs-number">15</span> <span class="hljs-number">18</span> <span class="hljs-number">21</span> <span class="hljs-number">24</span> <span class="hljs-number">27</span> <span class="hljs-number">30</span> <span class="hljs-number">33</span> <span class="hljs-number">36</span> <span class="hljs-number">39</span> <span class="hljs-number">42</span> <span class="hljs-number">45</span> <span class="hljs-number">48</span> <span class="hljs-number">51</span> <span class="hljs-number">54</span> <span class="hljs-number">57</span> <span class="hljs-number">60</span> <span class="hljs-number">63</span> <span class="hljs-number">66</span> <span class="hljs-number">69</span> <span class="hljs-number">72</span> <span class="hljs-number">75</span> <span class="hljs-number">78</span> <span class="hljs-number">81</span> <span class="hljs-number">84</span> <span class="hljs-number">87</span> <span class="hljs-number">90</span> <span class="hljs-number">93</span> <span class="hljs-number">96</span> <span class="hljs-number">99</span> <span class="hljs-number">102</span> <span class="hljs-number">105</span> <span class="hljs-number">108</span> <span class="hljs-number">111</span> <span class="hljs-number">114</span> <span class="hljs-number">117</span><br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p>[<a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/]">https://software.intel.com/sites/landingpage/IntrinsicsGuide/]</a>: â€œ IntelÂ® Intrinsics Guideâ€</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AVX</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AVXå‘é‡åŒ–å­¦ä¹ (å››)-INTç±»å‹è½¬åŒ–æˆDOUBLEç±»å‹</title>
    <link href="/2022/01/17/AVX004/"/>
    <url>/2022/01/17/AVX004/</url>
    
    <content type="html"><![CDATA[<h1 id="AVXå‘é‡åŒ–å­¦ä¹ -å››-INTç±»å‹è½¬åŒ–æˆDOUBLEç±»å‹"><a href="#AVXå‘é‡åŒ–å­¦ä¹ -å››-INTç±»å‹è½¬åŒ–æˆDOUBLEç±»å‹" class="headerlink" title="AVXå‘é‡åŒ–å­¦ä¹ (å››)-INTç±»å‹è½¬åŒ–æˆDOUBLEç±»å‹"></a>AVXå‘é‡åŒ–å­¦ä¹ (å››)-INTç±»å‹è½¬åŒ–æˆDOUBLEç±»å‹</h1><p>ä½¿ç”¨AVXæŒ‡ä»¤é›†æŠŠINTç±»å‹è½¬åŒ–ä¸ºDOUBLEç±»å‹</p><h2 id="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"><a href="#ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»" class="headerlink" title="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"></a>ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m128i _mm_setr_epi32 (<span class="hljs-keyword">int</span> e3, <span class="hljs-keyword">int</span> e2, <span class="hljs-keyword">int</span> e1, <span class="hljs-keyword">int</span> e0)<br></code></pre></div></td></tr></table></figure><p><strong>Synopsis</strong></p><p>__m128i _mm_setr_epi32 (int e3, int e2, int e1, int e0)<br>#include &lt;emmintrin.h&gt;<br>Instruction: <strong>Sequence</strong><br>CPUID Flags: SSE2</p><p><strong>Description</strong></p><p>Set packed 32-bit integers in dst with the supplied values in reverse order.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">dst[<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] := e3 <br>dst[<span class="hljs-number">63</span>:<span class="hljs-number">32</span>] := e2 <br>dst[<span class="hljs-number">95</span>:<span class="hljs-number">64</span>] := e1 <br>dst[<span class="hljs-number">127</span>:<span class="hljs-number">96</span>] := e0<br></code></pre></div></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256d _mm256_cvtepi32_pd (__m128i a)<br></code></pre></div></td></tr></table></figure><p><strong>Synopsis</strong></p><p>m256d _mm256_cvtepi32_pd (m128i a)<br>#include &lt;immintrin.h&gt;<br>Instruction: vcvtdq2pd ymm, xmm<br>CPUID Flags: AVX</p><p><strong>Description</strong></p><p>Convert packed signed 32-bit integers in a to packed double-precision (64-bit) floating-point elements, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">FOR j := <span class="hljs-number">0</span> to <span class="hljs-number">3</span> <br>    i := j*<span class="hljs-number">32</span> <br>    m := j*<span class="hljs-number">64</span> <br>    dst[m+<span class="hljs-number">63</span>:m] := <span class="hljs-built_in">Convert_Int32_To_FP64</span>(a[i+<span class="hljs-number">31</span>:i]) <br>ENDFOR <br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p><strong>Performance</strong></p><table><thead><tr><th align="left">Architecture</th><th align="center">Latency</th><th align="center">Throughput (CPI)</th></tr></thead><tbody><tr><td align="left">Icelake</td><td align="center">7</td><td align="center">1</td></tr><tr><td align="left">Skylake</td><td align="center">7</td><td align="center">1</td></tr><tr><td align="left">Broadwell</td><td align="center">6</td><td align="center">1</td></tr><tr><td align="left">Haswell</td><td align="center">6</td><td align="center">1</td></tr><tr><td align="left">Ivy Bridge</td><td align="center">4</td><td align="center">1</td></tr></tbody></table><h2 id="ç¨‹åºè¿è¡Œå¹³å°"><a href="#ç¨‹åºè¿è¡Œå¹³å°" class="headerlink" title="ç¨‹åºè¿è¡Œå¹³å°"></a>ç¨‹åºè¿è¡Œå¹³å°</h2><p>åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒA3åˆ†åŒº</p><h2 id="ç¼–è¯‘æŒ‡ä»¤"><a href="#ç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="ç¼–è¯‘æŒ‡ä»¤"></a>ç¼–è¯‘æŒ‡ä»¤</h2><p>g++ int_to_double.cpp -msse2 -mavx -o test01</p><h2 id="è¿è¡ŒæŒ‡ä»¤"><a href="#è¿è¡ŒæŒ‡ä»¤" class="headerlink" title="è¿è¡ŒæŒ‡ä»¤"></a>è¿è¡ŒæŒ‡ä»¤</h2><p>.&#x2F;test01</p><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> a[<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;<br><span class="hljs-keyword">double</span> b[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>    __m128i x = _mm_setr_epi32(a[<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">2</span>],a[<span class="hljs-number">3</span>]);   <span class="hljs-comment">//load</span><br> __m256d v5=_mm256_cvtepi32_pd(x);       <span class="hljs-comment">//convert</span><br>    _mm256_storeu_pd(b,v5);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>    &#123;<br>    cout&lt;&lt;b[i]&lt;&lt;endl;<br>&#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br><span class="hljs-number">0</span><br><span class="hljs-number">0</span><br><span class="hljs-number">0</span><br><span class="hljs-number">0</span><br><span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p>[<a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/]">https://software.intel.com/sites/landingpage/IntrinsicsGuide/]</a>: â€œ IntelÂ® Intrinsics Guideâ€</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AVX</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gprofã€gprof2dot.pyã€dotä½¿ç”¨æ–¹æ³•ç®€ä»‹</title>
    <link href="/2022/01/09/tool001/"/>
    <url>/2022/01/09/tool001/</url>
    
    <content type="html"><![CDATA[<h1 id="gprofã€gprof2dot-pyã€dotä½¿ç”¨æ–¹æ³•ç®€ä»‹"><a href="#gprofã€gprof2dot-pyã€dotä½¿ç”¨æ–¹æ³•ç®€ä»‹" class="headerlink" title="gprofã€gprof2dot.pyã€dotä½¿ç”¨æ–¹æ³•ç®€ä»‹"></a>gprofã€gprof2dot.pyã€dotä½¿ç”¨æ–¹æ³•ç®€ä»‹</h1><h2 id="1-ï¼šgprofä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼Œä»¥SLICä¸ºä¾‹ï¼š"><a href="#1-ï¼šgprofä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼Œä»¥SLICä¸ºä¾‹ï¼š" class="headerlink" title="(1)ï¼šgprofä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼Œä»¥SLICä¸ºä¾‹ï¼š"></a>(1)ï¼šgprofä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼Œä»¥SLICä¸ºä¾‹ï¼š</h2><h3 id="1-åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ·»åŠ -pgé€‰é¡¹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š"><a href="#1-åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ·»åŠ -pgé€‰é¡¹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š" class="headerlink" title="1 åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ·»åŠ -pgé€‰é¡¹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š"></a>1 åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ·»åŠ -pgé€‰é¡¹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">gcc -pg SLIC.cpp -o SLIC<br></code></pre></div></td></tr></table></figure><h3 id="2-è¿è¡Œç¨‹åºï¼Œè¿è¡Œç»“æŸä¹‹åä¼šå½¢æˆæ–‡ä»¶gmon-outï¼Œå‘½ä»¤å¦‚ä¸‹"><a href="#2-è¿è¡Œç¨‹åºï¼Œè¿è¡Œç»“æŸä¹‹åä¼šå½¢æˆæ–‡ä»¶gmon-outï¼Œå‘½ä»¤å¦‚ä¸‹" class="headerlink" title="2 è¿è¡Œç¨‹åºï¼Œè¿è¡Œç»“æŸä¹‹åä¼šå½¢æˆæ–‡ä»¶gmon.outï¼Œå‘½ä»¤å¦‚ä¸‹:"></a>2 è¿è¡Œç¨‹åºï¼Œè¿è¡Œç»“æŸä¹‹åä¼šå½¢æˆæ–‡ä»¶gmon.outï¼Œå‘½ä»¤å¦‚ä¸‹:</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-string">./SLIC</span><br></code></pre></div></td></tr></table></figure><h3 id="3-ä½¿ç”¨gprofå†æ¬¡æ‰§è¡Œç¨‹åºï¼Œå¹¶å°†ç»“æœé‡å®šä½åˆ°prof-logä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š"><a href="#3-ä½¿ç”¨gprofå†æ¬¡æ‰§è¡Œç¨‹åºï¼Œå¹¶å°†ç»“æœé‡å®šä½åˆ°prof-logä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š" class="headerlink" title="3 ä½¿ç”¨gprofå†æ¬¡æ‰§è¡Œç¨‹åºï¼Œå¹¶å°†ç»“æœé‡å®šä½åˆ°prof.logä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š"></a>3 ä½¿ç”¨gprofå†æ¬¡æ‰§è¡Œç¨‹åºï¼Œå¹¶å°†ç»“æœé‡å®šä½åˆ°prof.logä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</h3><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">gprof ./SLIC &gt; <span class="hljs-keyword">prof</span>.<span class="hljs-built_in">log</span><br></code></pre></div></td></tr></table></figure><p>åˆ†æprof.logå°±å¯ä»¥è·å¾—ç¨‹åºçš„è°ƒç”¨å…³ç³»ã€å‡½æ•°æ‰§è¡Œæ—¶é—´ç­‰ä¿¡æ¯ã€‚å¯¹gprofçš„åˆ†ææ–¹æ³•è§ä»¥ä¸‹blog</p><p><a href="http://blog.csdn.net/macky0668/article/details/6839517">http://blog.csdn.net/macky0668/article/details/6839517</a></p><h2 id="2-ï¼šé…åˆgprof2dot-pyä¸dotå·¥å…·çš„ä½¿ç”¨-æˆ‘æ˜¯å®‰è£…åœ¨äº†Win10å¹³å°"><a href="#2-ï¼šé…åˆgprof2dot-pyä¸dotå·¥å…·çš„ä½¿ç”¨-æˆ‘æ˜¯å®‰è£…åœ¨äº†Win10å¹³å°" class="headerlink" title="(2)ï¼šé…åˆgprof2dot.pyä¸dotå·¥å…·çš„ä½¿ç”¨(æˆ‘æ˜¯å®‰è£…åœ¨äº†Win10å¹³å°)"></a>(2)ï¼šé…åˆ<em>gprof2dot.py</em>ä¸dotå·¥å…·çš„ä½¿ç”¨(æˆ‘æ˜¯å®‰è£…åœ¨äº†Win10å¹³å°)</h2><p>ä»¥ä¸Šæ–¹æ³•ä»ç„¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯åˆ†æç»“æœä¸å¤Ÿç›´è§‚ï¼Œç‰¹åˆ«æ˜¯å‡½æ•°çš„è°ƒç”¨å…³ç³»ã€‚å› æ­¤ä¸ºè§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œå¯ä»¥é…åˆ<em>gprof2dot.py</em>ä¸dotå·¥å…·çš„ä½¿ç”¨ã€‚</p><h3 id="1-å®‰è£…gprof2dot-pyä¸dot"><a href="#1-å®‰è£…gprof2dot-pyä¸dot" class="headerlink" title="1.å®‰è£…gprof2dot.pyä¸dot"></a>1.å®‰è£…<em>gprof2dot.py</em>ä¸dot</h3><p><a href="https://github.com/jrfonseca/gprof2dot">GitHub - jrfonseca&#x2F;gprof2dot: Converts profiling output to a dot graph.</a></p><h3 id="2-é€šè¿‡ä»¥ä¸‹åœ°å€å¯è·å¾—graphvizï¼Œå®‰è£…graphvizåå¯ä½¿ç”¨dotå·¥å…·"><a href="#2-é€šè¿‡ä»¥ä¸‹åœ°å€å¯è·å¾—graphvizï¼Œå®‰è£…graphvizåå¯ä½¿ç”¨dotå·¥å…·" class="headerlink" title="2.é€šè¿‡ä»¥ä¸‹åœ°å€å¯è·å¾—graphvizï¼Œå®‰è£…graphvizåå¯ä½¿ç”¨dotå·¥å…·"></a>2.é€šè¿‡ä»¥ä¸‹åœ°å€å¯è·å¾—graphvizï¼Œå®‰è£…graphvizåå¯ä½¿ç”¨dotå·¥å…·</h3><p><a href="https://graphviz.org/download/source/">Source Code | Graphviz</a></p><p>åœ¨ä½¿ç”¨ä¸Šè¿°å·¥å…·å‰ï¼Œè¿˜éœ€è¦å…ˆäº§ç”Ÿprof.logæ–‡ä»¶ï¼Œprof.logæ–‡ä»¶çš„äº§ç”Ÿæ–¹æ³•è§ä¸Šæ–‡ã€‚</p><h3 id="3-é¦–å…ˆé€šè¿‡å‘½ä»¤è¡Œè¿›å…¥ä½ å®‰è£…gprof2dot-pyçš„æ ¹ç›®å½•ï¼š"><a href="#3-é¦–å…ˆé€šè¿‡å‘½ä»¤è¡Œè¿›å…¥ä½ å®‰è£…gprof2dot-pyçš„æ ¹ç›®å½•ï¼š" class="headerlink" title="3.é¦–å…ˆé€šè¿‡å‘½ä»¤è¡Œè¿›å…¥ä½ å®‰è£…gprof2dot.pyçš„æ ¹ç›®å½•ï¼š"></a>3.é¦–å…ˆé€šè¿‡å‘½ä»¤è¡Œè¿›å…¥ä½ å®‰è£…gprof2dot.pyçš„æ ¹ç›®å½•ï¼š</h3><p><img src="/2022/01/09/tool001/image-20220109165659998.png"></p><h3 id="4-é€šè¿‡ä»¥ä¸‹å‘½ä»¤å³å¯å¾—åˆ°å‡½æ•°è°ƒç”¨å›¾ï¼š"><a href="#4-é€šè¿‡ä»¥ä¸‹å‘½ä»¤å³å¯å¾—åˆ°å‡½æ•°è°ƒç”¨å›¾ï¼š" class="headerlink" title="4.é€šè¿‡ä»¥ä¸‹å‘½ä»¤å³å¯å¾—åˆ°å‡½æ•°è°ƒç”¨å›¾ï¼š"></a>4.é€šè¿‡ä»¥ä¸‹å‘½ä»¤å³å¯å¾—åˆ°å‡½æ•°è°ƒç”¨å›¾ï¼š</h3><p><img src="/2022/01/09/tool001/image-20220109170212157.png"></p><h3 id="5-ç»“æœå¦‚ä¸‹ï¼š"><a href="#5-ç»“æœå¦‚ä¸‹ï¼š" class="headerlink" title="5.ç»“æœå¦‚ä¸‹ï¼š"></a>5.ç»“æœå¦‚ä¸‹ï¼š</h3><p><img src="/2022/01/09/tool001/image-20220109170315471.png"></p><h2 id="3-ï¼šæ¥ä¸Šæ–‡è¡¥å……å‡ ç‚¹å¯èƒ½æ— æ³•äº§ç”Ÿgmon-outæ–‡ä»¶çš„æƒ…å†µï¼š"><a href="#3-ï¼šæ¥ä¸Šæ–‡è¡¥å……å‡ ç‚¹å¯èƒ½æ— æ³•äº§ç”Ÿgmon-outæ–‡ä»¶çš„æƒ…å†µï¼š" class="headerlink" title="(3)ï¼šæ¥ä¸Šæ–‡è¡¥å……å‡ ç‚¹å¯èƒ½æ— æ³•äº§ç”Ÿgmon.outæ–‡ä»¶çš„æƒ…å†µï¼š"></a>(3)ï¼šæ¥ä¸Šæ–‡è¡¥å……å‡ ç‚¹å¯èƒ½æ— æ³•äº§ç”Ÿgmon.outæ–‡ä»¶çš„æƒ…å†µï¼š</h2><p>  1.ç¨‹åºä¸æ˜¯ä»main returnæˆ–exit()é€€å‡ºï¼Œåˆ™å¯èƒ½ä¸ç”Ÿæˆgmon.outã€‚<br>  2.ç¨‹åºå¦‚æœå´©æºƒï¼Œå¯èƒ½ä¸ç”Ÿæˆgmon.outã€‚<br>  3.æµ‹è¯•å‘ç°åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Œå¯èƒ½ä¸ç”Ÿæˆgmon.outã€‚<br>  4.ç¨‹åºå¿½ç•¥SIGPROFä¿¡å·ï¼ä¸€å®šä¸èƒ½æ•è·ã€å¿½ç•¥SIGPROFä¿¡å·ã€‚manæ‰‹å†Œå¯¹SIGPROFçš„è§£é‡Šæ˜¯ï¼šprofiling timer expired. å¦‚æœå¿½ç•¥è¿™ä¸ªä¿¡å·ï¼Œgprofçš„è¾“å‡ºåˆ™æ˜¯ï¼šEach sample counts as 0.01 seconds. no time accumulated.<br>  5.å¦‚æœç¨‹åºè¿è¡Œæ—¶é—´éå¸¸çŸ­ï¼Œåˆ™gprofå¯èƒ½æ— æ•ˆ</p><h2 id="å‚è€ƒæ–‡çŒ®ï¼š"><a href="#å‚è€ƒæ–‡çŒ®ï¼š" class="headerlink" title="å‚è€ƒæ–‡çŒ®ï¼š"></a>å‚è€ƒæ–‡çŒ®ï¼š</h2><p><a href="https://blog.csdn.net/u012927281/article/details/51132064">(4æ¡æ¶ˆæ¯) gprofã€gprof2dot.pyã€dotä½¿ç”¨æ–¹æ³•ç®€ä»‹_Andy.Wangçš„åšå®¢-CSDNåšå®¢_gprof2dot</a></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ€§èƒ½åˆ†æå·¥å…·</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶æŸ¥é›†</title>
    <link href="/2022/01/04/Algorithm004/"/>
    <url>/2022/01/04/Algorithm004/</url>
    
    <content type="html"><![CDATA[<h1 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h1><p>å¹¶æŸ¥é›†ï¼ˆDisjoint Setï¼‰æ˜¯ä¸€ç§éå¸¸ç²¾å·§è€Œå®ç”¨çš„æ•°æ®ç»“æ„ã€‚ç”¨äºå¤„ç†ä¸ç›¸äº¤é›†åˆçš„åˆå¹¶é—®é¢˜ã€‚</p><p>å¹¶æŸ¥é›†ç”¨æ¥ç®¡ç†å…ƒç´ åˆ†ç»„æƒ…å†µã€‚å¹¶æŸ¥é›†å¯ä»¥é«˜æ•ˆåœ°è¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚</p><p>1.æŸ¥è¯¢å…ƒç´  aå’Œå…ƒç´  bæ˜¯å¦å±äºåŒä¸€ç»„ã€‚<br>2.åˆå¹¶å…ƒç´  aå’Œå…ƒç´  bæ‰€åœ¨çš„ç»„ã€‚<br><img src="/2022/01/04/Algorithm004/20191114081139557.png"></p><p><img src="/2022/01/04/Algorithm004/20191114081642983-16413015433853.png"></p><h2 id="1-åˆå§‹åŒ–"><a href="#1-åˆå§‹åŒ–" class="headerlink" title="1.åˆå§‹åŒ–"></a>1.åˆå§‹åŒ–</h2><p>æˆ‘ä»¬å‡†å¤‡ nä¸ªèŠ‚ç‚¹æ¥è¡¨ç¤º nä¸ªå…ƒç´ ã€‚æœ€å¼€å§‹æ—¶æ²¡æœ‰è¾¹ã€‚</p><p><img src="/2022/01/04/Algorithm004/20191114081846480.png"></p><h2 id="2-æŸ¥è¯¢"><a href="#2-æŸ¥è¯¢" class="headerlink" title="2.æŸ¥è¯¢"></a>2.æŸ¥è¯¢</h2><p>ä¸ºäº†æŸ¥è¯¢ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦å±äºåŒä¸€ç»„ï¼Œæˆ‘ä»¬éœ€è¦æ²¿ç€æ ‘å‘ä¸Šèµ°ï¼Œæ¥æŸ¥è¯¢åŒ…å«è¿™ä¸ªå…ƒç´ çš„æ ‘çš„æ ¹æ˜¯è°ã€‚å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹èµ°åˆ°äº†åŒä¸€ä¸ªæ ¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥çŸ¥é“å®ƒä»¬å±äºåŒä¸€ç»„ã€‚</p><p>åœ¨ä¸‹å›¾ä¸­ï¼Œå…ƒç´  2 å’Œå…ƒç´  5éƒ½èµ°åˆ°äº†å…ƒç´  1ï¼Œå› æ­¤å®ƒä»¬å±äºåŒä¸€ç»„ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºå…ƒç´  7 èµ°åˆ°çš„æ˜¯å…ƒç´  6ï¼Œå› æ­¤åŒå…ƒç´  2æˆ–å…ƒç´  5 å±äºä¸åŒç»„ã€‚</p><p><img src="/2022/01/04/Algorithm004/20191114082935860.png"></p><h2 id="3-åˆå¹¶"><a href="#3-åˆå¹¶" class="headerlink" title="3.åˆå¹¶"></a>3.åˆå¹¶</h2><p>åƒä¸‹å›¾ä¸€æ ·ï¼Œä»ä¸€ä¸ªç»„çš„æ ¹å‘å¦ä¸€ä¸ªç»„çš„æ ¹è¿è¾¹ï¼Œè¿™æ ·ä¸¤æ£µæ ‘å°±å˜æˆäº†ä¸€æ£µæ ‘ï¼Œ ä¹Ÿå°±æŠŠä¸¤ä¸ªç»„åˆå¹¶ä¸ºä¸€ä¸ªç»„äº†ã€‚</p><p><img src="/2022/01/04/Algorithm004/20191114082505100.png"></p><h2 id="4-è·¯å¾„å‹ç¼©"><a href="#4-è·¯å¾„å‹ç¼©" class="headerlink" title="4.è·¯å¾„å‹ç¼©"></a>4.è·¯å¾„å‹ç¼©</h2><p>ä¸Šé¢çš„æŸ¥è¯¢ç¨‹åº find() æ²¿ç€æœç´¢è·¯å¾„æ‰¾åˆ°æ ¹ç»“ç‚¹ï¼Œè¿™æ¡è·¯å¾„å¯èƒ½å¾ˆé•¿ã€‚</p><p>ä¼˜åŒ–ï¼šæ²¿è·¯å¾„è¿”å›æ—¶ï¼Œé¡ºä¾¿æŠŠ i æ‰€å±çš„é›†æ”¹æˆæ ¹ç»“ç‚¹ã€‚ä¸‹æ¬¡å†æœï¼Œå¤æ‚åº¦æ˜¯ O(1)ã€‚</p><p>è¿™ç§æ–¹æ³•ç§°ä¸ºè·¯å¾„å‹ç¼©ï¼Œåœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªæœç´¢è·¯å¾„ä¸Šçš„å…ƒç´ æ‰€å±çš„é›†éƒ½è¢«æ”¹ä¸ºæ ¹ç»“ç‚¹ã€‚</p><p>è·¯å¾„å‹ç¼©çš„æ€æƒ³æ˜¯ï¼Œæˆ‘ä»¬åªå…³å¿ƒæ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼Œè€Œå¹¶ä¸å¤ªå…³å¿ƒæ ‘çš„çœŸæ­£çš„ç»“æ„ã€‚è·¯å¾„å‹ç¼©ä¸ä»…ä¼˜åŒ–äº†ä¸‹æ¬¡æŸ¥è¯¢ï¼Œè€Œä¸”ä¹Ÿä¼˜åŒ–äº†åˆå¹¶ï¼Œå› ä¸ºåˆå¹¶æ—¶ä¹Ÿç”¨åˆ°äº†æŸ¥è¯¢ã€‚<br><img src="/2022/01/04/Algorithm004/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODE1MTg4,size_16,color_FFFFFF,t_70.png"><img src="/2022/01/04/Algorithm004/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyODE1MTg4,size_16,color_FFFFFF,t_70-16413019286669.png"></p><h2 id="5-æŒ‰ç§©åˆå¹¶"><a href="#5-æŒ‰ç§©åˆå¹¶" class="headerlink" title="5.æŒ‰ç§©åˆå¹¶"></a>5.æŒ‰ç§©åˆå¹¶</h2><p>åˆå¹¶å…ƒç´  x å’Œ y æ—¶ï¼Œå…ˆæœåˆ°å®ƒä»¬çš„æ ¹ç»“ç‚¹ï¼›<br>åˆå¹¶è¿™ä¸¤ä¸ªæ ¹ç»“ç‚¹ï¼šæŠŠä¸€ä¸ªæ ¹ç»“ç‚¹çš„é›†æ”¹æˆå¦ä¸€ä¸ªæ ¹ç»“ç‚¹ã€‚<br>è¿™ä¸¤ä¸ªæ ¹ç»“ç‚¹çš„é«˜åº¦ä¸åŒï¼ŒæŠŠé«˜åº¦è¾ƒå°çš„é›†åˆå¹¶åˆ°è¾ƒå¤§çš„é›†ä¸Šï¼Œèƒ½å‡å°‘æ ‘çš„é«˜åº¦ã€‚</p><p><img src="/2022/01/04/Algorithm004/20191114090118888.png"></p><p>è¿™æ ·ï¼Œåœ¨åˆå§‹åŒ–æ—¶å°±è¦ç”¨ä¸€ä¸ªæ•°ç»„å®šä¹‰å…ƒç´  içš„é«˜åº¦ï¼Œåœ¨åˆå¹¶æ—¶æ›´æ”¹ã€‚</p><p>ä¸‹é¢ä»£ç åŠ å…¥äº†ä¸Šè¿°ä¸¤ä¸ªä¼˜åŒ–ï¼Œæˆ‘ä»¬ç”¨ç¼–å·ä»£è¡¨æ¯ä¸ªå…ƒç´ ã€‚æ•°ç»„ par[ ]è¡¨ç¤ºçš„æ˜¯çˆ¶äº²çš„ç¼–å·ï¼Œpar[ x ] &#x3D; &#x3D; x  æ—¶ï¼Œx æ˜¯æ‰€åœ¨çš„æ ‘çš„æ ¹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">int</span> par[N];   <span class="hljs-comment">//çˆ¶äº²</span><br><span class="hljs-keyword">int</span> rank[N];  <span class="hljs-comment">//æ ‘çš„é«˜åº¦</span><br><br><span class="hljs-comment">// åˆå§‹åŒ–nä¸ªå…ƒç´ </span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)<br>&#123;<br>par[i] = i;<br>rank[i] = <span class="hljs-number">0</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-comment">// æŸ¥è¯¢æ ‘çš„æ ¹ï¼ˆè·¯å¾„å‹ç¼©ï¼‰</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(par[x] == x)<br><span class="hljs-keyword">return</span> x;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">return</span> par[x] = <span class="hljs-built_in">find</span>(par[x]);<br>&#125;<br><br><span class="hljs-comment">// åˆå¹¶xå’Œyæ‰€å±çš„é›†åˆï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unite</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>x = <span class="hljs-built_in">find</span>(x);<br>y = <span class="hljs-built_in">find</span>(y);<br><span class="hljs-keyword">if</span>(x == y)  <span class="hljs-keyword">return</span>;<br><br><span class="hljs-keyword">if</span>(rank[x] &lt; rank[y])<br>par[x] = y;<br><span class="hljs-keyword">else</span><br>&#123;<br>par[y] = x;<br><span class="hljs-keyword">if</span>(rank[x] == rank[y])rank[x]++;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ ·é¢˜ä¸€ï¼šL2-024-éƒ¨è½-25-åˆ†"><a href="#æ ·é¢˜ä¸€ï¼šL2-024-éƒ¨è½-25-åˆ†" class="headerlink" title="æ ·é¢˜ä¸€ï¼šL2-024 éƒ¨è½ (25 åˆ†)"></a>æ ·é¢˜ä¸€ï¼š<strong>L2-024 éƒ¨è½ (25 åˆ†)</strong></h2><h3 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h3><p>åœ¨ä¸€ä¸ªç¤¾åŒºé‡Œï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„å°åœˆå­ï¼Œè¿˜å¯èƒ½åŒæ—¶å±äºå¾ˆå¤šä¸åŒçš„æœ‹å‹åœˆã€‚æˆ‘ä»¬è®¤ä¸ºæœ‹å‹çš„æœ‹å‹éƒ½ç®—åœ¨ä¸€ä¸ªéƒ¨è½é‡Œï¼Œäºæ˜¯è¦è¯·ä½ ç»Ÿè®¡ä¸€ä¸‹ï¼Œåœ¨ä¸€ä¸ªç»™å®šç¤¾åŒºä¸­ï¼Œåˆ°åº•æœ‰å¤šå°‘ä¸ªäº’ä¸ç›¸äº¤çš„éƒ¨è½ï¼Ÿå¹¶ä¸”æ£€æŸ¥ä»»æ„ä¸¤ä¸ªäººæ˜¯å¦å±äºåŒä¸€ä¸ªéƒ¨è½ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°<em>N</em>ï¼ˆâ‰¤104ï¼‰ï¼Œæ˜¯å·²çŸ¥å°åœˆå­çš„ä¸ªæ•°ã€‚éšå<em>N</em>è¡Œï¼Œæ¯è¡ŒæŒ‰ä¸‹åˆ—æ ¼å¼ç»™å‡ºä¸€ä¸ªå°åœˆå­é‡Œçš„äººï¼š</p><p><em>K</em> <em>P</em>[1] <em>P</em>[2] â‹¯ <em>P</em>[<em>K</em>]</p><p>å…¶ä¸­<em>K</em>æ˜¯å°åœˆå­é‡Œçš„äººæ•°ï¼Œ<em>P</em>[<em>i</em>]ï¼ˆ<em>i</em>&#x3D;1,â‹¯,<em>K</em>ï¼‰æ˜¯å°åœˆå­é‡Œæ¯ä¸ªäººçš„ç¼–å·ã€‚è¿™é‡Œæ‰€æœ‰äººçš„ç¼–å·ä»1å¼€å§‹è¿ç»­ç¼–å·ï¼Œæœ€å¤§ç¼–å·ä¸ä¼šè¶…è¿‡104ã€‚</p><p>ä¹‹åä¸€è¡Œç»™å‡ºä¸€ä¸ªéè´Ÿæ•´æ•°<em>Q</em>ï¼ˆâ‰¤104ï¼‰ï¼Œæ˜¯æŸ¥è¯¢æ¬¡æ•°ã€‚éšå<em>Q</em>è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€å¯¹è¢«æŸ¥è¯¢çš„äººçš„ç¼–å·ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>é¦–å…ˆåœ¨ä¸€è¡Œä¸­è¾“å‡ºè¿™ä¸ªç¤¾åŒºçš„æ€»äººæ•°ã€ä»¥åŠäº’ä¸ç›¸äº¤çš„éƒ¨è½çš„ä¸ªæ•°ã€‚éšåå¯¹æ¯ä¸€æ¬¡æŸ¥è¯¢ï¼Œå¦‚æœä»–ä»¬å±äºåŒä¸€ä¸ªéƒ¨è½ï¼Œåˆ™åœ¨ä¸€è¡Œä¸­è¾“å‡º<code>Y</code>ï¼Œå¦åˆ™è¾“å‡º<code>N</code>ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">4<br>3 10 1 2<br>2 3 4<br>4 1 5 7 8<br>3 9 6 4<br>2<br>10 5<br>3 7ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">10 2<br>Y<br>Nç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span>  N=<span class="hljs-number">10005</span>;<br><span class="hljs-keyword">int</span> par[N];       <span class="hljs-comment">//çˆ¶äº²</span><br><span class="hljs-keyword">int</span> deep[N];      <span class="hljs-comment">//æ ‘çš„é«˜åº¦</span><br><span class="hljs-keyword">int</span> isroot[N];    <span class="hljs-comment">//ç”¨æ¥è®°å½•äº’ä¸ç›¸äº¤çš„éƒ¨è½çš„ä¸ªæ•°ã€‚å¦‚æœåŒå±äºä¸€ä¸ªéƒ¨è½ï¼Œé‚£ä¸ªè¿™ä¸ªéƒ¨è½çš„å…ƒç´ çš„æ ¹èŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚</span><br>                  <span class="hljs-comment">//æ‰€ä»¥åªè¦ç»Ÿè®¡æœ‰å¤šå°‘ä¸ªæ ¹èŠ‚ç‚¹å°±å¯ä»¥çŸ¥é“æœ‰å¤šå°‘ä¸ªäº’ä¸ç›¸äº¤çš„éƒ¨è½ä¸ªæ•°</span><br>set&lt;<span class="hljs-keyword">int</span>&gt; st;      <span class="hljs-comment">//é›†åˆèƒ½å¾ˆå¥½çš„è¿‡æ»¤åˆ°é‡å¤å…ƒç´ ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨æ¥ç»Ÿè®¡ä¸æ˜¯é‡å¤å…ƒç´ çš„ä¸ªæ•°</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)<br>    &#123;<br>        par[i] = i;<br>        deep[i] =<span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(par[x] == x ) <span class="hljs-keyword">return</span> x;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> par[x] = <span class="hljs-built_in">find</span>(par[x]);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unite</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    x=<span class="hljs-built_in">find</span>(x);<br>    y=<span class="hljs-built_in">find</span>(y);<br>    <span class="hljs-keyword">if</span>(x==y) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span>(deep[x]&lt;deep[y])<br>    &#123;<br>        par[x]=y;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        par[y]=x;<br>        <span class="hljs-keyword">if</span>(deep[x]==deep[y]) deep[x]++;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;n;<br>    <span class="hljs-built_in">init</span>(<span class="hljs-number">10005</span>);<br>    <span class="hljs-built_in">memset</span>(isroot,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(isroot));<br>    <span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> num,first;<br>        cin&gt;&gt;num&gt;&gt;first;<br>        st.<span class="hljs-built_in">insert</span>(first);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;num ; ++j) &#123;<br>            <span class="hljs-keyword">int</span> next;<br>            cin&gt;&gt;next;<br>            st.<span class="hljs-built_in">insert</span>(next);<br>            <span class="hljs-built_in">unite</span>(first,next);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¯»æ‰¾äº’ä¸ç›¸äº¤çš„éƒ¨è½</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">1</span>; l &lt;=st.<span class="hljs-built_in">size</span>() ; ++l) &#123;<br>        isroot[<span class="hljs-built_in">find</span>(l)]=<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> m = <span class="hljs-number">1</span>; m &lt;=st.<span class="hljs-built_in">size</span>() ; ++m) &#123;<br>        ans+=isroot[m];<br>    &#125;<br>    cout&lt;&lt;st.<span class="hljs-built_in">size</span>()&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;ans&lt;&lt;endl;<br>    <span class="hljs-keyword">int</span> time;<br>    cin&gt;&gt;time;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;time ; ++k) &#123;<br>        <span class="hljs-keyword">int</span> a,b;<br>        cin&gt;&gt;a&gt;&gt;b;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(a)==<span class="hljs-built_in">find</span>(b))<br>        &#123;<br>            cout&lt;&lt;<span class="hljs-string">&quot;Y&quot;</span>&lt;&lt;endl;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout&lt;&lt;<span class="hljs-string">&quot;N&quot;</span>&lt;&lt;endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³èµ„æ–™ï¼š"><a href="#ç›¸å…³èµ„æ–™ï¼š" class="headerlink" title="ç›¸å…³èµ„æ–™ï¼š"></a>ç›¸å…³èµ„æ–™ï¼š</h2><p><a href="https://blog.csdn.net/qq_42815188/article/details/86769629">(3æ¡æ¶ˆæ¯) å¹¶æŸ¥é›†_æ—©ç¡èº«ä½“å¥½hh-CSDNåšå®¢_å¹¶æŸ¥é›†</a>ï¼šæ—©ç¡èº«ä½“å¥½hh-å¹¶æŸ¥é›†(CSDN)</p><h2 id="æ ·é¢˜é“¾æ¥ï¼š"><a href="#æ ·é¢˜é“¾æ¥ï¼š" class="headerlink" title="æ ·é¢˜é“¾æ¥ï¼š"></a>æ ·é¢˜é“¾æ¥ï¼š</h2><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805056736444416">é¢˜ç›®è¯¦æƒ… - L2-024 éƒ¨è½ (25 åˆ†) (pintia.cn)</a>ï¼šL2-024 éƒ¨è½ (25 åˆ†)</p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ€çŸ­è·¯å¾„-Floyedå’ŒDijkstra</title>
    <link href="/2022/01/03/Algorithm003/"/>
    <url>/2022/01/03/Algorithm003/</url>
    
    <content type="html"><![CDATA[<h1 id="æœ€çŸ­è·¯å¾„-Floyedå’ŒDijkstra"><a href="#æœ€çŸ­è·¯å¾„-Floyedå’ŒDijkstra" class="headerlink" title="æœ€çŸ­è·¯å¾„-Floyedå’ŒDijkstra"></a>æœ€çŸ­è·¯å¾„-Floyedå’ŒDijkstra</h1><h2 id="Floyed"><a href="#Floyed" class="headerlink" title="Floyed"></a>Floyed</h2><h3 id="æ ·é¢˜ä¸€ï¼šP1364-åŒ»é™¢è®¾ç½®"><a href="#æ ·é¢˜ä¸€ï¼šP1364-åŒ»é™¢è®¾ç½®" class="headerlink" title="æ ·é¢˜ä¸€ï¼šP1364 åŒ»é™¢è®¾ç½®"></a>æ ·é¢˜ä¸€ï¼šP1364 åŒ»é™¢è®¾ç½®</h3><h4 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h4><p>è®¾æœ‰ä¸€æ£µäºŒå‰æ ‘ï¼Œå¦‚å›¾ï¼š</p><p><img src="/2022/01/03/Algorithm003/166.png"></p><p>å…¶ä¸­ï¼Œåœˆä¸­çš„æ•°å­—è¡¨ç¤ºç»“ç‚¹ä¸­å±…æ°‘çš„äººå£ã€‚åœˆè¾¹ä¸Šæ•°å­—è¡¨ç¤ºç»“ç‚¹ç¼–å·ï¼Œç°åœ¨è¦æ±‚åœ¨æŸä¸ªç»“ç‚¹ä¸Šå»ºç«‹ä¸€ä¸ªåŒ»é™¢ï¼Œä½¿æ‰€æœ‰å±…æ°‘æ‰€èµ°çš„è·¯ç¨‹ä¹‹å’Œä¸ºæœ€å°ï¼ŒåŒæ—¶çº¦å®šï¼Œç›¸é‚»æ¥ç‚¹ä¹‹é—´çš„è·ç¦»ä¸º 11ã€‚å¦‚ä¸Šå›¾ä¸­ï¼Œè‹¥åŒ»é™¢å»ºåœ¨1 å¤„ï¼Œåˆ™è·ç¦»å’Œ &#x3D;4+12+2\times20+2\times40&#x3D;136&#x3D;4+12+2Ã—20+2Ã—40&#x3D;136ï¼›è‹¥åŒ»é™¢å»ºåœ¨ 33 å¤„ï¼Œåˆ™è·ç¦»å’Œ &#x3D;4\times2+13+20+40&#x3D;81&#x3D;4Ã—2+13+20+40&#x3D;81ã€‚</p><h4 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h4><p>ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•° n<em>n</em>ï¼Œè¡¨ç¤ºæ ‘çš„ç»“ç‚¹æ•°ã€‚</p><p>æ¥ä¸‹æ¥çš„ n<em>n</em> è¡Œæ¯è¡Œæè¿°äº†ä¸€ä¸ªç»“ç‚¹çš„çŠ¶å†µï¼ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° w, u, v<em>w</em>,<em>u</em>,<em>v</em>ï¼Œå…¶ä¸­ w<em>w</em> ä¸ºå±…æ°‘äººå£æ•°ï¼Œu<em>u</em> ä¸ºå·¦é“¾æ¥ï¼ˆä¸º 00 è¡¨ç¤ºæ— é“¾æ¥ï¼‰ï¼Œv<em>v</em> ä¸ºå³é“¾æ¥ï¼ˆä¸º 00 è¡¨ç¤ºæ— é“¾æ¥ï¼‰ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h4><p>ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°è·ç¦»å’Œã€‚</p><h4 id="è¾“å…¥è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å…¥è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å…¥è¾“å‡ºæ ·ä¾‹ï¼š</h4><figure class="highlight basic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs basic"><span class="hljs-number">5</span><br><span class="hljs-symbol">13 </span><span class="hljs-number">2</span> <span class="hljs-number">3</span><br><span class="hljs-symbol">4 </span><span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">12 </span><span class="hljs-number">4</span> <span class="hljs-number">5</span><br><span class="hljs-symbol">20 </span><span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-symbol">40 </span><span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h4 id="è¾“å‡ºï¼š"><a href="#è¾“å‡ºï¼š" class="headerlink" title="è¾“å‡ºï¼š"></a>è¾“å‡ºï¼š</h4><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs">81<br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> tree[<span class="hljs-number">1000</span>][<span class="hljs-number">1000</span>];   <span class="hljs-comment">//treeçš„ä½œç”¨é‚»æ¥çŸ©é˜µå»ºæ ‘</span><br><span class="hljs-keyword">int</span> w[<span class="hljs-number">1000</span>],l,r;  <span class="hljs-comment">//wæ¯ä¸ªç»“ç‚¹çš„å±…æ°‘äººå£æ•°</span><br><span class="hljs-keyword">int</span> mindis;       <span class="hljs-comment">//æœ€å°è®°å½•å’Œ</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;j++)<br>        &#123;<br>            tree[i][j]=<span class="hljs-number">0X3FFFFFFF</span>;    <span class="hljs-comment">//åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n ; ++i) &#123;<br>        tree[i][i]=<span class="hljs-number">0</span>;    <span class="hljs-comment">//åˆå§‹åŒ–</span><br>        cin&gt;&gt;w[i]&gt;&gt;l&gt;&gt;r;  <span class="hljs-comment">//è¯»å…¥æ•°æ®</span><br>        <span class="hljs-keyword">if</span>(l&gt;<span class="hljs-number">0</span>) tree[i][l]=tree[l][i]=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(r&gt;<span class="hljs-number">0</span>) tree[i][r]=tree[r][i]=<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;=n ; ++k) <span class="hljs-comment">//ç”¨Floyedæ±‚ä»»æ„ä¸¤ç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„</span><br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n ; ++i) &#123;<br>            <span class="hljs-keyword">if</span>(i!=k)<br>            &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;=n ; ++j) &#123;<br>                    <span class="hljs-keyword">if</span>(i!=j&amp;&amp;j!=k&amp;&amp;tree[i][k]+tree[k][j]&lt;tree[i][j])<br>                    &#123;<br>                        tree[i][j]=tree[i][k]+tree[k][j];<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    mindis=INT_MAX;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-comment">//ç©·ä¸¾åŒ»é™¢å»ºåœ¨Nä¸ªç»“ç‚¹ï¼Œæ‰¾å‡ºæœ€çŸ­è·ç¦»</span><br>    &#123;<br>        <span class="hljs-keyword">int</span> sum =<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;j++)<br>        &#123;<br>            sum+=tree[i][j]*w[j];<br>        &#125;<br>        <span class="hljs-keyword">if</span>(sum&lt;mindis) mindis=sum;<br>    &#125;<br>    cout&lt;&lt;mindis&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="Dijkstra"><a href="#Dijkstra" class="headerlink" title="Dijkstra"></a>Dijkstra</h2><h3 id="æ ·é¢˜äºŒï¼š"><a href="#æ ·é¢˜äºŒï¼š" class="headerlink" title="æ ·é¢˜äºŒï¼š"></a>æ ·é¢˜äºŒï¼š</h3><h4 id="é¢˜ç›®æè¿°ï¼š-1"><a href="#é¢˜ç›®æè¿°ï¼š-1" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h4><p><img src="/2022/01/03/Algorithm003/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x5bm5fbWc=,size_16,color_FFFFFF,t_70.png"></p><p>è¾“å…¥nå’Œmï¼Œä»£è¡¨nä¸ªèŠ‚ç‚¹ï¼Œmæ¡è¾¹ï¼Œç„¶åæ˜¯mè¡Œè¾“å…¥ï¼Œæ¯è¡Œæœ‰x,y,zï¼Œä»£è¡¨xåˆ°yçš„è·¯è·ç¦»ä¸ºzã€‚<br>é—®é¢˜ï¼šä»1å‡ºå‘åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„</p><h4 id="æµ‹è¯•æ ·ä¾‹ï¼š"><a href="#æµ‹è¯•æ ·ä¾‹ï¼š" class="headerlink" title="æµ‹è¯•æ ·ä¾‹ï¼š"></a>æµ‹è¯•æ ·ä¾‹ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">7</span> <span class="hljs-number">12</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">20</span><br><span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">50</span><br><span class="hljs-number">1</span> <span class="hljs-number">4</span> <span class="hljs-number">30</span><br><span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">25</span><br><span class="hljs-number">2</span> <span class="hljs-number">6</span> <span class="hljs-number">70</span><br><span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">40</span><br><span class="hljs-number">3</span> <span class="hljs-number">6</span> <span class="hljs-number">50</span><br><span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">25</span><br><span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">55</span><br><span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">10</span><br><span class="hljs-number">5</span> <span class="hljs-number">7</span> <span class="hljs-number">70</span><br><span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">50</span><br><span class="hljs-number">5</span><br></code></pre></div></td></tr></table></figure><h4 id="è¾“å‡ºï¼š-1"><a href="#è¾“å‡ºï¼š-1" class="headerlink" title="è¾“å‡ºï¼š"></a>è¾“å‡ºï¼š</h4><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>-&gt;<span class="hljs-number">2</span>-&gt;<span class="hljs-number">3</span>-&gt;<span class="hljs-number">5</span><br><span class="hljs-attribute">70</span><br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºæºä»£ç ï¼š-1"><a href="#ç¨‹åºæºä»£ç ï¼š-1" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">int</span> mapdis[maxn][maxn];  <span class="hljs-comment">//è¡¨ç¤ºx-&gt;yçš„è·ç¦»(æœ‰å‘)</span><br><span class="hljs-keyword">int</span> dis[maxn];  <span class="hljs-comment">//ä»£è¡¨æœ€çŸ­è·¯å¾„é•¿</span><br><span class="hljs-keyword">int</span> path[maxn];  <span class="hljs-comment">//è®°å½•å‰é©±èŠ‚ç‚¹</span><br><span class="hljs-keyword">int</span> vis[maxn]; <span class="hljs-comment">//ç”¨æ¥è®°å½•è¯¥ç‚¹æ˜¯å¦å·²ç»æ˜¯æœ€çŸ­è·¯å¾„çš„ç‚¹</span><br><span class="hljs-keyword">int</span> n,m;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dijkstra</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//åˆå§‹åŒ–</span><br>    <span class="hljs-built_in">memset</span>(dis,<span class="hljs-number">0x3f</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(dis));<br>    <span class="hljs-built_in">memset</span>(path,<span class="hljs-number">-1</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(path));<br>    <span class="hljs-built_in">memset</span>(vis,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(vis));<br>    <br>    dis[s]=<span class="hljs-number">0</span>;   <span class="hljs-comment">//è‡ªèº«åˆ°è‡ªèº«çš„è·ç¦»æ˜¯0</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>; <span class="hljs-comment">//ç”¨æ¥è®°å½•å½“è½®çš„èµ·å§‹ç‚¹</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=n; ++i) &#123;<br>            <span class="hljs-keyword">if</span>(!vis[i]&amp;&amp;dis[i]&lt;dis[k])     <span class="hljs-comment">//å¦‚æœè¿™ä¸ªç‚¹è¿˜ä¸ä¸ºæœ€çŸ­è·¯å¾„çš„ç‚¹ï¼Œå¹¶ä¸”è¿™ä¸ªç‚¹çš„è·¯å¾„æ˜¯ç°åœ¨æ‰€æœ‰ç‚¹ä¸­æœ€å°çš„</span><br>            &#123;<br>                k=i;      <span class="hljs-comment">//é‚£ä¹ˆå°±è®°å½•è¿™ä¸ªç‚¹ä¸ºå½“è½®çš„èµ·å§‹ç‚¹</span><br>                  <span class="hljs-comment">//ç‰¹æ®Šçš„è¿™é‡Œç¬¬ä¸€æ¬¡æ‰¾åˆ°çš„æ˜¯èµ·ç‚¹ï¼ŒåŠs=1ã€‚</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(!k) <span class="hljs-keyword">return</span>;  <span class="hljs-comment">//æ‰€æœ‰ç‚¹å·²ç»ä¸ºæœ€çŸ­è·¯å¾„çš„ç‚¹ï¼Œåˆ™è¿”å›</span><br>        vis[k]=<span class="hljs-number">1</span>;       <span class="hljs-comment">//æ ‡è®°è¯¥ç‚¹ä¸ºæœ€çŸ­è·¯å¾„çš„ç‚¹</span><br>        <span class="hljs-comment">//æ¾å¼›æ“ä½œ</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;=n ; ++j) &#123;   <br>            <span class="hljs-comment">//ç¬¬ä¸€æ¬¡å¾ªç¯åªæœ‰èµ·ç‚¹çš„é‚»æ¥ç‚¹çš„è·ç¦»è¢«æ›´æ–°</span><br>            <span class="hljs-comment">//æ¯æ¬¡éƒ½æ›´æ–°æ‰¾åˆ°ï¼Œæ–°æ‰¾åˆ°çš„ç‚¹çš„é‚»æ¥ç‚¹(æ–°æ‰¾åˆ°çš„ç‚¹ä¹Ÿå°±æ˜¯å½“è½®çš„èµ·å§‹ç‚¹)</span><br>            <span class="hljs-keyword">if</span>(dis[j]&gt;dis[k]+mapdis[k][j])  <span class="hljs-comment">//æœ€çŸ­è·¯æ˜¯ç”±æœ€çŸ­è·¯+æŸä¸€æ¡å›ºå®šè·¯ç»„æˆ</span><br>            &#123;<br>                dis[j]=dis[k]+mapdis[k][j];<span class="hljs-comment">//è·¯å¾„è¢«æ”¹å˜</span><br>                path[j]=k;<span class="hljs-comment">//é‡æ–°è®°å½•å‰é©±ï¼Œæœ€çŸ­è·¯æ˜¯ç”±æœ€çŸ­è·¯+æŸä¸€æ¡å›ºå®šè·¯ç»„æˆï¼Œæ‰€ä»¥å‰é©±æ˜¯æœ‰æ•ˆçš„</span><br>            &#125;<br>        &#125;<br><br>    &#125;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> <span class="hljs-comment">//é€’å½’æ‰“å°</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(x == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">print</span>(path[x]);<br>    cout&lt;&lt;x&lt;&lt;<span class="hljs-string">&quot;-&gt;&quot;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    n,m;<br>    cin&gt;&gt;n&gt;&gt;m;<br>    <span class="hljs-comment">//åˆå§‹åŒ–</span><br>    <span class="hljs-built_in">memset</span>(mapdis,<span class="hljs-number">0x3f</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(mapdis));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;m ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> x,y,z;<br>        cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;<br>        <span class="hljs-comment">//è®°å½•x-&gt;yçš„è·ç¦»</span><br>        mapdis[x][y]=z;<br>    &#125;<br>    <span class="hljs-built_in">Dijkstra</span>(<span class="hljs-number">1</span>);  <span class="hljs-comment">//æ±‚1å‡ºå‘åˆ°å„ç‚¹çš„æœ€çŸ­è·¯å¾„</span><br>    <span class="hljs-keyword">int</span> order;    <span class="hljs-comment">//è¯»å…¥ç»ˆç‚¹</span><br>    cin&gt;&gt;order;<br>    <span class="hljs-built_in">print</span>(path[order]);  <span class="hljs-comment">//æ‰“å°æœ€çŸ­è·¯å¾„</span><br>    cout&lt;&lt;order&lt;&lt;endl;<br>    cout&lt;&lt;dis[order];    <span class="hljs-comment">//æœ€çŸ­è·¯å¾„é•¿</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="æ ·é¢˜ä¸‰ï¼šL2-001-ç´§æ€¥æ•‘æ´-25-åˆ†"><a href="#æ ·é¢˜ä¸‰ï¼šL2-001-ç´§æ€¥æ•‘æ´-25-åˆ†" class="headerlink" title="æ ·é¢˜ä¸‰ï¼šL2-001 ç´§æ€¥æ•‘æ´ (25 åˆ†)"></a>æ ·é¢˜ä¸‰ï¼š<strong>L2-001 ç´§æ€¥æ•‘æ´ (25 åˆ†)</strong></h3><h4 id="é¢˜ç›®æè¿°ï¼š-2"><a href="#é¢˜ç›®æè¿°ï¼š-2" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h4><p>ä½œä¸ºä¸€ä¸ªåŸå¸‚çš„åº”æ€¥æ•‘æ´é˜Ÿä¼çš„è´Ÿè´£äººï¼Œä½ æœ‰ä¸€å¼ ç‰¹æ®Šçš„å…¨å›½åœ°å›¾ã€‚åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºæœ‰å¤šä¸ªåˆ†æ•£çš„åŸå¸‚å’Œä¸€äº›è¿æ¥åŸå¸‚çš„å¿«é€Ÿé“è·¯ã€‚æ¯ä¸ªåŸå¸‚çš„æ•‘æ´é˜Ÿæ•°é‡å’Œæ¯ä¸€æ¡è¿æ¥ä¸¤ä¸ªåŸå¸‚çš„å¿«é€Ÿé“è·¯é•¿åº¦éƒ½æ ‡åœ¨åœ°å›¾ä¸Šã€‚å½“å…¶ä»–åŸå¸‚æœ‰ç´§æ€¥æ±‚åŠ©ç”µè¯ç»™ä½ çš„æ—¶å€™ï¼Œä½ çš„ä»»åŠ¡æ˜¯å¸¦é¢†ä½ çš„æ•‘æ´é˜Ÿå°½å¿«èµ¶å¾€äº‹å‘åœ°ï¼ŒåŒæ—¶ï¼Œä¸€è·¯ä¸Šå¬é›†å°½å¯èƒ½å¤šçš„æ•‘æ´é˜Ÿã€‚</p><h4 id="è¾“å…¥æ ¼å¼"><a href="#è¾“å…¥æ ¼å¼" class="headerlink" title="è¾“å…¥æ ¼å¼:"></a>è¾“å…¥æ ¼å¼:</h4><p>è¾“å…¥ç¬¬ä¸€è¡Œç»™å‡º4ä¸ªæ­£æ•´æ•°<em>N</em>ã€<em>M</em>ã€<em>S</em>ã€<em>D</em>ï¼Œå…¶ä¸­<em>N</em>ï¼ˆ2â‰¤<em>N</em>â‰¤500ï¼‰æ˜¯åŸå¸‚çš„ä¸ªæ•°ï¼Œé¡ºä¾¿å‡è®¾åŸå¸‚çš„ç¼–å·ä¸º0 ~ (<em>N</em>âˆ’1)ï¼›<em>M</em>æ˜¯å¿«é€Ÿé“è·¯çš„æ¡æ•°ï¼›<em>S</em>æ˜¯å‡ºå‘åœ°çš„åŸå¸‚ç¼–å·ï¼›<em>D</em>æ˜¯ç›®çš„åœ°çš„åŸå¸‚ç¼–å·ã€‚</p><p>ç¬¬äºŒè¡Œç»™å‡º<em>N</em>ä¸ªæ­£æ•´æ•°ï¼Œå…¶ä¸­ç¬¬<em>i</em>ä¸ªæ•°æ˜¯ç¬¬<em>i</em>ä¸ªåŸå¸‚çš„æ•‘æ´é˜Ÿçš„æ•°ç›®ï¼Œæ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚éšåçš„<em>M</em>è¡Œä¸­ï¼Œæ¯è¡Œç»™å‡ºä¸€æ¡å¿«é€Ÿé“è·¯çš„ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯ï¼šåŸå¸‚1ã€åŸå¸‚2ã€å¿«é€Ÿé“è·¯çš„é•¿åº¦ï¼Œä¸­é—´ç”¨ç©ºæ ¼åˆ†å¼€ï¼Œæ•°å­—å‡ä¸ºæ•´æ•°ä¸”ä¸è¶…è¿‡500ã€‚è¾“å…¥ä¿è¯æ•‘æ´å¯è¡Œä¸”æœ€ä¼˜è§£å”¯ä¸€ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼:"></a>è¾“å‡ºæ ¼å¼:</h4><p>ç¬¬ä¸€è¡Œè¾“å‡ºæœ€çŸ­è·¯å¾„çš„æ¡æ•°å’Œèƒ½å¤Ÿå¬é›†çš„æœ€å¤šçš„æ•‘æ´é˜Ÿæ•°é‡ã€‚ç¬¬äºŒè¡Œè¾“å‡ºä»<em>S</em>åˆ°<em>D</em>çš„è·¯å¾„ä¸­ç»è¿‡çš„åŸå¸‚ç¼–å·ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ï¼Œè¾“å‡ºç»“å°¾ä¸èƒ½æœ‰å¤šä½™ç©ºæ ¼ã€‚</p><h4 id="è¾“å…¥æ ·ä¾‹"><a href="#è¾“å…¥æ ·ä¾‹" class="headerlink" title="è¾“å…¥æ ·ä¾‹:"></a>è¾“å…¥æ ·ä¾‹:</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">3</span><br><span class="hljs-number">20</span> <span class="hljs-number">30</span> <span class="hljs-number">40</span> <span class="hljs-number">10</span><br><span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span><br><span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span><br><span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">3</span><br><span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span><br><span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span>ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h4 id="è¾“å‡ºæ ·ä¾‹"><a href="#è¾“å‡ºæ ·ä¾‹" class="headerlink" title="è¾“å‡ºæ ·ä¾‹:"></a>è¾“å‡ºæ ·ä¾‹:</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">2</span> <span class="hljs-number">60</span><br><span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">3</span>ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h4 id="æœ€çŸ­è·¯å¾„æ¡æ•°ï¼š"><a href="#æœ€çŸ­è·¯å¾„æ¡æ•°ï¼š" class="headerlink" title="æœ€çŸ­è·¯å¾„æ¡æ•°ï¼š"></a>æœ€çŸ­è·¯å¾„æ¡æ•°ï¼š</h4><p>å¦‚æœé€šè¿‡ <strong>index</strong> ç‚¹èƒ½æŠŠæœ€çŸ­è·¯å¾„æ›´æ–°ï¼Œé‚£ä¹ˆæœ€çŸ­è·¯å¾„æ¡æ•°å°±æ˜¯ä»èµ·ç‚¹åˆ°<strong>index</strong>çš„æœ€çŸ­è·¯å¾„æ¡æ•°ã€‚</p><p><img src="/2022/01/03/Algorithm003/134d3eff026ab567e3a337c45dda5d61.png"></p><p>ä¾‹å¦‚è¿™å¼ å›¾ï¼Œå¦‚æœ<strong>index</strong>å¯ä»¥æ›´æ–°å½“å‰çš„æœ€çŸ­è·¯å¾„ï¼Œå¹¶ä¸”sé€šè¿‡1å’Œ2åˆ°è¾¾indexç‚¹çš„è·ç¦»éƒ½ç›¸ç­‰ï¼Œé‚£ä¹ˆä»såˆ°dçš„æœ€çŸ­è·¯å¾„æ¡æ•°å…¶å®å°±æ˜¯ä»såˆ°indexçš„æœ€çŸ­è·¯å¾„æ¡æ•°ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°ç¬¬ä¸€ä¸ªå¼å­</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">num[i]=num[index];<br></code></pre></div></td></tr></table></figure><p>å¦‚æœé€šè¿‡indexç‚¹çš„å‘¨è½¬ï¼Œè·ç¦»ä¸å˜ï¼ˆä¾ç„¶æ˜¯æœ€å°å€¼ï¼‰ï¼Œè¿™è¯´æ˜é€šè¿‡indexå‘¨è½¬ä½¿å¾—æœ€çŸ­è·¯å¾„æ¡æ•°åˆå¤šå‡ºäº†ä¸€éƒ¨åˆ†ï¼Œåªéœ€è¦ç”¨ä¹‹å‰å¾—åˆ°çš„æœ€çŸ­è·¯å¾„æ¡æ•°åŠ ä¸Šnum[index]å³å¯ï¼Œç”±æ­¤å¾—å‡ºç¬¬äºŒä¸ªå¼å­</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">num[i]+=num[index];<br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºæºä»£ç ï¼š-2"><a href="#ç¨‹åºæºä»£ç ï¼š-2" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> n,m,s,d;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> maxn=<span class="hljs-number">505</span>;<br><span class="hljs-keyword">int</span> arr[maxn];   <span class="hljs-comment">//è®°å½•æ¯ä¸ªåŸå¸‚çš„æ´å…µæ•°</span><br><span class="hljs-keyword">int</span> dismap[maxn][maxn];    <span class="hljs-comment">//å‚¨å­˜X-Yçš„é•¿åº¦</span><br><span class="hljs-keyword">int</span> path[maxn];    <span class="hljs-comment">//å‰é©±èŠ‚ç‚¹</span><br><span class="hljs-keyword">int</span> dis[maxn];     <span class="hljs-comment">//æœ€çŸ­è·¯å¾„</span><br><span class="hljs-keyword">int</span> cost[maxn];    <span class="hljs-comment">//æœ€å¤§æ•‘æ´é˜Ÿæ•°é‡</span><br><span class="hljs-keyword">int</span> vis[maxn];     <span class="hljs-comment">//ç”¨æ¥è®°å½•è¯¥ç‚¹æ˜¯å¦å·²ç»æ˜¯æœ€çŸ­è·¯å¾„çš„ç‚¹</span><br><span class="hljs-keyword">int</span> num[maxn];     <span class="hljs-comment">//æœ€çŸ­è·¯å¾„çš„æ¡æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dijk</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(path,<span class="hljs-number">-1</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(path));<br>    <span class="hljs-built_in">memset</span>(dis,<span class="hljs-number">0x3f</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(dis));<br>    <span class="hljs-built_in">memset</span>(cost,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(cost));<br>    <span class="hljs-built_in">memset</span>(vis,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(vis));<br>    <span class="hljs-built_in">memset</span>(num,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(num));<br>    dis[s]=<span class="hljs-number">0</span>;<br>    cost[s]=arr[s];   <span class="hljs-comment">//æ­¤æ—¶æ•‘æ´é˜Ÿæ•°é‡ç­‰äºå‡ºå‘ç‚¹çš„æ•‘æ´é˜Ÿæ•°é‡</span><br>    num[s]=<span class="hljs-number">1</span>;         <span class="hljs-comment">//ä¸€æ¡æœ€çŸ­è·¯å¾„</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)<br>    &#123;<br>        <span class="hljs-keyword">int</span> k=<span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">int</span> maxt =<span class="hljs-number">0x3f</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) &#123;<br>            <span class="hljs-keyword">if</span>(!vis[i]&amp;&amp;dis[i]&lt;maxt)<br>            &#123;<br>                k=i;<br>                maxt=dis[i];<br>            &#125;<br>        &#125;<br>        vis[k]=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(k==<span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; ++j) &#123;<br><br>            <span class="hljs-keyword">if</span>(!vis[j]&amp;&amp;dis[j]&gt;dis[k]+dismap[k][j])&#123;<br>                dis[j]=dis[k]+dismap[k][j];<br>                path[j]=k;<br>                num[j]=num[k];   <span class="hljs-comment">//å¦‚æœèƒ½æ›´æ–°ï¼Œè¯´æ˜äº§ç”Ÿäº†æ–°çš„æœ€çŸ­è·¯å¾„ï¼Œnum[i]å˜ä¸ºä»såˆ°kçš„è·¯å¾„æ¡æ•°</span><br>                cost[j] = cost[k]+arr[j];  <span class="hljs-comment">//äº§ç”Ÿäº†æ–°çš„æœ€çŸ­è·¯å¾„,äººæ•°ä¸ºcost[k]+arr[j]</span><br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!vis[j]&amp;&amp;dis[j]==dis[k]+dismap[k][j])&#123; <span class="hljs-comment">//å­˜åœ¨æ–°çš„æœ€çŸ­è·¯å¾„</span><br>                num[j]+=num[k];   <span class="hljs-comment">//æœ€çŸ­è·¯å¾„æ¡æ•°æ›´æ–°</span><br>                <span class="hljs-comment">//æ— è®ºæ´å…µé‡æ˜¯å¦èƒ½æ›´æ–°ï¼Œæ—¢ç„¶å·²ç»æœ‰äº†å¦ä¸€æ¡è·¯ä¸å½“å‰æœ€çŸ­è·¯é•¿åº¦ç›¸åŒ</span><br><span class="hljs-comment">//å°±è¯´æ˜å¤šäº†ä¸€äº›æœ€çŸ­è·¯æ¡æ•°</span><br>                <span class="hljs-keyword">if</span>(cost[j]&lt;cost[k]+arr[j])   <span class="hljs-comment">//æ´å…µé‡èƒ½æ›´æ–°</span><br>                &#123;<br>                    cost[j]=cost[k]+arr[j];<br>                    path[j]=k;<br><br>                &#125;<br>            &#125;<br><br>        &#125;<br>    &#125;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(x==<span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">print</span>(path[x]);<br>    cout&lt;&lt;x&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>    cin&gt;&gt;n&gt;&gt;m&gt;&gt;s&gt;&gt;d;<br>    <span class="hljs-built_in">memset</span>(arr,<span class="hljs-number">0</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(arr));<br>    <span class="hljs-built_in">memset</span>(dismap,<span class="hljs-number">0x3f</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(dismap));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;n ; ++j) &#123;<br>        cin&gt;&gt;arr[j];<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;m ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> x,y,z;<br>        cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;<br>        <span class="hljs-comment">//æ­¤é¢˜æ˜¯æ— å‘å›¾</span><br>        dismap[x][y]=z;<br>        dismap[y][x]=z;<br>    &#125;<br>    <span class="hljs-built_in">dijk</span>(s);<br>    cout&lt;&lt;num[d]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;cost[d]&lt;&lt;endl;<span class="hljs-comment">//æ‰“å°æœ€çŸ­è·¯å¾„æ¡æ•°å’Œæœ€å¤§æ´å…µæ•°</span><br>    <span class="hljs-built_in">print</span>(path[d]);<br>    cout&lt;&lt;d&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³é¢˜ç›®é“¾æ¥ï¼š"><a href="#ç›¸å…³é¢˜ç›®é“¾æ¥ï¼š" class="headerlink" title="ç›¸å…³é¢˜ç›®é“¾æ¥ï¼š"></a>ç›¸å…³é¢˜ç›®é“¾æ¥ï¼š</h2><p>[<a href="https://www.luogu.com.cn/problem/P2404"><a href="https://www.luogu.com.cn/problem/P1364">P1364 åŒ»é™¢è®¾ç½® - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)</a></a>]: â€œ æ ·é¢˜ä¸€ï¼šP1364 åŒ»é™¢è®¾ç½®â€</p><p><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805073643683840">é¢˜ç›®è¯¦æƒ… - L2-001 ç´§æ€¥æ•‘æ´ (25 åˆ†) (pintia.cn)</a> ï¼šæ ·é¢˜ä¸‰ï¼šL2-001 ç´§æ€¥æ•‘æ´ (25 åˆ†)</p><p><a href="https://www.freesion.com/article/8556971489/">L2-001 ç´§æ€¥æ•‘æ´ (25 åˆ†)&amp;&amp;dijkstra - ç°ä¿¡ç½‘ï¼ˆè½¯ä»¶å¼€å‘åšå®¢èšåˆï¼‰ (freesion.com)</a>ï¼šæ ·é¢˜ä¸‰å‚è€ƒèµ„æ–™</p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MPIå­¦ä¹ (äº”)-ç¯å½¢æ‹“æ‰‘ä¸Šåˆ©ç”¨MPIè¿›è¡Œé€šä¿¡</title>
    <link href="/2022/01/01/mpi005/"/>
    <url>/2022/01/01/mpi005/</url>
    
    <content type="html"><![CDATA[<h1 id="MPIå­¦ä¹ -äº”-ç¯å½¢æ‹“æ‰‘ä¸Šåˆ©ç”¨MPIè¿›è¡Œé€šä¿¡"><a href="#MPIå­¦ä¹ -äº”-ç¯å½¢æ‹“æ‰‘ä¸Šåˆ©ç”¨MPIè¿›è¡Œé€šä¿¡" class="headerlink" title="MPIå­¦ä¹ (äº”)-ç¯å½¢æ‹“æ‰‘ä¸Šåˆ©ç”¨MPIè¿›è¡Œé€šä¿¡"></a>MPIå­¦ä¹ (äº”)-ç¯å½¢æ‹“æ‰‘ä¸Šåˆ©ç”¨MPIè¿›è¡Œé€šä¿¡</h1><p>è¿™é‡Œï¼Œæˆ‘ä»¬æ¼”ç¤ºäº†ä¸€ä¸ªç®€å•çš„MPIç¨‹åºï¼Œå®ƒä½¿ç”¨é˜»å¡é€šä¿¡åŸè¯­sendå’Œreceiveæ¥è¿›è¡Œå¹¿æ’­æ“ä½œï¼š</p><h2 id="ç¨‹åºè¿è¡Œå¹³å°"><a href="#ç¨‹åºè¿è¡Œå¹³å°" class="headerlink" title="ç¨‹åºè¿è¡Œå¹³å°"></a>ç¨‹åºè¿è¡Œå¹³å°</h2><p>åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒA3åˆ†åŒº</p><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><p>mpi&#x2F;intel&#x2F;2017.5</p><h2 id="ç¼–è¯‘æŒ‡ä»¤"><a href="#ç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="ç¼–è¯‘æŒ‡ä»¤"></a>ç¼–è¯‘æŒ‡ä»¤</h2><p>mpic++ mpi005.cpp -o mpi005</p><h2 id="è¿è¡ŒæŒ‡ä»¤"><a href="#è¿è¡ŒæŒ‡ä»¤" class="headerlink" title="è¿è¡ŒæŒ‡ä»¤"></a>è¿è¡ŒæŒ‡ä»¤</h2><p>srun -p amd_256 -N 1 -n  4   .&#x2F;mpi005(ä½¿ç”¨SLURMä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ)</p><p>1ä¸ªåˆ†åŒºï¼Œæ ¸æ•°ä¸º4</p><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mpi.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> *argv[])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> rank, value, size;<br>MPI_Status status;<br><span class="hljs-built_in">MPI_Init</span>(&amp;argc, &amp;argv);<br><span class="hljs-built_in">MPI_Comm_rank</span>(MPI_COMM_WORLD, &amp;rank);<br><span class="hljs-built_in">MPI_Comm_size</span>(MPI_COMM_WORLD, &amp;size);<br><br><span class="hljs-keyword">if</span>(rank == <span class="hljs-number">0</span>) &#123;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;value );<br><span class="hljs-comment">/*Master node sends out the value*/</span><br><span class="hljs-built_in">MPI_Send</span>(&amp;value, <span class="hljs-number">1</span>, MPI_INT, rank + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, MPI_COMM_WORLD);&#125;<span class="hljs-comment">//</span><br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-comment">/*Slave nodes block on receive the send on the value*/</span><br>        <span class="hljs-comment">//æ¥å—ä¸Šä¸€ä¸ªè¿›ç¨‹å‘é€çš„æ¶ˆæ¯</span><br><span class="hljs-built_in">MPI_Recv</span>(&amp;value, <span class="hljs-number">1</span>, MPI_INT, rank - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>,MPI_COMM_WORLD, &amp;status);<br><br><span class="hljs-keyword">if</span>(rank &lt; size<span class="hljs-number">-1</span>)<br>&#123;<br>            <span class="hljs-comment">//å‘ä¸‹ä¸€ä¸ªè¿›ç¨‹å‘é€æ¶ˆæ¯</span><br><span class="hljs-built_in">MPI_Send</span>(&amp;value, <span class="hljs-number">1</span>, MPI_INT, rank + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, MPI_COMM_WORLD);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;process %d got %d\n&quot;</span>, rank, value);<br>&#125;<br><span class="hljs-built_in">MPI_Finalize</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125; <br><br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¿è¡Œç»“æœ"><a href="#ç¨‹åºè¿è¡Œç»“æœ" class="headerlink" title="ç¨‹åºè¿è¡Œç»“æœ"></a>ç¨‹åºè¿è¡Œç»“æœ</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//5 5ä¸ºè¯»å…¥çš„valueå€¼</span><br>process <span class="hljs-number">1</span> got <span class="hljs-number">5</span><br>process <span class="hljs-number">2</span> got <span class="hljs-number">5</span><br>process <span class="hljs-number">3</span> got <span class="hljs-number">5</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Graph-Data Structure</title>
    <link href="/2021/12/22/algorithm002/"/>
    <url>/2021/12/22/algorithm002/</url>
    
    <content type="html"><![CDATA[<h1 id="Graph-Data-Structure"><a href="#Graph-Data-Structure" class="headerlink" title="Graph-Data Structure"></a>Graph-Data Structure</h1><h2 id="1-é‚»æ¥è¡¨çš„åº”ç”¨"><a href="#1-é‚»æ¥è¡¨çš„åº”ç”¨" class="headerlink" title="1.é‚»æ¥è¡¨çš„åº”ç”¨"></a>1.é‚»æ¥è¡¨çš„åº”ç”¨</h2><h3 id="æ ·é¢˜ä¸€ï¼šL2-025-åˆ†è€Œæ²»ä¹‹-25-åˆ†"><a href="#æ ·é¢˜ä¸€ï¼šL2-025-åˆ†è€Œæ²»ä¹‹-25-åˆ†" class="headerlink" title="æ ·é¢˜ä¸€ï¼šL2-025 åˆ†è€Œæ²»ä¹‹ (25 åˆ†)"></a>æ ·é¢˜ä¸€ï¼šL2-025 åˆ†è€Œæ²»ä¹‹ (25 åˆ†)</h3><h4 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h4><p>åˆ†è€Œæ²»ä¹‹ï¼Œå„ä¸ªå‡»ç ´æ˜¯å…µå®¶å¸¸ç”¨çš„ç­–ç•¥ä¹‹ä¸€ã€‚åœ¨æˆ˜äº‰ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é¦–å…ˆæ”»ä¸‹æ•Œæ–¹çš„éƒ¨åˆ†åŸå¸‚ï¼Œä½¿å…¶å‰©ä½™çš„åŸå¸‚å˜æˆå­¤ç«‹æ— æ´ï¼Œç„¶åå†åˆ†å¤´å„ä¸ªå‡»ç ´ã€‚ä¸ºæ­¤å‚è°‹éƒ¨æä¾›äº†è‹¥å¹²æ‰“å‡»æ–¹æ¡ˆã€‚æœ¬é¢˜å°±è¯·ä½ ç¼–å†™ç¨‹åºï¼Œåˆ¤æ–­æ¯ä¸ªæ–¹æ¡ˆçš„å¯è¡Œæ€§ã€‚</p><h4 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h4><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡ºä¸¤ä¸ªæ­£æ•´æ•° N å’Œ Mï¼ˆå‡ä¸è¶…è¿‡10 000ï¼‰ï¼Œåˆ†åˆ«ä¸ºæ•Œæ–¹åŸå¸‚ä¸ªæ•°ï¼ˆäºæ˜¯é»˜è®¤åŸå¸‚ä» 1 åˆ° N ç¼–å·ï¼‰å’Œè¿æ¥ä¸¤åŸå¸‚çš„é€šè·¯æ¡æ•°ã€‚éšå M è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€æ¡é€šè·¯æ‰€è¿æ¥çš„ä¸¤ä¸ªåŸå¸‚çš„ç¼–å·ï¼Œå…¶é—´ä»¥ä¸€ä¸ªç©ºæ ¼åˆ†éš”ã€‚åœ¨åŸå¸‚ä¿¡æ¯ä¹‹åç»™å‡ºå‚è°‹éƒ¨çš„ç³»åˆ—æ–¹æ¡ˆï¼Œå³ä¸€ä¸ªæ­£æ•´æ•° K ï¼ˆâ‰¤ 100ï¼‰å’Œéšåçš„ K è¡Œæ–¹æ¡ˆï¼Œæ¯è¡ŒæŒ‰ä»¥ä¸‹æ ¼å¼ç»™å‡ºï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">Np v<span class="hljs-selector-attr">[1]</span> v<span class="hljs-selector-attr">[2]</span> ... v<span class="hljs-selector-attr">[Np]</span><br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <code>Np</code> æ˜¯è¯¥æ–¹æ¡ˆä¸­è®¡åˆ’æ”»ä¸‹çš„åŸå¸‚æ•°é‡ï¼Œåé¢çš„ç³»åˆ— <code>v[i]</code> æ˜¯è®¡åˆ’æ”»ä¸‹çš„åŸå¸‚ç¼–å·ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h4><p>å¯¹æ¯ä¸€å¥—æ–¹æ¡ˆï¼Œå¦‚æœå¯è¡Œå°±è¾“å‡º<code>YES</code>ï¼Œå¦åˆ™è¾“å‡º<code>NO</code>ã€‚</p><h4 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; v[<span class="hljs-number">10005</span>]; <span class="hljs-comment">//å£°æ˜é‚»æ¥è¡¨</span><br>    <span class="hljs-keyword">int</span> n,num;<br>    cin&gt;&gt;n&gt;&gt;num;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;num ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> start,end;<br>        cin&gt;&gt;start&gt;&gt;end;<br>        <span class="hljs-comment">//åˆ›å»ºé‚»æ¥è¡¨</span><br>        v[start].<span class="hljs-built_in">push_back</span>(end); <br>        v[end].<span class="hljs-built_in">push_back</span>(start);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> k;<br>    cin&gt;&gt;k;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;k ; ++j) &#123;<br>        <span class="hljs-keyword">int</span> np;<br>        cin&gt;&gt;np;<br>        <span class="hljs-keyword">int</span> flag=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">int</span> book[<span class="hljs-number">10005</span>]=&#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-comment">//æ¯è½®ç‚¸æ¯åŸå¸‚åˆå§‹åŒ–</span><br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;=np ; ++i) &#123;<br>            <span class="hljs-keyword">int</span> dead;<br>            cin&gt;&gt;dead;<br>            book[dead]=<span class="hljs-number">1</span>; <span class="hljs-comment">//è¢«ç‚¸æ¯çš„åŸå¸‚æ ‡è®°ä¸º1</span><br>        &#125;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> l = <span class="hljs-number">1</span>; l &lt;=n ; ++l) &#123;<br>            <br>            <span class="hljs-keyword">if</span>(book[l]==<span class="hljs-number">0</span>)<span class="hljs-comment">//æ²¡æœ‰è¢«ç‚¸æ¯çš„åŸå¸‚</span><br>            &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;v[l].<span class="hljs-built_in">size</span>() ; ++i) &#123; <span class="hljs-comment">//éå†è¯¥åŸå¸‚çš„é‚»æ¥è¡¨</span><br>                    <br>                    <span class="hljs-keyword">if</span>(book[v[l][i]]==<span class="hljs-number">0</span>) <span class="hljs-comment">//å­˜åœ¨ç€è¿˜è¿é€šçš„åŸå¸‚</span><br>                    &#123;<br>                        flag=<span class="hljs-number">0</span>;<span class="hljs-comment">//è¯´æ˜æ–¹æ¡ˆä¸å¯è¡Œ</span><br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">1</span>)<br>        &#123;<br>            cout&lt;&lt;<span class="hljs-string">&quot;YES&quot;</span>&lt;&lt;endl;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout&lt;&lt;<span class="hljs-string">&quot;NO&quot;</span>&lt;&lt;endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºè¾“å…¥ï¼š"><a href="#ç¨‹åºè¾“å…¥ï¼š" class="headerlink" title="ç¨‹åºè¾“å…¥ï¼š"></a>ç¨‹åºè¾“å…¥ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">10</span> <span class="hljs-number">11</span><br><span class="hljs-number">8</span> <span class="hljs-number">7</span><br><span class="hljs-number">6</span> <span class="hljs-number">8</span><br><span class="hljs-number">4</span> <span class="hljs-number">5</span><br><span class="hljs-number">8</span> <span class="hljs-number">4</span><br><span class="hljs-number">8</span> <span class="hljs-number">1</span><br><span class="hljs-number">1</span> <span class="hljs-number">2</span><br><span class="hljs-number">1</span> <span class="hljs-number">4</span><br><span class="hljs-number">9</span> <span class="hljs-number">8</span><br><span class="hljs-number">9</span> <span class="hljs-number">1</span><br><span class="hljs-number">1</span> <span class="hljs-number">10</span><br><span class="hljs-number">2</span> <span class="hljs-number">4</span><br><span class="hljs-number">5</span><br><span class="hljs-number">4</span> <span class="hljs-number">10</span> <span class="hljs-number">3</span> <span class="hljs-number">8</span> <span class="hljs-number">4</span><br><span class="hljs-number">6</span> <span class="hljs-number">6</span> <span class="hljs-number">1</span> <span class="hljs-number">7</span> <span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">9</span><br><span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">8</span> <span class="hljs-number">4</span><br><span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">8</span><br><span class="hljs-number">7</span> <span class="hljs-number">9</span> <span class="hljs-number">8</span> <span class="hljs-number">7</span> <span class="hljs-number">6</span> <span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span><br></code></pre></div></td></tr></table></figure><h4 id="ç¨‹åºè¾“å‡ºï¼š"><a href="#ç¨‹åºè¾“å‡ºï¼š" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">NO<br>YES<br>YES<br>NO<br>NO<br></code></pre></div></td></tr></table></figure><h2 id="é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š"><a href="#é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š" class="headerlink" title="é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š"></a>é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š</h2><p>[<a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805056195379200]">https://pintia.cn/problem-sets/994805046380707840/problems/994805056195379200]</a>: â€œæ ·ä¾‹ä¸€:L2-025 åˆ†è€Œæ²»ä¹‹ (25 åˆ†)â€</p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Data Structure</tag>
      
      <tag>Graph</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DFS-æ·±åº¦ä¼˜å…ˆæœç´¢</title>
    <link href="/2021/12/21/algorithm001/"/>
    <url>/2021/12/21/algorithm001/</url>
    
    <content type="html"><![CDATA[<h1 id="DFS-æ·±åº¦ä¼˜å…ˆæœç´¢"><a href="#DFS-æ·±åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="DFS-æ·±åº¦ä¼˜å…ˆæœç´¢"></a>DFS-æ·±åº¦ä¼˜å…ˆæœç´¢</h1><h2 id="æ ·é¢˜1-å…¨æ’åˆ—"><a href="#æ ·é¢˜1-å…¨æ’åˆ—" class="headerlink" title="æ ·é¢˜1-å…¨æ’åˆ—"></a>æ ·é¢˜1-å…¨æ’åˆ—</h2><h3 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h3><p>è¾“å…¥ä¸€ä¸ªæ•°nï¼Œè¾“å‡ºnçš„å…¨æ’åˆ—</p><h3 id="ç¨‹åºæºä»£ç ï¼š"><a href="#ç¨‹åºæºä»£ç ï¼š" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[<span class="hljs-number">100</span>];<br><span class="hljs-keyword">int</span> book[<span class="hljs-number">100</span>];<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> step)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">if</span>(step==n+<span class="hljs-number">1</span>)  <span class="hljs-comment">//è¿™é‡Œè¡¨ç¤ºdfsç»“æŸ,æ²¡æœ‰å¯ä»¥æ’çš„æ•°å­—äº†</span><br>    &#123;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>;  i&lt;=n ; i++) &#123;<br>            cout&lt;&lt;a[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>        &#125;<br>        cout&lt;&lt;endl;<br>        <span class="hljs-keyword">return</span> ;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(book[i]==<span class="hljs-number">0</span>)  <span class="hljs-comment">//è¯´æ˜æ•°å­—iè¿˜æ²¡æœ‰è¢«ä½¿ç”¨,å¯ä»¥ç”¨æ¥æ’åˆ—</span><br>        &#123;<br>            a[step]=i;<span class="hljs-comment">//æ’åˆ—æ•°å­—i</span><br>            book[i]=<span class="hljs-number">1</span>;<span class="hljs-comment">//æ ‡è®°æ•°å­—iä¸ºå·²ä½¿ç”¨</span><br>            <span class="hljs-built_in">dfs</span>(step+<span class="hljs-number">1</span>);<br>            <span class="hljs-comment">//ç»§ç»­æ’åˆ—æ²¡æœ‰ä½¿ç”¨çš„æ•°å­—</span><br>            book[i]=<span class="hljs-number">0</span>;<br>            <span class="hljs-comment">//è¿™é‡Œè¡¨ç¤ºdfsè°ƒç”¨ç»“æŸäº†,æ„æ€æ˜¯æ•°å­—iå·²ç»å…¨éƒ¨æ’åˆ—å®Œäº†ï¼Œä½†è¿˜éœ€è¦</span><br>            <span class="hljs-comment">//æŒ‰ç…§é¡ºåºå°†æ•°å­—iæ”¶å›ï¼Œé‡æ–°æ’åˆ—ã€‚</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cin&gt;&gt;n;<br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">//dfså‡½æ•°çš„å¼€å§‹</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å…¥ï¼š"><a href="#ç¨‹åºè¾“å…¥ï¼š" class="headerlink" title="ç¨‹åºè¾“å…¥ï¼š"></a>ç¨‹åºè¾“å…¥ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">3</span><br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡ºï¼š"><a href="#ç¨‹åºè¾“å‡ºï¼š" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span><br><span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span><br><span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">3</span><br><span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">1</span><br><span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span><br><span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><h2 id="æ ·é¢˜äºŒ-è‡ªç„¶æ•°çš„æ‹†åˆ†é—®é¢˜"><a href="#æ ·é¢˜äºŒ-è‡ªç„¶æ•°çš„æ‹†åˆ†é—®é¢˜" class="headerlink" title="æ ·é¢˜äºŒ-è‡ªç„¶æ•°çš„æ‹†åˆ†é—®é¢˜"></a>æ ·é¢˜äºŒ-è‡ªç„¶æ•°çš„æ‹†åˆ†é—®é¢˜</h2><h3 id="é¢˜ç›®æè¿°ï¼š-1"><a href="#é¢˜ç›®æè¿°ï¼š-1" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h3><p>ä»»ä½•ä¸€ä¸ªå¤§äº1çš„è‡ªç„¶æ•°nï¼Œæ€»å¯ä»¥æ‹†åˆ†æˆè‹¥å¹²ä¸ªå°äºnçš„è‡ªç„¶æ•°ä¹‹å’Œã€‚ç°åœ¨ç»™ä½ ä¸€ä¸ªè‡ªç„¶æ•°nï¼Œè¦æ±‚ä½ æ±‚å‡ºnçš„æ‹†åˆ†æˆä¸€äº›æ•°å­—çš„å’Œã€‚æ¯ä¸ªæ‹†åˆ†åçš„åºåˆ—ä¸­çš„æ•°å­—ä»å°åˆ°å¤§æ’åºã€‚ç„¶åä½ éœ€è¦è¾“å‡ºè¿™äº›åºåˆ—ï¼Œå…¶ä¸­å­—å…¸åºå°çš„åºåˆ—éœ€è¦ä¼˜å…ˆè¾“å‡ºã€‚</p><h3 id="ç¨‹åºæºä»£ç ï¼š-1"><a href="#ç¨‹åºæºä»£ç ï¼š-1" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">int</span> num;<br><span class="hljs-keyword">int</span> a[<span class="hljs-number">100000</span>]=&#123;<span class="hljs-number">1</span>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n,<span class="hljs-keyword">int</span> t)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=t<span class="hljs-number">-1</span>;i++)<span class="hljs-comment">//è¾“å‡ºä¸€ç§æ‹†åˆ†æ–¹æ¡ˆ</span><br><br>            <span class="hljs-keyword">if</span>(i!=t<span class="hljs-number">-1</span>) cout&lt;&lt;a[i]&lt;&lt;<span class="hljs-string">&quot;+&quot;</span>;<br>            <span class="hljs-keyword">else</span> cout&lt;&lt;a[i];<br>        cout&lt;&lt;endl;<br>        <span class="hljs-keyword">return</span> ;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=a[t<span class="hljs-number">-1</span>];i&lt;=n;i++) &#123;<br>        <span class="hljs-keyword">if</span>(i&lt;num)<span class="hljs-comment">//å½“å‰æ•°iè¦å¤§äºç­‰äºå‰ä¸€ä½æ•°ï¼Œä¸”ä¸è¶…è¿‡n</span><br>        &#123;<br>            a[t]=i;<span class="hljs-comment">//ä¿å­˜å½“å‰æ‹†åˆ†çš„æ•°i</span><br>            n-=i;<span class="hljs-comment">//nå‡å»æ•°iï¼Œnçš„å€¼å°†ç»§ç»­æ‹†åˆ†</span><br>            <span class="hljs-built_in">dfs</span>(n,t+<span class="hljs-number">1</span>);<br>            n+=i;<span class="hljs-comment">//å›æº¯ï¼šåŠ ä¸Šæ‹†åˆ†çš„æ•°ï¼Œä»¥ä¾¿äº§ç”Ÿæ‰€æœ‰å¯èƒ½çš„æ‹†åˆ†</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin&gt;&gt;num;<br>    <span class="hljs-built_in">dfs</span>(num,<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å…¥ï¼š-1"><a href="#ç¨‹åºè¾“å…¥ï¼š-1" class="headerlink" title="ç¨‹åºè¾“å…¥ï¼š"></a>ç¨‹åºè¾“å…¥ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">7</span><br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºè¾“å‡ºï¼š-1"><a href="#ç¨‹åºè¾“å‡ºï¼š-1" class="headerlink" title="ç¨‹åºè¾“å‡ºï¼š"></a>ç¨‹åºè¾“å‡ºï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span><br><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">2</span><br><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">3</span><br><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">2</span>+<span class="hljs-number">2</span><br><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">4</span><br><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">2</span>+<span class="hljs-number">3</span><br><span class="hljs-number">1</span>+<span class="hljs-number">1</span>+<span class="hljs-number">5</span><br><span class="hljs-number">1</span>+<span class="hljs-number">2</span>+<span class="hljs-number">2</span>+<span class="hljs-number">2</span><br><span class="hljs-number">1</span>+<span class="hljs-number">2</span>+<span class="hljs-number">4</span><br><span class="hljs-number">1</span>+<span class="hljs-number">3</span>+<span class="hljs-number">3</span><br><span class="hljs-number">1</span>+<span class="hljs-number">6</span><br><span class="hljs-number">2</span>+<span class="hljs-number">2</span>+<span class="hljs-number">3</span><br><span class="hljs-number">2</span>+<span class="hljs-number">5</span><br><span class="hljs-number">3</span>+<span class="hljs-number">4</span><br></code></pre></div></td></tr></table></figure><h2 id="æ ·ä¾‹ä¸‰ï¼šL2-038-ç—…æ¯’æº¯æº-25-åˆ†"><a href="#æ ·ä¾‹ä¸‰ï¼šL2-038-ç—…æ¯’æº¯æº-25-åˆ†" class="headerlink" title="æ ·ä¾‹ä¸‰ï¼šL2-038 ç—…æ¯’æº¯æº (25 åˆ†)"></a>æ ·ä¾‹ä¸‰ï¼š<strong>L2-038 ç—…æ¯’æº¯æº (25 åˆ†)</strong></h2><h3 id="é¢˜ç›®æè¿°ï¼š-2"><a href="#é¢˜ç›®æè¿°ï¼š-2" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h3><p>ç—…æ¯’å®¹æ˜“å‘ç”Ÿå˜å¼‚ã€‚æŸç§ç—…æ¯’å¯ä»¥é€šè¿‡çªå˜äº§ç”Ÿè‹¥å¹²å˜å¼‚çš„æ¯’æ ªï¼Œè€Œè¿™äº›å˜å¼‚çš„ç—…æ¯’åˆå¯èƒ½è¢«è¯±å‘çªå˜äº§ç”Ÿç¬¬äºŒä»£å˜å¼‚ï¼Œå¦‚æ­¤ç»§ç»­ä¸æ–­å˜åŒ–ã€‚</p><p>ç°ç»™å®šä¸€äº›ç—…æ¯’ä¹‹é—´çš„å˜å¼‚å…³ç³»ï¼Œè¦æ±‚ä½ æ‰¾å‡ºå…¶ä¸­æœ€é•¿çš„ä¸€æ¡å˜å¼‚é“¾ã€‚</p><p>åœ¨æ­¤å‡è®¾ç»™å‡ºçš„å˜å¼‚éƒ½æ˜¯ç”±çªå˜å¼•èµ·çš„ï¼Œä¸è€ƒè™‘å¤æ‚çš„åŸºå› é‡ç»„å˜å¼‚é—®é¢˜ â€”â€” å³æ¯ä¸€ç§ç—…æ¯’éƒ½æ˜¯ç”±å”¯ä¸€çš„ä¸€ç§ç—…æ¯’çªå˜è€Œæ¥ï¼Œå¹¶ä¸”ä¸å­˜åœ¨å¾ªç¯å˜å¼‚çš„æƒ…å†µã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š"><a href="#è¾“å…¥æ ¼å¼ï¼š" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œä¸­ç»™å‡ºä¸€ä¸ªæ­£æ•´æ•° <em>N</em>ï¼ˆâ‰¤104ï¼‰ï¼Œå³ç—…æ¯’ç§ç±»çš„æ€»æ•°ã€‚äºæ˜¯æˆ‘ä»¬å°†æ‰€æœ‰ç—…æ¯’ä» 0 åˆ° <em>N</em>âˆ’1 è¿›è¡Œç¼–å·ã€‚</p><p>éšå <em>N</em> è¡Œï¼Œæ¯è¡ŒæŒ‰ä»¥ä¸‹æ ¼å¼æè¿°ä¸€ç§ç—…æ¯’çš„å˜å¼‚æƒ…å†µï¼š</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">k</span> å˜å¼‚æ ª<span class="hljs-number">1</span> â€¦â€¦ å˜å¼‚æ ªk<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <code>k</code> æ˜¯è¯¥ç—…æ¯’äº§ç”Ÿçš„å˜å¼‚æ¯’æ ªçš„ç§ç±»æ•°ï¼Œåé¢è·Ÿç€æ¯ç§å˜å¼‚æ ªçš„ç¼–å·ã€‚ç¬¬ <em>i</em> è¡Œå¯¹åº”ç¼–å·ä¸º <em>i</em> çš„ç—…æ¯’ï¼ˆ0â‰¤<em>i</em>&lt;<em>N</em>ï¼‰ã€‚é¢˜ç›®ä¿è¯ç—…æ¯’æºå¤´æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š"><a href="#è¾“å‡ºæ ¼å¼ï¼š" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>é¦–å…ˆè¾“å‡ºä»æºå¤´å¼€å§‹æœ€é•¿å˜å¼‚é“¾çš„é•¿åº¦ã€‚</p><p>åœ¨ç¬¬äºŒè¡Œä¸­è¾“å‡ºä»æºå¤´å¼€å§‹æœ€é•¿çš„ä¸€æ¡å˜å¼‚é“¾ï¼Œç¼–å·é—´ä»¥ 1 ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡Œé¦–å°¾ä¸å¾—æœ‰å¤šä½™ç©ºæ ¼ã€‚å¦‚æœæœ€é•¿é“¾ä¸å”¯ä¸€ï¼Œåˆ™è¾“å‡ºæœ€å°åºåˆ—ã€‚</p><p>æ³¨ï¼šæˆ‘ä»¬ç§°åºåˆ— { <em>a</em>1,â‹¯,<em>a**n</em> } æ¯”åºåˆ— { <em>b</em>1,â‹¯,<em>b**n</em> } â€œå°â€ï¼Œå¦‚æœå­˜åœ¨ 1â‰¤<em>k</em>â‰¤<em>n</em> æ»¡è¶³ <em>a**i</em>&#x3D;<em>b**i</em> å¯¹æ‰€æœ‰ <em>i</em>&lt;<em>k</em> æˆç«‹ï¼Œä¸” <em>a**k</em>&lt;<em>b**k</em>ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š"><a href="#è¾“å…¥æ ·ä¾‹ï¼š" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">10<br>3 6 4 8<br>0<br>0<br>0<br>2 5 9<br>0<br>1 7<br>1 2<br>0<br>2 3 1ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">4<br>0 4 9 1ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š-2"><a href="#ç¨‹åºæºä»£ç ï¼š-2" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>vector&lt;<span class="hljs-keyword">int</span>&gt; ans, tmp;<br><span class="hljs-keyword">bool</span> a[<span class="hljs-number">10005</span>][<span class="hljs-number">10005</span>];<br><span class="hljs-keyword">bool</span> book[<span class="hljs-number">10005</span>];<br><span class="hljs-keyword">int</span> maxn;<br><span class="hljs-keyword">int</span> n;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root,<span class="hljs-keyword">int</span> len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(len&gt;maxn)<br>    &#123;<br>        maxn =len;<br>        ans = tmp;<br><br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(len == maxn &amp;&amp; tmp &lt; ans)<br>    &#123;<br>        ans = tmp;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(a[root][i]) <span class="hljs-comment">//è¿é€š</span><br>        &#123;<br>            tmp.<span class="hljs-built_in">push_back</span>(i);<br>            <span class="hljs-built_in">dfs</span>(i,len+<span class="hljs-number">1</span>);<br>            tmp.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>    cin&gt;&gt;n;<br>    <span class="hljs-keyword">int</span> root=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;n ; ++i) &#123;<br>        <span class="hljs-keyword">int</span> k;<br>        cin&gt;&gt;k;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;k ; ++j) &#123;<br>            <span class="hljs-keyword">int</span> x;<br>            cin&gt;&gt;x;<br>            book[x]=<span class="hljs-literal">true</span>;    <span class="hljs-comment">//ç”¨æ¥åˆ¤æ–­è°æ˜¯ç—…æ¯’æºå¤´ï¼Œé¢˜ç›®ç»™å‡ºç—…æ¯’æºå¤´æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª</span><br>            a[i][x]=<span class="hljs-literal">true</span>;    <span class="hljs-comment">//ä½¿ç”¨é‚»æ¥çŸ©é˜µæ¥å‚¨å­˜å›¾ï¼Œè¿é€šä¸ºtrueï¼Œå¦åˆ™ä¸ºfalse</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">while</span>(book[root]) root++;  <span class="hljs-comment">//å¯»æ‰¾ç—…æ¯’æºå¤´</span><br>    tmp.<span class="hljs-built_in">push_back</span>(root);<br>    <span class="hljs-built_in">dfs</span>(root,<span class="hljs-number">1</span>); <span class="hljs-comment">//ä»ç—…æ¯’æºå¤´å¼€å§‹dfs</span><br>    cout&lt;&lt;ans.<span class="hljs-built_in">size</span>()&lt;&lt;endl;<br>    <span class="hljs-comment">//è¾“å‡ºæ ¼å¼æ§åˆ¶</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i &lt; ans.<span class="hljs-built_in">size</span>(); i++)&#123;<br>       <span class="hljs-keyword">if</span>(i!=ans.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>)<br>       &#123;<br>           cout&lt;&lt;ans[i]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>       &#125;<br>       <span class="hljs-keyword">else</span><br>       &#123;<br>           cout&lt;&lt;ans[i];<br>       &#125;<br>        <br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ ·é¢˜å››ï¼šL2-020-åŠŸå¤«ä¼ äºº-25-åˆ†"><a href="#æ ·é¢˜å››ï¼šL2-020-åŠŸå¤«ä¼ äºº-25-åˆ†" class="headerlink" title="æ ·é¢˜å››ï¼šL2-020 åŠŸå¤«ä¼ äºº (25 åˆ†)"></a>æ ·é¢˜å››ï¼š<strong>L2-020 åŠŸå¤«ä¼ äºº (25 åˆ†)</strong></h2><h3 id="é¢˜ç›®æè¿°ï¼š-3"><a href="#é¢˜ç›®æè¿°ï¼š-3" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h3><p>ä¸€é—¨æ­¦åŠŸèƒ½å¦ä¼ æ‰¿ä¹…è¿œå¹¶è¢«å‘æ‰¬å…‰å¤§ï¼Œæ˜¯è¦çœ‹ç¼˜åˆ†çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¸ˆå‚…ä¼ æˆç»™å¾’å¼Ÿçš„æ­¦åŠŸæ€»è¦æ‰“ä¸ªæŠ˜æ‰£ï¼Œäºæ˜¯è¶Šå¾€åä¼ ï¼Œå¼Ÿå­ä»¬çš„åŠŸå¤«å°±è¶Šå¼±â€¦â€¦ ç›´åˆ°æŸä¸€æ”¯çš„æŸä¸€ä»£çªç„¶å‡ºç°ä¸€ä¸ªå¤©åˆ†ç‰¹åˆ«é«˜çš„å¼Ÿå­ï¼ˆæˆ–è€…æ˜¯åƒåˆ°äº†çµä¸¹ã€æŒ–åˆ°äº†ç‰¹åˆ«çš„ç§˜ç¬ˆï¼‰ï¼Œä¼šå°†åŠŸå¤«çš„å¨åŠ›ä¸€ä¸‹å­æ”¾å¤§Nå€ â€”â€” æˆ‘ä»¬ç§°è¿™ç§å¼Ÿå­ä¸ºâ€œå¾—é“è€…â€ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æ¥è€ƒå¯ŸæŸä¸€ä½ç¥–å¸ˆçˆ·é—¨ä¸‹çš„å¾’å­å¾’å­™å®¶è°±ï¼šå‡è®¾å®¶è°±ä¸­çš„æ¯ä¸ªäººåªæœ‰1ä½å¸ˆå‚…ï¼ˆé™¤äº†ç¥–å¸ˆçˆ·æ²¡æœ‰å¸ˆå‚…ï¼‰ï¼›æ¯ä½å¸ˆå‚…å¯ä»¥å¸¦å¾ˆå¤šå¾’å¼Ÿï¼›å¹¶ä¸”å‡è®¾è¾ˆåˆ†ä¸¥æ ¼æœ‰åºï¼Œå³ç¥–å¸ˆçˆ·è¿™é—¨æ­¦åŠŸçš„æ¯ä¸ªç¬¬<code>i</code>ä»£ä¼ äººåªèƒ½åœ¨ç¬¬<code>i-1</code>ä»£ä¼ äººä¸­æ‹œ1ä¸ªå¸ˆå‚…ã€‚æˆ‘ä»¬å‡è®¾å·²çŸ¥ç¥–å¸ˆçˆ·çš„åŠŸåŠ›å€¼ä¸º<code>Z</code>ï¼Œæ¯å‘ä¸‹ä¼ æ‰¿ä¸€ä»£ï¼Œå°±ä¼šå‡å¼±<code>r%</code>ï¼Œé™¤éæŸä¸€ä»£å¼Ÿå­å¾—é“ã€‚ç°ç»™å‡ºå¸ˆé—¨è°±ç³»å…³ç³»ï¼Œè¦æ±‚ä½ ç®—å‡ºæ‰€æœ‰å¾—é“è€…çš„åŠŸåŠ›æ€»å€¼ã€‚</p><h3 id="è¾“å…¥æ ¼å¼ï¼š-1"><a href="#è¾“å…¥æ ¼å¼ï¼š-1" class="headerlink" title="è¾“å…¥æ ¼å¼ï¼š"></a>è¾“å…¥æ ¼å¼ï¼š</h3><p>è¾“å…¥åœ¨ç¬¬ä¸€è¡Œç»™å‡º3ä¸ªæ­£æ•´æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼š<em>N</em>ï¼ˆâ‰¤105ï¼‰â€”â€”æ•´ä¸ªå¸ˆé—¨çš„æ€»äººæ•°ï¼ˆäºæ˜¯æ¯ä¸ªäººä»0åˆ°<em>N</em>âˆ’1ç¼–å·ï¼Œç¥–å¸ˆçˆ·çš„ç¼–å·ä¸º0ï¼‰ï¼›<em>Z</em>â€”â€”ç¥–å¸ˆçˆ·çš„åŠŸåŠ›å€¼ï¼ˆä¸ä¸€å®šæ˜¯æ•´æ•°ï¼Œä½†èµ·ç æ˜¯æ­£æ•°ï¼‰ï¼›<em>r</em> â€”â€”æ¯ä¼ ä¸€ä»£åŠŸå¤«æ‰€æ‰“çš„æŠ˜æ‰£ç™¾åˆ†æ¯”å€¼ï¼ˆä¸è¶…è¿‡100çš„æ­£æ•°ï¼‰ã€‚æ¥ä¸‹æ¥æœ‰<em>N</em>è¡Œï¼Œç¬¬<em>i</em>è¡Œï¼ˆ<em>i</em>&#x3D;0,â‹¯,<em>N</em>âˆ’1ï¼‰æè¿°ç¼–å·ä¸º<em>i</em>çš„äººæ‰€ä¼ çš„å¾’å¼Ÿï¼Œæ ¼å¼ä¸ºï¼š</p><p><em>K**i</em> ID[1] ID[2] â‹¯ ID[<em>K**i</em>]</p><p>å…¶ä¸­<em>K**i</em>æ˜¯å¾’å¼Ÿçš„ä¸ªæ•°ï¼Œåé¢è·Ÿçš„æ˜¯å„ä½å¾’å¼Ÿçš„ç¼–å·ï¼Œæ•°å­—é—´ä»¥ç©ºæ ¼é—´éš”ã€‚<em>K**i</em>ä¸ºé›¶è¡¨ç¤ºè¿™æ˜¯ä¸€ä½å¾—é“è€…ï¼Œè¿™æ—¶åé¢è·Ÿçš„ä¸€ä¸ªæ•°å­—è¡¨ç¤ºå…¶æ­¦åŠŸè¢«æ”¾å¤§çš„å€æ•°ã€‚</p><h3 id="è¾“å‡ºæ ¼å¼ï¼š-1"><a href="#è¾“å‡ºæ ¼å¼ï¼š-1" class="headerlink" title="è¾“å‡ºæ ¼å¼ï¼š"></a>è¾“å‡ºæ ¼å¼ï¼š</h3><p>åœ¨ä¸€è¡Œä¸­è¾“å‡ºæ‰€æœ‰å¾—é“è€…çš„åŠŸåŠ›æ€»å€¼ï¼Œåªä¿ç•™å…¶æ•´æ•°éƒ¨åˆ†ã€‚é¢˜ç›®ä¿è¯è¾“å…¥å’Œæ­£ç¡®çš„è¾“å‡ºéƒ½ä¸è¶…è¿‡1010ã€‚</p><h3 id="è¾“å…¥æ ·ä¾‹ï¼š-1"><a href="#è¾“å…¥æ ·ä¾‹ï¼š-1" class="headerlink" title="è¾“å…¥æ ·ä¾‹ï¼š"></a>è¾“å…¥æ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs in">10 18.0 1.00<br>3 2 3 5<br>1 9<br>1 4<br>1 7<br>0 7<br>2 6 1<br>1 8<br>0 9<br>0 4<br>0 3ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºæ ·ä¾‹ï¼š-1"><a href="#è¾“å‡ºæ ·ä¾‹ï¼š-1" class="headerlink" title="è¾“å‡ºæ ·ä¾‹ï¼š"></a>è¾“å‡ºæ ·ä¾‹ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs out">404<br>ç»“å°¾æ— ç©ºè¡Œ<br></code></pre></div></td></tr></table></figure><h3 id="ç¨‹åºæºä»£ç ï¼š-3"><a href="#ç¨‹åºæºä»£ç ï¼š-3" class="headerlink" title="ç¨‹åºæºä»£ç ï¼š"></a>ç¨‹åºæºä»£ç ï¼š</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>vector&lt;<span class="hljs-keyword">int</span>&gt; tree[<span class="hljs-number">100000</span>];  <span class="hljs-comment">//ç”¨äºé‚»æ¥è¡¨å»ºæ ‘</span><br><span class="hljs-keyword">int</span> book[<span class="hljs-number">100000</span>];<br><span class="hljs-keyword">double</span> sum;<br><span class="hljs-keyword">double</span> r;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index,<span class="hljs-keyword">double</span> power)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(book[index]) <span class="hljs-comment">//æ˜¯å¾—é“è€…å°±ä¹˜ä»–çš„å€æ•° </span><br>    &#123;<br>        sum += power * book[index];<br>        <span class="hljs-keyword">return</span> ;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;tree[index].<span class="hljs-built_in">size</span>();i++)  <span class="hljs-comment">//éå†æ•´ä¸ªæ ‘</span><br>    &#123;<br>        <span class="hljs-built_in">dfs</span>(tree[index][i],power*r);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    <span class="hljs-keyword">double</span> z;<br>    cin&gt;&gt;n&gt;&gt;z&gt;&gt;r;<br>    r=(<span class="hljs-number">100</span>-r)/<span class="hljs-number">100.0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)<br>    &#123;<br>        <span class="hljs-keyword">int</span> k;<br>        cin&gt;&gt;k;<br>        <span class="hljs-keyword">if</span>(k==<span class="hljs-number">0</span>)   <span class="hljs-comment">//è¿™ä¸ªå¼Ÿå­æ˜¯å¦ä¸ºå¾—é“è€…</span><br>        &#123;<br>            <span class="hljs-keyword">int</span> power;<br>            cin&gt;&gt;power;<br>            book[i]=power;   <span class="hljs-comment">//è®°å½•å¾—é“è€…æ”¾å¤§å€æ•°</span><br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;k;j++)<br>            &#123;<br>                <span class="hljs-keyword">int</span> id;<br>                cin&gt;&gt;id;<br>                tree[i].<span class="hljs-built_in">push_back</span>(id);      <span class="hljs-comment">//ä½¿ç”¨é‚»æ¥è¡¨å»ºæ ‘</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">0</span>,z);<br>    cout&lt;&lt;(<span class="hljs-keyword">int</span>)sum&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š"><a href="#é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š" class="headerlink" title="é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š"></a>é¢˜ç›®ç›¸å…³é“¾æ¥ï¼š</h2><p>[<a href="https://www.luogu.com.cn/problem/P2404">P2404 è‡ªç„¶æ•°çš„æ‹†åˆ†é—®é¢˜ - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)</a>]: â€œ æ ·ä¾‹äºŒ-è‡ªç„¶æ•°çš„æ‹†åˆ†é—®é¢˜â€</p><p>[<a href="https://www.luogu.com.cn/problem/P2404"><a href="https://pintia.cn/problem-sets/994805046380707840/problems/1386335159927652361">é¢˜ç›®è¯¦æƒ… - L2-038 ç—…æ¯’æº¯æº (25 åˆ†) (pintia.cn)</a></a>]: â€œ æ ·ä¾‹ä¸‰-L2-038 ç—…æ¯’æº¯æº (25 åˆ†)â€</p><p>[<a href="https://www.luogu.com.cn/problem/P2404"><a href="https://pintia.cn/problem-sets/994805046380707840/problems/994805059118809088">é¢˜ç›®è¯¦æƒ… - L2-020 åŠŸå¤«ä¼ äºº (25 åˆ†) (pintia.cn)</a></a>]: â€œ æ ·ä¾‹å››-L2-020 åŠŸå¤«ä¼ äºº (25 åˆ†)â€</p>]]></content>
    
    
    <categories>
      
      <category>Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Machine Learning(ä¸€) ä¸€ä¸ªç¥ç»å…ƒç½‘ç»œ-çº¿æ€§å‡½æ•°</title>
    <link href="/2021/12/09/tensorflow001/"/>
    <url>/2021/12/09/tensorflow001/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ä¸ªç¥ç»å…ƒçš„ç½‘ç»œ-çº¿æ€§å‡½æ•°"><a href="#ä¸€ä¸ªç¥ç»å…ƒçš„ç½‘ç»œ-çº¿æ€§å‡½æ•°" class="headerlink" title="ä¸€ä¸ªç¥ç»å…ƒçš„ç½‘ç»œ(çº¿æ€§å‡½æ•°)"></a>ä¸€ä¸ªç¥ç»å…ƒçš„ç½‘ç»œ(çº¿æ€§å‡½æ•°)</h1><p>çº¿æ€§å‡½æ•° y &#x3D; 2 * x -1 </p><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment">#æ„å»ºæ¨¡å‹</span><br>model = keras.Sequential([keras.layers.Dense(units=<span class="hljs-number">1</span>,input_shape=[<span class="hljs-number">1</span>])])<br>model.<span class="hljs-built_in">compile</span>(optimizer=<span class="hljs-string">&#x27;sgd&#x27;</span>,loss=<span class="hljs-string">&#x27;mean_squared_error&#x27;</span>)<br><span class="hljs-comment">#å‡†å¤‡è®­ç»ƒæ•°æ®</span><br>xs=np.array([-<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">2.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">4.0</span>], dtype = <span class="hljs-built_in">float</span>)<br>ys=np.array([-<span class="hljs-number">3.0</span>,-<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">7.0</span>], dtype = <span class="hljs-built_in">float</span>)<br><span class="hljs-comment">#è®­ç»ƒæ¨¡å‹</span><br>model.fit(xs,ys,epochs=<span class="hljs-number">500</span>)<br></code></pre></div></td></tr></table></figure><h2 id="è®­ç»ƒæ¨¡å‹è¿‡ç¨‹-æˆªå–"><a href="#è®­ç»ƒæ¨¡å‹è¿‡ç¨‹-æˆªå–" class="headerlink" title="è®­ç»ƒæ¨¡å‹è¿‡ç¨‹(æˆªå–)"></a>è®­ç»ƒæ¨¡å‹è¿‡ç¨‹(æˆªå–)</h2><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">Epoch <span class="hljs-number">1</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 388ms/step - loss: <span class="hljs-number">3.4976</span><br>Epoch <span class="hljs-number">2</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 3ms/step - loss: <span class="hljs-number">2.9127</span><br>Epoch <span class="hljs-number">3</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 3ms/step - loss: <span class="hljs-number">2.4493</span><br>Epoch <span class="hljs-number">4</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 3ms/step - loss: <span class="hljs-number">2.0814</span><br>Epoch <span class="hljs-number">5</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 4ms/step - loss: <span class="hljs-number">1.7888</span><br>Epoch <span class="hljs-number">6</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 4ms/step - loss: <span class="hljs-number">1.5555</span><br>Epoch <span class="hljs-number">7</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 4ms/step - loss: <span class="hljs-number">1.3689</span><br>Epoch <span class="hljs-number">8</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 4ms/step - loss: <span class="hljs-number">1.2191</span><br>Epoch <span class="hljs-number">9</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 3ms/step - loss: <span class="hljs-number">1.0983</span><br>Epoch <span class="hljs-number">10</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 4ms/step - loss: <span class="hljs-number">1.0005</span><br>Epoch <span class="hljs-number">11</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 4ms/step - loss: <span class="hljs-number">0.9207</span><br>Epoch <span class="hljs-number">12</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 2ms/step - loss: <span class="hljs-number">0.8551</span><br>Epoch <span class="hljs-number">13</span>/<span class="hljs-number">500</span><br><span class="hljs-number">1</span>/<span class="hljs-number">1</span> [==============================] - 0s 5ms/step - loss: <span class="hljs-number">0.8009</span><br></code></pre></div></td></tr></table></figure><h2 id="ä½¿ç”¨æ¨¡å‹"><a href="#ä½¿ç”¨æ¨¡å‹" class="headerlink" title="ä½¿ç”¨æ¨¡å‹"></a>ä½¿ç”¨æ¨¡å‹</h2><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#ä½¿ç”¨æ¨¡å‹(è¾“å…¥)</span><br><span class="hljs-built_in">print</span>(model.predict([<span class="hljs-number">2021</span>]))<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#è¾“å‡º</span><br>[[<span class="hljs-number">4036.6035</span>]]<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#è¾“å…¥</span><br>model.predict([<span class="hljs-number">10.0</span>])<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">#è¾“å‡º</span><br>array([[<span class="hljs-number">18.984968</span>]], dtype=float32)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tensorflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MPIå­¦ä¹ (å››)-å¹¿æ’­ã€æ•£æ’­ã€æ”¶é›†ã€å½’çº¦å’Œå…¨å½’çº¦çš„MPIè¯­æ³•</title>
    <link href="/2021/11/27/mpi004/"/>
    <url>/2021/11/27/mpi004/</url>
    
    <content type="html"><![CDATA[<h1 id="MPI-å¹¿æ’­ã€æ•£æ’­ã€æ”¶é›†ã€å½’çº¦å’Œå…¨å½’çº¦çš„MPIè¯­æ³•"><a href="#MPI-å¹¿æ’­ã€æ•£æ’­ã€æ”¶é›†ã€å½’çº¦å’Œå…¨å½’çº¦çš„MPIè¯­æ³•" class="headerlink" title="MPI-å¹¿æ’­ã€æ•£æ’­ã€æ”¶é›†ã€å½’çº¦å’Œå…¨å½’çº¦çš„MPIè¯­æ³•"></a>MPI-å¹¿æ’­ã€æ•£æ’­ã€æ”¶é›†ã€å½’çº¦å’Œå…¨å½’çº¦çš„MPIè¯­æ³•</h1><h2 id="å¹¿æ’­ï¼šMPI-Bcast"><a href="#å¹¿æ’­ï¼šMPI-Bcast" class="headerlink" title="å¹¿æ’­ï¼šMPI_Bcast"></a>å¹¿æ’­ï¼šMPI_Bcast</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Bcast</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *buffer, <span class="hljs-keyword">int</span> count, MPI_Datatype datatype, <span class="hljs-keyword">int</span> root, MPI_Comm comm)</span></span><br><span class="hljs-function"><span class="hljs-comment">//int root å¹¿æ’­æ•°æ®çš„æ ¹è¿›ç¨‹çš„æ ‡è¯†å·(æ•´å‹)</span></span><br></code></pre></div></td></tr></table></figure><p><img src="/2021/11/27/mpi004/mpi001.png"></p><h2 id="æ•£æ’­ï¼šMPI-Scatter"><a href="#æ•£æ’­ï¼šMPI-Scatter" class="headerlink" title="æ•£æ’­ï¼šMPI_Scatter"></a>æ•£æ’­ï¼šMPI_Scatter</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Scatter</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sendbuf, <span class="hljs-keyword">int</span> sendcount, MPI_Datatype sendtype, <span class="hljs-keyword">void</span> *recvbuf, <span class="hljs-keyword">int</span> root, MPI_Comm comm)</span></span><br><span class="hljs-function"><span class="hljs-comment">//void *sendbuf å‘é€æ¶ˆæ¯ç¼“å†²åŒºçš„èµ·å§‹åœ°å€(å¯é€‰æ•°æ®ç±»å‹)</span></span><br><span class="hljs-function"><span class="hljs-comment">//void *recvbuf æ¥æ”¶æ¶ˆæ¯ç¼“å†²åŒºçš„èµ·å§‹åœ°å€(å¯é€‰æ•°æ®ç±»å‹)</span></span><br><span class="hljs-function"></span><br></code></pre></div></td></tr></table></figure><p><img src="/2021/11/27/mpi004/mpi002.png"></p><h2 id="æ”¶é›†ï¼šMPI-Gather"><a href="#æ”¶é›†ï¼šMPI-Gather" class="headerlink" title="æ”¶é›†ï¼šMPI_Gather"></a>æ”¶é›†ï¼šMPI_Gather</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Gather</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sendbuf, <span class="hljs-keyword">int</span> sendcount, MPI_Datatype sendtype, <span class="hljs-keyword">void</span> *recvbuf, <span class="hljs-keyword">int</span> recvcount, MPI_Datatype recvtype, <span class="hljs-keyword">int</span> root, MPI_Comm comm)</span></span><br></code></pre></div></td></tr></table></figure><p><img src="/2021/11/27/mpi004/mpi003.png"></p><h2 id="å½’çº¦ï¼šMPI-Reduce"><a href="#å½’çº¦ï¼šMPI-Reduce" class="headerlink" title="å½’çº¦ï¼šMPI_Reduce"></a>å½’çº¦ï¼šMPI_Reduce</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Reduce</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sendbuf, <span class="hljs-keyword">void</span> *recvbuf, <span class="hljs-keyword">int</span> count, MPI_Datatype datatype, MPI_Op op, <span class="hljs-keyword">int</span> root,  MPI_Comm comm)</span></span><br><span class="hljs-function"><span class="hljs-comment">//MPI_Op op  å½’çº¦æ“ä½œç¬¦(å¥æŸ„)</span></span><br></code></pre></div></td></tr></table></figure><p><img src="/2021/11/27/mpi004/mpi004.png"></p><p><img src="/2021/11/27/mpi004/mpi005.png"></p><h2 id="å…¨å½’çº¦ï¼šMPI-Allreduce"><a href="#å…¨å½’çº¦ï¼šMPI-Allreduce" class="headerlink" title="å…¨å½’çº¦ï¼šMPI_Allreduce"></a>å…¨å½’çº¦ï¼šMPI_Allreduce</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Allreduce</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sendbuf, <span class="hljs-keyword">void</span> *recvbuf, <span class="hljs-keyword">int</span> count, MPI_Datatype datatype, MPI_Op op, MPI_Comm comm)</span></span><br></code></pre></div></td></tr></table></figure><p><img src="/2021/11/27/mpi004/mpi006.png"></p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MPIå­¦ä¹ (ä¸‰)-é€šè¿‡OpenmMPä½¿ç”¨MPI</title>
    <link href="/2021/11/26/mpi003/"/>
    <url>/2021/11/26/mpi003/</url>
    
    <content type="html"><![CDATA[<h1 id="MPI-é€šè¿‡OpenMPä½¿ç”¨MPI"><a href="#MPI-é€šè¿‡OpenMPä½¿ç”¨MPI" class="headerlink" title="MPI-é€šè¿‡OpenMPä½¿ç”¨MPI"></a>MPI-é€šè¿‡OpenMPä½¿ç”¨MPI</h1><p>OpenMPæ˜¯å¦ä¸€ç§ä¸ºåŸºäºå…±äº«å†…å­˜çš„å¹¶è¡Œç¼–ç¨‹æä¾›çš„åº”ç”¨ç¼–ç¨‹æ¥å£ã€‚å½“äººä»¬æƒ³ä½¿ç”¨å¤šæ ¸å¤„ç†å™¨æ—¶ï¼Œé€šå¸¸ä½¿ç”¨OpenMPã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªâ€œHello Worldâ€ç¨‹åºï¼Œä½¿ç”¨äº†MPIå’ŒOpenMPçš„APIã€‚</p><h2 id="ç¨‹åºè¿è¡Œå¹³å°"><a href="#ç¨‹åºè¿è¡Œå¹³å°" class="headerlink" title="ç¨‹åºè¿è¡Œå¹³å°"></a>ç¨‹åºè¿è¡Œå¹³å°</h2><p>åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒA3åˆ†åŒº</p><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><p>mpi&#x2F;intel&#x2F;2017.5</p><h2 id="ç¼–è¯‘æŒ‡ä»¤"><a href="#ç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="ç¼–è¯‘æŒ‡ä»¤"></a>ç¼–è¯‘æŒ‡ä»¤</h2><p>mpic++    -fopenmp  mpi003.cpp -o mpi003</p><h2 id="è¿è¡ŒæŒ‡ä»¤"><a href="#è¿è¡ŒæŒ‡ä»¤" class="headerlink" title="è¿è¡ŒæŒ‡ä»¤"></a>è¿è¡ŒæŒ‡ä»¤</h2><p>srun -p amd_256 -N 2 -n  2   .&#x2F;mpi003(ä½¿ç”¨SLURMä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ)</p><p>2ä¸ªåˆ†åŒºï¼Œæ ¸æ•°ä¸º2</p><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;math.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;omp.h&gt;</span>  <span class="hljs-comment">//OpenMPæ‰€éœ€è¦çš„å¤´æ–‡ä»¶</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mpi.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span>  <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> myid, numprocs;<br><span class="hljs-keyword">int</span> namelen;<br><span class="hljs-keyword">int</span> thread_id , nthreads;<br><span class="hljs-keyword">char</span> processor_name[MPI_MAX_PROCESSOR_NAME];<br><span class="hljs-built_in">MPI_Init</span>(&amp;argc, &amp;argv);<br><span class="hljs-built_in">MPI_Comm_rank</span>(MPI_COMM_WORLD, &amp;myid);<br><span class="hljs-built_in">MPI_Comm_size</span>(MPI_COMM_WORLD, &amp;numprocs);<br><span class="hljs-built_in">MPI_Get_processor_name</span>(processor_name, &amp;namelen);<br>    <span class="hljs-comment">//æ„é€ å¹¶è¡ŒåŒº</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> omp parallel private(thread_id, nthreads) num_threads(8) <span class="hljs-comment">//è®¾ç½®çº¿ç¨‹æ•°ä¸º8</span></span><br>&#123;<br>thread_id = <span class="hljs-built_in">omp_get_thread_num</span>();  <span class="hljs-comment">//è·å¾—å½“å‰çº¿ç¨‹çš„id</span><br>nthreads = <span class="hljs-built_in">omp_get_num_threads</span>();  <span class="hljs-comment">//è·å¾—æ€»çš„çº¿ç¨‹æ•°</span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Thread number %d (on %d) for the MPI process number %d (on %d) [%s]\n&quot;</span>,<br>thread_id, nthreads, myid, numprocs, processor_name);<br>&#125; <br><span class="hljs-built_in">MPI_Finalize</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¿è¡Œç»“æœ"><a href="#ç¨‹åºè¿è¡Œç»“æœ" class="headerlink" title="ç¨‹åºè¿è¡Œç»“æœ"></a>ç¨‹åºè¿è¡Œç»“æœ</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">Thread number <span class="hljs-number">0</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">4</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">3</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">5</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">2</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">6</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">0</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">1</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">2</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">5</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">1</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">7</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">1</span> (on <span class="hljs-number">2</span>) [eb1316.para.bscc]<br>Thread number <span class="hljs-number">3</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">4</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">6</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br>Thread number <span class="hljs-number">7</span> (on <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> the MPI process number <span class="hljs-number">0</span> (on <span class="hljs-number">2</span>) [eb1314.para.bscc]<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MPIå­¦ä¹ (äºŒ)-éé˜»å¡é€šä¿¡ç¨‹åº(æ— ç¼“å†²)</title>
    <link href="/2021/11/26/mpi002/"/>
    <url>/2021/11/26/mpi002/</url>
    
    <content type="html"><![CDATA[<h1 id="MPI-éé˜»å¡é€šä¿¡ç¨‹åº-æ— ç¼“å†²"><a href="#MPI-éé˜»å¡é€šä¿¡ç¨‹åº-æ— ç¼“å†²" class="headerlink" title="MPI-éé˜»å¡é€šä¿¡ç¨‹åº(æ— ç¼“å†²)"></a>MPI-éé˜»å¡é€šä¿¡ç¨‹åº(æ— ç¼“å†²)</h1><p>éé˜»å¡é€šä¿¡ç¨‹åº(æ— ç¼“å†²)æ˜¯ç”±MPIä¸­çš„Isendå’ŒIreceiveæ¥è¡¨ç¤ºçš„ï¼Œå³å¼‚æ­¥é€šä¿¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€è¿›ç¨‹å‘å¸ƒä¸€æ¡â€œå‘é€æˆæƒè¯·æ±‚â€(æŒ‚èµ·çš„æ¶ˆæ¯)çš„æ¶ˆæ¯ï¼Œå¹¶ç»§ç»­å…¶ç¨‹åºçš„æ‰§è¡Œã€‚å½“æ¥æ”¶è¿›ç¨‹å‘å¸ƒä¸€ä¸ªâ€œåŒæ„å‘é€â€è®¸å¯æŒ‡ä»¤æ—¶ï¼Œæ•°æ®ä¼ è¾“å°±å¯åŠ¨äº†ã€‚æ‰€æœ‰çš„è¿™äº›æœºåˆ¶éƒ½æ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿçš„ä¿¡å·è¿›è¡Œå†…éƒ¨ç®¡ç†çš„ã€‚å½“æ•°æ®ä¼ è¾“å®Œæˆæ—¶ï¼Œæ£€æŸ¥çŠ¶æ€å¹¶æŒ‡ç¤ºè¿›ç¨‹æ˜¯å¦å¯ä»¥å®‰å…¨åœ°è¿›è¡Œè¯»&#x2F;å†™æ•°æ®ã€‚                                                                      éœ€è¦æ³¨æ„çš„æ˜¯åŸè¯­MPI_Wait(&amp;request,&amp;status)ç­‰åˆ°æ•°æ®ä¼ è¾“å®Œæˆ(æˆ–ä¸­æ–­å)ï¼Œä½¿ç”¨ä¸€ä¸ªæˆä¸ºstatusçš„çŠ¶æ€å˜é‡æ¥æŒ‡ç¤ºæ•°æ®ä¼ è¾“æ˜¯å¦å·²ç»æˆåŠŸã€‚</p><h2 id="ç›¸å…³çš„MPIåŸè¯­"><a href="#ç›¸å…³çš„MPIåŸè¯­" class="headerlink" title="ç›¸å…³çš„MPIåŸè¯­"></a>ç›¸å…³çš„MPIåŸè¯­</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Isend</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">int</span> count, MPI_Datatype datatype, <span class="hljs-keyword">int</span> dest, <span class="hljs-keyword">int</span> tag, MPI_comm comm, MPI_Request *req)</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Irecv</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *buf, <span class="hljs-keyword">int</span> count, MPI_Datatype datatype, <span class="hljs-keyword">int</span> src, <span class="hljs-keyword">int</span> tag, MPI_Comm comm, MPI_Request *req)</span></span><br></code></pre></div></td></tr></table></figure><p>MPI_Requestç»“æ„ä¸­ç»å¸¸ä½¿ç”¨çš„ï¼šå½“*reqæ“ä½œå®Œæˆæ—¶è¿”å› *flag &#x3D; 1,å¦åˆ™è¿”å› 0ã€‚</p><p>åŸè¯­MPI_Waitä¸€ç›´ç­‰åˆ°*reqæ‰€æ‰§è¡Œçš„æ“ä½œå®Œæˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MPI_Wait</span><span class="hljs-params">(MPI_Request *req, MPI_Status *status)</span></span><br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¿è¡Œå¹³å°"><a href="#ç¨‹åºè¿è¡Œå¹³å°" class="headerlink" title="ç¨‹åºè¿è¡Œå¹³å°"></a>ç¨‹åºè¿è¡Œå¹³å°</h2><p>åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒA3åˆ†åŒº</p><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><p>mpi&#x2F;intel&#x2F;2017.5</p><h2 id="ç¼–è¯‘æŒ‡ä»¤"><a href="#ç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="ç¼–è¯‘æŒ‡ä»¤"></a>ç¼–è¯‘æŒ‡ä»¤</h2><p>mpicc  mpi002.cpp -o mpi002</p><h2 id="è¿è¡ŒæŒ‡ä»¤"><a href="#è¿è¡ŒæŒ‡ä»¤" class="headerlink" title="è¿è¡ŒæŒ‡ä»¤"></a>è¿è¡ŒæŒ‡ä»¤</h2><p>mpirun -np 10   .&#x2F;mpi002(æœ¬åœ°æäº¤,é‡‡å–10ä¸ªè¿›ç¨‹)</p><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mpi.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;math.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">int</span> myid, numprocs;<br><span class="hljs-keyword">int</span> tag,source,destination,count;<br><span class="hljs-keyword">int</span> buffer;<br>MPI_Status status;<br>MPI_Request request;<br><span class="hljs-built_in">MPI_Init</span>(&amp;argc,&amp;argv);<br><span class="hljs-built_in">MPI_Comm_size</span>(MPI_COMM_WORLD,&amp;numprocs);<br><span class="hljs-built_in">MPI_Comm_rank</span>(MPI_COMM_WORLD,&amp;myid);<br>tag =<span class="hljs-number">2021</span>; <span class="hljs-comment">/* any integer to tag messages */</span><br>source = <span class="hljs-number">0</span>;<br>count = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span>(myid != source )<br>&#123;<br>buffer =<span class="hljs-number">2077</span>;<br><span class="hljs-comment">//å…¶ä»–è¿›ç¨‹å‘0å·è¿›ç¨‹å‘é€æ¶ˆæ¯</span><br><span class="hljs-built_in">MPI_Isend</span>(&amp;buffer,count,MPI_INT,source,tag,MPI_COMM_WORLD,&amp;request);<br><span class="hljs-built_in">MPI_Wait</span>(&amp;request,&amp;status);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;processor %d send %d to processor %d\n&quot;</span>,myid,buffer,source);<br>&#125;<br><br><span class="hljs-keyword">if</span>(myid == source )<br>&#123;<br><span class="hljs-comment">//0å·è¿›ç¨‹æ¥æ”¶æ¥è‡ªå…¶ä»–è¿›ç¨‹çš„æ¶ˆæ¯</span><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;numprocs;i++)<br>&#123;<br><span class="hljs-built_in">MPI_Irecv</span>(&amp;buffer,count,MPI_INT,i,tag,MPI_COMM_WORLD,&amp;request);<br><span class="hljs-built_in">MPI_Wait</span>(&amp;request,&amp;status);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;processor %d received %d from processor %d \n&quot;</span>,myid,buffer,i);<br>&#125;<br><br>&#125;<br><br><span class="hljs-built_in">MPI_Finalize</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">processor <span class="hljs-number">2</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">3</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">5</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">6</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">7</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">8</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">9</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">4</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">1</span> send <span class="hljs-number">2077</span> to processor <span class="hljs-number">0</span><br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">1</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">2</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">3</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">4</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">5</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">6</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">7</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">8</span> <br>processor <span class="hljs-number">0</span> received <span class="hljs-number">2077</span> from processor <span class="hljs-number">9</span> <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AVXå‘é‡åŒ–å­¦ä¹ (ä¸‰)-ifåˆ¤æ–­çš„å¤„ç†</title>
    <link href="/2021/11/24/AVX003/"/>
    <url>/2021/11/24/AVX003/</url>
    
    <content type="html"><![CDATA[<h1 id="AVX-ifåˆ¤æ–­çš„å¤„ç†"><a href="#AVX-ifåˆ¤æ–­çš„å¤„ç†" class="headerlink" title="AVX-ifåˆ¤æ–­çš„å¤„ç†"></a>AVX-ifåˆ¤æ–­çš„å¤„ç†</h1><p>ä½¿ç”¨AVXæŒ‡ä»¤é›†å¯¹ifåˆ¤æ–­è¿›è¡Œå¤„ç†</p><h2 id="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"><a href="#ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»" class="headerlink" title="ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»"></a>ä½¿ç”¨åˆ°çš„AVXå‡½æ•°ä»‹ç»</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256d _mm256_blendv_pd (__m256d a, __m256d b, __m256d mask)<br></code></pre></div></td></tr></table></figure><p><strong>Description</strong></p><p>Blend packed double-precision (64-bit) floating-point elements from a and b using mask, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">FOR j := <span class="hljs-number">0</span> to <span class="hljs-number">3</span><br>i := j*<span class="hljs-number">64</span><br>IF mask[i+<span class="hljs-number">63</span>]<br>dst[i+<span class="hljs-number">63</span>:i] := b[i+<span class="hljs-number">63</span>:i]<br>ELSE<br>dst[i+<span class="hljs-number">63</span>:i] := a[i+<span class="hljs-number">63</span>:i]<br>FI<br>ENDFOR<br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">__m256d _mm256_cmp_pd (__m256d a, __m256d b, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> imm8)<br></code></pre></div></td></tr></table></figure><p><strong>Description</strong></p><p>Compare packed double-precision (64-bit) floating-point elements in a and b based on the comparison operand specified by imm8, and store the results in dst.</p><p><strong>Operation</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">CASE</span> (imm8[<span class="hljs-number">4</span>:<span class="hljs-number">0</span>]) OF<br><span class="hljs-number">0</span>: OP := _CMP_EQ_OQ<br><span class="hljs-number">1</span>: OP := _CMP_LT_OS<br><span class="hljs-number">2</span>: OP := _CMP_LE_OS<br><span class="hljs-number">3</span>: OP := _CMP_UNORD_Q <br><span class="hljs-number">4</span>: OP := _CMP_NEQ_UQ<br><span class="hljs-number">5</span>: OP := _CMP_NLT_US<br><span class="hljs-number">6</span>: OP := _CMP_NLE_US<br><span class="hljs-number">7</span>: OP := _CMP_ORD_Q<br><span class="hljs-number">8</span>: OP := _CMP_EQ_UQ<br><span class="hljs-number">9</span>: OP := _CMP_NGE_US<br><span class="hljs-number">10</span>: OP := _CMP_NGT_US<br><span class="hljs-number">11</span>: OP := _CMP_FALSE_OQ<br><span class="hljs-number">12</span>: OP := _CMP_NEQ_OQ<br><span class="hljs-number">13</span>: OP := _CMP_GE_OS<br><span class="hljs-number">14</span>: OP := _CMP_GT_OS<br><span class="hljs-number">15</span>: OP := _CMP_TRUE_UQ<br><span class="hljs-number">16</span>: OP := _CMP_EQ_OS<br><span class="hljs-number">17</span>: OP := _CMP_LT_OQ<br><span class="hljs-number">18</span>: OP := _CMP_LE_OQ<br><span class="hljs-number">19</span>: OP := _CMP_UNORD_S<br><span class="hljs-number">20</span>: OP := _CMP_NEQ_US<br><span class="hljs-number">21</span>: OP := _CMP_NLT_UQ<br><span class="hljs-number">22</span>: OP := _CMP_NLE_UQ<br><span class="hljs-number">23</span>: OP := _CMP_ORD_S<br><span class="hljs-number">24</span>: OP := _CMP_EQ_US<br><span class="hljs-number">25</span>: OP := _CMP_NGE_UQ <br><span class="hljs-number">26</span>: OP := _CMP_NGT_UQ <br><span class="hljs-number">27</span>: OP := _CMP_FALSE_OS <br><span class="hljs-number">28</span>: OP := _CMP_NEQ_OS <br><span class="hljs-number">29</span>: OP := _CMP_GE_OQ<br><span class="hljs-number">30</span>: OP := _CMP_GT_OQ<br><span class="hljs-number">31</span>: OP := _CMP_TRUE_US<br>ESAC<br>FOR j := <span class="hljs-number">0</span> to <span class="hljs-number">3</span><br>i := j*<span class="hljs-number">64</span><br>dst[i+<span class="hljs-number">63</span>:i] := ( a[i+<span class="hljs-number">63</span>:i] OP b[i+<span class="hljs-number">63</span>:i] ) ? <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span> : <span class="hljs-number">0</span><br>ENDFOR<br>dst[MAX:<span class="hljs-number">256</span>] := <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºæºä»£ç "><a href="#ç¨‹åºæºä»£ç " class="headerlink" title="ç¨‹åºæºä»£ç "></a>ç¨‹åºæºä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;immintrin.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">double</span> a[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>,<span class="hljs-number">4.4</span>,<span class="hljs-number">5.5</span>,<span class="hljs-number">6.6</span>,<span class="hljs-number">7.7</span>,<span class="hljs-number">8.8</span>,<span class="hljs-number">2.1</span>&#125;;<br><span class="hljs-keyword">double</span> b[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">2.1</span>,<span class="hljs-number">3.2</span>,<span class="hljs-number">6.4</span>,<span class="hljs-number">8.6</span>,<span class="hljs-number">3.7</span>,<span class="hljs-number">9.9</span>,<span class="hljs-number">5.1</span>,<span class="hljs-number">4.2</span>,<span class="hljs-number">6.6</span>&#125;;<br><span class="hljs-keyword">double</span> d[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">0</span>&#125;;     <span class="hljs-comment">//è®°å½•åŸå§‹ifåˆ¤æ–­åçš„å€¼</span><br><span class="hljs-keyword">double</span> e[<span class="hljs-number">9</span>]=&#123;<span class="hljs-number">0</span>&#125;;     <span class="hljs-comment">//è®°å½•AVX-ifåˆ¤æ–­åçš„å€¼</span><br><br>__m256d v0;<br>__m256d v1;<br>__m256d v2,v3;<br>__m256d v4;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(a[i]&gt;b[i])<br>&#123;<br>d[i] = a[i];<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>d[i]=b[i];<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-number">9</span><span class="hljs-number">-4</span>;i+=<span class="hljs-number">4</span>)<br>&#123;<br>v0 = _mm256_loadu_pd(a+i);<br>v1 = _mm256_loadu_pd(b+i);<br>v2=_mm256_add_pd(v0,v1);<br>v3 =_mm256_blendv_pd(v0,v1,_mm256_cmp_pd(v0,v1,_CMP_LE_OQ));<br>_mm256_storeu_pd(e+i,v3);<br><br>&#125;<br>    <br><span class="hljs-keyword">for</span>(;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(a[i]&gt;b[i])<br>&#123;<br>e[i] = a[i];<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>e[i]=b[i];<br>&#125;<br>&#125;<br>    <br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is d.\n&quot;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf\n&quot;</span>,d[i]);<br>&#125;<br>    <br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is e with AVX.\n&quot;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i++)<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf\n&quot;</span>,e[i]);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125; <br></code></pre></div></td></tr></table></figure><h2 id="ç¨‹åºè¾“å‡º"><a href="#ç¨‹åºè¾“å‡º" class="headerlink" title="ç¨‹åºè¾“å‡º"></a>ç¨‹åºè¾“å‡º</h2><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">this</span> is d.<br><span class="hljs-number">2.100000</span><br><span class="hljs-number">3.200000</span><br><span class="hljs-number">6.400000</span><br><span class="hljs-number">8.600000</span><br><span class="hljs-number">5.500000</span><br><span class="hljs-number">9.900000</span><br><span class="hljs-number">7.700000</span><br><span class="hljs-number">8.800000</span><br><span class="hljs-number">6.600000</span><br><span class="hljs-keyword">this</span> is e with AVX.<br><span class="hljs-number">2.100000</span><br><span class="hljs-number">3.200000</span><br><span class="hljs-number">6.400000</span><br><span class="hljs-number">8.600000</span><br><span class="hljs-number">5.500000</span><br><span class="hljs-number">9.900000</span><br><span class="hljs-number">7.700000</span><br><span class="hljs-number">8.800000</span><br><span class="hljs-number">6.600000</span><br></code></pre></div></td></tr></table></figure><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p>[<a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/]">https://software.intel.com/sites/landingpage/IntrinsicsGuide/]</a>: â€œ IntelÂ® Intrinsics Guideâ€</p><p>[<a href="https://stackoverflow.com/questions/16988199/how-to-choose-avx-compare-predicate-variants">simd - How to choose AVX compare predicate variants - Stack Overflow</a>]: â€œStack Overflowâ€</p><p>[<a href="https://www.officedaytime.com/simd512e/simdimg/si.php?f=blendvpd">blendvpd (officedaytime.com)</a>]: â€œ_mm256_Blendv_pd()åŸç†è§£é‡Šâ€</p>]]></content>
    
    
    <categories>
      
      <category>HPC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AVX</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
